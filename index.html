<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style.css" rel="stylesheet" type="text/css" /><title>Mastering Microsoft Power BI (for pre sume)</title></head><body><div class="calibre1" id="calibre_link-53">
<div id="calibre_link-424" class="calibre2">
<div id="calibre_link-425" class="calibre3"><section class="calibre4">

            
            <article class="calibre5">
                
<div class="title-page-name"><strong class="calibre6"><span>Mastering Microsoft Power BI</span><br class="calibre3" />
<br class="calibre3" /></strong>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
</div>
<div class="title-page-name"><span>Expert techniques for effective data analytics and business intelligence</span></div>
<p class="calibre7"></p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<div class="title-page-name"><span>Brett Powell</span></div>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"> </p>
<p class="calibre7"></p>
<div class="title-page-name"><img class="alignnone" src="images/000056.png" /></div>
<div class="cdpalignleft"><strong class="calibre6"><strong class="calibre6">BIRMINGHAM - MUMBAI</strong></strong></div>
<p class="calibre7"></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-54">
<div id="calibre_link-426" class="calibre2">
<div id="calibre_link-427" class="calibre3"><section class="calibre4">

            
            <article class="calibre5">
                


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-55">
<div id="calibre_link-428" class="calibre2">
<div id="calibre_link-429" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Mastering Microsoft Power BI</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre8">Copyright Â© 2018 Packt Publishing</p>
<p class="calibre8">All rights reserved. No part of this book may be reproduced, stored in a retrieval system, or transmitted in any form or by any means, without the prior written permission of the publisher, except in the case of brief quotations embedded in critical articles or reviews.</p>
<p class="calibre8">Every effort has been made in the preparation of this book to ensure the accuracy of the information presented. However, the information contained in this book is sold without warranty, either express or implied. Neither the author(s), nor Packt Publishing or its dealers and distributors, will be held liable for any damages caused or alleged to have been caused directly or indirectly by this book.</p>
<p class="calibre8">Packt Publishing has endeavored to provide trademark information about all of the companies and products mentioned in this book by the appropriate use of capitals. However, Packt Publishing cannot guarantee the accuracy of this information.</p>
<p class="calibre8"><strong class="calibre6">Commissioning Editor:</strong> Amey Varangaonkar<br class="calibre3" />
<strong class="calibre6">Acquisition Editor:</strong> <span>Divya Poojari</span><br class="calibre3" />
<strong class="calibre6">Content Development Editor:</strong><span> Amrita Noronha</span><br class="calibre3" />
<strong class="calibre6">Technical Editor:</strong><span> Sneha Hanchate</span><br class="calibre3" />
<strong class="calibre6">Copy Editors:</strong><span> Safis Editing, Vikrant Phadkay</span><br class="calibre3" />
<strong class="calibre6">Project Coordinator:</strong> <span>Shweta Birwatkar</span><br class="calibre3" />
<strong class="calibre6">Proofreader:</strong><span> Safis Editing</span><br class="calibre3" />
<strong class="calibre6">Indexer:</strong> <span>Aishwarya Gangawane</span><br class="calibre3" />
<strong class="calibre6">Graphics:</strong> <span>Jisha Chirayil</span><br class="calibre3" />
<strong class="calibre6">Production Coordinator:</strong> <span>Shantanu Zagade</span></p>
<p class="calibre8">First published: March 2018</p>
<p class="calibre8">Production reference: 1280318</p>
<p class="calibre8">Published by Packt Publishing Ltd.<br class="calibre3" />
Livery Place<br class="calibre3" />
35 Livery Street<br class="calibre3" />
Birmingham<br class="calibre3" />
B3 2PB, UK.</p>
<p class="calibre8">ISBN <span>978-1-78829-723-3</span></p>
<p class="calibre8"><a href="http://www.packtpub.com" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">www.packtpub.com</a></p>
<p class="calibre7"></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-56">
<div id="calibre_link-430" class="calibre2">
<div id="calibre_link-431" class="calibre3"><section class="calibre4">

            
            <article class="calibre5">
                
<p class="calibre7"> </p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<p class="calibre7"></p>
<div class="packt_quote">
<p class="mce-root"><q class="pcalibre4 calibre10 pcalibre5">To my mother, Cathy, and my brother, Dustin. I love you both.</q></p>
</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-57">
<div id="calibre_link-432" class="calibre2">
<div id="calibre_link-433" class="calibre3"><section class="calibre4">

            
            <article class="calibre5">
                
<div class="cdpalignleft"><img src="images/000066.jpg" class="calibre11" /></div>
<div class="cdpalignleft"><span><a href="https://mapt.io/" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">mapt.io</a></span></div>
<p class="calibre7">Mapt is an online digital library that gives you full access to over 5,000 books and videos, as well as industry leading tools to help you plan your personal development and advance your career. For more information, please visit our website.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-58">
<div id="calibre_link-434" class="calibre2">
<div id="calibre_link-435" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Why subscribe?</h1>
                </header>
            
            <article class="calibre5">
                
<ul class="calibre12">
<li class="calibre13">
<p class="calibre14">Spend less time learning and more time coding with practical eBooks and Videos from over 4,000 industry professionals</p>
</li>
<li class="calibre13">
<p class="calibre14"><span>Improve your learning with Skill Plans built especially for you</span></p>
</li>
<li class="calibre13">
<p class="calibre14"><span>Get a free eBook or video every month</span></p>
</li>
<li class="calibre13">
<p class="calibre14"><span>Mapt is fully searchable</span></p>
</li>
<li class="calibre13">
<p class="calibre14"><span>Copy and paste, print, and bookmark content</span></p>
</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-59">
<div id="calibre_link-436" class="calibre2">
<div id="calibre_link-437" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">PacktPub.com</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Did you know that Packt offers eBook versions of every book published, with PDF and ePub files available? You can upgrade to the eBook version at <span><a href="http://www.PacktPub.com" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">www.PacktPub.com</a></span> and as a print book customer, you are entitled to a discount on the eBook copy. Get in touch with us at <kbd class="calibre15"><span>service@packtpub.com</span></kbd> for more details.</p>
<p class="calibre7">At <span><a href="http://www.packtpub.com" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">www.PacktPub.com</a></span>, you can also read a collection of free technical articles, sign up for a range of free newsletters, and receive exclusive discounts and offers on Packt books and eBooks.</p>
<p class="calibre7"></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-60">
<div id="calibre_link-438" class="calibre2">
<div id="calibre_link-439" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Contributors</h1>
                </header>
            
            <article class="calibre5">
                


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-61">
<div id="calibre_link-440" class="calibre2">
<div id="calibre_link-441" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">About the author</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span><strong class="calibre6">Brett Powell</strong> is the owner of Frontline Analytics, a data and analytics consulting firm and Microsoft Power BI partner. He has worked with Power BI technologies since they were first introduced with the Power Pivot add-in for Excel 2010 and has contributed to the design and delivery of Microsoft BI solutions across retail, manufacturing, finance, and professional services. He is also the author of</span> <em class="calibre16">Microsoft Power BI Cookbook</em><span> and</span><em class="calibre16"> </em><span>a regular speaker at Microsoft technology events such as the Power BI World Tour and the Data &amp; BI Summit. He regularly shares technical tips and examples on his blog, Insight Quest, and is a co-</span>organizer of the Boston BI User Group.  </p>
<div class="packt_quote1">I'd like to thank Packt for giving me this opportunity, the content and technical editing teams, and particularly Divya Poojari, acquisition editor, and Amrita Noronha, senior content development editor. As Power BI continues to evolve, it is necessary to be flexible with the outline and page counts, and I greatly appreciated this autonomy.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-62">
<div id="calibre_link-442" class="calibre2">
<div id="calibre_link-443" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">About the reviewer</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><strong class="calibre6">Ruben Oliva Ramos</strong> is a computer engineer from Tecnologico of LeÃ³n Institute, with a master's degree in computer and electronics systems engineering and networking specialization from the University of Salle Bajio. He has more than 5 years' experience of developing web apps to control and monitor devices connected to Arduino and Raspberry Pi, using web frameworks and cloud services to build IoT applications. He has authored <em class="calibre16">Raspberry Pi 3 Home Automation Projects</em>, <em class="calibre16">Internet of Things Programming with JavaScript</em>, <em class="calibre16">Advanced Analytics with R and Tableau</em>, and <em class="calibre16">SciPy Recipes</em> for <span>Packt</span>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-63">
<div id="calibre_link-444" class="calibre2">
<div id="calibre_link-445" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Packt is searching for authors like you</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">If you're interested in becoming an author for Packt, please visit <a href="http://authors.packtpub.com" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">authors.packtpub.com</a> and apply today. We have worked with thousands of developers and tech professionals, just like you, to help them share their insight with the global tech community. You can make a general application, apply for a specific hot topic that we are recruiting an author for, or submit your own idea.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-52">
<div id="calibre_link-446" class="calibre2">
<div id="calibre_link-447" class="calibre3"><section class="calibre4">             <header class="calibre5">                 <h1 class="header-title">Table of Contents</h1>             </header>              <article class="calibre5">                 <nav type="toc" id="calibre_link-448" class="calibre5">                     
<ol class="calibre12"><li hidden="hidden" class="front-matter">             <a href="#calibre_link-53" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Title Page</a>           </li> <li hidden="hidden" class="front-matter">             <a href="#calibre_link-54" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Copyright and Credits</a>          
<ol class="calibre17"><li hidden="hidden" class="front-matter">             <a href="#calibre_link-55" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Mastering Microsoft Power BI</a>           </li> </ol> </li> <li hidden="hidden" class="front-matter">             <a href="#calibre_link-56" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dedication</a>           </li> <li hidden="hidden" class="front-matter">             <a href="#calibre_link-57" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Packt Upsell</a>          
<ol class="calibre17"><li hidden="hidden" class="front-matter">             <a href="#calibre_link-58" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Why subscribe?</a>           </li> <li hidden="hidden" class="front-matter">             <a href="#calibre_link-59" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">PacktPub.com</a>           </li> </ol> </li> <li hidden="hidden" class="front-matter">             <a href="#calibre_link-60" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Contributors</a>          
<ol class="calibre17"><li hidden="hidden" class="front-matter">             <a href="#calibre_link-61" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">About the author</a>           </li> <li hidden="hidden" class="front-matter">             <a href="#calibre_link-62" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">About the reviewer</a>           </li> <li hidden="hidden" class="front-matter">             <a href="#calibre_link-63" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Packt is searching for authors like you</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-64" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Preface</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-65" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Who this book is for</a>           </li> <li class="front-matter">             <a href="#calibre_link-66" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">What this book covers</a>           </li> <li class="front-matter">             <a href="#calibre_link-67" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">To get the most out of this book</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-68" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Download the example code files</a>           </li> <li class="front-matter">             <a href="#calibre_link-69" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Download the color images</a>           </li> <li class="front-matter">             <a href="#calibre_link-70" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Conventions used</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-71" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Get in touch</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-72" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Reviews</a>           </li> </ol> </li> </ol> </li> <li value="1" class="chapter">             <a href="#calibre_link-73" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Planning Power BI Projects</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-74" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI deployment modes</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-75" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Corporate BI</a>           </li> <li class="front-matter">             <a href="#calibre_link-76" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Self-Service Visualization</a>           </li> <li class="front-matter">             <a href="#calibre_link-77" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Self-Service BI</a>           </li> <li class="front-matter">             <a href="#calibre_link-78" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Choosing a deployment mode</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-79" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Project discovery and ingestion</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-80" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Sample Power BI project template </a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-81" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Sample template &ndash; Adventure Works BI</a>           </li> </ol> </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-82" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI project roles</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-83" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dataset designer</a>           </li> <li class="front-matter">             <a href="#calibre_link-84" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Report authors</a>           </li> <li class="front-matter">             <a href="#calibre_link-5" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI admin</a>           </li> <li class="front-matter">             <a href="#calibre_link-19" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Project role collaboration</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-31" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI licenses</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-45" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI license scenarios</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-85" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI Premium features</a>           </li> </ol> </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-86" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Data warehouse bus matrix</a>           </li> <li class="front-matter">             <a href="#calibre_link-87" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dataset design process</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-88" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Selecting the business process</a>           </li> <li class="front-matter">             <a href="#calibre_link-16" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Declaring the grain</a>           </li> <li class="front-matter">             <a href="#calibre_link-89" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Identifying the dimensions</a>           </li> <li class="front-matter">             <a href="#calibre_link-90" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Defining the facts</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-91" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Data profiling</a>           </li> <li class="front-matter">             <a href="#calibre_link-92" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dataset planning</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-93" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Data transformations</a>           </li> <li class="front-matter">             <a href="#calibre_link-94" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Import versus DirectQuery</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-95" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Import mode </a>           </li> <li class="front-matter">             <a href="#calibre_link-96" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">DirectQuery mode</a>           </li> </ol> </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-97" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Sample project analysis</a>           </li> <li class="front-matter">             <a href="#calibre_link-98" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Summary</a>           </li> </ol> </li> <li value="2" class="chapter">             <a href="#calibre_link-22" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Connecting to Sources and Transforming Data with M</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-99" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Query design per dataset mode</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-100" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Import mode dataset queries</a>           </li> <li class="front-matter">             <a href="#calibre_link-101" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">DirectQuery dataset queries</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-102" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Data sources</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-103" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Authentication</a>           </li> <li class="front-matter">             <a href="#calibre_link-104" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Data source settings</a>           </li> <li class="front-matter">             <a href="#calibre_link-105" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Privacy levels</a>           </li> <li class="front-matter">             <a href="#calibre_link-106" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI as a data source</a>           </li> <li class="front-matter">             <a href="#calibre_link-107" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI Desktop options</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-108" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Global options</a>           </li> <li class="front-matter">             <a href="#calibre_link-109" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">CURRENT FILE options</a>           </li> </ol> </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-110" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">SQL views</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-111" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">SQL views versus M queries</a>           </li> <li class="front-matter">             <a href="#calibre_link-112" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">SQL view examples</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-113" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Date dimension view</a>           </li> <li class="front-matter">             <a href="#calibre_link-114" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Mark As Date Table</a>           </li> <li class="front-matter">             <a href="#calibre_link-115" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Product Dimension view</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-116" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Slowly-changing dimensions</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-117" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">M queries</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-118" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Data Source Parameters</a>           </li> <li class="front-matter">             <a href="#calibre_link-119" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Staging Queries</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-120" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">DirectQuery staging</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-0" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Fact and dimension queries</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-12" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Source Reference Only</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-26" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">M query summary</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-37" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Excel workbook &ndash; Annual Sales Plan</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-49" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Data types</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-121" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Item access in M</a>           </li> <li class="front-matter">             <a href="#calibre_link-122" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">DirectQuery report execution</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-123" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Bridge Tables Queries</a>           </li> <li class="front-matter">             <a href="#calibre_link-124" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Parameter Tables</a>           </li> <li class="front-matter">             <a href="#calibre_link-125" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Security Tables</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-126" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Query folding</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-127" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Partial query folding</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-128" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">M Query examples</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-129" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Trailing three years filter</a>           </li> <li class="front-matter">             <a href="#calibre_link-130" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Customer history column</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-131" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Derived column data types</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-132" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Product dimension integration</a>           </li> <li class="front-matter">             <a href="#calibre_link-133" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">R script transformation</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-134" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">M editing tools</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-135" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Advanced Editor</a>           </li> <li class="front-matter">             <a href="#calibre_link-136" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Visual Studio Code</a>           </li> <li class="front-matter">             <a href="#calibre_link-137" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Visual Studio</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-138" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Summary</a>           </li> </ol> </li> <li value="3" class="chapter">             <a href="#calibre_link-23" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Designing Import and DirectQuery Data Models</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-139" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dataset layers</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-140" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dataset objectives</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-141" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Competing objectives</a>           </li> <li class="front-matter">             <a href="#calibre_link-142" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">External factors</a>           </li> </ol> </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-143" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">The Data Model </a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-144" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">The Relationships View</a>           </li> <li class="front-matter">             <a href="#calibre_link-145" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">The Data View</a>           </li> <li class="front-matter">             <a href="#calibre_link-146" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">The Report View</a>           </li> <li class="front-matter">             <a href="#calibre_link-147" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Fact tables</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-148" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Fact table columns</a>           </li> <li class="front-matter">             <a href="#calibre_link-149" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Fact column data types</a>           </li> <li class="front-matter">             <a href="#calibre_link-150" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Fact-to-dimension relationships</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-151" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dimension tables</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-152" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Hierarchies</a>           </li> <li class="front-matter">             <a href="#calibre_link-153" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Custom sort</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-154" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Bridge tables</a>           </li> <li class="front-matter">             <a href="#calibre_link-155" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Parameter tables</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-156" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Measure groups</a>           </li> <li class="front-matter">             <a href="#calibre_link-157" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Last refreshed date</a>           </li> <li class="front-matter">             <a href="#calibre_link-3" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Measure support logic</a>           </li> </ol> </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-17" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Relationships</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-29" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Uniqueness </a>           </li> <li class="front-matter">             <a href="#calibre_link-40" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Ambiguity</a>           </li> <li class="front-matter">             <a href="#calibre_link-158" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Single-direction relationships</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-159" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Direct flights only</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-160" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Bidirectional relationships</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-161" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Shared dimensions</a>           </li> <li class="front-matter">             <a href="#calibre_link-162" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Date dimensions </a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-163" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">The CROSSFILTER function</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-164" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Model metadata</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-165" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Visibility</a>           </li> <li class="front-matter">             <a href="#calibre_link-166" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Column metadata</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-167" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Default Summarization</a>           </li> <li class="front-matter">             <a href="#calibre_link-168" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Data format</a>           </li> <li class="front-matter">             <a href="#calibre_link-169" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Data category</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-170" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Field descriptions</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-171" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Optimizing performance</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-172" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Import</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-173" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Columnar compression</a>           </li> <li class="front-matter">             <a href="#calibre_link-174" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Memory analysis via DMVs</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-175" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">DirectQuery </a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-176" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Optimized DAX functions</a>           </li> <li class="front-matter">             <a href="#calibre_link-177" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Columnstore and HTAP</a>           </li> </ol> </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-178" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Summary</a>           </li> </ol> </li> <li value="4" class="chapter">             <a href="#calibre_link-25" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Developing DAX Measures and Security Roles</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-179" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">DAX measures</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-180" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Filter context</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-181" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">SQL equivalent</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-182" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Measure evaluation process</a>           </li> <li class="front-matter">             <a href="#calibre_link-183" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Row context</a>           </li> <li class="front-matter">             <a href="#calibre_link-184" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Scalar and table functions</a>           </li> <li class="front-matter">             <a href="#calibre_link-185" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">The CALCULATE() function</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-186" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Related tables</a>           </li> <li class="front-matter">             <a href="#calibre_link-187" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">The FILTER() function</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-188" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">DAX variables</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-189" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Base measures</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-190" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Measure support expressions</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-191" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">KPI Targets</a>           </li> <li class="front-matter">             <a href="#calibre_link-192" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Current and prior periods</a>           </li> </ol> </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-193" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Date intelligence metrics</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-194" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Current versus prior and growth rates</a>           </li> <li class="front-matter">             <a href="#calibre_link-7" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Rolling periods</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-20" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dimension metrics</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-32" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Missing dimensions</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-47" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Ranking metrics</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-195" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dynamic ranking measures</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-196" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Security roles</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-197" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dynamic row-level security</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-198" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Performance testing</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-199" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">DAX Studio</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-200" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Tracing a Power BI dataset via DAX Studio</a>           </li> </ol> </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-201" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Summary</a>           </li> </ol> </li> <li value="5" class="chapter">             <a href="#calibre_link-202" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Creating and Formatting Power BI Reports</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-203" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Report planning</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-204" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI report architecture</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-205" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Live connections to Power BI datasets</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-206" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Customizing Live connection reports</a>           </li> <li class="front-matter">             <a href="#calibre_link-207" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Switching source datasets</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-208" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Visualization best practices</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-209" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Visualization anti-patterns</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-210" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Choosing the visual</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-211" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Tables versus charts</a>           </li> <li class="front-matter">             <a href="#calibre_link-212" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chart selection</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-213" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Visual interactions</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-214" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Edit interactions</a>           </li> <li class="front-matter">             <a href="#calibre_link-215" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">What-if parameters</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-216" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Slicers</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-217" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Slicer synchronization</a>           </li> <li class="front-matter">             <a href="#calibre_link-218" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Custom slicer parameters</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-219" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Report filter scopes</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-220" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Report filter conditions</a>           </li> <li class="front-matter">             <a href="#calibre_link-221" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Report and page filters</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-222" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Page filter or slicer?</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-223" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Relative date filtering</a>           </li> <li class="front-matter">             <a href="#calibre_link-224" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Visual-level filtering</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-225" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Top N visual-level filters</a>           </li> </ol> </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-226" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Visualization formatting</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-227" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Visual-level formatting</a>           </li> <li class="front-matter">             <a href="#calibre_link-228" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Line and column charts</a>           </li> <li class="front-matter">             <a href="#calibre_link-229" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Tooltips</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-230" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Report page tooltips</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-231" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Column and line chart conditional formatting</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-232" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Column chart conditional formatting</a>           </li> <li class="front-matter">             <a href="#calibre_link-1" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Line chart conditional formatting</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-13" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Table and matrix</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-27" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Table and matrix conditional formatting</a>           </li> <li class="front-matter">             <a href="#calibre_link-38" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Values as rows</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-50" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Scatter charts</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-233" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Map visuals</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-234" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Bubble map</a>           </li> <li class="front-matter">             <a href="#calibre_link-235" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Filled map</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-236" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Mobile-optimized reports</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-237" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Responsive visuals</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-238" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Report design summary</a>           </li> <li class="front-matter">             <a href="#calibre_link-239" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Summary</a>           </li> </ol> </li> <li value="6" class="chapter">             <a href="#calibre_link-44" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Applying Custom Visuals, Animation, and Analytics</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-240" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Drillthrough report pages</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-241" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Custom labels and the back button</a>           </li> <li class="front-matter">             <a href="#calibre_link-242" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Multi-column drillthrough</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-243" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Bookmarks</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-244" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Selection pane and the Spotlight property</a>           </li> <li class="front-matter">             <a href="#calibre_link-245" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Custom report navigation</a>           </li> <li class="front-matter">             <a href="#calibre_link-246" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">View mode</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-247" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">ArcGIS Map visual for Power BI</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-248" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">ArcGIS Maps Plus subscriptions</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-249" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Waterfall chart breakdown</a>           </li> <li class="front-matter">             <a href="#calibre_link-250" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Analytics pane</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-251" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Trend Line</a>           </li> <li class="front-matter">             <a href="#calibre_link-252" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Forecast line</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-253" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Quick Insights </a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-254" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Explain the increase/decrease</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-255" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Custom visuals</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-256" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Adding a custom visual</a>           </li> <li class="front-matter">             <a href="#calibre_link-257" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power KPI visual</a>           </li> <li class="front-matter">             <a href="#calibre_link-258" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chiclet Slicer</a>           </li> <li class="front-matter">             <a href="#calibre_link-259" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Impact Bubble Chart</a>           </li> <li class="front-matter">             <a href="#calibre_link-260" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dot Plot by Maq Software</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-261" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Animation and data storytelling</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-262" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Play axis for scatter charts</a>           </li> <li class="front-matter">             <a href="#calibre_link-263" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Pulse Chart</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-264" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Summary</a>           </li> </ol> </li> <li value="7" class="chapter">             <a href="#calibre_link-265" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Designing Power BI Dashboards and Architectures</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-266" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dashboards versus reports</a>           </li> <li class="front-matter">             <a href="#calibre_link-267" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dashboard design</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-268" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Visual selection</a>           </li> <li class="front-matter">             <a href="#calibre_link-4" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Layout</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-18" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Navigation pane</a>           </li> <li class="front-matter">             <a href="#calibre_link-30" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Full screen mode</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-41" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Supporting tiles</a>           </li> <li class="front-matter">             <a href="#calibre_link-269" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Custom date filters</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-270" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Multi-dashboard architectures</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-271" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Single-dashboard architecture</a>           </li> <li class="front-matter">             <a href="#calibre_link-272" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Multiple-dashboard architecture</a>           </li> <li class="front-matter">             <a href="#calibre_link-273" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Organizational dashboard architecture</a>           </li> <li class="front-matter">             <a href="#calibre_link-274" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Multiple datasets</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-275" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dashboard tiles</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-276" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Tile details and custom links</a>           </li> <li class="front-matter">             <a href="#calibre_link-277" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Images and text boxes</a>           </li> <li class="front-matter">             <a href="#calibre_link-278" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">SQL Server Reporting Services</a>           </li> <li class="front-matter">             <a href="#calibre_link-279" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Excel workbooks</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-280" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Live report pages</a>           </li> <li class="front-matter">             <a href="#calibre_link-281" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Mobile-optimized dashboards</a>           </li> <li class="front-matter">             <a href="#calibre_link-282" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Summary</a>           </li> </ol> </li> <li value="8" class="chapter">             <a href="#calibre_link-10" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Managing Application Workspaces and Content</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-283" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Application workspaces</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-284" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Workspace roles and rights</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-285" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Workspace admins</a>           </li> <li class="front-matter">             <a href="#calibre_link-286" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Workspace members</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-287" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">My Workspace</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-288" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Staged deployments</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-289" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Workspace datasets</a>           </li> <li class="front-matter">             <a href="#calibre_link-290" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI REST API</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-291" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Client application ID</a>           </li> <li class="front-matter">             <a href="#calibre_link-292" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Workspace and content IDs</a>           </li> <li class="front-matter">             <a href="#calibre_link-293" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">PowerShell sample scripts</a>           </li> </ol> </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-294" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dashboard data classifications</a>           </li> <li class="front-matter">             <a href="#calibre_link-295" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Version control</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-296" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">OneDrive for Business version history</a>           </li> <li class="front-matter">             <a href="#calibre_link-297" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Source control for M and DAX code</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-298" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Metadata management</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-299" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Field descriptions</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-300" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Creating descriptions</a>           </li> <li class="front-matter">             <a href="#calibre_link-301" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">View field descriptions</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-302" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Metadata reporting</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-303" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Query field descriptions</a>           </li> <li class="front-matter">             <a href="#calibre_link-304" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Standard metadata reports</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-305" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Server and database parameters</a>           </li> <li class="front-matter">             <a href="#calibre_link-306" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Querying the DMVs from Power BI</a>           </li> <li class="front-matter">             <a href="#calibre_link-8" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Integrating and enhancing DMV data</a>           </li> <li class="front-matter">             <a href="#calibre_link-21" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Metadata report pages</a>           </li> </ol> </li> </ol> </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-33" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Summary</a>           </li> </ol> </li> <li value="9" class="chapter">             <a href="#calibre_link-15" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Managing the On-Premises Data Gateway</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-307" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">On-premises data gateway planning</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-308" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Top gateway planning tasks</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-309" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Determining whether a gateway is needed</a>           </li> <li class="front-matter">             <a href="#calibre_link-310" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Identifying where the gateway should be installed</a>           </li> <li class="front-matter">             <a href="#calibre_link-311" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Defining the gateway infrastructure and hardware requirements</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-312" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">On-premises data gateway versus personal mode</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-313" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Gateway clusters</a>           </li> <li class="front-matter">             <a href="#calibre_link-314" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Gateway architectures</a>           </li> <li class="front-matter">             <a href="#calibre_link-315" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Gateway security</a>           </li> <li class="front-matter">             <a href="#calibre_link-316" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Gateway configuration</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-317" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">The gateway service account</a>           </li> <li class="front-matter">             <a href="#calibre_link-318" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">TCP versus HTTPS mode </a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-319" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Managing gateway clusters</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-320" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Gateway administrators</a>           </li> <li class="front-matter">             <a href="#calibre_link-321" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Gateway data sources and users</a>           </li> <li class="front-matter">             <a href="#calibre_link-322" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">PowerShell support for gateway clusters</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-323" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Troubleshooting and monitoring gateways</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-324" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Restoring, migrating, and taking over a gateway</a>           </li> <li class="front-matter">             <a href="#calibre_link-325" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Gateway log files</a>           </li> <li class="front-matter">             <a href="#calibre_link-326" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Performance Monitor counters</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-327" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Scheduled data refresh</a>           </li> <li class="front-matter">             <a href="#calibre_link-328" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">DirectQuery datasets</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-329" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Single sign-on to DirectQuery sources via Kerberos</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-330" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Live connections to Analysis Services models</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-331" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Azure Analysis Services refresh</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-332" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dashboard cache refresh</a>           </li> <li class="front-matter">             <a href="#calibre_link-333" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Summary</a>           </li> </ol> </li> <li value="10" class="chapter">             <a href="#calibre_link-11" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Deploying the Power BI Report Server</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-334" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Planning for the Power BI Report Server</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-335" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Feature differences with the Power BI service</a>           </li> <li class="front-matter">             <a href="#calibre_link-336" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Parity with SQL Server Reporting Services</a>           </li> <li class="front-matter">             <a href="#calibre_link-337" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Data sources and connectivity options</a>           </li> <li class="front-matter">             <a href="#calibre_link-338" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Hardware and user licensing</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-339" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Pro licenses for report authors</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-340" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Alternative and hybrid deployment models</a>           </li> <li class="front-matter">             <a href="#calibre_link-341" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Report Server reference topology</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-342" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Installation</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-343" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Hardware and software requirements</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-344" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Analysis Services Integrated</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-345" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Retrieve the Report Server product key</a>           </li> <li class="front-matter">             <a href="#calibre_link-42" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Migrating from SQL Server Reporting Services</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-34" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Configuration</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-346" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Service Account</a>           </li> <li class="front-matter">             <a href="#calibre_link-347" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Remote Report Server Database</a>           </li> <li class="front-matter">             <a href="#calibre_link-348" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Office Online Server for Excel Workbooks</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-43" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Upgrade cycles </a>           </li> <li class="front-matter">             <a href="#calibre_link-349" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Report Server Desktop Application</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-350" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Running desktop versions side by side</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-351" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Report Server Web Portal</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-352" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Scheduled data refresh</a>           </li> <li class="front-matter">             <a href="#calibre_link-353" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Data source authentication</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-354" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI mobile applications</a>           </li> <li class="front-matter">             <a href="#calibre_link-355" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Report server administration</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-356" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Securing Power BI report content</a>           </li> <li class="front-matter">             <a href="#calibre_link-357" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Execution logs</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-358" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Scale Power BI Report Server</a>           </li> <li class="front-matter">             <a href="#calibre_link-359" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Summary</a>           </li> </ol> </li> <li value="11" class="chapter">             <a href="#calibre_link-36" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Creating Power BI Apps and Content Distribution</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-360" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Content distribution methods</a>           </li> <li class="front-matter">             <a href="#calibre_link-361" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI apps</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-362" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Licensing apps</a>           </li> <li class="front-matter">             <a href="#calibre_link-363" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">App deployment process</a>           </li> <li class="front-matter">             <a href="#calibre_link-364" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">User permissions</a>           </li> <li class="front-matter">             <a href="#calibre_link-365" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Publishing apps</a>           </li> <li class="front-matter">             <a href="#calibre_link-366" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Installing apps</a>           </li> <li class="front-matter">             <a href="#calibre_link-367" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Apps on Power BI mobile</a>           </li> <li class="front-matter">             <a href="#calibre_link-368" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">App updates</a>           </li> <li class="front-matter">             <a href="#calibre_link-369" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Dataset-to-workspace relationship</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-370" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Self-Service BI workspace</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-371" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Self-Service content distribution</a>           </li> <li class="front-matter">             <a href="#calibre_link-372" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Risks to Self-Service BI</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-373" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Sharing dashboards and reports</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-374" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Sharing scopes</a>           </li> <li class="front-matter">             <a href="#calibre_link-375" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Sharing versus Power BI apps</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-376" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">SharePoint Online embedding</a>           </li> <li class="front-matter">             <a href="#calibre_link-377" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Custom application embedding</a>           </li> <li class="front-matter">             <a href="#calibre_link-378" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Publish to web</a>           </li> <li class="front-matter">             <a href="#calibre_link-379" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Data alerts</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-380" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Microsoft Flow integration</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-381" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Email Subscriptions</a>           </li> <li class="front-matter">             <a href="#calibre_link-382" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Analyze in Excel</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-383" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI Publisher for Excel</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-384" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Summary</a>           </li> </ol> </li> <li value="12" class="chapter">             <a href="#calibre_link-6" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Administering Power BI for an Organization</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-385" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Data governance for Power BI</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-9" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Implementing data governance</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-24" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Azure Active Directory</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-35" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Azure AD B2B collaboration</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-48" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Licensing external users</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-386" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Conditional access policies</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-387" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI Admin Portal</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-388" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Usage metrics</a>           </li> <li class="front-matter">             <a href="#calibre_link-389" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Users and Audit logs</a>           </li> <li class="front-matter">             <a href="#calibre_link-390" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Tenant settings</a>           </li> <li class="front-matter">             <a href="#calibre_link-391" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Embed Codes</a>           </li> <li class="front-matter">             <a href="#calibre_link-392" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Organizational Custom visuals</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-393" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Usage metrics reports</a>           </li> <li class="front-matter">             <a href="#calibre_link-394" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Audit logs</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-395" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Audit log monitoring solutions</a>           </li> <li class="front-matter">             <a href="#calibre_link-396" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Audit logs solution template</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-397" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI Premium capacities</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-398" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Capacity allocation</a>           </li> <li class="front-matter">             <a href="#calibre_link-399" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Create, size, and monitor capacities</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-400" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Change capacity size</a>           </li> <li class="front-matter">             <a href="#calibre_link-401" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Monitor premium capacities</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-402" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">App workspace assignment</a>           </li> <li class="front-matter">             <a href="#calibre_link-403" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Capacity admins</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-404" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Summary</a>           </li> </ol> </li> <li value="13" class="chapter">             <a href="#calibre_link-46" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Scaling with Premium and Analysis Services</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-405" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI Premium</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-406" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI Premium capabilities</a>           </li> <li class="front-matter">             <a href="#calibre_link-407" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Corporate Power BI datasets</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-408" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Limitation of Corporate BI datasets &ndash; Reusability</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-409" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Premium capacity nodes</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-410" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Frontend versus backend resources</a>           </li> </ol> </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-411" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI Premium capacity allocation</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-412" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Corporate and Self-Service BI capacity </a>           </li> <li class="front-matter">             <a href="#calibre_link-413" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Power BI Premium resource utilization</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-414" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Data model optimizations</a>           </li> <li class="front-matter">             <a href="#calibre_link-415" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Report and visualization optimizations</a>           </li> </ol> </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-416" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Premium capacity estimations</a>           </li> <li class="front-matter">             <a href="#calibre_link-417" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Analysis Services</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-418" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Analysis Services Models versus Power BI Desktop</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-419" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Scale</a>           </li> <li class="front-matter">             <a href="#calibre_link-420" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Usability</a>           </li> <li class="front-matter">             <a href="#calibre_link-421" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Development and management tools</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-422" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Azure Analysis Services versus SSAS</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-2" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">SSAS to Azure AS Migration</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-14" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Provision Azure Analysis Services </a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-28" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Migration of Power BI Desktop to Analysis Services</a>           </li> <li class="front-matter">             <a href="#calibre_link-39" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Summary</a>           </li> </ol> </li> <li class="front-matter">             <a href="#calibre_link-51" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Other Books You May Enjoy</a>          
<ol class="calibre17"><li class="front-matter">             <a href="#calibre_link-423" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Leave a review - let other readers know what you think</a>           </li> </ol> </li> </ol>                 </nav>             </article>              <footer class="calibre18"></footer>         </section>     </div>
</div>
</div>


<div class="calibre1" id="calibre_link-64">
<div id="calibre_link-449" class="calibre2">
<div id="calibre_link-450" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Preface</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Microsoft Power BI is a leading business intelligence and analytics platform that supports both self-service data visualization and exploration as well as enterprise BI deployments. Power BI consists of cloud services, mobile applications, a data modeling and report authoring application, and other utilities, including the On-premises data gateway. Additionally, organizations can deploy Power BI reports on-premise via the Power BI Report Server and scale their deployments with Power BI Premium capacity and Analysis Services.</p>
<p class="calibre7">This book provides an end-to-end analysis of Power BI tools and features, from planning a Power BI project to distributing Power BI apps to large groups of users. You'll be familiarized with all the fundamental concepts and see how Power BI datasets, reports, and dashboards can be designed to deliver insights and rich, interactive experiences. You'll also become knowledgeable about management and administration topics such as the allocation of Power BI Premium capacities, Azure Active Directory security groups, conditional access policies, and staged deployments of Power BI content. This book will encourage you to take advantage of these powerful features and follow thoughtful, consistent practices in deploying Power BI for your organization.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-65">
<div id="calibre_link-451" class="calibre2">
<div id="calibre_link-452" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Who this book is for</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">This book is intended for business intelligence professionals responsible for either the development of Power BI solutions or the management and administration of a Power BI deployment. BI developers can use this as a reference guide to features and techniques to enhance their solutions. Likewise, BI managers interested in a broad conceptual understanding, as well as processes and practices to inform their delivery of Power BI, will find this a useful resource. Experience of creating content on Power BI Desktop and sharing content on the Power BI service will be helpful.          </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-66">
<div id="calibre_link-453" class="calibre2">
<div id="calibre_link-454" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">What this book covers</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em><span>, discusses alternative deployment modes for Power BI, team and project roles, and licensing. Additionally, an example project template and its corresponding planning and dataset design processes are described.    </span></p>
<p class="calibre7"><a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em><span>, depicts the data access layer supporting a Power BI dataset, including data sources and fact and dimension table queries. Concepts of the Power Query M language, such as query folding and parameters, are explained and examples of custom M queries involving conditional and dynamic logic are given.    </span></p>
<p class="calibre7"><a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em><span>, reviews the components of the data model layer and design techniques in support of usability, performance, and other objectives. These topics include relationship cross-filtering, custom sort orders, hierarchies, and metadata.   </span></p>
<p class="calibre7"><a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em><span>, covers the implementation of analysis expressions reflecting business definitions and common analysis requirements. Primary DAX functions, concepts, and use cases such as date intelligence, row-level security roles, and performance testing are examined.</span></p>
<p class="calibre7"><a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em><span>, describes a report planning process, data visualization practices, and report design fundamentals, including visual selection and filter scopes. Top report development features, such as slicer visuals, tool tips, and conditional formatting are also reviewed. </span></p>
<p class="calibre7"><a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16">Applying Custom Visuals, Animation</em><span><em class="calibre16">, and Analytics</em>, examines powerful interactive and analytical features, including drillthrough report pages, bookmarks, the Analytics pane, ArcGIS Maps, and the waterfall charts. Additionally, examples of custom visuals, such as the Power KPI, and the capabilities of animation to support data storytelling are provided.  </span></p>
<p class="calibre7"><a href="#calibre_link-265" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 7</a>, <em class="calibre16">Designing Power BI Dashboards and Architectures</em>, pr<span>ovides guidance on visual selection, layout, and supporting tiles to drive effective dashboards. Alternative multi-dashboard architectures, such as an organizational dashboard architecture, are reviewed, is the configuration of dashboard tiles and mobile optimized dashboards.</span></p>
<p class="calibre7"><a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content</em><span>, features the role and administration of app workspaces in the context of Power BI solutions and staged deployments. Additionally, the Power BI REST API, content management features, and practices are reviewed, including field descriptions and version history. </span></p>
<p class="calibre7"><a href="#calibre_link-15" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 9</a>, <em class="calibre16">Managing the On-Premises Data Gateway</em><span>, covers top gateway planning considerations, including alternative gateway architectures, workloads, and hardware requirements. Gateway administration processes and tools are described, such as the manage gateways portal, gateway log files, and PowerShell Gateway commands. </span></p>
<p class="calibre7"><a href="#calibre_link-11" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 10</a>, <em class="calibre16">Deploying the Power BI Report Server</em>, contrasts the Power BI Report Server with the Power BI cloud service and provides guidance on deployment topics such as licensing, reference topology, configuration, administration, and upgrade cycles.    </p>
<p class="calibre7"><a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>, walks through the process of publishing and updating apps for groups of users. Additionally, other common distribution methods are covered, such as the sharing of reports and dashboards, email subscriptions, data-alert-driven emails, and embedding Power BI content in SharePoint Online.</p>
<p class="calibre7"><a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization</em>, highlights data governance for self-service and corporate BI, Azure Active Directory features such as Conditional Access Policies, and the Power BI admin portal. Details are provided about configuring Power BI service tenant settings, managing Power BI Premium capacities, and the tools available to monitor Power BI activities.   </p>
<p class="calibre7"><a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling with Premium and Analysis Services</em>, reviews the capabilities of Power BI Premium and alternative methods for allocating premium capacity. Additionally, Power BI datasets are contrasted with Analysis Services models, Azure Analysis Services is contrasted with SQL Server Analysis Services, and the migration of a Power BI dataset to an Analysis Services model is described.  </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-67">
<div id="calibre_link-455" class="calibre2">
<div id="calibre_link-456" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">To get the most out of this book</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A Power BI Pro license and access to the Power BI service is necessary to follow many of the topics and examples in this book. The assignment of the Power BI Service Administrator role within the Office 365 admin center, as well as administrative access to an On-premises data gateway, would also be helpful for the second half of this book. It's assumed that readers are familiar with the main user interfaces of Power BI Desktop and have some background in business intelligence or information technology.   </p>
<p class="calibre7">The primary data source for the examples in this book was the <span>AdventureWorks data warehouse sample database for SQL Server 2016 CTP3. A SQL Server 2017 Developer Edition database engine instance was used to host the sample database. For the import mode dataset, an Excel workbook stored the sales plan data. For the DirectQuery dataset, the sales plan data was stored in the sample SQL Server database.</span></p>
<div class="packt_infobox">The AdventureWorksDW2016CTP3 sample database can be downloaded from the following URL: <br class="calibre3" />
<a href="https://www.microsoft.com/en-us/download/details.aspx?id=49502" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://www.microsoft.com/en-us/download/details.aspx?id=49502</a>.<br class="calibre3" />
<br class="calibre3" />
Editions of SQL Server 2017 are available for download from the following URL: <br class="calibre3" />
<a href="https://www.microsoft.com/en-us/sql-server/sql-server-downloads" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://www.microsoft.com/en-us/sql-server/sql-server-downloads</a>.</div>
<p class="calibre7"><span>The Power BI Desktop files and specific queries and scripts utilized in the book are included in the code bundle. However, the source data and database are not included in the code bundle. Additionally, the database used by the book contains objects not included in the downloadable sample database, such as SQL views for each fact and dimension table. Therefore, even with access to a SQL Server 2017 database engine instance and the sample AdventureWorks data warehouse database, the examples in the book cannot be completely reproduced.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-68">
<div id="calibre_link-457" class="calibre2">
<div id="calibre_link-458" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Download the example code files</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">You can download the example code files for this book from your account at <a href="http://www.packtpub.com" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">www.packtpub.com</a>. If you purchased this book elsewhere, you can visit <a href="http://www.packtpub.com/support" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">www.packtpub.com/support</a> and register to have the files emailed directly to you.</p>
<p class="calibre7">You can download the code files by following these steps:</p>
<ol class="calibre12">
<li class="chapter">Log in or register at <a href="http://www.packtpub.com/support" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">www.packtpub.com</a>.</li>
<li class="chapter">Select the <span>SUPPORT</span> tab.</li>
<li class="chapter">Click on <span>Code Downloads &amp; Errata</span>.</li>
<li class="chapter">Enter the name of the book in the <span>Search</span> box and follow the onscreen instructions.</li>
</ol>
<p class="calibre7">Once the file is downloaded, please make sure that you unzip or extract the folder using the latest version of:</p>
<ul class="calibre12">
<li class="calibre13">WinRAR/7-Zip for Windows</li>
<li class="calibre13">Zipeg/iZip/UnRarX for Mac</li>
<li class="calibre13">7-Zip/PeaZip for Linux</li>
</ul>
<p class="calibre7"><span>The code bundle for the book is also hosted on GitHub at</span><span> </span><a href="https://github.com/PacktPublishing/Mastering-Microsoft-Power-BI" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://github.com/PacktPublishing/Mastering-Microsoft-Power-BI</a><span>. </span><span>In case there's an update to the code, it will be updated on the existing GitHub repository.</span></p>
<p class="calibre7"><span>We also have other code bundles from our rich catalog of books and videos available at</span><span> </span><strong class="calibre6"><span><a href="https://github.com/PacktPublishing/" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://github.com/PacktPublishing/</a></span></strong><span>. Check them out!</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-69">
<div id="calibre_link-459" class="calibre2">
<div id="calibre_link-460" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Download the color images</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">We also provide a PDF file that has color images of the screenshots/diagrams used in this book. You can download it here: <a href="http://www.packtpub.com/sites/default/files/downloads/MasteringMicrosoftPowerBI_ColorImages.pdf" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://www.packtpub.com/sites/default/files/downloads/<span>MasteringMicrosoftPowerBI</span>_ColorImages.pdf</a>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-70">
<div id="calibre_link-461" class="calibre2">
<div id="calibre_link-462" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Conventions used</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">There are a number of text conventions used throughout this book.</p>
<p class="calibre7"><kbd class="calibre15">CodeInText</kbd>: <span>Indicates c</span>ode words in text, database table names, folder names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter handles. <span>Here is an example:</span> "Mount the downloaded <kbd class="calibre15">WebStorm-10*.dmg</kbd> disk image file as another disk in your system."</p>
<p class="calibre7">A block of code is set as follows:</p>
<pre class="calibre19"> <span>SELECT<br class="calibre3" />P.ProductKey as 'Product Key'<br class="calibre3" />, P.ProductAlternateKey as 'Product Alternate Key'<br class="calibre3" />, P.EnglishProductName AS 'Product Name'<br class="calibre3" />, ISNULL(S.EnglishProductSubcategoryName, 'Undefined') 'Product<br class="calibre3" />Subcategory'<br class="calibre3" /></span></pre>
<p class="calibre7">When we wish to draw your attention to a particular part of a code block, the relevant lines or items are set in bold:</p>
<pre class="calibre19"><span>Internet Sales Amount (Import) =<br class="calibre3" />SUMX('Internet Sales','Internet Sales'[Order Quantity]*'Internet<br class="calibre3" />Sales'[Unit Price])<br class="calibre3" />Internet Sales Amount (DirectQuery) =<br class="calibre3" />SUM('Internet Sales'[Sales Amount])</span></pre>
<p class="calibre7"><strong class="calibre6">Bold</strong>: Indicates a new term, an important word, or w<span>ords that you see onscreen. For example, words in menus or dialog boxes appear in the text like this. Here is an example: "Select <span>System info</span> from the <span>Administration</span> panel.</span><span>"</span></p>
<div class="packt_infobox">Warnings or important notes appear like this.</div>
<div class="packt_tip pcalibre7 pcalibre6">Tips and tricks appear like this.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-71">
<div id="calibre_link-463" class="calibre2">
<div id="calibre_link-464" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Get in touch</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Feedback from our readers is always welcome.</p>
<p class="calibre7"><strong class="calibre6">General feedback</strong>: Email <kbd class="calibre15">feedback@packtpub.com</kbd> and mention the book title in the subject of your message. If you have questions about any aspect of this book, please email us at <kbd class="calibre15">questions@packtpub.com</kbd>.</p>
<p class="calibre7"><strong class="calibre6">Errata</strong>: Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you have found a mistake in this book, we would be grateful if you would report this to us. Please visit <a href="http://www.packtpub.com/submit-errata" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">www.packtpub.com/submit-errata</a>, selecting your book, clicking on the Errata Submission Form link, and entering the details.</p>
<p class="calibre7"><strong class="calibre6">Piracy</strong>: If you come across any illegal copies of our works in any form on the Internet, we would be grateful if you would provide us with the location address or website name. Please contact us at <kbd class="calibre15">copyright@packtpub.com</kbd> with a link to the material.</p>
<p class="calibre7"><strong class="calibre6">If you are interested in becoming an author</strong>: If there is a topic that you have expertise in and you are interested in either writing or contributing to a book, please visit <a href="http://authors.packtpub.com/" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">authors.packtpub.com</a>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-72">
<div id="calibre_link-465" class="calibre2">
<div id="calibre_link-466" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Reviews</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Please leave a review. Once you have read and used this book, why not leave a review on the site that you purchased it from? Potential readers can then see and use your unbiased opinion to make purchase decisions, we at Packt can understand what you think about our products, and our authors can see your feedback on their book. Thank you!</p>
<p class="calibre7">For more information about Packt, please visit <a href="https://www.packtpub.com/" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">packtpub.com</a>.</p>
<p class="calibre7"></p>
<p class="calibre7"></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-73">
<div id="calibre_link-467" class="calibre2">
<div id="calibre_link-468" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Planning Power BI Projects</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In this chapter, we will walk through a Power BI project planning process from the perspective of an organization with an on-premises data warehouse and a supporting nightly <strong class="calibre6">extract-transform-load</strong><span> (<strong class="calibre6">ETL</strong></span>) process but no existing SSAS servers or IT-approved Power BI datasets. The business intelligence team will be responsible for the development of a Power BI dataset, including source queries, relationships, and metrics, in addition to a set of Power BI reports and dashboards.</p>
<p class="calibre7">Almost all business users will consume the reports and dashboards in the Power BI online service and via the Power BI mobile apps, but a few business analysts will also require the ability to author Power BI and Excel reports for their teams based on the new dataset. Power BI Pro licenses and Power BI Premium capacity will be used to support the development, scalability, and distribution requirements of the project.</p>
<p class="calibre7">In this chapter, we will review the following topics:</p>
<ul class="calibre12">
<li class="calibre13">Power BI deployment modes</li>
<li class="calibre13">Project discovery and ingestion</li>
<li class="calibre13">Power BI project roles</li>
<li class="calibre13">Power BI licenses</li>
<li class="calibre13">Dataset design process</li>
<li class="calibre13">Dataset planning</li>
<li class="calibre13">Import and DirectQuery datasets</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-74">
<div id="calibre_link-469" class="calibre2">
<div id="calibre_link-470" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI deployment modes</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Organizations can choose to deliver and manage their Power BI deployment through IT and standard project workflows or to empower certain business users to take advantage of Self-Service BI capabilities with tools such as Power BI Desktop and Excel. In many scenarios, a combination of IT resources, such as the On-premises data gateway and Power BI Premium capacity, can be combined with the business users' knowledge of requirements and familiarity with data analysis and visualization.</p>
<p class="calibre7">Organizations may also utilize alternative deployment modes per project or with different business teams based on available resources and the needs of the project. The greatest value from Power BI deployments can be obtained when the technical expertise and governance of Corporate BI solutions are combined with the data exploration and analysis features, which can be made available to all users. The scalability and accessibility of Power BI solutions to support thousands of users, including read-only users who have not been assigned Power BI Pro licenses, is made possible by provisioning Power BI Premium capacity, as described in the final three chapters of this book.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-75">
<div id="calibre_link-471" class="calibre2">
<div id="calibre_link-472" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Corporate BI</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>The Corporate BI delivery approach in which the BI team develops and maintains both the Power BI dataset (data model) and the required report visualizations is a common deployment option, particularly for large-scale projects and projects with executive-level sponsors or stakeholders. This is the approach followed in this chapter and throughout this book, as it offers maximum control over top BI objectives, such as version control, scalability, usability, and performance.</span></p>
<p class="calibre7"><span>However, as per the following Power BI deployment modes diagram, there are other approaches in which business teams own or contribute to the solution: </span></p>
<div class="cdpalignleft"><img src="images/000077.png" class="calibre20" /></div>
<div class="mce-root1">Power BI deployment modes</div>
<p class="calibre7"><span>A Power BI dataset is a semantic data model composed of data source queries, relationships between dimensions and fact tables, and measurement calculations. The Power BI Desktop application can be used to create datasets as well as merely connect to existing datasets to author Power BI reports. The Power BI Desktop shares the same data retrieval and modeling engines as the latest version of </span><strong class="calibre6">SQL Server Analysis Services</strong><span> (</span><strong class="calibre6">SSAS</strong><span>) in tabular mode and </span>Azure Analysis Services, Microsoft's enterprise BI modeling solution<span>.</span> <span>Many BI/IT organizations utilize Analysis Services models as the primary data source for Power BI projects and it's possible to migrate Power BI Desktop files (<kbd class="calibre15">.pbix</kbd>) to Analysis Services models, as described in <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>,</span> <em class="calibre16">Scaling with Premium and Analysis Services.</em></p>
<p class="calibre7"><span>Self-service approaches can benefit both IT and business teams, as they can reduce IT resources, project timelines, and provide the business with a greater level of flexibility as their analytical needs change. Additionally, Power BI projects can be migrated across deployment modes over time as required skills and resources change. However, greater levels of self-service and shared ownership structures can also increase the risk of miscommunication and introduce issues of version control, quality, and consistency.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-76">
<div id="calibre_link-473" class="calibre2">
<div id="calibre_link-474" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Self-Service Visualization</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In the Self-Service Visualization approach, the dataset is created and maintained by the IT organization's BI team, but certain business users with Power BI Pro licenses create reports and dashboards for consumption by other users. In many scenarios, business analysts are already comfortable with authoring reports in Power BI Desktop (or, optionally, Excel) and can leverage their business knowledge to rapidly develop useful visualizations and insights. Given ownership of the dataset, the BI team can be confident that only curated data sources and standard metric definitions are used in reports and can ensure that the dataset remains available, performant, and updated, or refreshed as per business requirements.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-77">
<div id="calibre_link-475" class="calibre2">
<div id="calibre_link-476" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Self-Service BI</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In the Self-Service BI approach, the BI organization only contributes essential infrastructure and monitoring, such as the use of an On-premises data gateway and possibly Power Premium capacity to support the solution. Since the business team maintains control of both the dataset and the visualization layer, the business team has maximum flexibility to tailor its own solutions including data source retrieval, transformation, and modeling. This flexibility, however, can be negated by a lack of technical skills (for example, DAX measures) and a lack of technical knowledge such as the relationships between tables in a database. Additionally, business-controlled datasets can introduce version conflicts with corporate semantic models and generally lack the resilience, performance, and scalability of IT-owned datasets.</p>
<div class="packt_tip pcalibre7 pcalibre6">It's usually necessary or at least beneficial for BI organizations to own the Power BI datasets or at least the datasets which support important, widely distributed reports and dashboards. This is primarily due to the required knowledge of dimensional modeling best practices and the necessary technical skills in the M and DAX functional languages to develop sustainable datasets. Additionally, BI organizations require control of datasets to implement <strong class="calibre6">row-level security</strong> (<strong class="calibre6">RLS</strong>) and to maintain version control. Therefore, small datasets initially created by business teams are often migrated to the BI team and either integrated into larger models or rationalized given the equivalent functionality from an existing dataset.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-78">
<div id="calibre_link-477" class="calibre2">
<div id="calibre_link-478" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Choosing a deployment mode</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Larger organizations with experience of deploying and managing Power BI often utilize a mix of deployment modes depending on the needs of the project and available resources. For example, a Corporate BI solution with a set of standard IT developed reports and dashboards distributed via a Power BI app may be extended by assigning Power BI Pro licenses to certain business users who have experience or training in Power BI report design. These users could then leverage the existing data model and business definitions maintained by IT to create new reports and dashboards and distribute this content in a separate Power BI app to distinguish ownership. </p>
<div class="packt_infobox">An app workspace is simply a container of datasets, reports, and dashboards in the Power BI cloud service that can be distributed to large groups of users. A Power BI app represents the published version of an app workspace in the Power BI service and workspace. Members can choose which items in the workspace are included in the published Power BI app. See <a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Power BI Content,</em> and <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution,</em> for greater detail on app workspaces and apps, respectively.</div>
<p class="calibre7">Another common scenario is a <strong class="calibre6">proof-of-concept</strong> (<strong class="calibre6">POC</strong>) or small-scale self-service solution developed by a business user or a team to be transitioned to a formal, IT-owned, and managed solution. Power BI Desktop's rich graphical interfaces at each layer of the application (query editor, data model, and report canvas) make it possible and often easy for users to create useful models and reports with minimal experience and little to no code. It's much more difficult, of course, to deliver consistent insights across business functions (that is, finance, sales, and marketing) and at scale in a secure, governed environment. The IT organization can enhance the quality and analytical value of these assets as well as provide robust governance and administrative controls to ensure that the right data is being accessed by the right people.</p>
<p class="calibre7">The following list of fundamental questions will help guide a deployment mode decision:</p>
<ol class="calibre12">
<li class="chapter">Who will own the data model?
<ul class="calibre17">
<li class="chapter">Experienced dataset designers and other IT professionals are usually required to support complex data transformations, analytical data modeling, large data sizes, and security rules, such as RLS roles, as described in <a href="#calibre_link-25" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em></li>
<li class="chapter">If the required data model is relatively small and simple, or if the requirements are unclear, the business team may be best positioned to create at least the initial iterations of the model</li>
<li class="chapter">The data model could be created with Analysis Services or Power BI Desktop</li>
</ul>
</li>
<li class="chapter">Who will own the reports and dashboards?
<ul class="calibre17">
<li class="chapter">Experienced Power BI report developers with an understanding of corporate standards and data visualization best practices can deliver a consistent user experience</li>
<li class="chapter">Business users can be trained on report design and development practices and are well-positioned to manage the visualization layer, given their knowledge of business needs and questions</li>
</ul>
</li>
<li class="chapter">How will the Power BI content be managed and distributed?
<ul class="calibre17">
<li class="chapter">A staged deployment across development, test, and production environments, as described in <a href="#calibre_link-10" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content</em>, helps to ensure that quality, validated content is published. This approach is generally exclusive to Corporate BI projects.</li>
<li class="chapter">Sufficient Power BI Premium capacity is required to support distribution to Power BI Free users and either large datasets or demanding query workloads.</li>
<li class="chapter">Self-Service BI content can be assigned to Premium Capacity, but organizations may wish to limit the scale or scope of these projects to ensure that provisioned capacity is being used efficiently.</li>
</ul>
</li>
</ol>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-79">
<div id="calibre_link-479" class="calibre2">
<div id="calibre_link-480" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Project discovery and ingestion</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A set of standard questions within a project template form can be used to initiate Power BI projects. Business guidance on these questions informs the BI team of the high-level technical needs of the project and helps to promote a productive project kickoff.</p>
<p class="calibre7">By reviewing the project template, the BI team can ask the project sponsor or relevant <strong class="calibre6">subject matter experts</strong> (<strong class="calibre6">SMEs</strong>) targeted questions to better understand the current state and the goals of the project.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-80">
<div id="calibre_link-481" class="calibre2">
<div id="calibre_link-482" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Sample Power BI project template </h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>The primary focus of the project-planning template and the overall project planning stage is on the data sources and the scale and structure of the Power BI dataset required. The project sponsor or business users may only have an idea of several reports, dashboards, or metrics needed but, as a Corporate BI project, it's essential to focus on where the project fits within an overall BI architecture and the long-term <strong class="calibre6">return on investment</strong></span> (<span><strong class="calibre6">ROI</strong>) of the solution. For example, BI teams would look to leverage any existing Power BI datasets or SSAS tabular models applicable to the project and would be sensitive to version-control issues.<br class="calibre3" /></span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-81">
<div id="calibre_link-483" class="calibre2">
<div id="calibre_link-484" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Sample template &ndash; Adventure Works BI</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>The template is comprised of two tables. The first table answers the essential w<em class="calibre16">ho</em> and w<em class="calibre16">hen</em> questions so that the project can be added to the BI team's backlog. The BI team can use this information to plan their engagements across multiple ongoing and requested Power BI projects and to respond to project stakeholders, such as Vickie Jacobs, VP of Group Sales, in this example:</span></p>
<table class="calibre21">
<tbody class="calibre22">
<tr class="calibre23">
<td class="calibre24">
<div class="cdpalignleft"><strong class="calibre6">Date of Submission</strong></div>
</td>
<td class="calibre24">
<p class="cdpaligncenter">10/15/2017</p>
</td>
</tr>
<tr class="calibre25">
<td class="calibre24">
<p class="cdpaligncenter"><strong class="calibre6">Project Sponsor</strong></p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Vickie Jacobs, VP of Group Sales</p>
</td>
</tr>
<tr class="calibre23">
<td class="calibre24">
<p class="cdpaligncenter"><strong class="calibre6">Primary Stakeholders</strong></p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Adventure Works Sales<br class="calibre3" />
Adventure Works Corp</p>
</td>
</tr>
<tr class="calibre25">
<td class="calibre24">
<p class="cdpaligncenter"><strong class="calibre6">Power BI Author(s)</strong></p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Mark Langford, Sales Analytics Manager</p>
</td>
</tr>
</tbody>
</table>
<p class="calibre7"> </p>
<p class="calibre7">The following table is a list of questions that describe the project's requirements and scope. For example, the number of users that will be read-only consumers of Power BI reports and dashboards, and the number of self-service users that will need Power BI Pro licenses to create Power BI content will largely impact the total cost of the project.</p>
<p class="calibre7">Likewise, the amount of historical data to include in the dataset (2 years, 5 years?) can significantly impact performance scalability:</p>
<table class="calibre26">
<tbody class="calibre22">
<tr class="calibre23">
<td class="calibre27">
<p class="cdpaligncenter"><strong class="calibre6">Topic</strong></p>
</td>
<td class="calibre27">
<p class="cdpaligncenter"><strong class="calibre6">#</strong></p>
</td>
<td class="calibre27">
<p class="cdpaligncenter"><strong class="calibre6">Question</strong></p>
</td>
<td class="calibre27">
<p class="cdpaligncenter"><strong class="calibre6">Business Input</strong></p>
</td>
</tr>
<tr class="calibre28">
<td class="calibre24">
<p class="cdpaligncenter">Data sources</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">1</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Can you describe the required data? (For example, sales, inventory, shipping).</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter"><kbd class="calibre15">Internet Sales</kbd>, <kbd class="calibre15">Reseller Sales</kbd>, and the <kbd class="calibre15">Sales and Margin Plan</kbd>. We need to analyze total corporate sales, online, and reseller sales, and compare these results to our plan.</p>
</td>
</tr>
<tr class="calibre28">
<td class="calibre24">
<p class="cdpaligncenter">Data sources</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">2</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Is all of the data required for your project available in the data warehouse (SQL Server)?</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">No</p>
</td>
</tr>
<tr class="calibre28">
<td class="calibre24">
<p class="cdpaligncenter">Data Sources</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">3</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">What other data sources (if any) contain all or part of the required data <span>(for example, Web, Oracle, Excel)?</span></p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">The <kbd class="calibre15">Sales and Margin Plan</kbd> is maintained in Excel.</p>
</td>
</tr>
<tr class="calibre29">
<td class="calibre24">
<p class="cdpaligncenter">Security</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">4</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Should certain users be prevented from viewing some or all of the data?</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Yes, sales managers and associates should only see data for their sales territory group. VPs of sales, however, should have global access.</p>
</td>
</tr>
<tr class="calibre29">
<td class="calibre24">
<p class="cdpaligncenter">Security</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">5</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Does the data contain any PCII or sensitive data?</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">No, not that Iâm aware of</p>
</td>
</tr>
<tr class="calibre30">
<td class="calibre24">
<p class="cdpaligncenter">Scale</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">6</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Approximately, how many years of historical data are needed?</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">3-4</p>
</td>
</tr>
<tr class="calibre31">
<td class="calibre24">
<p class="cdpaligncenter">Data refresh</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">7</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">How often does the data need to be refreshed?</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Daily</p>
</td>
</tr>
<tr class="calibre31">
<td class="calibre24">
<p class="cdpaligncenter">Data refresh</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">8</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Is there a need to view data in real time (as it changes)?</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">No</p>
</td>
</tr>
<tr class="calibre25">
<td class="calibre24">
<p class="cdpaligncenter">Distribution</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">9</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Approximately, how many users will need to view reports and dashboards?</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">200</p>
</td>
</tr>
<tr class="calibre23">
<td class="calibre24">
<p class="cdpaligncenter">Distribution</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">10</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Approximately, how many users will need to create reports and dashboards?</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">3-4</p>
</td>
</tr>
<tr class="calibre32">
<td class="calibre24">
<p class="cdpaligncenter">Version control</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">11</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Are there existing reports on the same data? If so, please describe.</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Yes, there are daily and weekly sales snapshot reports available on the portal. Additionally, our team builds reports in Excel that compare actuals to plan.</p>
</td>
</tr>
<tr class="calibre32">
<td class="calibre24">
<p class="cdpaligncenter">Version Control</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">12</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Is the Power BI solution expected to replace these existing reports?</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Yes, we would like to exclusively use Power BI going forward.</p>
</td>
</tr>
</tbody>
</table>
<p class="calibre7"> </p>
<p class="calibre7"><span>A business analyst inside the IT organization can partner with the business on completing the project ingestion template and review the current state to give greater context to the template. Prior to the project kickoff meeting, the business analyst can meet with the BI team members to review the template and any additional findings or considerations. </span></p>
<div class="packt_tip pcalibre7 pcalibre6"><span>Many questions with greater levels of detail will be raised as the project moves forward and therefore the template shouldn't attempt to be comprehensive or overwhelm business teams. The specific questions to include should use business-friendly language and serve to call out the top drivers of project resources and Corporate BI priorities, such as security and version control.<br class="calibre3" /></span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-82">
<div id="calibre_link-485" class="calibre2">
<div id="calibre_link-486" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI project roles</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Following the review of the project template and input from the business analyst, members of the Power BI team can directly engage the project sponsor and other key stakeholders to officially engage in the project. These stakeholders include subject matter experts on the data source systems, business team members knowledgeable of the current state of reporting and analytics, and administrative or governance personnel with knowledge of organizational policies, available licenses, and current usage. </p>
<p class="calibre7">New Power BI projects of any significant scale and long-term adoption of Power BI within organizations require <strong class="calibre6">Dataset Designers</strong>, <strong class="calibre6">Report Authors</strong>, and a <strong class="calibre6">Power BI Admin(s)</strong>, as illustrated in the following diagram:</p>
<div class="cdpalignleft"><img src="images/000088.png" class="calibre33" /></div>
<div class="mce-root1">Power BI team roles</div>
<p class="calibre7">Each of the three Power BI project roles and perhaps longer-term roles as part of a business intelligence team entail a distinct set of skills and responsibilities. It can be advantageous in a short-term or POC scenario for a single user to serve as both a dataset designer and a report author. However, the Power BI platform and the multi-faceted nature of Corporate BI deployments is too broad and dynamic for a single BI professional to adequately fulfill both roles. It's therefore recommended that team members either self-select or are assigned distinct roles based on their existing skills and experience and that each member develops advanced and current knowledge relevant to their role. A BI manager and/or a project manager can help facilitate effective communication across roles and between the BI team and other stakeholders, such as project sponsors.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-83">
<div id="calibre_link-487" class="calibre2">
<div id="calibre_link-488" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dataset designer</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Power BI report visualizations and dashboard tiles are built on top of datasets, and each Power BI report is associated with a single dataset. Power BI datasets can import data from multiple data sources on a refresh schedule or can be configured to issue queries directly to a single data source to resolve report queries. Datasets are therefore a critical component of Power BI projects and their design has tremendous implications regarding user experience, query performance, source system and Power BI resource utilization, and more. </p>
<p class="calibre7">The dataset designer is responsible for the data access layer of the Power BI dataset, including the authentication to data sources and the M queries used to define the tables of the data model. Additionally, the dataset designer defines the relationships of the model and any required row-level security roles, and develops the DAX measure expressions for use in reports, such as <strong class="calibre6">year-to-date</strong> (<strong class="calibre6">YTD</strong>) sales. Given these responsibilities, the dataset designer should regularly communicate with data source owners or SMEs, as well as report authors. For example, the dataset designer needs to be aware of changes to data sources so that data access queries can be revised accordingly and report authors can advise of any additional measures or columns necessary to create new reports. Furthermore, the dataset designer should be aware of the performance and resource utilization of deployed datasets and should work with the Power BI admin on issues such as Power BI Premium capacity.</p>
<p class="calibre7">As per the <em class="calibre16">Power BI team toles</em> diagram, there are usually very few dataset designers in a team while there may be many report authors. This is largely due to the organizational objectives of version control and reusability, which leads to a small number of large datasets. Additionally, robust dataset development requires knowledge of the M and DAX functional programming languages, dimensional modeling practices, and business intelligence. Database experience is also very helpful. If multiple dataset designers are on a team they should look to standardize their development practices so that they can more easily learn and support each other's solutions.</p>
<div class="packt_infobox">A Power BI dataset designer often has experience in developing SSAS models, particularly SSAS tabular models. For organizations utilizing both SSAS and Power BI Desktop, this could be the same individual. Alternatively, users with experience of building models in Power Pivot for Excel may also prove to be capable Power BI dataset designers.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-84">
<div id="calibre_link-489" class="calibre2">
<div id="calibre_link-490" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Report authors</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Report authors interface directly with the consumers of reports and dashboards or a representative of this group. In a self-service deployment mode or a hybrid project (business and IT), a small number of report authors may themselves work within the business. Above all else, report authors must have a clear understanding of the business questions to be answered and the measures and attributes (columns) needed to visually analyze and answer these questions. The report author should also be knowledgeable of visualization best practices, such as symmetry and minimalism, in addition to any corporate standards for report formatting and layout.</p>
<p class="calibre7">Power BI Desktop provides a rich set of formatting properties and analytical features, giving report authors granular control over the appearance and behavior of visualizations.</p>
<p class="calibre7">Report authors should be very familiar with all standard capabilities, such as conditional formatting, drilldown, drillthrough, and cross-highlighting, as they often lead demonstrations or training sessions. Additionally, report authors should understand the organization's policies on custom visuals available in the MS Office store and the specific use cases for top or popular custom visuals. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-5">
<div id="calibre_link-491" class="calibre2">
<div id="calibre_link-492" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI admin</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A Power BI admin is focused on the overall deployment of Power BI within an organization in terms of security, governance, and resource utilization. Power BI admins are <span>not involved in the day-to-day activities of specific projects but rather configure and manage settings in Power BI that align with the organization's policies. A Power BI admin, for example, monitors the adoption of Power BI content, identifies any high-risk user activities, and manages any Power BI Premium capacities that have been provisioned. Additionally, Power BI admins use Azure Active Directory security groups within the Power BI admin portal to manage access to various Power BI features, such as sharing Power BI content with external organizations. </span></p>
<p class="calibre7">Users assigned to the <span>Power BI service administrator</span> role obtain access to the Power BI admin portal and the rights to configure Power BI <span>Tenant settings</span>. For example, in the following image, <strong class="calibre6">Anna Sanders</strong> is assigned to the Power BI service administrator role within the Office 365 admin center: </p>
<div class="cdpaligncenter1"><img src="images/000098.png" class="calibre34" /></div>
<div class="mce-root1">Assigning Power BI service admin role</div>
<p class="calibre7">The <strong class="calibre6">Power BI service administrator role</strong> allows Anna to access the Power BI admin portal to enable or disable features, such as exporting data and printing reports and dashboard. BI and IT managers that oversee Power BI deployments are often assigned to this role, as it also provides the ability to manage Power BI Premium capacities and access to standard monitoring and usage reporting. Note that o<span>nly global administrators of Office 365 can assign users to the Power BI service administrator role.</span></p>
<p class="calibre7">The Power BI admin should have a clear understanding of the organizational policy on the various tenant settings, such as whether content can be shared with external users. For most tenant settings, the Power BI service administrator can define rules in the Power BI admin portal to include or exclude specific security groups. For example, external sharing can be disabled for the entire organization except for a specific security group of users. Most organizations should assign two or more users to the Power BI service administrator role and ensure these users are trained on the administration features specific to this role. <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization</em>, contains details on the Power BI admin portal and other administrative topics<em class="calibre16">.</em></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-19">
<div id="calibre_link-493" class="calibre2">
<div id="calibre_link-494" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Project role collaboration</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Communicating and documenting project role assignments during the planning stage promotes the efficient use of time during the development and operations phases. For organizations committed to the Power BI platform as a component of a longer-term data strategy, the project roles may become full-time positions.</p>
<p class="calibre7">For example, BI developers with experience in DAX and/or SSAS tabular databases may be hired as dataset designers while BI developers with experience in data visualization tools and corporate report development may be hired as report authors:</p>
<table class="calibre35">
<tbody class="calibre22">
<tr class="calibre36">
<td class="calibre24">
<p class="cdpaligncenter"><strong class="calibre6">Name</strong></p>
</td>
<td class="calibre24">
<p class="cdpaligncenter"><strong class="calibre6">Project role</strong></p>
</td>
</tr>
<tr class="calibre25">
<td class="calibre24">
<p class="cdpaligncenter">Brett Powell</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Dataset Designer</p>
</td>
</tr>
<tr class="calibre23">
<td class="calibre24">
<p class="cdpaligncenter">Jennifer Lawrence</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Report Author</p>
</td>
</tr>
<tr class="calibre25">
<td class="calibre24">
<p class="cdpaligncenter">Anna Sanders</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Power BI Service Admin</p>
</td>
</tr>
<tr class="calibre23">
<td class="calibre24">
<p class="cdpaligncenter">Mark Langford</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">Report Author</p>
</td>
</tr>
<tr class="calibre25">
<td class="calibre24">
<p class="cdpaligncenter">Stacy Loeb</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">QA Tester</p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-31">
<div id="calibre_link-495" class="calibre2">
<div id="calibre_link-496" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI licenses</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Users can be assigned either a Power BI Free or a Power BI Pro license. Power BI licenses (Pro and Free) can be purchased individually in the Office 365 admin center, and a Power Pro license is included with an Office 365 Enterprise E5 subscription. A Power BI Pro license is required to publish content to Power BI app workspaces, consume a Power BI app that's not assigned to Power BI Premium capacity, and utilize other advanced features, as shown in the following table:</p>
<table class="calibre37">
<tbody class="calibre22">
<tr class="calibre36">
<td class="calibre24">
<p class="cdpaligncenter"><strong class="calibre6">Feature</strong></p>
</td>
<td class="calibre24">
<p class="cdpaligncenter"><strong class="calibre6">Power BI Free</strong></p>
</td>
<td class="calibre24">
<p class="cdpaligncenter"><strong class="calibre6">Power BI Pro</strong></p>
</td>
</tr>
<tr class="calibre25">
<td class="calibre24">
<p class="cdpaligncenter">Connect to 70+ data sources</p>
</td>
<td class="calibre38">
<p class="cdpaligncenter"><strong class="calibre6">Yes</strong></p>
</td>
<td class="calibre38">
<p class="cdpaligncenter"><strong class="calibre6">Yes</strong></p>
</td>
</tr>
<tr class="calibre23">
<td class="calibre24">
<p class="cdpaligncenter">Publish to web</p>
</td>
<td class="calibre38">
<p class="cdpaligncenter"><strong class="calibre6">Yes</strong></p>
</td>
<td class="calibre38">
<p class="cdpaligncenter"><strong class="calibre6">Yes</strong></p>
</td>
</tr>
<tr class="calibre25">
<td class="calibre24">
<p class="cdpaligncenter">Peer-to-peer sharing</p>
</td>
<td class="calibre39">
<p class="cdpaligncenter"><strong class="calibre6">No</strong></p>
</td>
<td class="calibre38">
<p class="cdpaligncenter"><strong class="calibre6">Yes</strong></p>
</td>
</tr>
<tr class="calibre23">
<td class="calibre24">
<p class="cdpaligncenter">Export to Excel, CSV, PowerPoint</p>
</td>
<td class="calibre38">
<p class="cdpaligncenter"><strong class="calibre6">Yes</strong></p>
</td>
<td class="calibre38">
<p class="cdpaligncenter"><strong class="calibre6">Yes</strong></p>
</td>
</tr>
<tr class="calibre25">
<td class="calibre24">
<p class="cdpaligncenter">Email subscriptions</p>
</td>
<td class="calibre39">
<p class="cdpaligncenter"><strong class="calibre6">No</strong></p>
</td>
<td class="calibre38">
<p class="cdpaligncenter"><strong class="calibre6">Yes</strong></p>
</td>
</tr>
<tr class="calibre23">
<td class="calibre24">
<p class="cdpaligncenter">App workspaces and apps</p>
</td>
<td class="calibre39">
<p class="cdpaligncenter"><strong class="calibre6">No</strong></p>
</td>
<td class="calibre38">
<p class="cdpaligncenter"><strong class="calibre6">Yes</strong></p>
</td>
</tr>
<tr class="calibre25">
<td class="calibre24">
<p class="cdpaligncenter">Analyze in Excel, Analyze in Power BI Desktop</p>
</td>
<td class="calibre39">
<p class="cdpaligncenter"><strong class="calibre6">No</strong></p>
</td>
<td class="calibre38">
<p class="cdpaligncenter"><strong class="calibre6">Yes</strong></p>
</td>
</tr>
</tbody>
</table>
<p class="calibre7"> </p>
<p class="calibre7">With Power BI Premium, users with Power BI Free licenses are able to access and view Power BI apps of reports and dashboards that have been assigned to premium capacities. This access includes consuming the content via the Power BI mobile application. Additionally, Power BI Pro users can share dashboards with Power BI Free users if the dashboard is contained in a Premium workspace. Power BI Pro licenses are required for users that create or distribute Power BI content, such as connecting to published datasets from Power BI Desktop or Excel. </p>
<p class="calibre7">In this sample project example, only three or four business users may need Power BI Pro licenses to create and share reports and dashboards. Mark Langford, a data analyst for the sales organization, requires a Pro license to analyze published datasets from Microsoft Excel. Jennifer Lawrence, a Corporate BI developer and report author for this project, requires a Pro license to publish Power BI reports to app workspaces and distribute Power BI apps to users.</p>
<p class="calibre7">The following image from the Office 365 admin center identifies the assignment of a Power BI Pro license to a report author: </p>
<div class="cdpalignleft"><img src="images/000109.png" class="calibre40" /></div>
<div class="mce-root1">Power BI Pro license assignment</div>
<p class="calibre7">As a report author, Jennifer doesn't require any custom role assignment as per the <strong class="calibre6">Roles</strong> property of the preceding image. If Jennifer becomes responsible for administering Power BI in the future, the <strong class="calibre6"><kbd class="calibre15">Edit</kbd></strong> option for the Roles property can be used to assign her to the Power BI service administrator role, as described in the <em class="calibre16">Power BI project roles</em> section earlier.</p>
<p class="calibre7">The approximately 200 Adventure Works sales team users who only need to view the content can be assigned Free licenses and consume the published content via Power BI apps associated with Power BI Premium capacity. Organizations can obtain more Power BI Pro licenses and Power BI Premium capacity (virtual cores, RAM) as usage and workloads increase. </p>
<div class="packt_infobox">Typically, a Power BI service administrator is also assigned a Power BI Pro license, but a Power BI Pro license is not required to be assigned to the Power BI service administrator role. </div>
<p class="calibre7">The administration and governance of Power BI deployments at scale involve several topics (such as authentication, activity monitoring, and auditing), and Power BI provides features dedicated to simplifying administration.</p>
<p class="calibre7">These topics and features are reviewed in <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization.</em></p>
<div class="packt_tip pcalibre7 pcalibre6"><span>Given the broad controls associated with the Power BI service administrator role, such as managing Power BI Premium capacities and setting policies for the sharing of external content, some organizations may choose to limit this access to defined time periods. <strong class="calibre6">Azure Active Directory Privileged Identity Management</strong> (<strong class="calibre6">PIM</strong>) can be used to provide short-term, audited access to this role. For example, a decision could be made to allow one security group of users to export data from Power BI. A user, such as a BI manager, could be granted Power BI service administrator rights for one day to implement this policy in the Power BI admin portal.</span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-45">
<div id="calibre_link-497" class="calibre2">
<div id="calibre_link-498" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI license scenarios</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The optimal mix of Power BI Pro and Power BI Premium licensing in terms of total cost will vary based on the volume of users and the composition of these users between read-only consumers of content versus Self-Service BI users. In relatively small deployments, such as 200 total users, a Power BI Pro license can be assigned to each user regardless of self-service usage and Power BI Premium capacity can be avoided. Be advised, however, that, as per the following <em class="calibre16">Power BI Premium features</em> section, there are other benefits to licensing Power BI Premium capacity that may be necessary for certain deployments, such as larger datasets or more frequent data refreshes.</p>
<p class="calibre7">If an organization consists of 700 total users with 600 read-only users and 100 self-service users (content creators), it's more cost effective to assign Power BI Pro licenses to the 100 self-service users and to provision Power BI Premium capacity to support the other 600 users. Likewise, for a larger organization with 5,000 total users and 4,000 self-service users, the most cost-effective licensing option is to assign Power Pro licenses to the 4,000 self-service users and to license Power BI Premium for the remaining 1,000 users. </p>
<div class="packt_infobox">Several factors drive the amount of Power BI Premium capacity to provision, such as the number of concurrent users, the complexity of the queries generated, and the number of concurrent data refreshes. T<span>he Power BI Premium calculator </span>provides an initial estimate of the mix of Power BI Pro and Power BI Premium capacity needed for a given workload and can be found at <a href="https://powerbi.microsoft.com/en-us/calculator/" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://powerbi.microsoft.com/en-us/calculator/</a>.</div>
<p class="calibre7">See <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization,</em> and <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling with Power BI Premium and SSAS,</em> for additional details on aligning Power BI licenses and resources with the needs of Power BI deployments.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-85">
<div id="calibre_link-499" class="calibre2">
<div id="calibre_link-500" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI Premium features</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">An organization may choose to license Power BI Premium capacities for additional or separate reasons beyond the ability to distribute Power BI content to read-only users without incurring per-user license costs. Significantly, greater detail on Power BI Premium features and deployment considerations is included in <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling with Premium and Analysis Services</em>.</p>
<p class="calibre7">The following table identifies several of the top additional benefits and capabilities of Power BI Premium:</p>
<div class="cdpalignleft"><img src="images/000120.png" class="calibre41" /></div>
<div class="mce-root2">Additional Power BI Premium capabilities</div>
<div class="packt_infobox">Beyond the six features listed in the preceding table, the roadmap included in the Power BI Premium white paper has advised of future capabilities including read-only replicas, pin to memory, and geographic distribution. See the Power BI Premium white paper (<a href="http://bit.ly/2wBGPRJ" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2wBGPRJ</a>) and related documentation for the latest updates.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-86">
<div id="calibre_link-501" class="calibre2">
<div id="calibre_link-502" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Data warehouse bus matrix</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>The fundamentals of the dataset should be designed so that it can support future BI and analytics projects and other business teams requiring access to the same data. The dataset will be tasked with delivering both accurate and consistent results across teams and use cases as well as providing a familiar and intuitive interface for analysis. </span></p>
<p class="calibre7">To promote reusability and project communication, a data warehouse bus matrix of business processes and shared dimensions is recommended:</p>
<div class="cdpalignleft"><img src="images/000130.png" class="calibre42" /></div>
<div class="mce-root2">Data warehouse bus matrix</div>
<p class="calibre7">Each row reflects an important and recurring business process, such as the monthly close of the general ledger, and each column represents a business entity, which may relate to one or several of the business processes. The shaded rows (<kbd class="calibre15">Internet Sales</kbd>, <kbd class="calibre15">Reseller Sales</kbd>, and <kbd class="calibre15">Sales Plan</kbd>) identify the business processes that will be implemented as their own star schemas for this project. T<span>he business matrix can be developed in collaboration with business stakeholders, such as the corporate finance manager, as well as source system and business intelligence or data warehouse SMEs.</span></p>
<div class="packt_infobox"><span>The data warehouse bus matrix is a staple of the Ralph Kimball data warehouse architecture, which provides an incremental and integrated approach to data warehouse design. This architecture, as per </span><em class="calibre16">The Data Warehouse Toolkit</em><span> </span><em class="calibre16">(Third Edition)</em><em class="calibre16"> </em><span>by Ralph Kimball, allows for scalable data models, as multiple business teams or functions often require access to the same business process data and dimensions.<br class="calibre3" /></span></div>
<p class="calibre7">Additional business processes, such as maintaining product inventory levels, could potentially be added to the same Power BI dataset in a future project. Importantly, these future additions could leverage existing dimension tables, such as a <strong class="calibre6">Product</strong> table<strong class="calibre6">,</strong> including its source query, column metadata, and any defined hierarchies.</p>
<div class="packt_tip pcalibre7 pcalibre6">Each Power BI report is tied to a single dataset. Given this 1:1 relationship and the analytical value of integrated reports across multiple business processes, such as <kbd class="calibre43">Inventory</kbd> and <kbd class="calibre43">Internet Sales</kbd>, it's important to <span>design datasets that can scale to support multiple star schemas. Consolidating business processes into one or a few datasets also makes solutions more manageable and a better use of source system resources, as common tables (for example,</span> <kbd class="calibre43">Product</kbd><span>,</span> <kbd class="calibre43">Customer</kbd><span>) are only refreshed once.<br class="calibre3" /></span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-87">
<div id="calibre_link-503" class="calibre2">
<div id="calibre_link-504" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dataset design process</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">With the data warehouse bus matrix as a guide, the business intelligence team can work with representatives from the relevant business teams and project sponsors to complete the following four-step dataset design process:</p>
<ol class="calibre12">
<li class="chapter">Select the business process.</li>
<li class="chapter">Declare the grain.</li>
<li class="chapter">Identify the dimensions.</li>
<li class="chapter">Define the facts.</li>
</ol>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-88">
<div id="calibre_link-505" class="calibre2">
<div id="calibre_link-506" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Selecting the business process</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Ultimately each business process will be represented by a fact table with a star schema of many-to-one relationships to dimensions. In a discovery or requirements gathering process it can be difficult to focus on a single business process in isolation as users regularly analyze multiple business processes simultaneously or need to. Nonetheless, it's essential that the dataset being designed reflects low level business activities (for example, receiving an online sales order) rather than a consolidation or integration of distinct business processes such as a table with both online and reseller sales data:</p>
<ul class="calibre12">
<li class="calibre13">Confirm that the answer provided to the first question of the project template regarding data sources is accurate:
<ul class="calibre17">
<li class="calibre13">In this project, the required business processes are <kbd class="calibre15">Internet Sales</kbd>, <kbd class="calibre15">Reseller Sales</kbd>, <kbd class="calibre15">Annual Sales and Margin Plan</kbd></li>
<li class="calibre13">Each of the three business processes corresponds to a fact table to be included in the Power BI dataset</li>
</ul>
</li>
<li class="calibre13">Obtain a high-level understanding of the top business questions each business process will answer:<br class="calibre3" />
<ul class="calibre17">
<li class="calibre13">For example, <span>"What are total sales relative to the <kbd class="calibre15">Annual Sales Plan</kbd> and relative to last year?"</span></li>
<li class="calibre13">In this project, <kbd class="calibre15">Internet Sales</kbd> and <kbd class="calibre15">Reseller Sales</kbd> will be combined into overall corporate sales and margin KPIs</li>
</ul>
</li>
<li class="calibre13">Optionally, reference the data warehouse bus matrix of business processes and their related dimensions:
<ul class="calibre17">
<li class="calibre13">For example, discuss the integration of inventory data and the insights this integration may provide</li>
<li class="calibre13">In many projects, a choice or compromise has to be made given the limited availability of certain business processes and the costs or timelines associated with preparing this data for production use:
<ul class="calibre17">
<li class="calibre13">Additionally, business processes (fact tables) are the top drivers of the storage and processing costs of the dataset and thus should only be included if necessary.</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="packt_tip pcalibre7 pcalibre6"><span>A common anti-pattern to avoid in Power BI projects is the development of datasets for specific projects or teams rather than business processes. For example, one dataset would be developed exclusively for the marketing team and another dataset would be created for the sales organization. Assuming both teams require access to the same sales data, this approach naturally leads to a waste of resources, as the same sales data would be queried and refreshed twice and both datasets would consume storage resources in the Power BI service. Additionally, this isolated approach leads to manageability and version control issues, as the datasets may contain variations in transformation or metric logic. Therefore, although the analytical needs of specific business users or teams are indeed the priority of BI projects, it's important to plan for sustainable solutions that can ultimately be shared across teams.</span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-16">
<div id="calibre_link-507" class="calibre2">
<div id="calibre_link-508" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Declaring the grain</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">All rows of a fact table should represent the individual business process from step <em class="calibre16">1</em> at a certain level of detail or grain such as the header level or line level of a purchase order. Therefore, each row should have the same meaning and thus contain values for the same key columns to dimensions and the same numeric columns.</p>
<p class="calibre7">The grain of fact tables ultimately governs the level of detail available for analytical queries as well as the amount of data to be accessed:</p>
<ul class="calibre12">
<li class="calibre13">Determine what each row of the different business processes will represent:
<ul class="calibre17">
<li class="calibre13">For example, each row of the <kbd class="calibre15">Internet Sales</kbd> fact table represents the line of a sales order from a customer</li>
<li class="calibre13">The rows of the <kbd class="calibre15">Sales and Margin Plan</kbd>, however, are aggregated to the level of a <kbd class="calibre15">Calendar Month</kbd>, <kbd class="calibre15">Products Subcategory</kbd>, and <kbd class="calibre15">Sales Territory Region</kbd></li>
</ul>
</li>
</ul>
<div class="packt_infobox"><span>If it's necessary to apply filters or logic to treat certain rows of a fact table differently than others, the fact table likely contains multiple business processes (for example, shipments and orders) that should be split into separate tables. Although it's technically possible to build this logic into DAX measure expressions, well-designed fact tables benefit Power BI and other data projects and tools over the long term. The same metrics and visualizations can be developed via separate fact tables with their own relationships rather than consolidated fact tables. </span></div>
<ul class="calibre12">
<li class="calibre13">Review and discuss the implications of the chosen grain in terms of dimensionality and scale:
<ul class="calibre17">
<li class="calibre13">Higher granularities provide greater levels of dimensionality and thus detail but result in much larger fact tables</li>
<li class="calibre13">If a high grain or the maximum grain is chosen, determine the row counts per year and the storage size of this table once loaded into Power BI datasets</li>
<li class="calibre13">If a lower grain is chosen, ensure that project stakeholders understand the loss of dimensionalities, such as the inability to filter for specific products or customers</li>
</ul>
</li>
</ul>
<div class="packt_tip pcalibre7 pcalibre6">In general, a higher granularity is recommended for analytical power and sustainability. If a less granular design is chosen, such as the header level of a sales order, and this grain later proves to be insufficient to answer new business questions, then either a new fact table would have to be added to the dataset or the existing fact table and all of its measures and dependent reports would have to be replaced. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-89">
<div id="calibre_link-509" class="calibre2">
<div id="calibre_link-510" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Identifying the dimensions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The dimensions to be related to the fact table are a natural byproduct of the grain chosen in step <em class="calibre16">2</em> and thus largely impact the decision in step <em class="calibre16">2</em>. A single sample row from the fact table should clearly indicate the business entities (dimensions) associated with the given process such as the customer who purchased an individual product on a certain date and at a certain time via a specific promotion. Fact tables representing a lower grain will have fewer dimensions. For example, a fact table representing the header level of a purchase order may identify the vendor but not the individual products purchased from the vendor:</p>
<ul class="calibre12">
<li class="calibre13">Identify and communicate the dimensions that can be used to filter (aka <em class="calibre16">slice and dice</em>) each business process:<br class="calibre3" />
<ul class="calibre17">
<li class="calibre13">The foreign key columns based on the grain chosen in the previous step reference dimension tables.</li>
<li class="calibre13">Review a sample of all critical dimension tables, such as <strong class="calibre6">Product</strong> or <strong class="calibre6">Customer</strong>, and ensure these tables contain the columns and values necessary or expected.</li>
</ul>
</li>
<li class="calibre13">Communicate which dimensions can be used to filter multiple business processes simultaneously:
<ul class="calibre17">
<li class="calibre13">In this project, the <strong class="calibre6">Product</strong>, <strong class="calibre6">Sales Territory</strong>, and <strong class="calibre6">Date</strong> dimensions can be used to filter all three fact tables. </li>
<li class="calibre13"><span>The data warehouse bus matrix referenced earlier can be helpful for this step</span></li>
</ul>
</li>
<li class="calibre13">Look for any gap between the existing dimension tables and business questions or related reports:
<ul class="calibre17">
<li class="calibre13">For example, existing IT-supported reports may contain embedded logic that creates columns via SQL which are not stored in the data warehouse</li>
</ul>
</li>
<li class="calibre13">Strive to maintain version control for dimension tables and the columns (attributes) within dimension tables:
<ul class="calibre17">
<li class="calibre13">It may be necessary for project stakeholders to adapt or migrate from legacy reports or an internally maintained source to the Corporate BI source</li>
</ul>
</li>
</ul>
<p class="calibre7"><span>A significant challenge to the identity of the dimensions step can be a lack of <strong class="calibre6">Master Data Management</strong> (<strong class="calibre6">MDM</strong>) and alternative versions. For example, the sales organization may maintain their own dimension tables in Excel or Microsoft Access and their naming conventions and hierarchy structures may represent a conflict or gap with the existing data warehouse. Additionally, many corporate applications may store their own versions of common dimensions, such as products and customers. These issues should be understood and, despite pressure to deliver BI value quickly or according to a specific business team's preferred version, the long-term value of a single definition for an entire organization as expressed via the bus matrix should not be sacrificed.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-90">
<div id="calibre_link-511" class="calibre2">
<div id="calibre_link-512" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Defining the facts</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The facts represent the numeric columns to be included in the fact table. While the dimension columns from step <em class="calibre16">3</em> will be used for relationships to dimension tables, the fact columns will be used in measures containing aggregation logic such as the sum of a quantity column and the average of a price column:</p>
<ul class="calibre12">
<li class="calibre13">Define the business logic for each fact that will be represented by measures in the dataset:
<ul class="calibre17">
<li class="calibre13">For example, gross sales is equal to the extended amount on a sales order, and net sales is equal to gross sales minus discounts</li>
</ul>
</li>
<li class="calibre13">Any existing documentation or relevant technical metadata should be reviewed and validated</li>
<li class="calibre13">Similar to the dimensions, any conflicts between existing definitions should be addressed so that a single definition for a core set of metrics is understood and approved </li>
<li class="calibre13">Additionally, a baseline or target source should be identified to validate the accuracy of the metrics to be created.
<ul class="calibre17">
<li class="calibre13">For example, several months following the project, it should be possible to compare the results of DAX measures from the Power BI dataset to an SSRS report or a SQL query</li>
<li class="calibre13">If no variance exists between the two sources, the DAX measures are valid and thus any doubt or reported discrepancy is due to some other factor</li>
</ul>
</li>
</ul>
<div class="packt_infobox">See <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>, <a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em>, and <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles,</em> for details on the fact table columns to include in Power BI datasets (for import or DirectQuery) and the development of DAX metric expressions. The fact definitions from this step relate closely to the concept of base measures described in <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em>. Ultimately, the DAX measures implemented have to tie to the approved definitions, but there are significant data processing, storage and performance implications based on how this logic is computed. In many cases, the Power BI dataset can provide the same logic as an existing system but via an alternative methodology that better aligns with Power BI or the specific project need. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-91">
<div id="calibre_link-513" class="calibre2">
<div id="calibre_link-514" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Data profiling</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The four-step dataset design process can be immediately followed by a technical analysis of the source data for the required fact and dimension tables of the dataset. Technical metadata, including database diagrams and data profiling results, such as the existence of null values in source columns, are essential for the project planning stage. This information is used to ensure the Power BI dataset reflects the intended business definitions and is built on a sound and trusted source.</p>
<p class="calibre7">For example, the following SQL Server database diagram describes the schema for the reseller sales business process:</p>
<div class="cdpalignleft"><img src="images/000140.png" class="calibre44" /></div>
<div class="mce-root2">SQL Server Datdbase diagram: reseller sales</div>
<p class="calibre7">The foreign key constraints identify the surrogate key columns to be used in the relationships of the Power BI dataset and the referential integrity of the source database. In this schema, the product dimension is modeled as three separate dimension tables&mdash;<kbd class="calibre15">DimProduct</kbd>, <kbd class="calibre15">DimProductSubcategory</kbd>, and <kbd class="calibre15">DimProductCategory</kbd>. Given the priorities of usability, manageability, and query performance, a single denormalized product dimension table that includes essential <kbd class="calibre15">Product Subcategory</kbd> and <kbd class="calibre15">Product Category</kbd> columns is generally recommended. This will reduce the volume of source queries, relationships, and tables in the data model and will improve report query performance, as fewer relationships will need to be scanned by the dataset engine. </p>
<p class="calibre7">Clear visibility to the source system, including referential and data integrity constraints, data quality, and any <span>MDM</span> processes, is essential. Unlike other popular BI tools, Power BI is capable of addressing many data integration and quality issues, particularly with relational database sources which Power BI can leverage to execute data transformation operations. However, Power BI's ETL capabilities are not a substitute for data warehouse architecture and enterprise ETL tools, such as <strong class="calibre6">SQL Server Integration Services</strong> (<strong class="calibre6">SSIS</strong>). For example, it's the responsibility of the data warehouse to support historical tracking with slowly changing dimension ETL processes that generate new rows and surrogate keys for a dimension when certain columns change. To illustrate a standard implementation of slowly changing dimensions, the following query of the <kbd class="calibre15">DimProduct</kbd> table in the Adventure Works data warehouse returns three rows for one product (<kbd class="calibre15">FR-M94B-38</kbd>):</p>
<div class="cdpalignleft"><img src="images/000150.png" class="calibre45" /></div>
<div class="mce-root2">Historical tracking of dimensions via slowly changing dimension ETL processes </div>
<p class="calibre7">It's the responsibility of the Power BI team and particularly the dataset designer to accurately reflect this historical tracking via relationships and DAX measures, such as the count of distinct products not sold. Like historical tracking, the data warehouse should also reflect all master data management processes that serve to maintain accurate master data for essential dimensions, such as customers, products, and employees. In other words, despite many line of business applications and ERP, CRM, HRM, and other large corporate systems which store and process the same master data, the data warehouse should reflect the centrally governed and cleansed standard. Creating a Power BI dataset which only reflects one of these source systems may later introduce version control issues and, similar to choosing an incorrect granularity for a fact table, can ultimately require costly and invasive revisions. </p>
<p class="calibre7">Different tools are available with data profiling capabilities. If the data source is the SQL Server, SSIS can be used to analyze source data to be used in a project.</p>
<p class="calibre7">In the following image, the <span>Data Profiling Task</span> is used in an SSIS package to analyze the customer dimension table:</p>
<div class="cdpaligncenter1"><img src="images/000160.png" class="calibre46" /></div>
<div class="mce-root2">Data Profiling Task in SQL Server integration services</div>
<div class="packt_infobox">The Data Profiling Task requires an ADO.NET connection to the data source and can write its output to an XML file or an SSIS variable. In this example, the ADO.NET data source is the Adventure Works data warehouse database in SQL Server 2016 and the destination is an XML file (<kbd class="calibre43">DataProfilingData.xml</kbd>). Once the task is executed, the XML file can be read via the SQL Server Data Profile Viewer as per the following example. Note that this application, Data Profile Viewer, requires an installation of the SQL Server and that the Data Profiling Task only works with SQL Server data sources. </div>
<p class="calibre7">All fact and dimension table sources can be analyzed quickly for the count and distribution of unique values, the existence of null values, and other useful statistics.</p>
<p class="calibre7">Each data profiling task can be configured to write its results to an XML file on a network location for access via tools such as the <span>Data Profile Viewe</span><span>r</span>. In this example, the <span>Data Profile Viewer</span> is opened from within SSIS to analyze the output of the <span>Data Profiling Task</span> for the <span>Customer</span> dimension table:</p>
<div class="cdpalignleft"><img src="images/000170.png" class="calibre47" /></div>
<div class="mce-root2">Data Profile Viewer: column null ratio profiles of DimCustomer table</div>
<p class="calibre7"><span>Identifying and documenting issues in the source data via data profiling is a critical step in the planning process. For example, the cardinality or count of unique values largely determines the data size of a column in an import mode dataset. Similarly, the severity of data quality issues identified impacts whether a DirectQuery dataset is a feasible option. </span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-92">
<div id="calibre_link-515" class="calibre2">
<div id="calibre_link-516" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dataset planning</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>After the source data has been profiled and evaluated against the requirements identified in the four-step dataset design process, the BI team can further analyze the implementation options for the dataset. In almost all Power BI projects, even with significant investments in enterprise data warehouse architecture and ETL tools and processes, some level of additional logic, integration, or transformation is needed to enhance the quality and value of the source data or to effectively support a business requirement. A priority of the dataset, planning stage is to determine how the identified data transformation issues will be addressed to support the dataset. Additionally, based on all available information and requirements, the project team must determine whether to develop an import mode dataset or a DirectQuery dataset.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-93">
<div id="calibre_link-517" class="calibre2">
<div id="calibre_link-518" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Data transformations</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>To help clarify the dataset planning process, a diagram such as the following can be created that identifies the different layers of the data warehouse and Power BI dataset where transformation and business logic can be implemented: </span></p>
<div class="cdpalignleft"><img src="images/000180.png" class="calibre48" /></div>
<div class="mce-root2">Dataset planning architecture</div>
<p class="calibre7"><span>In some projects, minimal transformation logic is needed and can be easily included in the Power BI dataset or the SQL views accessed by the dataset. For example, if only a few additional columns are needed for a dimension table and there's straightforward guidance on how these columns should be computed, the IT organization may choose to implement these transformations within Power BI's M queries rather than revise the data warehouse, at least in the short term.</span></p>
<div class="packt_infobox"><span>If a substantial gap between BI needs and the corporate data warehouse is allowed to persist and grow due to various factors, such as cost, project expediency, and available data warehouse skills, then Power BI datasets will become more complex to build and maintain. Dataset designers should regularly analyze and communicate the implications of datasets assuming greater levels of complexity. </span></div>
<p class="calibre7"><span>However, if the required transformation logic is complex or extensive with multiple join operations, row filters, and data type changes, then the IT organization may choose to implement essential changes in the data warehouse to support the new dataset and future BI projects. For example, a staging table and a SQL stored procedure may be needed to support a revised nightly update process or the creation of an index may be needed to deliver improved query performance for a DirectQuery dataset.</span></p>
<p class="calibre7">Ideally, all required data transformation and shaping logic could be implemented in the source data warehouse and its ETL processes so that Power BI is exclusively used for analytics and visualization. However, in the reality of scarce IT resources and project delivery timelines, typically at least a portion of these issues must be handled through other means, such as SQL view objects or Power BI's M query functions. </p>
<div class="packt_tip pcalibre7 pcalibre6"><span>A best practice is to implement data transformation operations within the data warehouse or source system. This minimizes the resources required to process an import mode dataset and, for DirectQuery datasets, can significantly improve query performance, as these operations would otherwise be executed during report queries. For many common data sources, such as Oracle and Teradata, M query expressions are translated into equivalent SQL statements (if possible) and these statements are passed back to the source system via a process called Query Folding. See <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M,</em> for more details on query folding. </span></div>
<p class="calibre7"><span>As per the dataset planning architecture diagram, a layer of SQL views should serve as the source objects to datasets created with Power BI Desktop. By creating a SQL view for each dimension and fact table of the dataset, the data source owner or administrator is able to identify the views as dependencies of the source tables and is therefore less likely to implement changes that would impact the dataset without first consulting the BI team. Additionally, the SQL views improve the availability of the dataset, as modifications to the source tables will be much less likely to cause the refresh process to fail.</span></p>
<p class="calibre7"><span>As a general rule, the BI team and IT organization will want to avoid the use of DAX for data transformation and shaping logic, such as DAX calculated tables and calculated columns. The primary reason for this is that it weakens the link between the dataset and the d</span><span>ata source, as these expressions are processed entirely by the Power BI dataset after source queries have been executed. Additionally, the distribution of transformation logic across multiple layers of the solution (SQL, M, DAX) causes datasets to become less flexible and manageable. Moreover, tables and columns created via DAX do not benefit from the same compression algorithms applied to standard tables and columns and thus can represent both a waste of resources as well as a performance penalty for queries accessing these columns.</span></p>
<p class="calibre7">In the event that required data transformation logic cannot be implemented directly in the data warehouse or its ETL or <strong class="calibre6">extract-load-transform</strong> (<strong class="calibre6">ELT</strong>) process, a secondary alternative is to build this logic into the layer of SQL views supporting the Power BI dataset. For example, a SQL view for the product dimension could be created that joins the <kbd class="calibre15">Product</kbd>, <kbd class="calibre15">Product Subcategory</kbd>, and <kbd class="calibre15">Product Category</kbd> dimension tables, and this view could be accessed by the Power BI dataset. As a third option, M functions in the Power BI query expressions could be used to enhance or transform the data provided by the SQL views. See <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M,</em> for details on these functions and the Power BI data access layer generally.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-94">
<div id="calibre_link-519" class="calibre2">
<div id="calibre_link-520" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Import versus DirectQuery</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A subsequent but closely related step to dataset planning is choosing between the default <span>Import</span> mode or <span>DirectQuery</span> mode. In some projects, this is a simple decision as only one option is feasible or realistic given the known requirements while other projects entail significant analysis of the pros and cons of either design. For example, if a data source is considered slow or ill-equipped to handle a high volume of analytical queries then an import mode dataset is very likely the preferred option. Additionally, if multiple data sources are required for a dataset and they cannot be consolidated into a single DirectQuery data source then an import mode dataset is the only option. Likewise, if near real-time visibility to a data source is an essential business requirement then DirectQuery is the only option.</p>
<p class="calibre7">When DirectQuery is a feasible option or can be made a feasible option via minimal modifications, organizations may be attracted to the prospect of leveraging investments in high-performance database and data warehouse systems. However, the overhead costs and version control concerns of import mode can be reduced via Power BI features, such as the dataset refresh APIs discussed in <a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content</em>, and the expected incremental data refresh feature for Power BI Premium capacities. </p>
<p class="calibre7">The following list of questions can help guide an import versus DirectQuery decision:</p>
<ol class="calibre12">
<li class="chapter">Is there a single data source for our dataset which Power BI supports as a DirectQuery source?
<ul class="calibre17">
<li class="chapter">For example, each fact and dimension table needed by the dataset is stored in a single data warehouse database, such as Oracle, Teradata, SQL Server, or Azure SQL Database.</li>
<li class="chapter">The following URL identifies the data sources supported for DirectQuery with Power BI, including sources which are currently only in beta: <a href="http://bit.ly/2AcMp25" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">http://bit.ly/2AcMp25</a>.</li>
</ul>
</li>
<li class="chapter">If DirectQuery is an option per question <em class="calibre16">1</em>, is this source capable of supporting the analytical query workload of Power BI?
<ul class="calibre17">
<li class="chapter">For example, although Azure SQL Data Warehouse technically supports DirectQuery, it's not recommended to use Azure SQL Data Warehouse as a DirectQuery data source, given the limitations on the volume of concurrent queries supported and a lack of query plan caching. </li>
<li class="chapter">In many other scenarios, the data source may not be optimized for analytical queries, such as with star schema designs and indexes which target common BI/reporting queries. Additionally, if the database is utilized for <strong class="calibre6">online transaction processing</strong> (<strong class="calibre6">OLTP</strong>) workloads and/or other BI/analytical tools, then it's necessary to evaluate any potential impact to these applications and the availability of resources.</li>
</ul>
</li>
<li class="chapter">Is an import mode dataset feasible, given the size of the dataset and any requirements for near real-time visibility to the data source?
<ul class="calibre17">
<li class="chapter">Currently Power BI Premium supports import mode datasets up to 10 GB in size and incremental data refresh is not available. Therefore, massive datasets must either use a DirectQuery data source or a Live connection to an Analysis Services model.</li>
<li class="chapter">Additionally, Power BI Premium currently supports a maximum of 48 refreshes per day for import mode datasets. Therefore, if there's a need to view data source data for the last several minutes or seconds, an import mode dataset is not feasible.</li>
</ul>
</li>
<li class="chapter">If the DirectQuery source is capable of supporting a Power BI workload as per question <em class="calibre16">2</em>, is the DirectQuery connection more valuable than the additional performance and flexibility provided via the import mode?
<ul class="calibre17">
<li class="chapter">In other words, if an import mode dataset is feasible, as per question <em class="calibre16">3</em>, then an organization should evaluate the trade-offs of the two modes. For example, since an import mode dataset will be hosted in the Power BI service and in a compressed and columnar in-memory data store, it will likely provide a performance advantage. This is particularly the case if the DirectQuery source is hosted on-premises and thus queries from the Power BI cloud service must pass through the On-premises data gateway reviewed in <a href="#calibre_link-15" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chapter 9</a>, <em class="calibre16"><em class="calibre16">Managing the On-Premises Data Gateway.</em></em></li>
<li class="chapter">Additionally, any future data sources and most future data transformations will need to be integrated into the DirectQuery source. With an import mode dataset, the scheduled import process can include many data transformations and potentially other data sources without negatively impacting query performance.</li>
</ul>
</li>
</ol>
<p class="calibre7">For organizations that have invested in powerful data source systems for BI workloads, there's a strong motivation to leverage this system via DirectQuery. A business intelligence team or architect will be adverse to copying data into another data store and thus creating both another data movement and a source of reporting that must be supported. As a result of this scenario, Microsoft is actively investing in improvements to DirectQuery datasets for Power BI and Analysis Services models in <span>DirectQuery</span> mode. These investments are expected to reduce the gap in query performance between DirectQuery and the import mode. Additionally, a hybrid dataset mode may be released that allows teams to isolate tables or even partitions of tables between DirectQuery and Import storage options. </p>
<p class="calibre7">However, Microsoft is also in the process of expanding support for large import mode Power BI datasets hosted in Power BI Premium capacity. For example, in the near future a dataset much larger than 10 GB could be incrementally refreshed to only update or load the most recent data. Additional details on the capabilities provided by Power BI Premium, potential future enhancements, and the implications for Power BI deployments are included in <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling with Premium and Analysis Services.</em></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-95">
<div id="calibre_link-521" class="calibre2">
<div id="calibre_link-522" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Import mode </h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">An import mode dataset can include multiple data sources, such as SQL Server, Oracle, and an Excel file. Since a snapshot of the source data is loaded into the Power BI cloud service, in addition to its in-memory columnar compressed structure, query performance is usually good for most scenarios. Another important advantage of import mode datasets is the ability to implement data transformations without negatively impacting query performance. Unlike DirectQuery datasets, the operations of data source SQL views and the M queries of Import datasets are executed during the scheduled data refresh process. The <em class="calibre16">Query Design per dataset mode</em> section of <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>, discusses this issue in greater detail. </p>
<p class="calibre7">Given the performance advantage of the in-memory mode relative to DirectQuery, the ability to integrate multiple data sources, and the relatively few use cases where real-time visibility is required, most Power BI datasets are designed using the import mode. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-96">
<div id="calibre_link-523" class="calibre2">
<div id="calibre_link-524" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">DirectQuery mode</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A DirectQuery dataset is limited to a single data source and serves as merely a thin semantic layer or interface to simplify the report development and data exploration experience. DirectQuery datasets translate report queries into compatible queries for the data source and leverage the data source for query processing, thus eliminating the need to store and refresh an additional copy of the source data.</p>
<p class="calibre7">A common use case of Power BI and SSAS Tabular DirectQuery datasets is to provide reporting on top of relatively small databases associated with OLTP applications. For example, if SQL Server 2016 or later is used as the relational database for an OLTP application, nonclustered columnstore indexes can be applied to several tables needed for analytics. Since nonclustered indexes are updateable in SQL Server 2016, the database engine can continue to utilize existing indexes to process OLTP transactions, such as a clustered index on a primary key column while the nonclustered columnstore index will be used to deliver performance for the analytical queries from Power BI. The business value of near real-time access to the application can be further enhanced with Power BI features, such as data-driven alerts and notifications.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-97">
<div id="calibre_link-525" class="calibre2">
<div id="calibre_link-526" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Sample project analysis</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As per the data refresh questions from the project template (#7-8), the Power BI dataset only needs to be refreshed daily&mdash;there's not a need for real-time visibility of the data source. From a dataset design perspective, this means that the default import mode is sufficient for this project in terms of latency or data freshness. The project template also advises that an Excel file containing the <kbd class="calibre15">Annual Sales Plan</kbd> must be included in addition to the historical sales data in the SQL Server data warehouse. Therefore, unless the <kbd class="calibre15">Annual Sales Plan</kbd> data can be migrated to the same SQL Server database containing the <kbd class="calibre15">Internet Sales</kbd> and <kbd class="calibre15">Reseller Sales</kbd> data, an import mode dataset is the only option. </p>
<div class="packt_infobox">The data security requirements from the project template can be implemented via simple security roles and therefore do not materially impact the import or DirectQuery decision. DirectQuery datatsets can support dynamic or user-based security models as well but, given restrictions on the DAX functions that can be used in security roles for DirectQuery datasets, import mode datasets can more easily support complex security requirements. However, depending on the data source and the security applied to that source relative to the requirements of the project, organizations may leverage existing data source security through a DirectQuery dataset via a single sign-on with Kerberos delegation.</div>
<p class="calibre7">Finally, the BI team must also consider the scale of the dataset relative to size limitations with import mode datasets. As per the project template (#6), 3&ndash;4 years of sales history needs to be included, and thus the dataset designer needs to determine the size of the Power BI dataset that would store that data. For example, if Power BI Premium capacity is not available, the PBIX dataset is limited to a max size of 1 GB. If Power BI Premium capacity is available, large datasets (for example, 10 GB+) potentially containing hundreds of millions of rows can be published to the Power BI service. </p>
<p class="calibre7">The decision for this project is to develop an import mode dataset and to keep the Excel file containing the <kbd class="calibre15">Annual Sales Plan</kbd> on a secure network location. The BI team will develop a layer of views to retrieve the required dimension and fact tables from the SQL Server database as well as connectivity to the Excel file. The business will be responsible for maintaining the following <kbd class="calibre15">Annual Sales Plan</kbd> Excel file in its current schema, including any row updates and the insertion of new rows for future plan years: </p>
<div class="cdpaligncenter1"><img src="images/000190.png" class="calibre49" /></div>
<div class="mce-root2">Annual Sales Plan in Excel data table </div>
<p class="calibre7">By using the existing Excel file for the planned sales and margin data rather than integrating this data into the data warehouse, the project is able to start faster and maintain continuity for the business team responsible for this source. Similar to collaboration with all data source owners, the dataset designer could advise the business user or team responsible for the sales plan on the required structure and the rules for maintaining the data source to allow for integration into Power BI. For example, the name and directory of the file, as well as the column names of the Excel data table, cannot be changed without first communicating these requested revisions. <span>Additionally, the values of the</span> <kbd class="calibre15">Sales Territory Region</kbd><span>,</span> <kbd class="calibre15">Product Subcategory</kbd><span>, and</span> <kbd class="calibre15">Calendar Yr-Mo</kbd> <span>columns must remain aligned with those used in the data warehouse to support the required actual versus plan visualizations.<br class="calibre3" /></span></p>
<p class="calibre7"><span>The sales plan includes multiple years and represents a granularity of the month, sales territory region, and product subcategory. In other words, each row represents a unique combination of values from the <kbd class="calibre15">Calendar Yr-Mo</kbd>, <kbd class="calibre15">Sales Territory Region</kbd>, and <kbd class="calibre15">Product Subcategory</kbd> columns.</span> The <em class="calibre16">Bridge tables</em> section in <a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em>, describes how these three columns are used in integrating the Sales Plan data into the dataset containing <kbd class="calibre15">Internet Sale</kbd>s and <kbd class="calibre15">Reseller Sales</kbd> data.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-98">
<div id="calibre_link-527" class="calibre2">
<div id="calibre_link-528" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In this chapter, we've walked through the primary elements and considerations in planning a Power BI project. A standard and detailed planing process inclusive of the self-service capabilities needed or expected, project roles and responsibilities, and the design of the dataset can significantly reduce the time and cost to develop and maintain the solution. With a sound foundation of business requirements and technical analysis, a business intelligence team can confidently move forward into a development stage.</p>
<p class="calibre7">In the next chapter, the two data sources identified in this chapter (SQL Server and Excel) will be accessed to begin development of an import mode dataset. Source data will be retrieved via Power BI's M language queries to retrieve the set of required fact and dimension tables. Additionally, several data transformations and query techniques will be applied to enhance the analytical value of the data and the usability of the dataset. </p>
<p class="calibre7"> </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-22">
<div id="calibre_link-529" class="calibre2">
<div id="calibre_link-530" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Connecting to Sources and Transforming Data with M</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>This chapter follows up on the dataset planning process described in the previous chapter by implementing M queries in a new Power BI Desktop file to retrieve the required fact and dimension tables. Parameters and variables are used to access a set of SQL views reflecting the data warehouse tables inside a SQL Server database and the <kbd class="calibre15">Annual Sales Plan</kbd> data contained in an Excel workbook. Additional M queries are developed to support relationships between the sales plan and dimension tables and to promote greater usability and manageability of the dataset.</span></p>
<p class="calibre7"><span>Three examples of implementing data transformations and logic within M queries, such as the creation of a dynamic customer history segment column, are included. Finally, tools for editing and managing M queries, such as extensions for Visual Studio and Visual Studio Code, are reviewed. </span></p>
<p class="calibre7">In this chapter, we will review the following topics:</p>
<ul class="calibre12">
<li class="calibre13">Query design per dataset mode</li>
<li class="calibre13">Data sources</li>
<li class="calibre13">Power BI Desktop options</li>
<li class="calibre13">SQL views</li>
<li class="calibre13">Parameters</li>
<li class="calibre13">Staging queries</li>
<li class="calibre13">Data types</li>
<li class="calibre13">Query folding</li>
<li class="calibre13">M query examples</li>
<li class="calibre13">M query editing tools</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-99">
<div id="calibre_link-531" class="calibre2">
<div id="calibre_link-532" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Query design per dataset mode</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Many common M queries can be written for both import and DirectQuery datasets, but with widely different implications for the source system resources utilized and the performance of the analytical queries from Power BI. It's essential that the mode of the dataset (import or DirectQuery) has been determined in advance of the development of the data access queries and that this decision is reflected in the M queries of the dataset. </p>
<p class="calibre7">The M queries supporting a Power BI dataset import mode should exclude, or possibly split, columns with many unique values, such as a <kbd class="calibre15">Transaction Number</kbd> column, as these columns consume relatively high levels of memory. A standard design technique for import mode models is to exclude derived fact table columns with relatively more unique values when these values can be computed via simple DAX measure expressions based on columns of the same table with fewer unique values.</p>
<p class="calibre7">In the following example, the <kbd class="calibre15">SUMX()</kbd> DAX function is used to compute the <kbd class="calibre15">Sales Amount</kbd> measure based on the <kbd class="calibre15">Order Quantity</kbd> and <kbd class="calibre15">Unit Price</kbd> columns of the <kbd class="calibre15">Internet Sales</kbd> fact table, thus avoiding the need to import the <kbd class="calibre15">Sales Amount</kbd> column:</p>
<pre class="calibre19"><strong class="calibre6">Internet Sales Amount (Import)</strong> = <br class="calibre3" />SUMX('Internet Sales','Internet Sales'[Order Quantity]*'Internet Sales'[Unit Price]) <br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Sales Amount (DirectQuery) </strong>= <br class="calibre3" />SUM('Internet Sales'[Sales Amount])<strong class="calibre6"> </strong></pre>
<p class="calibre7">As per the second measure, the <kbd class="calibre15">Sales Amount</kbd> column would be included in a DirectQuery data model and the DAX measure for the sales amount would exclusively utilize this column to generate a more efficient SQL query for the data source.</p>
<div class="packt_infobox">The import mode model is able to efficiently compute similar <kbd class="calibre43">SUMX()</kbd> expressions at scale with basic arithmetic operators (<kbd class="calibre43">+</kbd>, <kbd class="calibre43">-</kbd>, <kbd class="calibre43">*</kbd>, <kbd class="calibre43">/</kbd>) as these operations are supported by the multithreaded storage engine of the xVelocity in-memory analytics engine. For greater detail on DAX measures for import and DirectQuery datasets, see <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em>.</div>
<p class="calibre7">The M queries supporting a DirectQuery dataset should generally contain minimal to no transformation logic as the complexity of the resulting SQL statement may negatively impact the performance of Power BI report queries as well as increase the resource usage of the data source.</p>
<p class="calibre7">This is especially important for the fact tables and any large dimension tables of the DirectQuery dataset. Given the central role of the data source for query performance and scalability of DirectQuery solutions, the Power BI dataset designer should closely collaborate with the data source owner or subject matter expert, such as a database administrator, to make the best use of available source system resources.</p>
<div class="packt_infobox">As noted in the <em class="calibre16">To get the most out of this book</em> section of the Preface, an AdventureWorks data warehouse sample database (<kbd class="calibre43">AdventureWorksDW2016CTP3</kbd>) hosted on a local instance of the SQL Server 2017 database engine was the primary data source for the examples in this book. The PBIX files included in the code bundle reference ATLAS as the name of the database server and AdventureWorksDW as the name of the database. Therefore, any attempt to refresh the queries within these PBIX files or create new queries against this data source will return errors as the user doesn't have access to this source.<br class="calibre3" />
<br class="calibre3" />
Additionally, certain objects of the <kbd class="calibre43">AdventureWorksDW</kbd> database used in this book such as views are not included in the downloadable sample database. For this reason, the exact results depicted in this book cannot be perfectly reproduced via a SQL Server 2017 (or later) database instance and the sample database alone. Moreover, the code examples in the book are intended to highlight essential concepts and use cases. The corresponding code included in the code bundle may, for example, include additional columns not referenced in the book as these columns weren't essential to the given example.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-100">
<div id="calibre_link-533" class="calibre2">
<div id="calibre_link-534" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Import mode dataset queries</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">All M queries of an import mode dataset are executed only once per scheduled refresh. Therefore, if sufficient resources are available during these scheduled intervals, the M queries can contain more complex and resource-intensive operations without negatively impacting report query performance. In fact, well-designed data retrieval processes can benefit from report query performance as the source data is prepped to take greater advantage of the compression algorithms applied to import mode datasets. The systems impacted by these retrieval operations depend on the data source, whether the data sources is located on-premises or in a public cloud, such as MS Azure, and the operations of the query itself.</p>
<p class="calibre7">In this project example with an on-premises SQL Server database, the M queries can utilize the database server's resources during each refresh via the query folding process described later in this chapter. In the event that certain M expressions cannot be translated into an equivalent SQL statement for the given source, these expressions will be evaluated by the in-memory M engine of the On-premises data gateway, which is installed on-premises. If the source database was in the cloud and not within an <strong class="calibre6">Infrastructure-as-a-Service</strong> (<strong class="calibre6">IaaS</strong>) virtual machine, a gateway would not be required for the refresh, and resources in Power BI, such as Power BI Premium capacity hardware, would be used to execute any M expressions that can't be folded to a source.</p>
<div class="packt_infobox">For import mode datasets, M queries can be partially folded such that a source database is used to execute only part of the required logic. For example, an M query may contain both simple transformation steps, such as filtering out rows, as well as more complex logic that references a custom M function. In this scenario, a SQL statement may be generated for the initial steps of the query, and the results of this SQL query could be used by another system's resources, such as the On-premises data gateway to process the remaining logic. All steps (variables) within an M query following a step that cannot be folded are also not folded. Likewise, any M step following a <kbd class="calibre43">Value.NativeQuery()</kbd> function that passes a SQL statement to a source system will also not be folded. See the <em class="calibre16">Query folding section</em> later in this chapter for more details.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-101">
<div id="calibre_link-535" class="calibre2">
<div id="calibre_link-536" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">DirectQuery dataset queries</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For DirectQuery datasets, every M query is folded to exclusively utilize the resources of the single data source. Therefore, certain M functions and query logic that lack an equivalent SQL expression for the given data source, such as Oracle or Teradata, are not supported. In these scenarios, the dataset designer can develop alternative M queries that produce the same target data structure and are supported by the source system or implement the necessary logic within the layer of SQL views supporting the dataset. </p>
<p class="calibre7">An additional and fundamental limitation to the scope of M queries for DirectQuery datasets is the impact on query performance and user experience. Since the SQL statements representing M queries must be executed by the source system during report viewing sessions, common transformations such as converting data types and sorting tables can cause significant performance degradation.</p>
<p class="calibre7">Additionally, a high volume of sub-optimal SQL queries passed from Power BI reports can quickly drive up the resource usage of the source system. Therefore, although it's often technically possible to implement similar data transformation logic in the SQL views and M queries of DirectQuery datasets as with import mode datasets, the performance and resource implications of these transformations frequently prove unacceptable.</p>
<div class="packt_tip pcalibre7 pcalibre6">Dataset designers of DirectQuery datasets should document the SQL statements generated by their M queries. As shown in the Query folding section later in this chapter, these queries can be accessed from the <span>View Native Query</span> command within the <span>Applied Steps</span> pane of the Power Query Editor in Power BI Desktop. Sharing and reviewing these queries with the data source owner, or a subject matter expert on the data source can often lead to new ideas to improve performance or data quality. For example, the data source owner can analyze the indexes of the source fact table and determine whether the <kbd class="calibre43">WHERE</kbd> clause of the query can take advantage of existing indexes. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-102">
<div id="calibre_link-537" class="calibre2">
<div id="calibre_link-538" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Data sources</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Data source connectivity is one of the strengths of Power BI, due to the vast list of standard data source connectors included in Power BI Desktop, in addition, to support for <strong class="calibre6">Open Database Connectivity</strong> (<strong class="calibre6">ODBC</strong><span>)</span> and<span> </span><strong class="calibre6">Object Linking and Embedding, Database</strong> (<strong class="calibre6">OLE DB</strong>) connections. The breadth of data connectivity options is further bolstered by the ability for developers to create custom Power BI data connectors for a specific application, service, or data source. Custom data connectors, the data retrieval processes created for all data sources for Power BI, and other Microsoft applications are developed with the M language.</p>
<p class="calibre7">Power BI's data connectors are consistently extended and improved with each monthly release of Power BI Desktop. New data sources are commonly added as a preview or beta release feature and previous beta connectors are moved from beta to general availability. </p>
<p class="calibre7">In the following example from the October 2017 release of Power BI Desktop, the connector for <span>Google BigQuery</span> is in beta while Amazon Redshift has been generally available since the June 2017 release: </p>
<div class="cdpalignleft"><img src="images/000200.png" class="calibre50" /></div>
<div class="mce-root2">Beta and generally-available data connectors in Power BI Desktop</div>
<div class="packt_infobox">Beta connectors should only be used for testing purposes, as differences between the beta release and the subsequent generally-available connector may cause queries dependent on the beta version to fail.</div>
<p class="calibre7">The data connector icons exposed in the <span>Get Data</span> graphical interface of Power BI Desktop are associated with the data access functions of M, such as <kbd class="calibre15">Sql.Database()</kbd>. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-103">
<div id="calibre_link-539" class="calibre2">
<div id="calibre_link-540" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Authentication</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Power BI Desktop saves a data source credential, or sign-in identity, for each data source connection used. These credentials and settings are not stored in the <kbd class="calibre15">PBIX</kbd> file but rather on the local computer specific to the given user.</p>
<p class="calibre7">An authentication dialog specific to the data source is rendered if the user hasn't accessed the data source before or if the user has removed existing permissions to the data source in Power BI Desktop's <span>Data source s</span><span>ettings</span> menu. In the following example, an <kbd class="calibre15">Sql.Database()</kbd> M query function references the <kbd class="calibre15">AdventureWorksDW</kbd> SQL Server database on the ATLAS server.</p>
<p class="calibre7">In this scenario, the user has not previously accessed this data source (or has cleared existing source permissions), and thus executing this query prompts the user to configure the authentication to this source as shown in the following image:</p>
<div class="cdpalignleft"><img src="images/000211.png" class="calibre51" /></div>
<div class="mce-root2">Edit Authentication Credentials in Power BI Desktop</div>
<p class="calibre7">Most relational database sources have similar authentication options. For SQL Server, the user can choose between the default Windows-integrated authentication (that is, <span>Use my current credentials</span>) or database authentication if the database is in Mixed Mode. Additionally, the credentials can be saved exclusively to the specific database or be reused for other databases on the same server. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-104">
<div id="calibre_link-541" class="calibre2">
<div id="calibre_link-542" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Data source settings</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The <span>Data source settings</span> menu provides access to the authentication and privacy levels configured for each data source within the current file and the saved permissions available to all of the user's Power BI Desktop files.</p>
<p class="calibre7">This menu can be accessed under the <span>Edit Queries</span> drop-down on the <span>Home</span> tab of Power BI Desktop's report view or from the <span>Home</span> tab of the <span>Query Editor</span>, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000221.png" class="calibre52" /></div>
<div class="mce-root2">Data source settings menu in Power BI Desktop</div>
<p class="calibre7">In this example, the user chose to save the Windows authentication to the ATLAS server rather than the specific database (<kbd class="calibre15">AdventureWorksDW</kbd>) on the server. The <span>Edit Permissions...</span> command button provides the ability to revise the authentication, such as from Windows to database or to enter a new username and password.</p>
<p class="calibre7">The <span>Edit...</span> command of the <span>Edit Permissions</span> menu, highlighted in the following image, prompts the same SQL Server credential menu that was used when originally configuring the method of authentication to the data source:</p>
<div class="cdpalignleft"><img src="images/000231.png" class="calibre53" /></div>
<div class="mce-root2">Edit credentials accessed via Edit Permissions</div>
<div class="packt_infobox">Many organizations set policies requiring users to regularly revise their usernames or passwords for certain data sources. Once these credentials have been updated, the user should utilize the <span>Edit Permissions</span> menu to ensure that the updated credentials will be used for M queries against this data source. Depending on the security policy of the data source, repeated failures to authenticate due to the outdated credentials saved in Power BI Desktop can cause the user's account to be temporarily locked out of the data source. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-105">
<div id="calibre_link-543" class="calibre2">
<div id="calibre_link-544" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Privacy levels</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In addition to the authentication method and user credentials for a data source, Power BI also stores a privacy level for each data source. <span>Privacy levels define the isolation level of data sources and thus restrict the integration of data sources in M queries. </span></p>
<p class="calibre7"><span>For example, in the absence of privacy levels, an M query that merges a CSV file with a publicly available online database could result in the data from the CSV file being passed to the online database to execute the operation. Although this default behavior is preferable from a query performance and resource utilization standpoint, the CSV file may contain sensitive information that should never leave the organization or even an individual user's machine. Applying privacy levels, such as <span>Private</span> for the CSV file and <span>Public</span> for the online database, isolates the two sources during query execution thus preventing unauthorized access to sensitive data.</span></p>
<p class="calibre7">The privacy level of a data source can be accessed from the same <span>Edit Permissions</span> dialog available in the <span>Data source settings</span> menu as shown in the following screenshot: </p>
<div class="cdpalignleft"><img src="images/000241.png" class="calibre54" /></div>
<div class="mce-root2">Privacy Level options per data source</div>
<p class="calibre7">The default <span>Privacy Level</span> for data sources is <span>None</span>. Therefore, dataset designers should revise privacy levels when first configuring data sources in Power BI Desktop based on the security policies for the given sources.</p>
<p class="calibre7">Four privacy levels are available: </p>
<ul class="calibre12">
<li class="calibre13"><span>Public</span>: A public data source is not isolated from other public sources, but data transfer from organizational and private data sources to public data sources is prevented. Public source data can be transferred to an organizational data source but not to a private data source. </li>
<li class="calibre13"><span>Organizational</span>: An organizational data source is isolated from all public data sources but is visible to other organizational data sources. For example, if a CSV file is marked as organizational, then a query that integrates this source with an organizational SQL Server database can transfer this data to the database server to execute the query. </li>
<li class="calibre13"><span>Private</span>: A private data source is completely isolated from all other data sources. Data from the private data source will not be transferred to any other data sources, and data from public sources will not be transferred to the private source.</li>
<li class="calibre13"><span>None</span>: Th<span>e privacy level</span><span> applied is inherited from a separate data source, or not applied if the separate parent source has not been configured. For example, the privacy level for an Excel workbook stored on a network directory could be set to <span>None</span>, yet the isolation level of <span>Private</span> would be enforced if a data source for the root directory of the file is set to <span>Private</span>. </span></li>
</ul>
<p class="calibre7">In this project, the Excel workbook containing the <kbd class="calibre15">Annual Sales Plan</kbd> is not merged with any queries accessing the SQL Server data warehouse and thus the privacy levels do not impact any queries. However, as with all other data security issues, such as <strong class="calibre6">row-level security</strong> (<strong class="calibre6">RLS</strong>) roles, the dataset designer should be mindful of privacy levels and apply the appropriate setting per data source.</p>
<div class="packt_infobox">Restrictive privacy levels that do not directly reject queries that can only be executed by violating the privacy (isolation) level of a data source may still prevent query folding from occurring and thus significantly reduce performance and reliability. For example, if an Excel workbook is isolated from a SQL Server data source due to a <span>Private</span> privacy level, then the local resources available to the M engine will be used to execute this operation rather than the SQL Server database engine. If the source data retrieved from SQL Server is large enough, the resource requirements to load this data and then execute this operation locally could cause the query to fail.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-106">
<div id="calibre_link-545" class="calibre2">
<div id="calibre_link-546" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI as a data source</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Over 59 distinct cloud services are available to Power BI, such as Google Analytics and Dynamics 365. Most importantly for this project, the Power BI online service is a fully supported data source enabling report development in Power BI Desktop against published datasets. As shown in the following screenshot, the datasets contained in Power BI App Workspaces in which the user is a member are exposed as data sources: </p>
<div class="cdpalignleft"><img src="images/000252.png" class="calibre55" /></div>
<div class="mce-root2">Power BI service data connector in Power BI Desktop</div>
<div class="packt_infobox">Connecting to a dataset published to Power BI establishes a Live connection for the given report, just like connections to SQL Server Analysis Services. With Live connections, all data retrieval and modeling capabilities are disabled and the queries associated with report visualizations are executed against the source database.</div>
<p class="calibre7">Leveraging published datasets as the sources for reports provides a natural isolation between the dataset design and report development processes. For example, a dataset designer can implement changes to a local Power BI Desktop file (PBIX), such as the creation of new DAX measures, and re-publish the dataset to make these measures available to report authors. Additionally, these connections provide report authors with visibility to the latest successful refresh of the dataset if the dataset is configured in import mode. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-107">
<div id="calibre_link-547" class="calibre2">
<div id="calibre_link-548" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI Desktop options</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Dataset designers should be aware of the global and current file settings available to manage the Power BI Desktop environment. Among other options, these settings include the implementation of the privacy levels described earlier, the DAX functions available to DirectQuery datasets, auto recovery, preview features, and whether M queries will be executed in parallel or not.</p>
<p class="calibre7">Power BI Desktop options can be accessed from the <span>File</span> menu as follows (<span>File</span> | <span>Options and settings</span> | <span>Options</span>):</p>
<div class="cdpalignleft"><img src="images/000262.png" class="calibre56" /></div>
<div class="mce-root2">Power BI Desktop options &ndash; GLOBAL Privacy</div>
<div class="packt_infobox">By setting the global <span>Privacy Levels</span> option to <span>Always combine data according to your Privacy Level settings for each source</span>, the current file privacy setting options are disabled. For all development and project activities, it's recommended to apply the privacy levels established per data source rather than each PBIX file's privacy settings.</div>
<p class="calibre7">It's outside the scope of this chapter to provide details of each Power BI Desktop option, but the following two sections recommend settings that are relevant to dataset design.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-108">
<div id="calibre_link-549" class="calibre2">
<div id="calibre_link-550" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Global options</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Global options only need to be set once and concern fundamental settings, including data source privacy levels and security:</p>
<ol class="calibre12">
<li class="chapter">Set the <span>DirectQuery</span> option to <span>Allow unrestricted measures in DirectQuery mode</span></li>
<li class="chapter">Configure the security options to require user approval for new native database queries and to use the ArcGIS Maps for Power BI</li>
<li class="chapter">Set the privacy option to always combine data according to privacy level settings for each source</li>
<li class="chapter">Configure the Power Query Editor options to display the <span>Query Settings</span> pane and the <span>Formula Bar</span></li>
<li class="chapter">Click the <span>OK</span> button in the bottom-right corner of the <span>Options</span> dialog to apply these settings:
<ul class="calibre17">
<li class="chapter">It may be necessary to restart Power BI Desktop for the revised settings to take effect</li>
</ul>
</li>
</ol>
<div class="packt_infobox">For DirectQuery datasets, not all DAX functions can be translated to a SQL statement for execution by the data source. When DAX measures use these non-optimized functions, especially against larger or unfiltered tables, the local execution can result in poor performance. However, when used appropriately, such as against pre-filtered or aggregated data, unrestricted measure expressions can add to the analytical value of the dataset without negatively impacting performance. See the official documentation for DAX-formula compatibility with DirectQuery models <a href="http://bit.ly/2oK8QXB" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2oK8QXB</a>.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-109">
<div id="calibre_link-551" class="calibre2">
<div id="calibre_link-552" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">CURRENT FILE options</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The <span>CURRENT FILE</span> options must be set per the Power BI Desktop file and are particularly important when creating a new dataset:</p>
<ol class="calibre12">
<li class="chapter">Disable the automatic column type and header detection for unstructured sources</li>
<li class="chapter">Disable all relationship options, including the import of relationships from data sources and the detection of new relationships after data is loaded</li>
<li class="chapter">Assuming a date dimension table is available to the dataset, disable the <span>Auto Date/Time</span> option</li>
<li class="chapter">For larger import datasets with many queries, disable the parallel loading of tables</li>
<li class="chapter">Click the <span>OK</span> button in the bottom-right corner of the <span>Options</span> dialog to apply these settings:</li>
</ol>
<div class="cdpalignleft"><img src="images/000272.png" class="calibre57" /></div>
<div class="mce-root2">Power BI Desktop Options &ndash; CURRENT FILE Data Load </div>
<div class="packt_infobox">The dataset designer should explicitly apply the appropriate data types within the M queries, accessing any unstructured sources, such as Excel files. Likewise, the dataset designer should have access to data source documentation or subject matter experts regarding table relationships. Furthermore, the columns and hierarchies of the dataset's date dimension table can be used instead of the automatic internal date tables associated with the <span>Auto Date/Time</span> option.</div>
<p class="calibre7">Large Power BI datasets with multiple fact tables can contain many queries which, if executed in parallel, can overwhelm the resources of the source system resulting in a data refresh failure. Disabling the parallel loading of tables, therefore, improves the availability of the dataset and reduces the impact of the refresh process on the source server.</p>
<div class="packt_tip pcalibre7 pcalibre6">When Power BI Desktop is being used for report development rather than dataset development, the <span>Query reduction</span> in <span>CURRENT FILE</span> options can benefit the user experience. These options, including the disabling of cross-highlighting by default and the use of an <span>Apply</span> button for slicer and filter selections, result in fewer report queries being generated. Particularly for large and DirectQuery datasets, these options can contribute to more efficient and responsive self-service experiences with reports.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-110">
<div id="calibre_link-553" class="calibre2">
<div id="calibre_link-554" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">SQL views</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As described in the <em class="calibre16">Dataset planning</em> section of <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <span><em class="calibre16">Planning Power BI Projects</em>, </span>a set of SQL views should be created within the data source and these objects, rather than the database tables, should be accessed by the Power BI dataset. <span>Each fact and dimension table required by the Power BI dataset should have its own SQL view and its own M query within the dataset that references this view. The SQL views should preferably be assigned to a dedicated database schema and identify the dimension or fact table represented as shown in the following screenshot:</span></p>
<div class="cdpalignleft"><img src="images/000282.png" class="calibre58" /></div>
<div class="mce-root2">Views assigned to BI schema in SQL Server </div>
<div class="packt_infobox">A common practice is to create a database schema specific to the given dataset being created or to the specific set of reports and dashboards required for a project. However, as suggested in the <em class="calibre16">Data Warehouse Bus Matrix</em> section of <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <span><em class="calibre16">Planning Power BI Projects</em> </span>there shouldn't be multiple versions of dimensions and facts across separate datasets&mdash;version control is a top long-term deliverable for the BI team. Therefore, a single database schema with a generic name (BI in this example) is recommended. </div>
<p class="calibre7">The existence of SQL view objects declares a dependency to source tables that are visible to the data source owner. In the event that a change to the source tables of a view is needed or planned, the SQL view can be adjusted, thus avoiding any impact to the Power BI dataset, such as a refresh failure or an unexpected change in the data retrieved. As shown in the following SQL Server dialog, a view (<span>BI.vDim_Promotion</span>) is identified as a dependent object of the <span>DimPromotion</span> dimension table:</p>
<div class="cdpalignleft"><img src="images/000292.png" class="calibre59" /></div>
<div class="mce-root2">SQL Server Object Dependencies</div>
<p class="calibre7">For mature data warehouse sources, the simple query logic contained in each SQL view is sufficient to support the needs of the dataset. However, with Power BI (and SSAS Tabular 2017), BI teams can also leverage M functions to further enhance the value of this data.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-111">
<div id="calibre_link-555" class="calibre2">
<div id="calibre_link-556" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">SQL views versus M queries</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A common question in Power BI projects specific to data retrieval is whether to implement any remaining transformation logic outside the data source in SQL views, within the M queries of the dataset, or both. For <strong class="calibre6">SQL Server Analysis Services</strong> (<strong class="calibre6">SSAS</strong>) projects prior to SQL Server 2017, the layer of SQL views was the only option to implement any transformations and some BI teams may prefer this more familiar language and approach. In other scenarios, however, the SQL views may not be accessible or the dataset designer may have a particular strength in M query development relative to SQL. Additionally, given the expanded role of M queries in the Microsoft ecosystem, such as<span> the</span> Common Data Service, as well as support for M query development in Visual Studio, other BI teams may see long-term value in M queries for lightweight data transformation needs.</p>
<p class="calibre7">Ideally, an organization's data warehouse already includes necessary data transformations and thus minimal transformation is required within SQL or M. In this scenario, the M query for the table can simply reference the SQL view of the table, which itself contains minimal to no transformations, and inherit all required columns and logic. As a secondary alternative, the SQL views can be modified to efficiently implement the required logic thus isolating this code to the data source. As a third design option, M queries can implement the required logic and, via query folding, generate a SQL statement for execution by the source. Yet another design option, though less than ideal, is to implement part of the required logic in the SQL view and the remaining logic in the M query.</p>
<p class="calibre7"><span>The guiding principle of the data retrieval process for the import mode dataset is to leverage the resources and architecture of the data source. The M queries of the Power BI dataset, which access the layer of SQL views in the source system, ultimately represent the fact and dimension tables of the data model exposed for report development and ad hoc analysis. This model should address all data transformation needs, thus avoiding the need for DAX-calculated columns and DAX-calculated tables.</span></p>
<p class="calibre7"><span>Additionally, the data model in Power BI (or Analysis Services) should remain aligned with the architecture and definitions of the data warehouse. If a gap is created by embedding data transformation logic (for example, new columns) into the Power BI dataset that is not present in the data warehouse, plans should be made to eventually migrate this logic to the data warehouse to restore alignment.</span></p>
<p class="calibre7"><span>In other words, a user or tool should be able to return the same results of a Power BI report based on the Power BI dataset by issuing a SQL query against the source data warehouse. This is particularly essential in environments with other BI and reporting tools built on top of the data warehouse.</span></p>
<div class="packt_tip pcalibre7 pcalibre6">If it's necessary to use both SQL views and M functions to implement the data transformation logic, then both queries should be documented and, when possible, this logic should be consolidated closer to the data source.</div>
<p class="calibre7">As shown in the <em class="calibre16">Dataset Planning Architecture</em> diagram from <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>, there are six layers in which data logic can be implemented:</p>
<div class="cdpalignleft"><img src="images/000302.png" class="calibre60" /></div>
<div class="mce-root2">Dataset planning architecture</div>
<p class="calibre7">Data retrieval processes should strive to leverage the resources of data sources and avoid or minimize the use of local resources. For example, a derived column implemented within either a <strong class="calibre6">SQL Views</strong> (layer 3) or within an <strong class="calibre6">M Queries</strong> (layer 4) which folds its logic to the data source is preferable to a column created by a <strong class="calibre6">DAX Calculated Tables and Columns</strong> (layer 5). Likewise, if data transformation logic is included within M queries (for example, joins, group by), it's important to ensure these operations are being executed by the source system as described in the <em class="calibre16">Query folding</em> section later in this chapter. These considerations are especially critical for large tables given the relatively limited resources (for example, CPU, Memory) of a Power BI dataset or the On-premises data gateway if applicable.</p>
<p class="calibre7">Additionally, the dimension and fact tables of the Power BI dataset and the DAX measures created should represent a single version for the organization&mdash;not a customization for a specific team or project sponsor. Therefore, although the combination of SQL views and M queries provides significant flexibility for implementing data transformations and logic, over time this logic should be incorporated into corporate data warehouses and <strong class="calibre6">extract-transform-load</strong> (<strong class="calibre6">ETL</strong>) processes so that all business intelligence tools have access to a common data source.</p>
<div class="packt_tip pcalibre7 pcalibre6">Incrementally migrate transformation logic closer to the corporate data warehouse over time. For example, a custom column that's originally created within an M query via the <kbd class="calibre43">Table.AddColumn()</kbd> function and a conditional expression (<span><kbd class="calibre43">if...then</kbd>), could first be built into the SQL view supporting the table, thus eliminating the need for the M query logic.<br class="calibre3" />
<br class="calibre3" />
In a second and final stage, the column could be added to the dimension or fact table of the corporate data warehouse and the conditional expression could be implemented within a standard data warehouse ETL package or stored procedure. This final migration stage would eliminate the need for the SQL view logic, improve the durability and performance of the data retrieval process, and in some scenarios also increase the feasibility of a DirectQuery dataset.</span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-112">
<div id="calibre_link-557" class="calibre2">
<div id="calibre_link-558" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">SQL view examples</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Each SQL view should only retrieve the columns required for the dimension or fact table. If necessary, the views should apply business-friendly, unambiguous column aliases with spaces and proper casing. Dimension table views should include the surrogate key used for the relationship-to-fact tables, as well as the business or natural key column if historical tracking is maintained as will be shown by the customer dimension example later in this section.</p>
<p class="calibre7">Fact table views should include the foreign key columns for the relationships to the dimension tables, the fact columns needed for measures, and a <kbd class="calibre15">WHERE</kbd> clause to only retrieve the required rows, such as the prior three years. Given the size of many data warehouse fact tables and the differences in how this data can best be accessed per the Query design per dataset mode section earlier, dataset designers should ensure that the corresponding SQL views are efficient and appropriate for the dataset.</p>
<p class="calibre7">A robust date dimension table is critical for all datasets and thus its SQL view and/or M query has a few unique requirements. For example, it should include integer columns that can define the default sort order of weekdays as well as sequentially increasing integer columns to support date intelligence expressions. The date table should also include a natural hierarchy of columns (that is, <kbd class="calibre15">Year</kbd>, <kbd class="calibre15">Year-Qtr</kbd>, <kbd class="calibre15">Year-Mo</kbd>, <kbd class="calibre15">Year-Wk</kbd>) for both the Gregorian (standard) calendar as well as any custom fiscal calendar. These columns enable simple drill-up/down experiences in Power BI and report visualizations at different date granularities that span multiple time periods, such as the prior two years by week.</p>
<div class="packt_tip pcalibre7 pcalibre6">Given the static nature of the <kbd class="calibre43">Date</kbd> (and <kbd class="calibre43">Time</kbd>) dimension tables, their minimal size, and their universal application in reports and dashboards, it's usually a good use of IT/BI resources to enhance the source date table in the data warehouse. This could include any derived columns currently supported via SQL views or M queries as well as columns uniquely valuable to the organization, such as company holidays. Additionally, any dynamic columns, such as <kbd class="calibre43">Calendar Month Status</kbd> (<kbd class="calibre43">Current Month</kbd>, <kbd class="calibre43">Prior Month</kbd>) can be computed within a SQL-stored procedure or an ETL package and this processing can be scheduled to update the source date table daily.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-113">
<div id="calibre_link-559" class="calibre2">
<div id="calibre_link-560" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Date dimension view</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The following sample from a date dimension SQL view includes several columns that will be needed by the Power BI dataset:</p>
<div class="cdpalignleft"><img src="images/000312.png" class="calibre61" /></div>
<div class="mce-root2">Sample date dimension columns</div>
<p class="calibre7">The <kbd class="calibre15">Calendar Year Month Number</kbd> column can be used to define the default sort order of the <kbd class="calibre15">Calendar Yr-Mo</kbd> column and can also support date intelligence DAX measure expressions that select a specific time, frame such as the trailing four months. Likewise, a prior calendar year date (or prior fiscal year date) column can be referenced in date intelligence measure expressions. The <kbd class="calibre15">Calendar Month Status</kbd> and <kbd class="calibre15">Calendar Year Status</kbd> columns make it easy for report authors to define common filter conditions, such as the current and prior month or the current year excluding the current month. Additionally, since the values for these columns are updated either by a daily job in the source database or computed within the SQL view for the date dimension, the filter conditions for these columns only need to be set once.</p>
<div class="packt_infobox">Power BI Desktop supports relative date filtering conditions for date columns by default. Similar to the <kbd class="calibre43">Calendar Month</kbd> and <kbd class="calibre43">Year Status</kbd> columns identified earlier, this feature is also useful in defining many common report filter conditions, such as the last 20 days. However, the filter conditions available in relative date filtering are not comprehensive and typical conditions, such as all of last year and all dates from the current year, can only be defined via the status columns. Additional details regarding relative date filtering are available in <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em><em class="calibre16">.</em></div>
<p class="calibre7">The following T-SQL from the date dimension view (<kbd class="calibre15">BI.vDim_Date</kbd>) leverages the <kbd class="calibre15">CURRENT_TIMESTAMP()</kbd> function to compute two dynamic columns (<kbd class="calibre15">Calendar Year Status</kbd>, <kbd class="calibre15">Calendar Month Status</kbd>) and the <kbd class="calibre15">DATEPART()</kbd> function to retrieve the date rows from January 1st of three years ago through the current date:</p>
<pre class="calibre19">SELECT<br class="calibre3" />  D.Date<br class="calibre3" />, <br class="calibre3" />  CASE<br class="calibre3" />    WHEN YEAR(D.[Date]) = YEAR(CURRENT_TIMESTAMP) THEN 'Current Calendar Year'<br class="calibre3" />    WHEN YEAR(D.[Date]) = YEAR(CURRENT_TIMESTAMP)-1 THEN 'Prior Calendar Year'<br class="calibre3" />    WHEN YEAR(D.[Date]) = YEAR(CURRENT_TIMESTAMP)-2 THEN '2 Yrs Prior Calendar Year'<br class="calibre3" />    WHEN YEAR(D.[Date]) = YEAR(CURRENT_TIMESTAMP)-3 THEN '3 Yrs Prior Calendar Year'<br class="calibre3" />    ELSE 'Other Calendar Year' <br class="calibre3" />  END AS [Calendar Year Status]<br class="calibre3" />,<br class="calibre3" />  CASE<br class="calibre3" />    WHEN YEAR(D.[Date]) = YEAR(CURRENT_TIMESTAMP) AND MONTH(D.Date) = MONTH(CURRENT_TIMESTAMP) THEN 'Current Calendar Month'<br class="calibre3" />    WHEN YEAR(D.[Date]) = YEAR(DATEADD(MONTH,-1,CAST(CURRENT_TIMESTAMP AS date))) AND <br class="calibre3" />    MONTH(D.[Date]) = MONTH(DATEADD(MONTH,-1,CAST(CURRENT_TIMESTAMP AS date))) THEN 'Prior Calendar Month'<br class="calibre3" />    WHEN YEAR(D.[Date]) = YEAR(DATEADD(MONTH,-2,CAST(CURRENT_TIMESTAMP AS date))) AND <br class="calibre3" />    MONTH(D.[Date]) = MONTH(DATEADD(MONTH,-2,CAST(CURRENT_TIMESTAMP AS date))) THEN '2 Mo Prior Calendar Month'<br class="calibre3" />    WHEN YEAR(D.[Date]) = YEAR(DATEADD(MONTH,-3,CAST(CURRENT_TIMESTAMP AS date))) AND <br class="calibre3" />    MONTH(D.[Date]) = MONTH(DATEADD(MONTH,-3,CAST(CURRENT_TIMESTAMP AS date))) THEN '3 Mo Prior Calendar Month'<br class="calibre3" />    ELSE 'Other Calendar Month'<br class="calibre3" />  END AS [Calendar Month Status]<br class="calibre3" />FROM<br class="calibre3" />DBO.DimFinDate as D<br class="calibre3" />WHERE<br class="calibre3" />D.[Calendar Year] &gt;= DATEPART(YEAR,CURRENT_TIMESTAMP)-3 AND D.Date &lt;= CAST(CURRENT_TIMESTAMP as date);   </pre>
<p class="calibre7">Provided that the scheduled refresh of the import mode dataset is successful, reports with filter conditions defined against the dynamic date columns, such as <kbd class="calibre15">Calendar Month Status</kbd>, will be updated automatically.</p>
<div class="packt_tip pcalibre7 pcalibre6">If the date columns in the SQL Server data source are only available as integers in <kbd class="calibre43">YYYYMMDD</kbd> format, the following T-SQL expression can be used to produce a date data type within the SQL view:<br class="calibre3" />
<br class="calibre3" />
<kbd class="calibre43">CONVERT(date,CAST(F.OrderDateKey AS nvarchar(8)),112)</kbd><br class="calibre3" />
<br class="calibre3" />
However, the <span>Mark as Date Table</span> feature can be used to leverage existing <kbd class="calibre43">YYYYMMDD</kbd> integer columns for date relationships, as described in the following section.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-114">
<div id="calibre_link-561" class="calibre2">
<div id="calibre_link-562" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Mark As Date Table</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Most data warehouses store date columns as integers for query performance reasons. For example, an <kbd class="calibre15">Order Date Key</kbd> column on a fact table would store the <kbd class="calibre15">20180225</kbd> (<kbd class="calibre15">YYYYMMDD</kbd>) value as an integer data type to represent February 25th, 2018. Likewise, an existing date dimension table in the data warehouse usually also contains a <kbd class="calibre15">YYYYMMDD</kbd> date key column to support the join to these fact tables in SQL queries. If this date dimension table also contains a date column and meets essential data integrity criteria, the <span>Mark as Date Table</span> feature in Power BI Desktop can be used to leverage existing integer/whole number columns representing dates for relationships.</p>
<p class="calibre7">In the following screenshot, the <span>Date</span> table has been selected in the <span>Fields</span> list in Power BI Desktop and the <span>Mark as Date Table</span> icon has been selected from the modeling tab of the ribbon:</p>
<div class="cdpalignleft"><img src="images/000322.png" class="calibre62" /></div>
<div class="mce-root2">Mark as Date Table</div>
<p class="calibre7">As shown in the preceding screenshot, the column named <span>Date</span>, which is stored as a <span>Date</span> data type, has been specified as the <span>Date column</span> to use by the <span>Mark as Date Table</span> feature. Power BI validates that this column meets the required criteria to function properly.</p>
<p class="calibre7">In addition to relationships based on <kbd class="calibre15">YYYYMMDD</kbd> columns, this feature enables DAX Time Intelligence functions, such as<strong class="calibre6"><span> </span><kbd class="calibre15">SAMEPERIODLASTYEAR()</kbd></strong>,<span> </span>to work properly. Power BI will use the date column specified by the model author in the <span>Mark as Date Table</span> setting in executing these expressions.</p>
<p class="calibre7">To utilize the <span>Mark as Date Table</span> feature, the <span>Date column</span> (<span>Date</span> data type) specified for the <span>Mark as Date Table</span> feature must meet the following criteria:</p>
<ul class="calibre12">
<li class="calibre13">No null values.</li>
<li class="calibre13">No duplicate values.</li>
<li class="calibre13">Contiguous date values:
<ul class="calibre17">
<li class="calibre13">There must be a single date value for each date from the earliest date to the latest date. In other words, there can't be any gaps or missing dates.</li>
</ul>
</li>
<li class="calibre13">If a date/time column is used, the timestamp must be the same for each value of the column. </li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-115">
<div id="calibre_link-563" class="calibre2">
<div id="calibre_link-564" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Product Dimension view</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As shown in the database diagram schema referenced in <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em><em class="calibre16">, </em>it's recommended to provide a consolidated or de-normalized dimension for datasets. In the following view (<kbd class="calibre15">BI.vDim_Product</kbd>), three product dimension tables are joined and a logical column, <span><kbd class="calibre15">Product Category Group</kbd>,</span> is created to support a common reporting and analysis need:</p>
<pre class="calibre19">SELECT<br class="calibre3" />  P.ProductKey as 'Product Key'<br class="calibre3" />, P.ProductAlternateKey as 'Product Alternate Key'<br class="calibre3" />, P.EnglishProductName AS 'Product Name'<br class="calibre3" />, ISNULL(S.EnglishProductSubcategoryName, 'Undefined') 'Product Subcategory'<br class="calibre3" />, ISNULL(C.EnglishProductCategoryName, 'Undefined') AS 'Product Category'<br class="calibre3" />, CASE <br class="calibre3" />  WHEN C.EnglishProductCategoryName = 'Bikes' THEN 'Bikes' <br class="calibre3" />  WHEN C.EnglishProductCategoryName IS NULL THEN 'Undefined'<br class="calibre3" />  ELSE 'Non-Bikes'<br class="calibre3" />  END AS 'Product Category Group'<br class="calibre3" />FROM<br class="calibre3" />DBO.DimProduct AS P<br class="calibre3" />LEFT JOIN DBO.DimProductSubcategory AS S <br class="calibre3" />ON P.ProductSubcategoryKey = S.ProductSubcategoryKey<br class="calibre3" />LEFT JOIN DBO.DimProductCategory AS C<br class="calibre3" />ON S.ProductCategoryKey = C.ProductCategoryKey</pre>
<p class="calibre7">In this example, it's necessary to use <kbd class="calibre15">LEFT JOIN</kbd> since the product dimension table in the data warehouse allows for null values in the foreign key column (<kbd class="calibre15">ProductSubcategoryKey</kbd>). Retrieving the product rows that haven't yet been assigned a subcategory or category is necessary for certain reports that highlight future products. For these products, an <kbd class="calibre15">ISNULL()</kbd> function is used to replace null values with an undefined value. Additionally, similar to the <span>Date</span> view, a <kbd class="calibre15">CASE</kbd> expression is used to generate a column that groups the product rows into two categories (<kbd class="calibre15">Bikes</kbd> and <kbd class="calibre15">Non-Bikes</kbd>). </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-116">
<div id="calibre_link-565" class="calibre2">
<div id="calibre_link-566" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Slowly-changing dimensions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The product and customer dimension views retrieve both the surrogate key column used for relationships in the dataset as well as the business key that uniquely identifies the given product or customer, respectively. For example, the same product (<kbd class="calibre15">FR-M94B-38</kbd>) is represented by three product dimension rows (<kbd class="calibre15">304</kbd>, <kbd class="calibre15">305</kbd>, <kbd class="calibre15">306</kbd>) due to changes in its list price over time:</p>
<div class="cdpalignleft"><img src="images/000332.png" class="calibre63" /></div>
<div class="mce-root2">Slowly-changing dimension processing applied to Product Dimension</div>
<p class="calibre7">As discussed in <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>, the historical tracking of core business entities, such as customers and products, via slowly-changing dimension ETL processes is an essential requirement for data warehouses. The ability to insert and update rows based off of changes in specific columns is well outside the scope of SQL views and M query transformations.</p>
<div class="packt_infobox">DAX measures will reference the business key or alternate key column of these dimension tables to compute the discount count of these entities. For dimensions without slowly-changing dimension processing applied, the foreign key column of the related fact table can be used to compute the distinct count of dimension values associated with the given fact or event. Greater detail on these measures is included in <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em>.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-117">
<div id="calibre_link-567" class="calibre2">
<div id="calibre_link-568" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">M queries</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">With the SQL views created, the data sources configured, and the Power BI Desktop environment options applied, the dataset designer can finally develop the data retrieval queries and parameters of the dataset.</p>
<p class="calibre7">Within the Power Query Editor of Power BI Desktop, group folders can be used to organize M queries into common categories such as <span>Data Source Parameters</span>, <span>Staging Queries</span>, <span>Fact table Queries</span>, <span>Dimension Table Queries</span>, and <span>Bridge Table Queries</span> as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000342.png" class="calibre64" /></div>
<div class="mce-root2">Power Query Editor in Power BI Desktop with group folders</div>
<p class="calibre7">The parameters and queries displayed with a gray font are included in the refresh process of the dataset but not loaded to the data modeling layer. For example, the <kbd class="calibre15">AdWorksSQLServer</kbd> query displayed in the preceding image merely exposes the objects of the SQL Server database via the <kbd class="calibre15">Sql.Database()</kbd> M function for other queries to reference. This query, along with the data source parameters, all have a gray font and are used to streamline the data retrieval process such that a single change can be implemented to update many dependent queries. </p>
<p class="calibre7"><span>Right-click a query or parameter in the queries list to expose the </span><span>Enable load</span><span> and </span><span>Include in report refresh</span><span> properties as shown in the following screenshot:</span></p>
<div class="cdpalignleft"><img src="images/000352.png" class="calibre65" /></div>
<div class="mce-root2">Enable load and Include in report refresh</div>
<p class="calibre7"><span>For many datasets, the only queries that should be loaded to the data model are the dimension and fact table queries and certain parameter table queries. For this dataset, three bridge tables will also be loaded and included in the report refresh to support the analysis of</span> <kbd class="calibre15">Internet Sales</kbd> <span>and</span> <kbd class="calibre15">Reseller Sales</kbd> <span>data versus the annual</span> <kbd class="calibre15">Sales and Margin Plan</kbd><span>.</span></p>
<div class="packt_infobox">The parameter table queries, as described in the following <span>Parameters</span> table section, do not contain data and are merely used as placeholders for related DAX measures in the Power BI <span>Fields</span> list, similar to display folders. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-118">
<div id="calibre_link-569" class="calibre2">
<div id="calibre_link-570" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Data Source Parameters</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Parameters are special M queries that do not access an external data source and only return a scalar or individual value, such as a specific date, number, or string of text characters. The primary use case for parameters is to centrally define a common and important value, such as a server name or the name of a database, and then reference that parameter value in multiple other queries. Like global variables, parameters improve the manageability of large datasets as the dataset designer can simply revise a single parameter's value rather than manually modify many queries individually. </p>
<p class="calibre7">Query parameters can be created and modified via the <span>Manage Parameters</span> dialog available on the <span>Home</span> tab of the Power Query Editor. The following image of <span>Manage Parameters</span> identifies the six parameters defined for the SQL Server database and the Microsoft Excel workbook:</p>
<div class="cdpalignleft"><img src="images/000362.png" class="calibre66" /></div>
<div class="mce-root2">Manage Parameters in Power Query Editor</div>
<p class="calibre7">For this dataset, development and production environment database parameters (for example, <span>ProdServer</span> and <span>ProdD</span><span>B</span>) are configured with a list of valid possible values to make it easy and error-free when switching data sources. For the same purpose, both the name of the Excel workbook containing the annual <kbd class="calibre15">Sales and Margin Plan</kbd> and its file directory are also stored as parameters.</p>
<p class="calibre7">The <span>Suggested Values</span><em class="calibre16"> </em>dropdown provides the option to allow any value to be entered manually, for a value to be selected from a hardcoded list of valid values, and for a query that returns a list (a value type in M, such as a table and a record), to dynamically populate a list of valid parameter values. Given the small number of valid server names in this example and the infrequency of changing production and development server names, the three suggested values have been entered manually.</p>
<div class="packt_infobox">Parameters are often used with <strong class="calibre6">Power BI Template</strong> (.<strong class="calibre6">PBIT</strong>) files to enable business users to customize their own reports with pre-defined and pre-filtered queries and measures. For example, the user would open a template and select a specific department, and this selection would be used to filter the M queries of the dataset.<br class="calibre3" />
<br class="calibre3" />
Additionally, parameters can be useful in defining the values used in the filtering conditions of queries, such as the starting and ending dates and in the calculation logic used to create custom columns in M queries. Parameters are usually only used by other queries and thus not loaded (gray font) but they can be loaded to the data model as individual tables with a single column and a single row. If loaded, the parameters can be accessed by DAX expressions just like other tables in the model. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-119">
<div id="calibre_link-571" class="calibre2">
<div id="calibre_link-572" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Staging Queries</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>With the data source parameters configured, staging queries can be used to expose the data sources to the dimension and fact table queries of the dataset. For example, the</span> <kbd class="calibre15">AdWorksSQLServer</kbd> <span>staging query merely passes the production server and production database parameter values into the <kbd class="calibre15">Sql.Database()</kbd> M function as shown in the earlier image of the Power Query Editor interface. This query results in a table containing the schemas and objects stored in the database, including the SQL views supporting the fact and dimension tables. </span></p>
<p class="calibre7"><span>The <span>SalesPlanFilePath</span> staging query used for the <kbd class="calibre15">Annual Sales Plan</kbd> Excel workbook source is very similar in that it merely references the file name and file directory parameters to form a complete file path, as shown in the following screenshot:</span></p>
<div class="cdpalignleft"><img src="images/000372.png" class="calibre67" /></div>
<div class="mce-root2">Annual Sales Plan Staging Query&mdash;Excel Workbook</div>
<p class="calibre7">The third and final staging query, <kbd class="calibre15">CurrentDateQry</kbd>, simply computes the current date as a date value:</p>
<div class="cdpalignleft"><img src="images/000381.png" class="calibre68" /></div>
<div class="mce-root2">Current Date Staging Query </div>
<p class="calibre7">Just like parameters, the results of staging queries, such as <kbd class="calibre15">CurrentDateQry</kbd>, can be referenced by other queries, such as the filtering condition of a fact table. In the following sample M query, the <kbd class="calibre15">Table.SelectRows()</kbd> function is used in the <kbd class="calibre15">Internet Sales</kbd> query to only retrieve rows where the <kbd class="calibre15">Order Date</kbd> column is less than or equal to the value of the <kbd class="calibre15">CurrentDateQry</kbd> (10/16/2017):</p>
<pre class="calibre19">let<br class="calibre3" />    Source = AdWorksSQLServer,<br class="calibre3" />    ISales = Source{[Schema = "BI", Item = "vFact_InternetSales"]}[Data],<br class="calibre3" />    <strong class="calibre6">CurrentDateFilter = Table.SelectRows(ISales, each   [Order Date] &lt;= <br class="calibre3" />    CurrentDateQry)</strong><br class="calibre3" />in<br class="calibre3" />    CurrentDateFilter</pre>
<p class="calibre7">In this simple example, the same filter condition can easily be built into the SQL view (<kbd class="calibre15">vFact_InternetSales</kbd>), supporting the fact table and this approach would generally be preferable. However, it's important to note that the M engine is able to convert the final query variable (<kbd class="calibre15">CurrentDateFilter</kbd>), including the reference to the staging query (<kbd class="calibre15">CurrentDateQry</kbd>), into a single SQL statement via Query Folding. In some data transformation scenarios, particularly with rapid iterations and agile project lifecycles, it can be preferable to at least temporarily utilize efficient M queries within the Power BI dataset (or Analysis Services model) rather than implement modifications to the data source (for example, data warehouse tables or views). </p>
<div class="packt_tip pcalibre7 pcalibre6">As you will see in the <em class="calibre16">Query folding</em> section later in this chapter, if it's necessary to use M to implement query transformations or logic, the dataset designer should be vigilant in ensuring this logic is folded into a SQL statement and thus executed by the source system. This is particularly important for large queries retrieving millions of rows, given the limited resources of the on-premises gateway server (if applicable) or any provisioned capacities (hardware) with Power BI Premium.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-120">
<div id="calibre_link-573" class="calibre2">
<div id="calibre_link-574" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">DirectQuery staging</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The database staging query for a DirectQuery dataset is slightly different than an import mode dataset. For this query, an additional variable is added to the let expression, as shown in the following example:</p>
<pre class="calibre19">let<br class="calibre3" />    Source = Sql.Database(ProdServer, ProdDB),<br class="calibre3" />    DummyVariable = null<br class="calibre3" />in<br class="calibre3" />    Source</pre>
<p class="calibre7">The additional variable (<kbd class="calibre15">DummyVariable</kbd>) is ignored by the query and the same <kbd class="calibre15">Sql.Database()</kbd> function that references the server and database parameters for the import mode dataset can also be used for the DirectQuery dataset.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-0">
<div id="calibre_link-575" class="calibre2">
<div id="calibre_link-576" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Fact and dimension queries</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For larger datasets with multiple fact tables, most M queries will access a single SQL view, apply minimal to no transformations, and then expose the results of this query to the data model as a dimension or fact table. For import mode datasets, the M query is executed upon a scheduled refresh and the query results are loaded into a compressed, columnar format. For DirectQuery mode datasets, the M queries with the <span>Enable load</span> property<em class="calibre16"> </em>set only define the SQL statement representing the given dimension or fact tables. The DirectQuery data source will utilize these SQL statements to create SQL queries necessary to resolve report queries, such as joining the <kbd class="calibre15">Internet Sales</kbd> query with the <kbd class="calibre15">Product</kbd> query.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-12">
<div id="calibre_link-577" class="calibre2">
<div id="calibre_link-578" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Source Reference Only</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The following M query references the SQL view (<kbd class="calibre15">BI.vDim_Customer</kbd>) via the staging query (<kbd class="calibre15">AdWorksSQLServer</kbd>) and does not apply any further transformations:</p>
<div class="cdpalignleft"><img src="images/000391.png" class="calibre69" /></div>
<div class="mce-root2">Customer Dimension Query</div>
<p class="calibre7">The customer query accesses the unique M record associated with the schema (BI) and SQL view (<kbd class="calibre15">vDim_Customer</kbd>) from the table produced by the staging query (<kbd class="calibre15">AdWorksSQLServer</kbd>). This record contains all field names of the staging table query including the <kbd class="calibre15">Data</kbd> field that stores the SQL view. Referencing the <kbd class="calibre15">Data</kbd> field of the M record retrieves the results of the SQL view. </p>
<p class="calibre7">Since no M transformations are applied, the M query reflects the source SQL view and changes to the SQL view such that the removal of a column will be automatically carried over to the Power BI dataset upon the next refresh. The one-to-one relationship between the SQL view and the M query is one of the primary reasons to favor implementing, or migrating, data transformation logic within the data warehouse source rather than in the Power BI dataset.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-26">
<div id="calibre_link-579" class="calibre2">
<div id="calibre_link-580" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">M query summary</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In summary, the Power Query Editor interface in Power BI Desktop should contain the following types or groups of queries:</p>
<ul class="calibre12">
<li class="calibre13"><span>Parameters</span>:<br class="calibre3" />
<ul class="calibre17">
<li class="calibre13">These will be used to store individual values essential to the data retrieval that could change, such as the names of servers, databases, and file paths.</li>
</ul>
</li>
<li class="calibre13"><span>Staging Queries</span>:
<ul class="calibre17">
<li class="calibre13">These queries will not be loaded to the data model but will contain logic used by one or many other queries.</li>
<li class="calibre13">For example, a staging query will connect to a specific SQL Server database based on two parameters (server and database) and this staging query will be used by the fact and dimension table queries. </li>
</ul>
</li>
<li class="calibre13"><span>Fact and Dimension Queries</span>:
<ul class="calibre17">
<li class="calibre13">These queries will define the tables exposed to the data model layer and optionally the reporting interface. </li>
<li class="calibre13">It's essential that these queries contain columns supporting the relationships of the data model as well as all columns needed for calculations/aggregations, grouping, and filtering in reports. </li>
</ul>
</li>
<li class="calibre13"><span>Parameter Tables</span> <strong class="calibre6">(optional)</strong>:
<ul class="calibre17">
<li class="calibre13">Additional tables can be loaded to the data model that don't contain relationships but are used for other purposes, such as the user interface as a placeholder for hidden logic. </li>
</ul>
</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-37">
<div id="calibre_link-581" class="calibre2">
<div id="calibre_link-582" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Excel workbook &ndash; Annual Sales Plan</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For the import mode dataset, the annual <kbd class="calibre15">Sales and Margin Plan</kbd> data is retrieved from a table object within an Excel workbook. In the following fact table query (<kbd class="calibre15">Sales and Margin Plan</kbd>), the <kbd class="calibre15">SalesPlanFilePath staging query</kbd> is referenced within an <kbd class="calibre15">Excel.Workbook()</kbd> data access function:</p>
<div class="cdpalignleft"><img src="images/000401.png" class="calibre70" /></div>
<div class="mce-root2">Sales and Margin Plan query from Excel workbook source</div>
<p class="calibre7">As you saw in the Power BI Desktop settings section earlier in this chapter, the automatic data type detection option for unstructured sources should be disabled. It's, therefore, necessary to explicitly define the appropriate data type for each column of the Excel table via the <kbd class="calibre15">Table.TransformColumnTypes()</kbd> function. The <kbd class="calibre15">Int64.Type</kbd>, <kbd class="calibre15">Currency.Type</kbd>, and <kbd class="calibre15">type number</kbd> arguments used in this function correspond to the <kbd class="calibre15">Whole Number</kbd>, <kbd class="calibre15">Fixed Decimal Number</kbd>, and <kbd class="calibre15">Decimal Number</kbd> data types, respectively.</p>
<p class="calibre7">For a DirectQuery dataset, the <kbd class="calibre15">Sales and Margin Plan</kbd> data would be retrieved from a SQL view within the same database as the other fact and dimension tables as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000411.png" class="calibre71" /></div>
<div class="mce-root2">Sales and Margin Plan M query for DirectQuery dataset</div>
<p class="calibre7">The cost and time required to integrate the <kbd class="calibre15">Sales and Margin Plan</kbd> data into the data warehouse database are one of the reasons that the default import mode dataset was chosen for this project. The limitation of a single database within a single data source is currently one of the primary limiting factors for DirectQuery datasets. In the following screenshot, an error is thrown when trying to utilize two databases from the same database server for a DirectQuery dataset:</p>
<div class="mce-root2"><img src="images/000420.png" width="414" height="185" class="calibre72" /> </div>
<div class="mce-root2">DirectQuery limitation &ndash; Single Database</div>
<p class="calibre7">DirectQuery is a strategic priority for Microsoft and thus current limitations may be eliminated in the near future.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-49">
<div id="calibre_link-583" class="calibre2">
<div id="calibre_link-584" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Data types</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>For structured data sources, such as SQL Server, the source column data types will determine the data types applied in Power BI. For example, a money data type in SQL Server will result in a <kbd class="calibre15">Fixed Decimal Number</kbd> data type in Power BI. Likewise, the integer data types in SQL Server will result in a <kbd class="calibre15">Whole Number</kbd> data type and the numeric and decimal data types in SQL Server will result in <kbd class="calibre15">Decimal Number</kbd> data types in Power BI. </span></p>
<p class="calibre7"><span>When an M query is loaded to the data model in a Power BI dataset, a</span> <kbd class="calibre15">Fixed Decimal Number</kbd> <span>data type is the equivalent of a (19,4) numeric or decimal data type in SQL Server. With four digits to the right of the decimal place, the use of the</span> <kbd class="calibre15">Fixed Decimal Number</kbd> <span>data type avoids rounding errors. The <kbd class="calibre15">Decimal Number</kbd> data type is equivalent to a floating point or approximate data type with a limit of 15 significant digits. Given the potential for rounding errors with <kbd class="calibre15">Decimal Number</kbd> data types and the performance advantage of</span> <kbd class="calibre15">Fixed Decimal Number</kbd> <span>data types, if four digits of precision is sufficient, the</span> <kbd class="calibre15">Fixed Decimal Number</kbd> <span>data type is recommended to store numbers with fractional components. All integer or whole number numeric columns should be stored as <kbd class="calibre15">Whole Number</kbd> types in Power BI.</span></p>
<p class="calibre7"><span>Numeric columns in M queries can be set to <kbd class="calibre15">Whole Number</kbd>,</span> <kbd class="calibre15">Fixed Decimal Number</kbd><span>, and <kbd class="calibre15">Decimal Number</kbd> data types via the following expressions, respectively&mdash;<kbd class="calibre15">Int64.Type</kbd>, <kbd class="calibre15">Currency.Type</kbd>, and <kbd class="calibre15">type number</kbd>. The <kbd class="calibre15">Table.TransformColumnTypes()</kbd> function is used in the following M query example to convert the data types of the <kbd class="calibre15">Discount Amount</kbd>, <kbd class="calibre15">Sales Amount</kbd>, and <kbd class="calibre15">Extended Amount</kbd> columns:</span></p>
<pre class="calibre19">let<br class="calibre3" />    Source = AdWorksSQLServer,<br class="calibre3" />    Sales = Source{[Schema = "BI", Item = "vFact_InternetSales"]}[Data],<br class="calibre3" />    TypeChanges = Table.TransformColumnTypes(Sales,<br class="calibre3" />            {<br class="calibre3" />                {"Discount Amount", Int64.Type}, // Whole Number <br class="calibre3" />                {"Sales Amount", Currency.Type}, // Fixed Decimal Number<br class="calibre3" />                {"Extended Amount", type number} // Decimal Number<br class="calibre3" />            })<br class="calibre3" />in<br class="calibre3" />    TypeChanges</pre>
<div class="packt_infobox">As M is a case-sensitive language, the data type expressions must be entered in the exact case, such as <kbd class="calibre43">type number</kbd> rather than Type Number. Note that single-line and multi-line comments can be included in M queries. See the <em class="calibre16">M query examples</em> section later in this chapter for additional details.</div>
<p class="calibre7"><span>Given the impact on performance and the potential for rounding errors, it's important to check the numeric data types defined for each column of large fact tables. Additional details on data types are included in <a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em>.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-121">
<div id="calibre_link-585" class="calibre2">
<div id="calibre_link-586" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Item access in M</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Accessing records from tables, items from lists, and values from records are fundamental to M query development. In the following example, the results of the <kbd class="calibre15">BI.vDim_Account</kbd> SQL view are returned to Power BI using slightly different M syntax than the customer dimension query from the previous section: </p>
<pre class="calibre19">let<br class="calibre3" />    Source = AdWorksSQLServer,<br class="calibre3" />    AccountRecord = Source{[Name = "BI.vDim_Account"]},<br class="calibre3" />    Account = AccountRecord[Data]<br class="calibre3" />in<br class="calibre3" />    Account</pre>
<p class="calibre7"><span>For this query, a record is retrieved from the <kbd class="calibre15">AdWorksSQLServer</kbd> staging query based only on the Name column. The <kbd class="calibre15">Data</kbd> field of this record is then accessed in a separate variable (<kbd class="calibre15">Account</kbd>) to return the results of the <kbd class="calibre15">BI.vDim_Account</kbd> SQL view to Power BI.</span> <span>BI teams or the dataset designer can decide on a standard method for accessing the items exposed from a data source staging query.</span></p>
<p class="calibre7">The following sample code retrieves the <kbd class="calibre15">"Cherry"</kbd> string value from an M list:</p>
<pre class="calibre19">let<br class="calibre3" />    Source = {"Apple","Banana","Cherry","Dates"},<br class="calibre3" />    ItemFromList = Source{2}<br class="calibre3" />in<br class="calibre3" />    ItemFromList</pre>
<p class="calibre7">M is a zero-based system such that <kbd class="calibre15">Source{0}</kbd> would return the <kbd class="calibre15">"Apple"</kbd> value and <kbd class="calibre15">Source{4}</kbd> would return an error since there are only four items in the list. Zero-based access also applies to extracting characters from a text value. For example, the <kbd class="calibre15">Text.Range("Brett",2,2)</kbd> M expression returns the <kbd class="calibre15">et</kbd> characters. </p>
<div class="packt_infobox">The list value type in M is an ordered sequence of values. There are many functions available for analyzing and transforming list values, such as <kbd class="calibre43">List.Count()</kbd> and <kbd class="calibre43">List.Distinct()</kbd>. List functions that aggregate the values they contain (for example, <kbd class="calibre43">List.Average()</kbd>) are often used within grouping queries that invoke the <kbd class="calibre43">Table.Group()</kbd> function. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-122">
<div id="calibre_link-587" class="calibre2">
<div id="calibre_link-588" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">DirectQuery report execution</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In the following database trace from <span>SQL Server Profiler</span>, a DirectQuery dataset has translated a Power BI report query into a SQL statement, which joins the SQL statements associated with the <kbd class="calibre15">Reseller Sales</kbd>, <span>Reseller</span>, and <span>Date</span> M queries:</p>
<div class="cdpalignleft"><img src="images/000002.png" class="calibre73" /></div>
<div class="mce-root2">SQL Server Profiler trace &ndash; Power BI DirectQuery report visualization</div>
<p class="calibre7">For DirectQuery datasets, it's important to understand both the individual queries associated with each table of the model as well as how the data source is utilizing these queries in resolving report queries. In this example, the three table queries are used as derived tables to form the <kbd class="calibre15">FROM</kbd> clause of the outer SQL statement. Additionally, though not included in the trace image, the <kbd class="calibre15">WHERE</kbd> clause reflects a slicer (filter) selection for a specific calendar year in a Power BI report.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-123">
<div id="calibre_link-589" class="calibre2">
<div id="calibre_link-590" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Bridge Tables Queries</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The analysis of actual or historical <kbd class="calibre15">Sales and Margin Plan</kbd> versus the <kbd class="calibre15">Annual Sales Plan</kbd> is one of the top requirements for this dataset. Given the granularity of the annual <kbd class="calibre15">Sales and Margin Plan</kbd> (<kbd class="calibre15">Calendar Month</kbd>, <kbd class="calibre15">Product Subcategory</kbd>, <kbd class="calibre15">Sales Territory Region</kbd>), it's necessary to create bridge tables reflecting the unique values of these columns.</p>
<p class="calibre7">The three bridge tables, which can be hidden from the user interface, enable relationships between the <kbd class="calibre15">Date</kbd>, <kbd class="calibre15">Product</kbd>, and <kbd class="calibre15">Sales Territory</kbd> dimension tables with the <kbd class="calibre15">Sales and Margin Plan</kbd> fact table.</p>
<p class="calibre7">In the following example, the <kbd class="calibre15">Sales Territory</kbd> dimension table query is referenced as a source and the unique values of the <kbd class="calibre15">Sales Territory Region</kbd> column are retrieved via the <kbd class="calibre15">Table.Distinct()</kbd> function:</p>
<div class="cdpalignleft"><img src="images/000011.png" class="calibre74" /></div>
<div class="mce-root2">Sales Territory Bridge Table query for actual versus plan analysis</div>
<p class="calibre7">In the data model, the bridge tables will have one-to-many relationships with both the <kbd class="calibre15">Annual Sales Plan</kbd> fact table and their associated dimension tables. The relationship between the bridge tables and the dimensions will be set to allow bidirectional cross-filtering such that a filter selection for a <kbd class="calibre15">Product Category</kbd> (for example, <kbd class="calibre15">Bikes</kbd>) will impact both the historical sales fact tables as well as the <kbd class="calibre15">Sales and Margin Plan</kbd>. Greater details of this model will be discussed in <a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em>. The <span>Enable load</span> and <span>Include in Report Refresh</span><em class="calibre16"> </em>properties for each bridge table query (accessible via the right-click menu) should be set to true.</p>
<div class="packt_infobox">All three bridge table M queries result in simple SQL statements, such as the following, via Query Folding: <br class="calibre3" />
<br class="calibre3" />
<kbd class="calibre43">"Select distinct [Sales Territory Region] from BI.vDim_SalesTerritory"</kbd><br class="calibre3" />
<br class="calibre3" />
Therefore, all three bridge table queries can be used in a DirectQuery dataset. Additionally, these bridge queries could be stored as new SQL views in the source database to eliminate the dependency on M functions. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-124">
<div id="calibre_link-591" class="calibre2">
<div id="calibre_link-592" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Parameter Tables</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The final group of M queries, parameter table queries, are developed for usability and manageability purposes. From a usability standpoint, the <kbd class="calibre15">Date Intelligence Metrics</kbd> and <kbd class="calibre15">Adventure Works Sales</kbd> queries serve to consolidate similar DAX measures in the <span>Field</span><span>s</span> list. Additionally, the <kbd class="calibre15">CurrentDate</kbd> query is used to provide reports with a text message advising of the latest data refresh date. From a manageability standpoint, the <kbd class="calibre15">Measure Support</kbd> query can be used to centralize intermediate or branching DAX expressions that can be referenced by many DAX measures.</p>
<p class="calibre7">As shown in the following example of the <kbd class="calibre15">Adventure Works Sales</kbd> query, a trivial expression can be used for three of the four queries since the purpose of the query is simply to provide a table name to the data model:</p>
<div class="cdpalignleft"><img src="images/000022.png" class="calibre75" /></div>
<div class="mce-root2">Adventure Works Sales Parameter Tables query</div>
<p class="calibre7">The <kbd class="calibre15">Date Intelligence Metrics</kbd>, <kbd class="calibre15">Adventure Works Sales</kbd>, and <kbd class="calibre15">Measure Support</kbd> queries can all retrieve a blank value and the <span>Include in report refresh</span> property can be disabled. The following two chapters will demonstrate how these blank tables can be utilized as data model metadata, and DAX measures are added to the dataset in <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em>, and <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em>, respectively. </p>
<p class="calibre7">The <kbd class="calibre15">CurrentDate</kbd> query is the only parameter table query that needs to be executed with each report refresh. The following M script for the <kbd class="calibre15">CurrentDate</kbd> query produces a table with one column and one record, representing the current date as of the time of execution:</p>
<pre class="calibre19">let<br class="calibre3" />    RefreshDateTime = DateTime.LocalNow(),<br class="calibre3" />    TimeZoneOffset = -5,<br class="calibre3" />    RefreshDateTimeAdjusted = RefreshDateTime + #duration(0,TimeZoneOffset,0,0),<br class="calibre3" />    RefreshDateAdjusted = DateTime.Date(RefreshDateTimeAdjusted),<br class="calibre3" />    TableCreate = Table.FromRecords({[CurrentDate = RefreshDateAdjusted]}),<br class="calibre3" />    DateType = Table.TransformColumnTypes(TableCreate,{"CurrentDate", type date})<br class="calibre3" />in<br class="calibre3" />    DateType</pre>
<p class="calibre7">All reported times in Microsoft Azure are expressed in <strong class="calibre6">Coordinated Universal Time</strong> (<strong class="calibre6">UTC</strong>). Therefore, timezone adjustment logic can be built into the M query to ensure the last refreshed date message reflects the local timezone. In the preceding example, five hours are reduced from the <kbd class="calibre15">DateTime.LocalNow()</kbd> function reflecting the variance between US Eastern Standard Time and UTC. The adjusted datetime value is then converted into a date value and a table is built based on this modified date value. </p>
<p class="calibre7">As shown in the following image, the <kbd class="calibre15">Adventure Works Sales</kbd> and <kbd class="calibre15">Date Intelligence Metrics</kbd> queries are represented in the <span>FIELDS</span> list and the <kbd class="calibre15">CurrentDate</kbd> query is used by a DAX measure to advise of the last refreshed date:</p>
<div class="cdpalignleft"><img src="images/000030.png" class="calibre76" /></div>
<div class="mce-root2">Parameter Tables in Fields list and Data Refresh Message</div>
<p class="calibre7">The DAX expression supporting the last refreshed message is as follows:</p>
<pre class="calibre19">Last Refresh Msg = <br class="calibre3" />  VAR CurrentDateValue = MAX('CurrentDate'[CurrentDate])<br class="calibre3" />  RETURN "Last Refreshed: " &amp; CurrentDateValue </pre>
<p class="calibre7">An additional example of using DAX to return a string value for title or label purposes is included in the <em class="calibre16">Drillthrough Report Pages</em> section of <a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16">Applying Custom Visuals, Animation, and Analytics</em>.</p>
<div class="packt_infobox">As datasets grow larger and more complex, BI teams or dataset designers may add or revise group names to better organize M queries. For example, the four parameter group queries in this section serve three separate functions (<kbd class="calibre43">fields list</kbd>, <kbd class="calibre43">last refreshed date</kbd>, and <kbd class="calibre43">DAX logic centralization</kbd>).<br class="calibre3" />
<br class="calibre3" />
To experienced Power BI and SSAS Tabular developers, a parameter table is understood as a custom table of parameter values loaded to a model and exposed to the reporting interface. DAX measures can be authored to detect which value (parameter) has been selected by the user <span>(for example, 10% growth, 20% growth)</span> and dynamically compute the corresponding result. For this dataset, the concept of <span>Parameter Tables</span> is extended to include any query that is loaded to the data model but not related to any other table in the data model.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-125">
<div id="calibre_link-593" class="calibre2">
<div id="calibre_link-594" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Security Tables</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Based on the data security needs for this project described in <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <span><em class="calibre16">Planning Power BI Projects</em>,</span> it's not necessary to retrieve any tables for the purpose of implementing a <strong class="calibre6">row-level security</strong> (<strong class="calibre6">RLS</strong>) role. As shown in the <em class="calibre16">Sample Power BI project template</em> section in <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>, the sales managers and associates should only have access to their <kbd class="calibre15">Sales Territory</kbd> groups, while the Vice Presidents should have global access. With these simple requirements, the security groups of users (for example, North America, Europe, the Pacific region) can be created and assigned to corresponding RLS roles defined in the data model. See <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em>, for details on implementing these security roles.</p>
<p class="calibre7">In projects with more complex or granular security requirements, it's often necessary to load additional tables to the data model such as a <kbd class="calibre15">Users</kbd> table and a <kbd class="calibre15">Permissions</kbd> table. For example, if users were to be restricted to specific postal codes rather than sales territory groups, a dynamic, table-driven approach that applies filters based on the user issuing the report request would be preferable to creating (and maintaining) a high volume of distinct RLS roles and security groups. Given the importance of dynamic (user-based) security, particularly for large-scale datasets, detailed examples of implementing dynamic security for both import and DirectQuery datasets are included in <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em>. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-126">
<div id="calibre_link-595" class="calibre2">
<div id="calibre_link-596" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Query folding</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Query folding is one of the most powerful and important capabilities of the M language as it translates M expressions into SQL statements that can be executed by the source system. With query folding, M serves as an abstraction layer to implement both common and complex data cleansing and transformation operations while still leveraging source system resources. When implementing any remaining logic or data transformations via M functions, a top priority of the dataset designer is to ensure that these operations are folded to the data source.</p>
<p class="calibre7">In the following M query, a<span> </span><kbd class="calibre15">Table.RemoveColumns()</kbd><span> </span>M function is applied against the SQL view for the <kbd class="calibre15">Internet Sales</kbd> fact table to exclude three columns that are not needed for the dataset:</p>
<div class="cdpalignleft"><img src="images/000039.png" class="calibre77" /></div>
<div class="mce-root2">Power Query Editor: View Native Query</div>
<p class="calibre7">The additional step is translated to a SQL query that simply doesn't select the three columns. The specific SQL statement passed to the source system can be accessed by right-clicking the final step in the <span>Query Settings</span> pane and selecting<span> </span><span>View Native Query</span>. If the<span> </span><span>View Native Query</span><span> </span>option is grayed out, this indicates that the specific step or transformation is executed with local resources.</p>
<div class="packt_infobox">Selecting<span> one of the </span><span>APPLIED STEPS</span><span> in the <span>Query Settings</span> pane displays a preview of the results of the query of the given step. Particularly for queries with several steps, the ability to quickly walk through the transformations or view the query results at any given step is very helpful in analyzing and debugging M queries. Note that the names of the variables used in the M query will be reflected in the <span>APPLIED STEPS</span> pane, further underscoring the importance of applying intuitive variable names in M queries.</span></div>
<p class="calibre7"><span>Query folding is limited by the data source of the M expression with relational databases, such as SQL Server and Oracle, supporting the most query folding. Alternatively, no query folding is possible when an Excel workbook or a text file is the data source of a query. The M queries against these file sources will use local M engine resources and thus the volume of data imported as well as the complexity of the query should be limited. Other sources, such as SharePoint lists, Active Directory, and Exchange, support some level of query folding, though significantly less than relational databases.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-127">
<div id="calibre_link-597" class="calibre2">
<div id="calibre_link-598" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Partial query folding</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Dataset designers should check the final step of each query in the dataset to ensure that query folding is occurring. If all required transformations or logic of an M query cannot be folded into a single SQL statement, the dataset designer should attempt to re-design the query to obtain as much query folding as possible. For example, all common or simple transformations can be implemented in the first four steps of the query so that <span>View Native Query</span><em class="calibre16"> </em>will be visible for the fourth step. The remaining logic can be added as the fifth step of the query and this locally executed step or transformation will be applied against the results of the SQL statement generated from the fourth step of the query. </p>
<div class="packt_tip pcalibre7 pcalibre6">The<span> </span><kbd class="calibre43">Value.NativeQuery()</kbd><span> </span>M function can be used to pass a SQL statement to the data source. However, any further transformations applied to the results of this function in the M query will exclusively use local resources. Therefore, if implemented, the SQL statement passed to the data source should either include all required logic for the query or return a small result set that can be further processed with local resources. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-128">
<div id="calibre_link-599" class="calibre2">
<div id="calibre_link-600" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">M Query examples</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The M query language includes hundreds of functions and several books have been written about to its application. The greater purpose of this chapter is to understand M queries in the context of a corporate Power BI solution that primarily leverages an IT-managed data warehouse. As shown in the examples shared in the <em class="calibre16">M Queries</em> section earlier, the combination of a mature data warehouse and a layer of SQL view objects within this source may eliminate any need for further data transformations. However, Power BI Dataset designers should still be familiar with the fundamentals of M queries and their most common use cases, as it's often necessary to further extend and enhance source data. </p>
<p class="calibre7">The following sections demonstrate three common data transformation scenarios that can be implemented in M. Beyond retrieving the correct results, the M queries also generate SQL statements for execution by the source system via query folding, and comments are included for longer-term maintenance purposes. </p>
<div class="packt_infobox">If you're new to M query development, you can create a blank query from the <span>Other category of data source connectors</span> available within the <span>Get Data</span> dialog. Alternatively, you can duplicate an existing query via the right-click context menu of a query in the Power Query Editor and then rename and revise the duplicate query. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-129">
<div id="calibre_link-601" class="calibre2">
<div id="calibre_link-602" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Trailing three years filter</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The objective of this example is to retrieve dates from three years prior to the current year through the current date. For example, on October 18th, 2017, the query should retrieve January 1st, 2014 through October 18th, 2017. This requirement ensures that three full years of historical data, plus the current year, is always available to support reporting.</p>
<p class="calibre7">The starting date and current date values for the filter condition are computed via <kbd class="calibre15">Date</kbd> and <kbd class="calibre15">DateTime</kbd> M functions and assigned variables names (<kbd class="calibre15">StartDate</kbd>, <kbd class="calibre15">CurrentDate</kbd>). Since the starting date will always be on January 1st, it's only necessary to compute the starting year and pass this value to the <kbd class="calibre15">#date</kbd> constructor. Finally, the two date variables are passed to the <kbd class="calibre15">Table.SelectRows()</kbd> function to implement the filter on the <kbd class="calibre15">Reseller Sales</kbd> fact table view: </p>
<pre class="calibre19">let<br class="calibre3" />//Trailing Three Year Date Values<br class="calibre3" />    CurrentDate = DateTime.Date(DateTime.LocalNow()),<br class="calibre3" />    StartYear = Date.Year(CurrentDate)-3,<br class="calibre3" />    StartDate = #date(StartYear,1,1), <br class="calibre3" />//Reseller Sales View<br class="calibre3" />    Source = AdWorksSQLServer,<br class="calibre3" />    ResellerSales = Source{[Schema = "BI", Item = "vFact_ResellerSales"]}[Data], <br class="calibre3" />//Trailing Three Year Filter<br class="calibre3" />    FilterResellerSales = <br class="calibre3" />        Table.SelectRows(ResellerSales, each [Order Date] &gt;= StartDate and [Order Date] &lt;= CurrentDate)<br class="calibre3" />in<br class="calibre3" />    FilterResellerSales</pre>
<p class="calibre7">As shown in the <span>View Native Query</span> dialog available in the <span>Applied Steps</span> window of the Power Query Editor, the custom filter condition is translated into a T-SQL statement for the source SQL Server database to execute:</p>
<div class="cdpalignleft"><img src="images/000048.png" class="calibre78" /></div>
<div class="mce-root2">Query Folding of three year filter condition </div>
<p class="calibre7">Note that the order of the variables in the expression doesn't impact the final query. For example, the two <kbd class="calibre15">Reseller Sales</kbd> view variables could be specified prior to the three date variables and the final <kbd class="calibre15">FilterResellerSales</kbd> variable would still generate the same SQL query. Additionally, be advised that M is a case-sensitive language. For example, referencing the variable defined as <kbd class="calibre15">StartDate</kbd> via the name <kbd class="calibre15">Startdate</kbd> will result in a failure.</p>
<div class="packt_infobox">Single-line comments can be entered in M queries following the double forward slash (<kbd class="calibre43">//</kbd>) characters per the trailing three years example. Multiline or delimited comments start with the (<kbd class="calibre43">/*</kbd>) characters and end with the (<kbd class="calibre43">*/</kbd>) characters, just like T-SQL queries for SQL Server.</div>
<p class="calibre7"><span>If the requirement was only to retrieve the trailing three years of data relative to the current date (for example, October 18th, 2014 through October 18th, 2017) the <kbd class="calibre15">StartDate</kbd> variable could be computed via the <kbd class="calibre15">Date.AddYears()</kbd> function, as follows:</span></p>
<pre class="calibre19">//Trailing three years (e.g. October 18th, 2014 through October 18, 2017)<br class="calibre3" />   CurrentDate = DateTime.Date(DateTime.LocalNow()),<br class="calibre3" />   StartDate = Date.AddYears(CurrentDate,-3)</pre>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-130">
<div id="calibre_link-603" class="calibre2">
<div id="calibre_link-604" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Customer history column</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In this example, the goal is to add a column to the customer dimension table that groups the customers into four categories based on the date of their first purchase. Specifically, the new column needs to leverage the existing first purchase date column and assign the customer rows to one of the following four categories&mdash;<kbd class="calibre15">First Year Customer</kbd>, <kbd class="calibre15">Second Year Customer</kbd>, <kbd class="calibre15">Third Year Customer</kbd>, <kbd class="calibre15">Legacy Customer</kbd>. Since the column will be computed daily with each scheduled refresh, it will be used by the sales and marketing teams to focus their efforts on new and older customer segments.</p>
<p class="calibre7">A combination of date functions and conditional logic (<kbd class="calibre15">if..then..else</kbd>) is used with the <kbd class="calibre15">Table.AddColumn()</kbd> function to produce the new column:</p>
<pre class="calibre19">let<br class="calibre3" />// Customer History Date Bands<br class="calibre3" />   CurrentDate = DateTime.Date(DateTime.LocalNow()),<br class="calibre3" />   OneYearAgo = Date.AddYears(CurrentDate,-1),<br class="calibre3" />   TwoYearsAgo = Date.AddYears(CurrentDate,-2),<br class="calibre3" />   ThreeYearsAgo = Date.AddYears(CurrentDate,-3),<br class="calibre3" />//Customer Dimension<br class="calibre3" />    Source = AdWorksSQLServer,<br class="calibre3" />    Customer = Source{[Schema = "BI", Item = "vDim_Customer"]}[Data],<br class="calibre3" />    CustomerHistoryColumn = Table.AddColumn(Customer, "Customer History Segment", <br class="calibre3" />    each<br class="calibre3" />    if [Customer First Purchase Date] &gt;= OneYearAgo then "First Year Customer" <br class="calibre3" />    else if [Customer First Purchase Date] &gt;= TwoYearsAgo and [Customer First Purchase Date] &lt; OneYearAgo then "Second Year Customer"<br class="calibre3" />    else if [Customer First Purchase Date] &gt;= ThreeYearsAgo and [Customer First Purchase Date] &lt; TwoYearsAgo then "Third Year Customer" <br class="calibre3" />else "Legacy Customer", type text)<br class="calibre3" />in<br class="calibre3" />   CustomerHistoryColumn</pre>
<p class="calibre7">As shown in the following image from the Power Query Editor, the <kbd class="calibre15">Customer History Segment</kbd> produces one of four text values based on the <kbd class="calibre15">Customer First Purchase Date</kbd> column: </p>
<div class="cdpalignleft"><img src="images/000059.png" class="calibre79" /></div>
<div class="mce-root2">Customer History Segment column in Power Query Editor</div>
<p class="calibre7">In this example, the customer <kbd class="calibre15">Alan Zheng</kbd> falls into the <kbd class="calibre15">Third Year Customer</kbd> segment since his first purchase date (10/20/2014) is after 10/18/2014 - three years prior to the current date (10/18/2017). When the dataset is refreshed on 10/21/2017, <kbd class="calibre15">Alan Zheng</kbd> will be re-classified as a <kbd class="calibre15">Legacy Customer</kbd> by the <kbd class="calibre15">Customer History Segment</kbd> column since his first purchase date will be more than three years old at that time. </p>
<p class="calibre7">Like the previous M query example of a trailing three year filter, the conditional logic for the derived customer column is also translated into T-SQL via query folding:</p>
<div class="cdpalignleft"><img src="images/000069.png" class="calibre80" /></div>
<div class="mce-root2">Native SQL Query generated by Customer M Query</div>
<div class="packt_tip pcalibre7 pcalibre6">The two dynamic columns (<kbd class="calibre43">Calendar Year Status</kbd>, <kbd class="calibre43">Calendar Month Status</kbd>) included in the date dimension SQL view earlier in this chapter could also be computed via M functions. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-131">
<div id="calibre_link-605" class="calibre2">
<div id="calibre_link-606" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Derived column data types</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>The final parameter to the </span><kbd class="calibre15">Table.AddColumn()</kbd><span> function is optional but should be specified to define the data type of the new column. In the customer history column example, the new column is defined as a text data type. If a whole number column was created, an <kbd class="calibre15">Int64.Type</kbd> would be specified, such as the following example:</span></p>
<pre class="calibre19">MyNewColumn = Table.AddColumn(Product, "My Column", each 5, Int64.Type)</pre>
<p class="calibre7"><span>If the data type of the column is not defined in the </span><kbd class="calibre15">Table.AddColumn()</kbd><span> function or later in the query via the </span><kbd class="calibre15">Table.TransformColumnTypes()</kbd><span> function, the new column will be set as an <span>Any</span> data type, as shown in the following screenshot:</span></p>
<div class="cdpalignleft"><img src="images/000080.png" class="calibre81" /></div>
<div class="mce-root2">Data Type of Any</div>
<p class="calibre7">Columns of the <span>Any</span> data type will be loaded to the data model as a text data type. Dataset designers should ensure that each column in every query has a data type specified. In other words, the <span>Any</span> (that is, unknown) data type should not be allowed in M queries.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-132">
<div id="calibre_link-607" class="calibre2">
<div id="calibre_link-608" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Product dimension integration</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The SQL view for the product dimension referenced earlier in this chapter contained the following four operations:</p>
<ol class="calibre12">
<li class="chapter">Join the <kbd class="calibre15">Product</kbd>, <kbd class="calibre15">ProductSubcategory</kbd>, and <kbd class="calibre15">ProductCategory</kbd> dimension tables into a single query</li>
<li class="chapter">Create a custom product category group column (for example, <kbd class="calibre15">Bikes</kbd> versus <kbd class="calibre15">Non-Bikes</kbd>)</li>
<li class="chapter">Apply report-friendly column names with spaces and proper casing</li>
<li class="chapter">Replace any null values in the <kbd class="calibre15">Product Subcategory</kbd> and <kbd class="calibre15">Product Category</kbd> columns with the <kbd class="calibre15">'Undefined'</kbd> value</li>
</ol>
<p class="calibre7">Like almost all operations available to SQL <kbd class="calibre15">SELECT</kbd> queries, the same query can also be created via M functions. If the SQL view for the product dimension cannot be created within the data source, the following M query produces the same results:</p>
<pre class="calibre19">let<br class="calibre3" />    Source = AdWorksSQLServer,<br class="calibre3" />//Product Dimension Table Views<br class="calibre3" />    Product = Source{[Schema = "BI", Item = "vDim_Products"]}[Data],<br class="calibre3" />    ProductSubCat = Source{[Schema = "BI", Item = "vDim_ProductSubcategory"]}[Data], <br class="calibre3" />    ProductCat = Source{[Schema = "BI", Item = "vDim_ProductCategory"]}[Data],<br class="calibre3" /><br class="calibre3" />//Product Outer Joins <br class="calibre3" />    ProductJoinSubCat = Table.NestedJoin(Product,"ProductSubcategoryKey",ProductSubCat,"ProductSubcategoryKey","ProductSubCatTableCol",JoinKind.LeftOuter),<br class="calibre3" />    ProductJoinSubCatCol = Table.ExpandTableColumn(ProductJoinSubCat,"ProductSubCatTableCol",{"EnglishProductSubcategoryName","ProductCategoryKey"},{"Product Subcategory", "ProductCategoryKey"}),<br class="calibre3" /><br class="calibre3" />    ProductJoinCat = Table.NestedJoin(ProductJoinSubCatCol,"ProductCategoryKey",ProductCat,"ProductCategoryKey","ProductCatTableCol",JoinKind.LeftOuter),<br class="calibre3" />    ProductJoinCatCol = Table.ExpandTableColumn(ProductJoinCat,"ProductCatTableCol",{"EnglishProductCategoryName"},{"Product Category"}),<br class="calibre3" /><br class="calibre3" />//Select and Rename Columns<br class="calibre3" />    ProductDimCols = Table.SelectColumns(ProductJoinCatCol,{"ProductKey","ProductAlternateKey","EnglishProductName","Product Subcategory","Product Category"}),<br class="calibre3" />    ProductDimRenameCols = Table.RenameColumns(ProductDimCols,{<br class="calibre3" />        {"ProductKey", "Product Key"},{"ProductAlternateKey","Product Alternate Key"},{"EnglishProductName","Product Name"}<br class="calibre3" />    }),<br class="calibre3" /><br class="calibre3" />//Product Category Group Column<br class="calibre3" />    ProductCatGroupCol = Table.AddColumn(ProductDimRenameCols,"Product Category Group", each <br class="calibre3" />        if [Product Category] = "Bikes" then "Bikes"<br class="calibre3" />        else if [Product Category] = null then "Undefined"<br class="calibre3" />        else "Non-Bikes"<br class="calibre3" />,type text),<br class="calibre3" /><br class="calibre3" />//Remove Null Values <br class="calibre3" />    UndefinedCatAndSubcat = Table.ReplaceValue(ProductCatGroupCol,null,"Undefined",Replacer.ReplaceValue,{"Product Subcategory","Product Category"})<br class="calibre3" />in<br class="calibre3" />    UndefinedCatAndSubcat</pre>
<p class="calibre7">The three product dimension tables in the dbo schema of the data warehouse are referenced from the <kbd class="calibre15">AdWorksSQLServer</kbd> staging query described earlier in this chapter.</p>
<p class="calibre7">The <kbd class="calibre15">Table.NestedJoin()</kbd> function is used to execute the equivalent of the <kbd class="calibre15">LEFT JOIN</kbd> operations from the SQL View, and the <kbd class="calibre15">Table.ExpandTableColumn()</kbd> function extracts and renames the required <kbd class="calibre15">Product Subcategory</kbd> and <kbd class="calibre15">Product Category</kbd> columns. Following the selection and renaming of columns, the <kbd class="calibre15">Product Category</kbd> group column is created via <span>a conditional expression within the </span><kbd class="calibre15">Table.AddColumn()</kbd> function. Finally, the <kbd class="calibre15">Table.ReplaceValue()</kbd> function replaces any null values in the <kbd class="calibre15">Product Category</kbd> and <kbd class="calibre15">Product Subcategory</kbd> columns with the <kbd class="calibre15">'Undefined'</kbd> text string. The Power Query Editor provides a preview of the results: </p>
<div class="cdpalignleft"><img src="images/000203.png" class="calibre82" /></div>
<div class="mce-root2">Power Query Editor preview of Product M Query</div>
<p class="calibre7">Despite the additional steps and complexity of this query relative to the previous M query examples (trailing three years filter, <kbd class="calibre15">Customer History Segment</kbd> column), the entire query is translated into a single SQL statement and executed by the source SQL Server database. The <span>View Native Query</span> option in the <span>Applied Steps</span> pane of the Power Query Editor reveals the specific syntax of the SQL statement generated via query folding:</p>
<div class="cdpalignleft"><img src="images/000101.png" class="calibre83" /></div>
<div class="mce-root2">Part of Native Query generated from Product M Query</div>
<div class="packt_infobox">Note<span> that a dedicated SQL view object in the BI schema (for example, <kbd class="calibre43">BI.vDim_ProductSubcategory</kbd>) is accessed for each of the three product dimension tables. Per the SQL views section earlier in this chapter, it's recommended to always access SQL views from Power BI datasets, as this declares a dependency with the source tables.</span></div>
<p class="calibre7">Note that the <kbd class="calibre15">Table.Join()</kbd> function could not be used in this scenario given the requirement for a left outer join and the presence of common column names. With a left outer join, the presence of common column names, such as <kbd class="calibre15">ProductSubcategoryKey</kbd> or <kbd class="calibre15">ProductCategoryKey</kbd>, for the tables in the join operation would cause an error. Additionally, although a left outer join is the default behavior of the <kbd class="calibre15">Table.NestedJoin()</kbd> function, it's recommended to explicitly specify the join kind (for example, <kbd class="calibre15">JoinKind.Inner</kbd>, <kbd class="calibre15">JoinKind.LeftOuter</kbd>, <kbd class="calibre15">JoinKind.LeftAnti</kbd>) as per the <kbd class="calibre15">ProductJoinSubCat</kbd> and <kbd class="calibre15">ProductJoinCat</kbd> variables of the M query. </p>
<div class="packt_tip pcalibre7 pcalibre6"><span>Whenever any unstructured or business-user-owned data sources are used as sources for a Power BI dataset, it's usually appropriate to implement additional data quality and error-handling logic within the M query. For example, a</span> step that invokes the <kbd class="calibre43">Table.Distinct()</kbd> function could be added to the <kbd class="calibre43">Sales and Margin Plan</kbd> query that retrieves from the Excel workbook to remove any duplicate rows. Additionally, the third parameter of the <kbd class="calibre43">Table.SelectColumns()</kbd> function (for example, <kbd class="calibre43">MissingField.UseNull</kbd>) can be used to account for scenarios in which source columns have been renamed or removed. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-133">
<div id="calibre_link-609" class="calibre2">
<div id="calibre_link-610" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">R script transformation</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">It's possible to execute an R script within an M query as part of a data transformation process.</p>
<p class="calibre7">As shown in the following image, the <kbd class="calibre15">Run R Script</kbd> is available on the <kbd class="calibre15">Transform</kbd> tab of the Power Query Editor in Power BI Desktop:</p>
<div class="cdpalignleft"><img src="images/000112.png" class="calibre84" /></div>
<div class="mce-root2">Run R Script Command in Power Query Editor</div>
<p class="calibre7">To execute the R script in Power BI Desktop, R needs to be installed on the local machine as well as any R packages used by the script. Most importantly, for the R script to work properly when the dataset is published to the Power BI service, the privacy levels for the data sources need to be set to <span>Public</span>. For most organizations, this limitation rules out the use of R scripts for data transformations in Power BI. Additionally, the presence of R scripts adds another layer of complexity to a solution that already includes SQL, M, and DAX.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-134">
<div id="calibre_link-611" class="calibre2">
<div id="calibre_link-612" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">M editing tools</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Power BI Desktop stores the M code for queries created via the Power Query Editor graphical interface or the Advanced Editor within M documents for repeatable execution. Similar to other languages and project types, code editing tools are available to support the development, documentation, and version control of M queries. Dataset designers can use Visual Studio or Visual Studio Code to author and manage the M queries for Power BI and other Microsoft projects. These tools include common development features, such as IntelliSense, syntax highlighting, and integrated source control.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-135">
<div id="calibre_link-613" class="calibre2">
<div id="calibre_link-614" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Advanced Editor</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In Power BI Desktop, the M code for each query can be accessed from the Advanced Editor window within the Power Query Editor. With the Power Query Editor open, select a query of interest from the list of queries on the left and click on the Advanced Editor icon from the <span>Home</span> tab to access the following window:</p>
<div class="cdpalignleft"><img src="images/000012.png" class="calibre85" /></div>
<div class="mce-root2">Advanced Editor in Power BI Desktop</div>
<p class="calibre7">As of the October 2017 release of Power BI Desktop, the Advanced Editor is limited to checking the syntax of the query. The colorization or highlighting of keywords, surrounding detection, and IntelliSense features available to DAX expressions is not yet available in Power BI Desktop. Given the importance of M queries to Power BI projects, as well as SQL Server Analysis Services 2017 and other Microsoft applications, external M editing tools, such as Visual Studio Code, are frequently used by dataset designers. </p>
<div class="packt_infobox">Experienced M query authors will often use the data transformation icons available in the Power Query Editor to quickly produce an initial version of one or a few of the requirements of the query. The author then uses the Advanced Editor or an external M editing tool to analyze the M code generated by the Power Query Editor and can revise or enhance this code, such as by changing variable names or utilizing optional parameters of certain M functions.<br class="calibre3" />
<br class="calibre3" />
For the most common and simple data transformation tasks, such as filtering out rows based on one value of a column (for example, <kbd class="calibre43">State = "Kansas"</kbd>), the M code generated by the Power Query Editor usually requires minimal revision. For more complex queries with custom or less common requirements, the Power Query Editor graphical interface is less helpful and a greater level of direct M development is necessary.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-136">
<div id="calibre_link-615" class="calibre2">
<div id="calibre_link-616" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Visual Studio Code</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Visual Studio Code is a free, lightweight code-editing tool from Microsoft that's available on all platforms (Windows, Mac, Linux). Power Query M Language is an extension to Visual Studio Code that provides code-editing support for M queries, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000023.png" class="calibre86" /></div>
<div class="mce-root2">M Query in Visual Studio Code</div>
<p class="calibre7">In this example, the same <kbd class="calibre15">Internet Sales</kbd> query viewed in the Advanced Editor of Power BI Desktop has been copied into a Visual Studio code file and saved with a (<kbd class="calibre15">.pq</kbd>) file extension. Once saved in a supported file extension, code-editing features, such as <span>colorization, auto-closing, and surrounding detection, </span><span>are applied. </span><span>M query files can be opened and saved with the following four file extensions&mdash;<kbd class="calibre15">.m</kbd>, <kbd class="calibre15">.M</kbd>, <kbd class="calibre15">.pq</kbd>, and <kbd class="calibre15">.PQ</kbd>.</span></p>
<div class="packt_tip pcalibre7 pcalibre6">Since the <kbd class="calibre43">.pq</kbd> file extension is used by the Power Query SDK for Visual Studio, as described in the following section, this file extension is recommended for storing M queries.</div>
<p class="calibre7">In the initial release of the extension (v 1.0.0), IntelliSense is limited to the terms within the query. Future updates will likely include IntelliSense support for the standard library of M functions and common M syntax, similar to the Power Query SDK for Visual Studio. To install the Power Query M Language extension for Visual Studio Code, open the Extensions Marketplace in Visual Studio Code (<span>View</span> | <span>Extensions</span>) and search for the name of the extension.</p>
<div class="packt_infobox">Prior to the M extension for Visual Studio Code and the Power Query SDK for Visual Studio, M developers commonly utilized the free Notepad++ code editor application. Since M is not a standard supported language for this tool, developers would create a user-defined language by pasting or typing in a list of M functions and keywords. The following blog post from Lars Schreiber, MS MVP, walks through the M for Notepad++ setup process: <a href="http://ssbi-blog.de/technical-topics-english/power-query-editor-using-notepad/" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://ssbi-blog.de/technical-topics-english/power-query-editor-using-notepad/</a>.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-137">
<div id="calibre_link-617" class="calibre2">
<div id="calibre_link-618" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Visual Studio</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For Visual Studio 2015 and 2017, the Power Query SDK can be used to create Data Connector and M query projects, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000005.png" class="calibre87" /></div>
<div class="mce-root2">Power Query project types in Visual Studio</div>
<p class="calibre7">With a new PQ file solution and project in Visual Studio, the M queries of a Power BI dataset can be added as separate (<kbd class="calibre15">.pq</kbd>) files, as shown in the following screenshot: </p>
<div class="cdpalignleft"><img src="images/000105.png" class="calibre88" /></div>
<div class="mce-root2">Power Query project in Visual Studio 2017</div>
<p class="calibre7">Unlike the extension for Visual Studio Code, the file extension types for Power Query projects are exclusive to (<kbd class="calibre15">.pq</kbd>). Most importantly, full M language Intellisense is supported, making it dramatically easier to find M functions relevant to specific data transformation operations. Moreover, unlike the extension for Visual Studio Code, M queries can be executed from within Visual Studio via the Power Query SDK for Visual Studio. To execute an M query in Visual Studio, such as in the preceding example, click the Start button on the toolbar (green play icon) or hit <em class="calibre16">F5</em>. You can also right-click the Power Query project (for example, <kbd class="calibre15">AdWorks Enteprise Import</kbd>) to configure properties of the M query project, such as the maximum output rows to return and whether native queries can be executed. </p>
<p class="calibre7">To install the Power Query SDK for Visual Studio, access the Visual Studio Marketplace (<span>Tools</span> | <span>Extensions and Updates</span>) and search for the name of the extension (Power Query SDK). </p>
<div class="packt_infobox">As per the lock icons next to the project files in the Solution Explorer window, the Power Query SDK for Visual Studio enables standard integration with source control and project management tools, such as <strong class="calibre6">Team Foundation Server</strong> (<strong class="calibre6">TFS</strong>) and <strong class="calibre6">Visual Studio Team Services</strong> (<strong class="calibre6">VSTS</strong>).</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-138">
<div id="calibre_link-619" class="calibre2">
<div id="calibre_link-620" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In this chapter, we've covered all components of the data retrieval process used to support the dataset for this project as described in <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>. This includes the layer of SQL views within a database source, source connectivity parameters in Power BI Desktop, and the M queries used to define and load the dimension and fact tables of the dataset. In constructing a data access layer and retrieval process for a dataset, we've also discussed the design considerations relative to import and DirectQuery datasets, Power BI Desktop configuration options, and data source privacy levels. Additionally, we've reviewed core concepts of the M language, including query folding, item access, and data types. Moreover, we've reviewed three examples of efficiently implementing impactful data transformation logic via M queries as well as the tools for developing and editing M queries.</p>
<p class="calibre7">In the next chapter, we'll leverage the M queries and design techniques described in this chapter to create import and DirectQuery data models. Specifically, the dimension and fact table M queries will become the dimension and fact tables of the data model, and relationships will be defined to form multiple star schemas. Additionally, the bridge table M queries will be used to support the analysis of historical sales and margin results versus the annual sales and margin plan.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-23">
<div id="calibre_link-621" class="calibre2">
<div id="calibre_link-622" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Designing Import and DirectQuery Data Models</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">This<span> </span>chapter utilizes the queries described in <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>, to create both an import and a DirectQuery Data Model. Relationships are created between fact and dimension tables to enable business users to analyze the fact data for both <kbd class="calibre15">Internet Sales</kbd> and <kbd class="calibre15">Reseller Sales</kbd> simultaneously by using common dimension tables and across multiple business dates. A combination of relationships, bidirectional cross-filtering, and DAX measures will be used to support the analysis of actual sales data versus the Annual Sales and Margin Plan. Additionally, the product dimension table is enhanced with a hierarchy to enable simple drill up/down, and a custom sort order is applied to columns in the date dimension table.</p>
<p class="calibre7">This chapter also includes recommended practices for model metadata, such as data categories, and tips to improve the usability of Data Models, such as a simplified field list. Finally, we will review common performance analysis tools and optimization techniques for import and DirectQuery Data Models. As described in the <em class="calibre16">Dataset planning</em> section of <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>, a DirectQuery model relies on the data source of the dataset (for example, a SQL Server-relational database) to execute report queries while an import model loads (copies) the source data into a columnar compressed in-memory data store. The implications of this decision significantly influence many factors of Power BI solutions, such as modifications to data source systems to support DirectQuery datasets and the configuration of scheduled refresh processes to support import mode datasets.</p>
<p class="calibre7">In this chapter, we will review the following topics:</p>
<ul class="calibre12">
<li class="calibre13">Dataset objectives</li>
<li class="calibre13">Views in Power BI Desktop</li>
<li class="calibre13">Fact table design</li>
<li class="calibre13">Relationships</li>
<li class="calibre13">Hierarchies</li>
<li class="calibre13">Custom sort orders</li>
<li class="calibre13">Bidirectional cross-filtering</li>
<li class="calibre13">Model metadata</li>
<li class="calibre13">Performance optimization</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-139">
<div id="calibre_link-623" class="calibre2">
<div id="calibre_link-624" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dataset layers</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As we saw in <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects,</em> and <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>, Power BI datasets are composed of three tightly integrated layers, all included within a Power BI Desktop file. The M Queries described in the <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M, </em>connect to data sources and optionally apply data cleansing and transformation processes to this source data to support the Data Model. The Data Model, the subject of this chapter, concerns the relationships defined between fact and dimension tables,<span> hierarchies of related columns, and metadata properties that define default behaviors, such as the sorting of column values. The final layer of datasets discussed in <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles,</em> <strong class="calibre6">Data Analysis Expressions</strong> (<strong class="calibre6">DAX</strong>) Measures, leverages the Data Model (and thus the M Queries) to deliver analytical insights for presentation in Power BI and other tools.</span></p>
<div class="packt_infobox">The term <em class="calibre16">Data Model</em> is often used instead of dataset, particularly in the context of Analysis Services. Both Azure Analysis Services models and <strong class="calibre6">SQL Server Analysis Services</strong> (<strong class="calibre6">SSAS</strong>) models created in Tabular mode include the same three layers of Power BI datasets. In other contexts, however, <em class="calibre16">Data Model</em> refers exclusively to the relationships, measures, and metadata, but not the source queries. For this reason, and given the use of the term datasets in the Power BI service, the term dataset (and <em class="calibre16">dataset designer</em>) is recommended.</div>
<p class="calibre7"><span>The following diagram summarizes the role of each of the three dataset layers:</span></p>
<div class="cdpalignleft"><img src="images/000033.png" class="calibre89" /></div>
<div class="mce-root2">Three layers of datasets</div>
<p class="calibre7">At the <strong class="calibre6">Data Model</strong> layer, all data integration and transformations should be complete. For example, it should not be necessary to define data types or create additional columns at the <strong class="calibre6">Data Model</strong> level. </p>
<div class="packt_tip pcalibre7 pcalibre6">Ensure that each layer of the dataset is being used for its intended role. For example, DAX Measures should not contain complex logic, so as to avoid unclean or inaccurate data. Likewise, DAX Measure expressions should not be limited by incorrect data types (for example, a number stored as text) or missing columns on the date table. Dataset designers and data source owners can work together to keep the analytical layers of datasets focused exclusively on analytics.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-140">
<div id="calibre_link-625" class="calibre2">
<div id="calibre_link-626" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dataset objectives</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For both Power BI projects and longer-term deployments, it's critical to distinguish Power BI datasets from Power BI reports and dashboards. Although Power BI Desktop is used to develop both datasets and reports, a Power BI dataset is an SSAS Data Model internally. Similar to an SSAS Data Model developed and maintained by IT, the intent of the Power BI dataset is to provide a simplified layer for reporting and analysis and to embed corporate-approved logic and security. Power BI reports, which are also saved as <kbd class="calibre15">.pbix</kbd> files, will only connect to the dataset and thus will exclusively leverage Power BI Desktop's visualization features, such as <span>Bookmarks</span> and <span>Slicer</span> visuals.</p>
<p class="calibre7">As per <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>, datasets and reports are also associated with unique technical and non-technical skills. A Power BI report developer, for example, should understand visualization standards, the essential logic and structure of the dataset, and how to distribute this content via Power BI Apps.</p>
<p class="calibre7">However, the report developer doesn't necessarily need to know any programming languages and can iterate very quickly on reports and dashboards. A Power BI dataset designer, conversely, must have a fundamental knowledge of DAX and is very well served by the M (Power Query) language and standard SQL. Additionally, the dataset designer is not able to iterate as quickly as the report developer given the technical dependencies within a dataset and the longer-term objectives for the dataset. </p>
<p class="calibre7">Given that the dataset serves as the bridge between data sources and analytical queries, it's important to proactively evaluate datasets relative to longer-term objectives. Large, consolidated datasets should be designed to support multiple teams and projects and to provide a standard version or definition of core metrics. Although organizations may enable business users to create datasets for specific use cases, corporate BI solutions should not utilize datasets like individual reports for projects or teams.</p>
<p class="calibre7">The following table summarizes the primary objectives of datasets and identifies the questions that can be used to evaluate a dataset in relation to each objective:</p>
<table class="calibre90">
<thead class="calibre91">
<tr class="calibre36">
<td class="calibre92">
<div class="cdpalignleft"><strong class="calibre6">Objective</strong></div>
</td>
<td class="calibre92">
<div class="cdpalignleft"><strong class="calibre6">Success criteria</strong></div>
</td>
</tr>
</thead>
<tbody class="calibre22">
<tr class="calibre93">
<td class="calibre24">
<p class="calibre94">User interface</p>
</td>
<td class="calibre24">
<p class="calibre94">How difficult is it for business users to build a report from scratch?<br class="calibre3" />
Are users able to easily find the measures and columns needed?</p>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<p class="calibre94">Version control</p>
</td>
<td class="calibre24">
<p class="calibre94">Do our measures align with an official, documented definition?<br class="calibre3" />
Are we reusing the same dimensions across multiple business processes?</p>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<p class="calibre94">Data security</p>
</td>
<td class="calibre24">
<p class="calibre94">Have we implemented and thoroughly tested <strong class="calibre6">Row-level security</strong> (<strong class="calibre6">RLS</strong>) roles?<br class="calibre3" />
Are we using <strong class="calibre6">Azure Activity Directory</strong> (<strong class="calibre6">AAD</strong>) security groups to implement security?</p>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<p class="calibre94">Performance</p>
</td>
<td class="calibre24">
<p class="calibre94">Are users able to interact with reports at the speed of thought?<br class="calibre3" />
Are our core DAX Measures efficient and utilizing all CPU cores available?</p>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<p class="calibre94">Scalability</p>
</td>
<td class="calibre24">
<p class="calibre94">Can the dataset support additional business processes and/or history?<br class="calibre3" />
Can the dataset support additional users and workloads?</p>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<p class="calibre94">Analytics</p>
</td>
<td class="calibre24">
<p class="calibre94">Does the dataset deliver advanced insights (out of the box)?<br class="calibre3" />
Are any local (report-level) measures or complex filters being used?</p>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<p class="calibre94">Availability</p>
</td>
<td class="calibre24">
<p class="calibre94">How confident are we in the data sources and data retrieval process?<br class="calibre3" />
Are there dependencies we can remove or potential errors we can trap?</p>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<p class="calibre94">Manageability</p>
</td>
<td class="calibre24">
<p class="cdpaligncenter">How difficult is it to implement changes or to troubleshoot issues?</p>
<p class="cdpaligncenter"><span>Can existing data transformation and analytical logic be consolidated?</span></p>
</td>
</tr>
</tbody>
</table>
<p class="calibre7">Several of the objectives are self-explanatory, but others, such as availability and manageability, are sometimes overlooked. For example, the same business logic may be built into many individual DAX Measures, making the dataset more difficult to maintain as requirements change. Additionally, there may be certain hardcoded dependencies within the M Queries that could cause a dataset refresh to fail. Dataset designers and BI teams must balance the needs to deliver business value quickly while not compromising the sustainability of the solution.</p>
<div class="packt_tip pcalibre7 pcalibre6">To simplify individual measures and improve manageability, common logic can be built into a small subset of hidden DAX Measures. The DAX Measures visible in the fields list can reference these hidden measures and thus will automatically update if any changes are necessary. This is very similar to parameters and data source staging queries in M per <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>. <span>Examples of centralizing DAX logic are provided later in this chapter within the <em class="calibre16">Parameters table</em> section.</span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-141">
<div id="calibre_link-627" class="calibre2">
<div id="calibre_link-628" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Competing objectives</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As a dataset is expanded to support more dimension and fact tables, advanced analytics, and more business users, it can be necessary to compromise certain objectives to deliver others. A common example of this is the implementation of date intelligence measures. For instance, five DAX Measures with their own date intelligence calculation (for example, <kbd class="calibre15">Year-to-Date</kbd>, <kbd class="calibre15">Prior Year-to-Date</kbd>), may be created for each existing measure thus causing a dataset with 20 measures to contain 120 measures. Since Power BI does not currently support display folders for measures, this can negatively impact the usability or user interface objective. Another example is the performance of complex DAX Measures relative to the scale of the dataset. Advanced, statistical calculations can be embedded in datasets but performance is limited by the size of the dataset and the volume of users that utilize this logic.</p>
<div class="packt_tip pcalibre7 pcalibre6">A method or work-around for providing the essential effect of measure-display folders can be achieved with parameter tables. Essentially, an empty table can be loaded to the model with a table name that describes a type of DAX Measure. DAX Measures can then be assigned to this table via the <span>Home Table</span> property. See the <em class="calibre16">Parameter tables</em> section for additional details. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-142">
<div id="calibre_link-629" class="calibre2">
<div id="calibre_link-630" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">External factors</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Just like any other database, a well-designed Power BI dataset can still fail to deliver its objectives due to external factors. For example, Power BI reports can be created that generate a wide and long table of many columns and many metrics. These data extracts and other dense visualizations that plot many different points are very resource-intensive relative to card- and summary-level chart visualizations. Additionally, even when the compression of an import mode dataset is maximized and the DAX Measures are efficient, there may be insufficient hardware resources available to support the given reporting workload. It's the responsibility of the Power BI admin, as described in <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>, and potentially any delegated capacity administrators to utilize the monitoring capabilities of Power BI and to provision the necessary resources to ensure sufficient performance.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-143">
<div id="calibre_link-631" class="calibre2">
<div id="calibre_link-632" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">The Data Model </h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The Data Model layer of the Power BI dataset consists of the Relationship View, the Data View, and the fields list exposed in the Report View. Each of the three views in Power BI Desktop is accessible via an icon in the top-left menu below the toolbar, although the Data View is exclusively available to import mode datasets. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-144">
<div id="calibre_link-633" class="calibre2">
<div id="calibre_link-634" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">The Relationships View</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The Relationships View provides the equivalent of a database diagram specific to the tables loaded to the model for the dataset. The relationship lines distinguish the one, or parent, table of each relationship from the many, or child, table. A solid line indicates that the relationship is active, while a dotted line denotes an inactive relationship that can only be activated via the <kbd class="calibre15">USERELATIONSHIP()</kbd> DAX expression. Additionally, the arrow icons on the relationship lines advise whether cross-filtering is single-directional (one arrow â one way) or bidirectional (two arrows).</p>
<p class="calibre7">In the following screenshot from the Relationships View, only the <kbd class="calibre15">Reseller</kbd> to <kbd class="calibre15">Reseller Sales</kbd> relationship is bidirectional and the relationships between all tables displayed are active:</p>
<div class="cdpalignleft"><img src="images/000247.png" class="calibre95" /></div>
<div class="mce-root2">Relationships View</div>
<p class="calibre7">Given the bidirectional cross-filtering relationship, a filter applied to the <kbd class="calibre15">Employee</kbd> table would filter the <kbd class="calibre15">Reseller Sales</kbd> table and then also filter the <kbd class="calibre15">Reseller</kbd> dimension table. Double-clicking a relationship line prompts the Edit Relationship dialog to optionally modify the columns defining the relationship, the cross-filtering behavior (single or bidirectional), and whether the relationship is active or passive. </p>
<div class="packt_infobox"><span>The bidirectional relationship between <kbd class="calibre43">Reseller</kbd> and <kbd class="calibre43">Reseller Sales</kbd> from this example is only intended to demonstrate the graphical representation of relationships in the Relationships View. Bidirectional relationships should only be applied in specific scenarios, as described in the <em class="calibre16">Bidirectional relationships</em> section later in this chapter.</span></div>
<p class="calibre7">A gray font indicates that the given column is not visible in the Report View. For certain tables that are only used for internal logic, such as bridge tables or measure support, the entire table will be grayed out and invisible to the Report View. Synonyms can only be accessed via the Relationships View and can serve to improve the accuracy of Power BI's Q &amp; A natural language queries by associating terms with tables, columns, and measures of the Data Model. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-145">
<div id="calibre_link-635" class="calibre2">
<div id="calibre_link-636" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">The Data View</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The Data View provides visibility to the imported rows for each table as well as important metadata, such as the count of rows and the distinct values for columns. In the following screenshot, the <kbd class="calibre15">Freight</kbd> column of the <kbd class="calibre15">Reseller Sales</kbd> table has been selected in the Data View, as indicated by the table icon on the far left:</p>
<div class="cdpalignleft"><img src="images/000053.png" class="calibre96" /></div>
<div class="mce-root2">Data View</div>
<p class="calibre7">Metadata of the column and/or table selected is displayed at the bottom of the Data View window. For example, selecting the <kbd class="calibre15">Freight</kbd> column per the preceding image results in a status message noting 53,207 rows for the <kbd class="calibre15">Reseller Sales</kbd> table and 1,394 distinct values for the <kbd class="calibre15">Freight</kbd> column. If only the table name is selected from the fields list, only the count of rows imported to the table is displayed at the bottom.</p>
<div class="packt_infobox">The count of rows, and particularly the count of distinct values in a column, is of critical importance to import mode datasets. Columns with many unique values, such as primary keys or highly precise numeric columns (that is, 3.123456), will consume much more memory. Additionally, as a columnar database, the columns with a larger memory footprint will also require more time to scan to resolve report queries. </div>
<p class="calibre7">DirectQuery datasets do not include Data View and thus common modeling features, such as setting the data format of columns and measures, can be accessed via the <span>Modeling</span> tab in the Report View. The dataset designer of a DirectQuery dataset would select the column or measure from the Fields list in the Report View and then access the relevant metadata property from the <span>Modeling</span> tab, such as <span>Data Category</span> and <span>Sort by Column</span>. The availability of Data View and its supporting metadata (for example, count of rows, discount count of values) is a modeling convenience of import mode datasets over DirectQuery datasets. In the absence of the Data View, DirectQuery modelers can use table report visuals on the Report View to sample or preview the values and formatting of columns and measures.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-146">
<div id="calibre_link-637" class="calibre2">
<div id="calibre_link-638" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">The Report View</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The Report View is primarily used for developing visualizations, but it also supports modeling features, such as the creation of user-defined hierarchies. In the following screenshot of a DirectQuery dataset, the <kbd class="calibre15">Customer City</kbd> column of the <kbd class="calibre15">Customer</kbd> table is selected from the fields list:</p>
<div class="cdpalignleft"><img src="images/000063.png" class="calibre97" /></div>
<div class="mce-root2">Modeling options in Report View</div>
<p class="calibre7">The <span>Data Category</span> and <span>Default Summarization</span> properties for the <kbd class="calibre15">Customer City</kbd> column have been set to <span>City</span> and <span>Don't summarize</span>, respectively. The <span>Modeling</span> tab of the Report View provides both import and DirectQuery datasets with access to all common modeling features, such as managing relationships, creating new DAX Measures, and accessing RLS roles.</p>
<div class="packt_infobox"><span>Note that the <span>New Table</span> option is grayed out for DirectQuery datasets since DAX-calculated tables are exclusively able to import models. However, as explained in both the chapters <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em></span> and<span><em class="calibre16"> </em><a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>, DAX-calculated columns and tables should be rarely used. M queries, SQL views, and data warehouse objects are almost always preferable alternatives to support the needed columns and tables. </span></div>
<p class="calibre7">In terms of data modeling, the Relationships View and the following <span>Manage relationships</span> dialog are the most fundamental interfaces as these definitions impact the behavior of DAX Measures and report queries:</p>
<div class="cdpalignleft"><img src="images/000073.png" class="calibre98" /></div>
<div class="mce-root2">Manage relationships dialog</div>
<p class="calibre7">Relationships can be created, edited, and deleted from the <span>Manage relationships</span> dialog. For larger models with many tables and relationships, the dataset designer can utilize both the Manage relationships dialog and the Relationships View. </p>
<div class="packt_tip pcalibre7 pcalibre6"><strong class="calibre6">Dynamic Management Views</strong> (<strong class="calibre6">DMVs</strong>), such as <kbd class="calibre43">TMSCHEMA_RELATIONSHIPS</kbd>, can be used to analyze Power BI datasets, just as they're used with other SQL Server products. To get started, simply open the DAX Studio application while the Power BI Desktop (PBIX) file is open and connect to the running dataset. You can then query the DMVs (that is, <kbd class="calibre43">select * from $SYSTEM.TMSCHEMA_RELATIONSHIPS</kbd>). For longer-term projects, it can be worthwhile to create a Power BI dataset that exclusively retrieves from DMVs data and supports updated documentation reports, such as the tables, columns, and measure definitions included in a dataset. An example of this is included in the <em class="calibre16">Microsoft Power BI</em> <em class="calibre16">Cookbook</em> (<a href="https://www.packtpub.com/big-data-and-business-intelligence/microsoft-power-bi-cookbook" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://www. packtpub.com/big-data-and-businessintelligence/microsoft-power-bi-cookbook</a>). </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-147">
<div id="calibre_link-639" class="calibre2">
<div id="calibre_link-640" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Fact tables</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">There are three fact tables for this dataset&mdash;<kbd class="calibre15">Internet Sales</kbd>, <kbd class="calibre15">Reseller Sales</kbd>, and the <kbd class="calibre15">Sales and Margin Plan</kbd>. The ability to analyze and filter two or all three of these tables concurrently via common dimensions, such as <kbd class="calibre15">Date</kbd>, <kbd class="calibre15">Product</kbd>, and <kbd class="calibre15">Sales Territory</kbd>, is what gives this dataset its analytical value to the business. A Power BI report, which is always connected to a single dataset, could contain visualizations comparing total <kbd class="calibre15">Adventure Works Sales</kbd> (<kbd class="calibre15">Internet Sales</kbd> plus <kbd class="calibre15">Reseller Sales</kbd>) to the overall <kbd class="calibre15">Sales and Margin Plan</kbd>. This same report could also include detailed visualizations that explain higher-level outcomes, such as the growth in online customers or changes in the <kbd class="calibre15">Reseller Sales</kbd> margin rates:</p>
<div class="cdpalignleft"><img src="images/000094.png" class="calibre99" /></div>
<div class="mce-root2">Data Warehouse Bus Matrix</div>
<p class="calibre7">Each checkmark symbol represents the existence of a relationship implemented either directly between the fact and dimension tables in the Data Model or, in the case of the <kbd class="calibre15">Sales and Margin Plan</kbd>, via bridge tables. See <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects, </em>for more details on the Data Warehouse Bus Matrix.</p>
<div class="packt_infobox">The <kbd class="calibre43">Sales and Margin Plan</kbd> is at a lower grain than the <kbd class="calibre43">Internet Sales</kbd> and <kbd class="calibre43">Reseller Sales</kbd> fact tables and thus cannot be filtered directly by columns such as <kbd class="calibre43">Product Name</kbd>. For the <kbd class="calibre43">Sales and Margin Plan</kbd> fact table, an alternative model design, including bridge tables and conditional DAX Measures, is used to support cross-filtering from the Product, Sales Territory, and Date dimension tables. See the <em class="calibre16">Bridge tables</em> section later in this chapter for more details.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-148">
<div id="calibre_link-641" class="calibre2">
<div id="calibre_link-642" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Fact table columns</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>Fact tables should only contain columns that are needed for relationships to dimension tables and numeric columns that are referenced by DAX Measures. In some models, an additional column that isn't modeled in a dimension table and is needed for analysis, such as <kbd class="calibre15">Sales Order Number</kbd>, may also be included in a fact table.</span></p>
<p class="calibre7"><span>Given their size and central role in the dataset, fact tables receive much greater analysis to deliver optimal performance and scalability.</span></p>
<p class="calibre7"><span>In the following T-SQL query of the <kbd class="calibre15">Reseller Sales</kbd> source fact table, columns are computed that produce the same values as the <kbd class="calibre15">ExtendedAmount</kbd>, <kbd class="calibre15">SalesAmount</kbd>, and <kbd class="calibre15">TotalProductCost</kbd> columns:</span></p>
<div class="cdpalignleft"><img src="images/000084.png" class="calibre100" /></div>
<div class="mce-root2">Reseller Sales fact column logic</div>
<p class="calibre7">Only the <kbd class="calibre15">UnitPrice</kbd>, <kbd class="calibre15">OrderQuantity</kbd>, <kbd class="calibre15">DiscountAmount</kbd>, and <kbd class="calibre15">ProductStandardCost</kbd> columns are needed for the import mode dataset since DAX Measures can be written to embed the necessary logic (for example, <kbd class="calibre15">UnitPrice</kbd> * <kbd class="calibre15">OrderQuantity</kbd>) for the <kbd class="calibre15">ExtendedAmount</kbd>, <kbd class="calibre15">SalesAmount</kbd>, and <kbd class="calibre15">TotalProductCost</kbd> columns. <span>By not importing these columns to the Data Model, a significant amount of data storage is saved and query performance is not compromised. Columns with few unique values, such as <kbd class="calibre15">OrderQuantity</kbd>, can be highly compressed by import mode datasets and thus are lightweight to store and fast to scan to resolve report queries. </span></p>
<div class="packt_infobox"><span>The same three columns can also be removed from the <kbd class="calibre43">Internet Sales</kbd> fact table. The </span><kbd class="calibre43">SUMX()</kbd><span> function will be used in the DAX Measures and only reference the source columns (<kbd class="calibre43">OrderQuantity</kbd>, <kbd class="calibre43">UnitPrice</kbd>, and <kbd class="calibre43">ProductStandardCost</kbd>).<br class="calibre3" />
<br class="calibre3" />
The $0.04 difference between the sum of the <kbd class="calibre43">Sales Amount</kbd> column and the <kbd class="calibre43">Sales Amount Calc</kbd> expression is caused by the <kbd class="calibre43">DiscountAmount</kbd> column being stored as a float (approximate) data type. In almost every scenario, a variance this small ($.04 out of $80.4 M) is acceptable to obtain the scalability benefit of not importing a fact table column.<br class="calibre3" /></span></div>
<p class="calibre7"><span>If the SQL View for the fact table is exclusively utilized by this dataset, then the three columns can be removed there. If the SQL View cannot be modified, then the three columns can be removed via the M Query for the fact table, as shown in the following screenshot: </span></p>
<div class="cdpalignleft"><img src="images/000116.png" class="calibre101" /></div>
<div class="mce-root2">Fact table columns excluded from the dataset </div>
<p class="calibre7">As shown in the previous screenshot, the <kbd class="calibre15">Table.RemoveColumns()</kbd> function excludes three columns from the source SQL View, as these columns only represent derived values from other columns that are included in the query. Therefore, for an import mode dataset, DAX Measures can be written to efficiently implement these simple calculations via the source columns, such as <kbd class="calibre15">Unit Price</kbd> and <kbd class="calibre15">Order Quantity</kbd>. However, for a DirectQuery dataset, these derived <span>columns (for example, <kbd class="calibre15">Total Product Cost</kbd>) would not be removed due to the performance advantage of the <kbd class="calibre15">SUM()</kbd> SQL expressions referencing individual columns. The following chapter contains</span><span> details on implementing these DAX measures and other measure expressions. </span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-149">
<div id="calibre_link-643" class="calibre2">
<div id="calibre_link-644" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Fact column data types</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">It's essential that the numeric columns of fact tables are assigned to the appropriate data types. All integer columns, such as <kbd class="calibre15">Order Quantity</kbd>, should be stored as a whole number data type, and decimal numbers will be stored as either fixed decimal numbers or as decimal numbers. If four decimal places is sufficient precision, a <span>Fixed decimal number</span> type should be used to avoid rounding errors and the additional storage and performance costs of the decimal number type.</p>
<p class="calibre7">In the following screenshot, the <kbd class="calibre15">Freight</kbd> column is stored as a <span>Fixed decimal number</span> type and, thus, despite a format of six decimal places, only four significant digits are displayed to the right of the decimal place: </p>
<div class="cdpalignleft"><img src="images/000126.png" class="calibre102" /></div>
<div class="mce-root2">Fixed decimal number data type</div>
<p class="calibre7">Dataset designers should check the numeric columns of fact tables and ensure that the appropriate data type has been assigned for each column. For example, certain scientific columns may require the deep precision available for decimal number types (15 significant digits), while accounting or financial columns generally need to be exact and thus the internal (19, 4) data type of a <span>Fixed decimal number</span> type is appropriate. Note that the result of aggregated expressions against this fixed decimal column will be a number of the same type and, therefore, to avoid overflow calculation errors, will also need to fit the (19, 4) data type. The <em class="calibre16">Data types</em> section in <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em> provides details on the relationship between M data types and data types in the Data Model, as well as the function for converting column types in M Queries. </p>
<p class="calibre7"><span>The Data View from the <span>Fixed decimal number</span> data type image is not available for DirectQuery datasets. For DirectQuery datasets, the data types of columns should be set and managed at the data source table level such that Power BI only reflects these types. Revising data types during report query execution, either via SQL views in the data source or the M Queries in Power BI, can significantly degrade the performance of DirectQuery datasets.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-150">
<div id="calibre_link-645" class="calibre2">
<div id="calibre_link-646" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Fact-to-dimension relationships</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">To create the Data Model relationships identified in the Data Warehouse Bus Matrix image:</p>
<ol class="calibre12">
<li class="chapter">Click <span>Manage Relationships</span> from the <span>Modeling</span> tab in Report View.</li>
<li class="chapter">From the <span>Manage Relationships</span> dialog, click the <span>New</span> command button at the bottom to open the <span>Create relationship</span> interface. Choose the fact table, such as <kbd class="calibre15">Internet Sales</kbd>, for the top table via the dropdown and then select the dimension table as shown in the following screenshot:</li>
</ol>
<div class="cdpalignleft"><img src="images/000136.png" class="calibre103" /></div>
<div class="mce-root2">Creating a relationship for the import mode dataset</div>
<p class="calibre7">If the relationship columns have the same name, such as <kbd class="calibre15">Currency Key</kbd> in this example, Power BI will automatically select the columns to define the relationship. Almost all relationships will follow this <span>Many to one(*:1)</span> or fact-to-dimension pattern with the <span>Cross-filter direction</span> property set to <span>Single</span> and the relationship set to active.</p>
<p class="calibre7">The two columns used for defining each relationship should be of the same data type. In most relationships, both columns will be of the whole number data type as only a numeric value can be used with slowly changing dimensions. For example, a <kbd class="calibre15">Product Key</kbd> column could use the values 12, 17, and 27 to represent three time periods for a single product as certain attributes of the product changed over time.</p>
<div class="packt_infobox"><span>Prior to the <span>Mark as Date Table</span> feature described in the previous chapter, a date column stored as a date data type was used for relationships in Power BI datasets as this enables the time intelligence functions of DAX to work correctly. Given this feature, however, whole number (integer) columns stored in YYYYMMDD format (for example, 20180225 for February 25th, 2018) can be used for fact-to-date table relationships in Power BI datasets. Details on utilizing this feature and other considerations for date dimension tables are included within the <em class="calibre16">SQL views</em> section of <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>.</span></div>
<p class="calibre7">As more relationships are created, it can be helpful to switch to the Relationships view and move or organize the dimension tables around the fact table. Relationships view can make it clear when additional relationships need to be defined and can be useful in explaining the model to report authors and users.</p>
<p class="calibre7">Click <span>OK</span> to create the relationship and repeat this process to build the planned star schema relationships for both the <kbd class="calibre15">Internet Sales</kbd> and <kbd class="calibre15">Reseller Sales</kbd> fact tables, as shown in the following screenshot of <kbd class="calibre15">Internet Sales</kbd>:</p>
<div class="cdpalignleft"><img src="images/000146.png" class="calibre104" /></div>
<div class="mce-root2">Internet Sales relationships</div>
<p class="calibre7">All relationships from <kbd class="calibre15">Internet Sales</kbd> to a dimension table are active (solid line) except for two additional relationships to the Date dimension table. In this dataset, the <kbd class="calibre15">Order Date</kbd> is used as the active relationship, but two additional inactive (dotted line) relationships are created based on the <kbd class="calibre15">Due Date</kbd> and <kbd class="calibre15">Ship Date</kbd> columns of the fact table. DAX Measures can be created to invoke these alternative relationships via the <kbd class="calibre15">USERELATIONSHIP()</kbd> DAX function, as shown in the following example:</p>
<pre class="calibre19"><strong class="calibre6">Internet Net Sales (Due Date)</strong> = <br class="calibre3" />CALCULATE([Internet Net Sales], USERELATIONSHIP('Internet Sales'[Due Date Key],'Date'[Date Key]))<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Net Sales (Ship Date)</strong> = <br class="calibre3" />CALCULATE([Internet Net Sales],USERELATIONSHIP('Internet Sales'[Ship Date Key],'Date'[Date Key]))</pre>
<p class="calibre7">The inactive relationships and their corresponding measures enable report visualizations based on a single-date dimension table, such as in the following table:</p>
<div class="cdpalignleft"><img src="images/000166.png" class="calibre105" /></div>
<div class="mce-root2">Measures with active and inactive relationships </div>
<p class="calibre7">In this scenario, the <kbd class="calibre15">Internet Net Sales</kbd> measure uses the active relationship based on <kbd class="calibre15">Order Date</kbd> by default, but the other measures override this relationship via the <kbd class="calibre15">CALCULATE()</kbd> and <kbd class="calibre15">USERELATIONSHIP()</kbd> functions.</p>
<div class="packt_infobox">A common alternative approach to inactive relationships is to load additional date dimension tables and create active relationships for each additional date column on the fact table (for example,<span> <kbd class="calibre43">Due Date</kbd>, <kbd class="calibre43">Ship Date</kbd>)</span> to these tables. The columns for these additional date tables can be named to avoid confusion with other date columns (for example, <kbd class="calibre43">Ship Date Calendar Year</kbd>) and some teams or organizations are more comfortable with table relationships than DAX Measures. Additionally, this design allows for intuitive matrix-style visualizations with two separate date dimensions (<kbd class="calibre43">Ship Date</kbd>, <kbd class="calibre43">Order Date</kbd>) on the <em class="calibre16">x</em> and <em class="calibre16">y</em> axis filtering a single measure via active relationships.</div>
<p class="calibre7">For DirectQuery datasets, the <span>Assume referential integrity</span> relationship property is critical for performance as this determines whether inner- or outer-join SQL statements are generated to resolve report queries. When enabled, as shown in the following screenshot, inner-join SQL queries will be passed to the source system when report queries require columns or logic from both tables of the relationship:</p>
<div class="cdpalignleft"><img src="images/000156.png" class="calibre106" /></div>
<div class="mce-root2">Assume referential integrity</div>
<p class="calibre7">If <span>Assume referential integrity</span> is not enabled, outer-join SQL queries will be generated to ensure that all necessary rows from the fact table or many sides of the relationship are retrieved to resolve the report query. The query optimizers within supported DirectQuery sources, such as SQL Server and Oracle, are able to produce much more efficient query execution plans when presented with inner-join SQL statements. Of course, improved performance is of no value if the outer join is necessary to return the correct results, thus it's essential for referential integrity violations in the source system to be addressed.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-151">
<div id="calibre_link-647" class="calibre2">
<div id="calibre_link-648" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dimension tables</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The columns of dimension tables give the measures from the fact tables context, such as <kbd class="calibre15">Internet Net Sales</kbd> by sales territory country and calendar year. More advanced dimension columns, such as the <kbd class="calibre15">Customer History Segment</kbd> column, described in <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M,</em> can instantly give report visualizations meaning and insight. In addition to their application within report visuals, such as the date axis of charts, dimension columns are frequently used to set the filter conditions of a report, a report page, or a specific visual of a report page. By default, Power BI lists dimension tables alphabetically in the fields list and also lists column names of tables alphabetically.</p>
<p class="calibre7">Just as dataset designers must ensure that all common DAX Measures are included in the dataset, dataset designers must also ensure that the necessary dimension columns are available to group, filter, and generally interact with the dataset. Two of the top usability features for dimension tables include hierarchies and custom sorting. When implemented, these features enable users to explore datasets more easily, such as drilling up, down, and through the columns of a hierarchy. Additionally, the sort by column feature serves to generate logical report layouts, such as the months of the year from January through December.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-152">
<div id="calibre_link-649" class="calibre2">
<div id="calibre_link-650" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Hierarchies</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">To create a hierarchy, select the column in the Fields list that will represent the top level of the hierarchy and use the ellipsis or right-click the menu to select the <span>New hierarchy</span> option, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000186.png" class="calibre107" /></div>
<div class="mce-root2">Creating a hierarchy</div>
<p class="calibre7">In this example, the <kbd class="calibre15">Product Category Group</kbd> column is the top level of the hierarchy and <kbd class="calibre15">Product Category</kbd> will be its child or lower level. Likewise, the <kbd class="calibre15">Product Subcategory</kbd> column will be a child of <kbd class="calibre15">Product Category</kbd> and the <kbd class="calibre15">Product Name</kbd> column will be the lowest level of the hierarchy under <kbd class="calibre15">Product Subcategory</kbd>. To add columns to the hierarchy, click the ellipsis next to the given column or use the right-click context menu to choose the <span>Add to hierarchy</span> option. Alternatively, the child columns can be dragged and dropped onto the name of the hierarchy by holding down the left mouse button when selecting the column. The levels of the columns can also be adjusted from within the hierarchy by dragging and dropping column names.</p>
<div class="packt_infobox">Dimension<span> tables often contain hierarchical data, such as dates (year, quarter, month, week, day) and geographies (country, state/province, city, zip code). As shown in the example of the date dimension in the previous chapter (see the </span><em class="calibre16">Date dimension view</em><span> section), natural date hierarchies in which each column value has only one parent (for example, 2017-Sep) are strongly recommended. Unnatural date hierarchies can be confusing in reports as it isn't clear which parent value (2015, 2016, 2017?) a given child value, such as September, belongs to.</span></div>
<p class="calibre7">Once the hierarchy is created, a single click of the hierarchy name in the fields list adds all the columns and their respective levels to the report visualization. In the following screenshot, all four columns of the <kbd class="calibre15">Product Hierarchy</kbd> are added to the <span>Axis</span> of a column chart to support drilling and interactive filter behavior in Power BI:</p>
<div class="cdpalignleft"><img src="images/000196.png" class="calibre108" /></div>
<div class="mce-root2">Hierarchy in Report Visual</div>
<p class="calibre7">Certain columns or levels of the hierarchy can optionally be removed from the specific visual. For example, if the report developer only wishes to include <kbd class="calibre15">Product Category</kbd> and <kbd class="calibre15">Product Subcategory</kbd> in a particular visual, the other two columns can be removed from the <span>Axis</span> field well via the delete (X) icons.</p>
<div class="packt_tip pcalibre7 pcalibre6">The DAX language includes a set of parent and child functions, such as <kbd class="calibre43">PATH()</kbd> and <kbd class="calibre43">PATHITEM()</kbd>, that can be used to create hierarchy columns when a dimension table contains a <kbd class="calibre43">Parent Key</kbd> column. Common examples of this include an organizational structure with multiple levels of management or a chart of financial accounts. Creating these columns via DAX functions is one of the few examples when DAX-calculated columns may be preferable to other alternatives. A detailed example of parent and child functions was included in Chapter 3 of the <em class="calibre16"><a href="https://www.packtpub.com/big-data-and-business-intelligence/microsoft-power-bi-cookbook" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Microsoft Power BI Cookbook</a> </em>by <em class="calibre16">Packt Publishing</em>. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-153">
<div id="calibre_link-651" class="calibre2">
<div id="calibre_link-652" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Custom sort</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Most dimension columns used in reports contain text values, and, by default, Power BI sorts these values alphabetically. To ensure these columns follow their logical order (for example, Jan, Feb, Mar) in report visualizations, it's necessary to store a corresponding column in the same dimension table and at the same granularity. For example, in addition to a <span>Calendar Month</span> column that contains the 12 text values for the names of the months, a <span>Calendar Month Number</span> column is included in the date dimension with the value of 1 for every row with the January value for <span>Calendar Month,</span> and so forth. </p>
<p class="calibre7">To set a custom sort order for a column, select the column in the fields list in Report View and then click the dropdown for the <span>Sort By Column</span> icon under the <span>Modeling</span> tab. Choose the supporting column that contains the integer values, such as <span>Calendar Month Number</span>, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000207.png" width="339" height="152" class="calibre109" /> </div>
<div class="mce-root2">Sort by Column</div>
<p class="calibre7">Most columns used as a <span>Sort by Column</span> are not needed for report visualizations and can be hidden from the fields list. Per the <em class="calibre16">Date Dimension View</em> section in <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>, sequentially increasing integer columns are recommended for natural hierarchy columns, such as <kbd class="calibre15">Calendar Yr-Mo</kbd>, as these columns can support both logical sorting and date intelligence calculations. </p>
<p class="calibre7">Although the <span>Calendar Month</span> and weekday columns are the most common examples for custom sorting, other dimension tables may also require hidden columns to support a custom or logical sort order. In the following example, an integer column is added to the Customer dimension M Query to support the logical sort order of the <kbd class="calibre15">Customer History Segment</kbd> column:</p>
<pre class="calibre19"><strong class="calibre6">                              /*Preceding M query variables not included*/</strong><br class="calibre3" />//Customer History Segment Column<br class="calibre3" />    CustomerHistoryColumn = Table.AddColumn(Customer, "Customer History Segment", each<br class="calibre3" />    if [Customer First Purchase Date] &gt;= OneYearAgo then "First Year Customer" <br class="calibre3" />    else if [Customer First Purchase Date] &gt;= TwoYearsAgo and [Customer First Purchase Date] &lt; OneYearAgo then "Second Year Customer"<br class="calibre3" />    else if [Customer First Purchase Date] &gt;= ThreeYearsAgo and [Customer First Purchase Date] &lt; TwoYearsAgo then "Third Year Customer" <br class="calibre3" />else "Legacy Customer", type text),<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">//Customer History Segment Column Sort</strong><br class="calibre3" /><strong class="calibre6">    CustomerHistColSort = Table.AddColumn(CustomerHistoryColumn, "Customer History Segment Sort", each </strong><br class="calibre3" /><strong class="calibre6">    if [Customer First Purchase Date] &gt;= OneYearAgo then 1 </strong><br class="calibre3" /><strong class="calibre6">    else if [Customer First Purchase Date] &gt;= TwoYearsAgo and [Customer First Purchase Date] &lt; OneYearAgo then 2</strong><br class="calibre3" /><strong class="calibre6">    else if [Customer First Purchase Date] &gt;= ThreeYearsAgo and [Customer First Purchase Date] &lt; TwoYearsAgo then 3 else 4, Int64.Type)</strong><br class="calibre3" />in<br class="calibre3" />    CustomerHistColSort</pre>
<p class="calibre7">With the integer column (<kbd class="calibre15">Customer History Segment Sort</kbd>) added to the Customer dimension table and the <span>Sort by Column</span> property of the <kbd class="calibre15">Customer History Segment</kbd> column set to reference this column, Power BI reports visualize the <kbd class="calibre15">Customer History Segment</kbd> column by the logical order of the four possible values (<kbd class="calibre15">First Year Customer</kbd>, <kbd class="calibre15">Second Year Customer</kbd>, <kbd class="calibre15">Third Year Customer</kbd>, and <kbd class="calibre15">Legacy Customer</kbd>) by default. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-154">
<div id="calibre_link-653" class="calibre2">
<div id="calibre_link-654" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Bridge tables</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For this dataset, bridge tables are used to link three dimension tables (<kbd class="calibre15">Sales Territory</kbd>, <kbd class="calibre15">Product</kbd>, and <kbd class="calibre15">Date</kbd>) to the <kbd class="calibre15">Sales and Margin Plan</kbd> fact table. As shown in the following <span>screenshot</span> from the Relationships View, the bridge tables are hidden from the fields list in the Report View (gray shading) and bidirectional cross-filtering is enabled between the dimension and bridge tables: </p>
<div class="cdpalignleft"><img src="images/000217.png" class="calibre110" /></div>
<div class="mce-root2">Bridge tables hidden from the Report View</div>
<p class="calibre7"><span>The bidirectional relationships enable filter selections on the three dimension tables (<kbd class="calibre15">Sales Territory</kbd>, <kbd class="calibre15">Product</kbd>, and <kbd class="calibre15">Date</kbd>) to impact the <kbd class="calibre15">Sales and Margin Plan</kbd> fact table as well as the <kbd class="calibre15">Internet Sales</kbd> and <kbd class="calibre15">Reseller Sales</kbd> fact tables. Given the higher granularity of the dimension tables relative to the <kbd class="calibre15">Sales and Margin Plan</kbd> (for example, individual dates versus months), the bridge tables with distinct values (the one side) and bidirectional cross-filtering support the core requirement of analyzing historical sales data (<kbd class="calibre15">Internet</kbd> and <kbd class="calibre15">Reseller Sales</kbd>) versus the <kbd class="calibre15">Sales and Margin Plan</kbd>. </span></p>
<p class="calibre7"><span>As described in the <em class="calibre16">Bridge Tables Queries</em> section of <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>, a <kbd class="calibre15">Table.Distinct()</kbd> M function can be used against the column from the given dimension table query that aligns with the granularity of the <kbd class="calibre15">Sales and Margin Plan</kbd> table.</span></p>
<p class="calibre7"><span>For example, the <kbd class="calibre15">Sales and Margin Plan</kbd> fact table contains rows per <kbd class="calibre15">Product Subcategory</kbd>, thus the <kbd class="calibre15">Product Subcategory</kbd> bridge table contains one row for each unique <kbd class="calibre15">Product Subcategory</kbd> value via the following M expression: </span></p>
<pre class="calibre19">let<br class="calibre3" />    SubCats = Table.SelectColumns(Product, {"Product Subcategory"}),<br class="calibre3" />    DistinctSubCats = Table.Distinct(SubCats)<br class="calibre3" />in <br class="calibre3" />    DistinctSubCats</pre>
<p class="calibre7">The existing M Query for the Product dimension table, which references the data source staging query (<kbd class="calibre15">AdWorksSQLServer</kbd>) and the SQL view of the dimension (<kbd class="calibre15">BI.vDim_Product</kbd>), is leveraged by the bridge table query. The M Queries for the bridge tables generate simple SQL statements ("<kbd class="calibre15">Select Distinct</kbd>..") for execution by the source system. Additionally, with the <span>Include in report refresh</span> query property set to true, any new dimension values are automatically retrieved into the dataset. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-155">
<div id="calibre_link-655" class="calibre2">
<div id="calibre_link-656" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Parameter tables</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Unlike the bridge tables, there are no relationships between the four parameter tables and any other tables in the model, as shown in the following <span>screenshot</span> from the Relationships View:</p>
<div class="cdpalignleft"><img src="images/000227.png" class="calibre111" /></div>
<div class="mce-root2">Parameter tables</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-156">
<div id="calibre_link-657" class="calibre2">
<div id="calibre_link-658" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Measure groups</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The <kbd class="calibre15">Date Intelligence</kbd> and <kbd class="calibre15">Adventure Works Sales</kbd> tables only serve to provide an intuitive name for users to find related DAX Measures. For example, several of the most important DAX Measures of the dataset will include both <kbd class="calibre15">Internet Sales</kbd> and <kbd class="calibre15">Reseller Sales</kbd>. It wouldn't make sense for these consolidated measures, such as Total Net Sales, to be found under the <kbd class="calibre15">Internet Sales</kbd> or <kbd class="calibre15">Reseller Sales</kbd> fact tables in the field list. For similar usability reasons, the <kbd class="calibre15">Date Intelligence Metrics</kbd> provides an intuitive name for users and report developers to find measures, such as year-to-date, prior year-to-date, and year-over-year growth. The two parameter tables, <kbd class="calibre15">Date Intelligence Metrics</kbd> and <kbd class="calibre15">Adventure Works Sales</kbd>, effectively serve as display folders, as shown in the following screenshot of the Fields list from the Report View:</p>
<div class="cdpalignleft"><img src="images/000237.png" class="calibre112" /></div>
<div class="mce-root2">Fields list with parameter tables</div>
<p class="calibre7">To obtain the calculator symbol icon in the fields list, all columns have to be hidden from the Report View and at least one DAX Measure must reference the table in its <span>Home Table</span> property. Once these two conditions are met, the show/hide pane arrow of the fields list highlighted in the image can be clicked to refresh the fields list.</p>
<p class="calibre7">In this example, the <kbd class="calibre15">Adventure Works Sales</kbd> and <kbd class="calibre15">Date Intelligence Metrics</kbd> tables both contain only a single column (named Dummy) that can be hidden via the right-click context menu accessible in the Relationships View, the fields list of Report View, and for import datasets the Data View as well.</p>
<p class="calibre7">The columns of the three fact tables (<kbd class="calibre15">Internet Sales</kbd>, <kbd class="calibre15">Reseller Sales</kbd>, and <kbd class="calibre15">Sales and Margin Plan</kbd>) are also hidden to provide users with an intuitive display of groups of measures at the top of the fields list followed by dimensions and their hierarchies. </p>
<p class="calibre7">The <span>Home Table</span> for a measure can be set by selecting it from the fields list and choosing a table from the <span>Home Table</span> dropdown on the <span>Modeling</span> tab in the Report View. As shown in the following screenshot, the <kbd class="calibre15">Internet Net Sales (PY YTD)</kbd> measure is selected and <kbd class="calibre15">Date Intelligence Metrics</kbd> is configured as its home table:</p>
<div class="cdpalignleft"><img src="images/000248.png" class="calibre113" /></div>
<div class="mce-root2">Home Table property for DAX Measures</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-157">
<div id="calibre_link-659" class="calibre2">
<div id="calibre_link-660" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Last refreshed date</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The <kbd class="calibre15">CurrentDate</kbd> table, as described in the <em class="calibre16">Data Source Parameters</em><span><br class="calibre3" /></span> section of <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <span>Connecting to Sources and Transforming Data with M</span>, contains only one column and one row, representing the date at the time the source M Query was executed. With this date value computed with each dataset refresh and loaded into the Data Model, a DAX Measure can be written to expose the date to the Power BI report visuals. In the following screenshot from the Report View, a measure named <kbd class="calibre15">Last Refresh Msg</kbd> uses a DAX variable to reference the parameter table and then passes this variable to a text string: </p>
<div class="cdpalignleft"><img src="images/000258.png" class="calibre114" /></div>
<div class="mce-root2">Last refreshed message via the parameter table</div>
<p class="calibre7">It's common to include a last refreshed text message on at least one report page of every published report. In the event the source dataset has failed to refresh for several days or longer, the text message will advise users of the issue. See <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em> for more information on DAX variables. </p>
<p class="calibre7"><span>For DirectQuery datasets, the M Query for the <kbd class="calibre15">CurrentDate</kbd> parameter table uses standard SQL syntax within the <kbd class="calibre15">Value.NativeQuery()</kbd> function, such as the following:</span></p>
<pre class="calibre19">let Source = AdWorksSQLServer,<br class="calibre3" />    View =   Value.NativeQuery(Source, "Select CAST(Current_Timestamp as date) as [CurrentDate]")<br class="calibre3" />in  View</pre>
<p class="calibre7">The <kbd class="calibre15">Source</kbd> variable references the <kbd class="calibre15">AdWorksSQLServer</kbd> staging query, as described in the previous chapter. The <em class="calibre16">Data Source Parameters</em> section of <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <span>Connecting to Sources and Transforming Data with M</span>, contains the M Query for the <kbd class="calibre15">CurrentDate</kbd> parameter table in the import mode datasets. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-3">
<div id="calibre_link-661" class="calibre2">
<div id="calibre_link-662" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Measure support logic</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The purpose of the Measure Support table is to centralize DAX expressions that can be reused by other measures. Since DAX variables are limited to the scope of individual measures, a set of hidden, intermediate measures avoids the need to declare variables for each measure. The intermediate, or branching, DAX measure expressions also make it easy and less error-prone to implement a change as all dependent DAX measures will be updated automatically. In this way, the Measure Support table serves a similar function to the parameter and staging query expressions, described in the previous chapter, for M Queries.</p>
<p class="calibre7">For this dataset, DAX expressions containing the <kbd class="calibre15">ISFILTERED()</kbd> and <kbd class="calibre15">ISCROSSFILTERED()</kbd> functions can be used to determine the granularity of the filter context for the <kbd class="calibre15">Product</kbd>, <kbd class="calibre15">Sales Territory</kbd>, and <kbd class="calibre15">Date</kbd> dimension tables. If the user or report developer has applied a filter at a granularity not supported by the <kbd class="calibre15">Sales and Margin Plan</kbd> fact table, such as an individual product or date, a blank should be returned to avoid confusion and incorrect actual versus plan comparisons. The following DAX Measure tests the filter context of the <kbd class="calibre15">Date</kbd> dimension table and returns one of two possible text values&mdash;<kbd class="calibre15">Plan Grain</kbd> or <kbd class="calibre15">Actual Grain</kbd>:</p>
<pre class="calibre19"><strong class="calibre6">Date Grain Plan Filter Test =</strong> SWITCH(TRUE(),<br class="calibre3" />  NOT(ISCROSSFILTERED('Date')),"Plan Grain",<br class="calibre3" />  ISFILTERED('Date'[Calendar Week in Year]) || ISFILTERED('Date'[Date]) || ISFILTERED('Date'[Weekday]) ||ISFILTERED('Date'[Calendar Yr-Wk]), "Actual Grain", "Plan Grain")</pre>
<p class="calibre7">Similar filter test measures can be created for the <kbd class="calibre15">Sales Territory</kbd> and <kbd class="calibre15">Product</kbd> dimension tables. All three measures should be hidden from the Report View, and the <span>Home Table</span> property should be set to <span>Measure Support</span>. Once these dimension-specific measures have been defined, a final support measure can integrate their results, as shown in the following example:</p>
<pre class="calibre19"><strong class="calibre6">Plan Grain Status =</strong> IF([Date Grain Plan Filter Test] = "Plan Grain" &amp;&amp; [Product Grain Plan Filter Test] = "Plan Grain" &amp;&amp; [Sales Territory Grain Plan Filter Test] = "Plan Grain", "Plan Grain", "Actual Grain")</pre>
<p class="calibre7">Given the logic built into the four hidden measure support expressions, DAX Measures can reference the results and deliver the intended conditional behavior in report visualizations, as shown in the following example of a variance-to-plan measure:</p>
<pre class="calibre19"><strong class="calibre6">Internet Net Sales Var to Plan =</strong> IF([Plan Grain Status] = "Actual Grain",BLANK(),<br class="calibre3" />[Internet Net Sales] - [Internet Net Sales Plan Amt])</pre>
<p class="calibre7">In the following report, the <kbd class="calibre15">Internet Net Sales Plan</kbd> and <kbd class="calibre15">Internet Net Sales Var to Plan</kbd> measures both return blank values when a product color or calendar year-week value has been selected from either slicer visual:</p>
<div class="cdpalignleft"><img src="images/000268.png" class="calibre115" /></div>
<div class="mce-root2">Sales and Margin Plan measures are blank due to the Product Color filter</div>
<p class="calibre7">The <kbd class="calibre15">Product Category</kbd> and <kbd class="calibre15">Sales Territory</kbd> country visuals do not cause the sales plan measures to return blank values since these columns are within the granularity of the <kbd class="calibre15">Sales and Margin Plan</kbd> fact table. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-17">
<div id="calibre_link-663" class="calibre2">
<div id="calibre_link-664" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Relationships</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>Relationships play a central role in the analytical behavior and performance of the dataset. Based on the filters applied at the report layer and the DAX expressions contained in the measures, relationships determine the set of active rows for each table of the model to be evaluated. It's critical that the dataset designer understands how relationships drive report behavior via cross-filtering and the rules that relationships in Power BI must adhere to, such as uniqueness and non ambiguity. </span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-29">
<div id="calibre_link-665" class="calibre2">
<div id="calibre_link-666" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Uniqueness </h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Relationships in Power BI Data Models are always defined between a single column from each of the two tables. One of these two columns must uniquely identify the rows of its table, such as the <kbd class="calibre15">Currency Key</kbd> column from the <kbd class="calibre15">Currency</kbd> table in the <em class="calibre16">Fact-to-dimension relationships</em> section earlier in this chapter. Power BI will throw an error message if a row with a duplicate value for the relationship column is attempted to be loaded to the one side of the relationship, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000278.png" class="calibre116" /></div>
<div class="mce-root2">Uniqueness enforced in relationships</div>
<p class="calibre7">Power BI and SSAS Tabular models do not enforce or require referential integrity as with relationship uniqueness, however. For example, a sales fact table can contain transactions for a customer that is not present in the customer dimension table. No error message will be thrown and DAX measures that sum the sales table will still result in the correct amount, including the new customer's transactions. A blank row is added to the customer dimension table by default for these scenarios (also known as early-arriving facts) and this row is visible when the measure is grouped by columns from the customer dimension table in report visualizations. If missing dimensions is an issue, the dataset designer can work with the data source owner and/or the data warehouse team to apply a standard foreign key value (for example, -1) to these new dimension members within an <span><strong class="calibre6">extract-transform-load</strong> </span>(<strong class="calibre6">ETL</strong>) process and a corresponding row can be added to dimensions with an unknown value for each column.</p>
<div class="packt_tip pcalibre7 pcalibre6">In the rare event that a text column is used for a relationship, note that DAX is not case-sensitive like the M language. For example, M functions that remove duplicates, such as <kbd class="calibre43">Table.Distinct()</kbd>, may result in unique text values (from M's perspective), such as <kbd class="calibre43">Apple</kbd> and <kbd class="calibre43">APPLE</kbd>. When these values are loaded to the data model, they will be considered duplicates and thus relationships will not be allowed. To resolve this issue, a standard casing format can be applied to the column within a <kbd class="calibre43">Table.TransformColumns()</kbd> function via text functions, such as <kbd class="calibre43">Text.Proper()</kbd> and <kbd class="calibre43">Text.Upper()</kbd>. Removing duplicates after the standard casing transformation will result in a column of unique values for the data model.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-40">
<div id="calibre_link-667" class="calibre2">
<div id="calibre_link-668" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Ambiguity</h1>
                </header>
            
            <article class="calibre5">
                
<p class="mce-root3">Data model relationships must result in a single, unambiguous filter path across the tables of the model. In other words, a filter applied to one table must follow a single path to filter another table&mdash;the filter context cannot branch off into multiple intermediate tables prior to filtering a final table. In the following screenshot from the Relationships View, only one of the two relationships to the <kbd class="calibre15">Auto Accidents</kbd> fact table is allowed to be active (solid line):</p>
<div class="cdpaligncenter1"><img src="images/000288.png" class="calibre117" /></div>
<div class="mce-root2">Ambiguous relationships avoided</div>
<p class="mce-root3">When a filter is applied to the <kbd class="calibre15">Auto Owners</kbd> table, the inactive relationship between <kbd class="calibre15">Insurance Polices</kbd> and <kbd class="calibre15">Auto Accidents</kbd> provides a single, unambiguous filter path from <kbd class="calibre15">Auto Owners</kbd> to <kbd class="calibre15">Auto Accidents</kbd> via relationships with the <kbd class="calibre15">Automobiles</kbd> table. If the model author tries to set both relationships to the <kbd class="calibre15">Auto Accidents</kbd> table as active, Power BI will reject this relationship and advise of the ambiguity it would create, as shown in the following screenshot:</p>
<div class="cdpaligncenter1"><img src="images/000298.png" class="calibre118" /></div>
<div class="mce-root2">Ambiguity error in the Edit Relationship Dialog</div>
<p class="calibre7">Given the active relationship between the <kbd class="calibre15">Automobiles</kbd> and <kbd class="calibre15">Auto Accidents</kbd> tables, if the relationship between <kbd class="calibre15">Insurance Policies</kbd> and <kbd class="calibre15">Auto Accidents</kbd> was active, the <kbd class="calibre15">Auto Owners</kbd> table would have two separate paths to filter the <kbd class="calibre15">Auto Accidents</kbd> table (via <kbd class="calibre15">Insurance Policies</kbd> or via <kbd class="calibre15">Automobiles</kbd>). </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-158">
<div id="calibre_link-669" class="calibre2">
<div id="calibre_link-670" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Single-direction relationships</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Single-direction cross-filtering relationships are the most common in Power BI datasets and particularly for data models with more than one fact table. In this dataset, whether import or DirectQuery, all relationships are defined with single direction cross-filtering except for the relationships from <kbd class="calibre15">Sales Territory</kbd>, <kbd class="calibre15">Product</kbd>, and <kbd class="calibre15">Date</kbd> to their corresponding bridge tables, as described in the following section on bidirectional relationships. </p>
<p class="calibre7">The following screenshot from the Relationships View includes three of the seven dimension tables related to <kbd class="calibre15">Reseller Sales</kbd>:</p>
<div class="cdpalignleft"><img src="images/000308.png" class="calibre119" /></div>
<div class="mce-root2">Single-direction relationships</div>
<p class="calibre7">As you can see from the arrow icons in the Relationships View, the filter context in single-direction relationships exclusively navigates from the one side of a relationship to the many side. In the absence of any DAX expressions that override the default cross-filtering behavior, tables on the one side of single-direction relationships are not filtered or impacted by filters applied to the table on the many side of the relationship. For example, the <kbd class="calibre15">Employee</kbd> table has 299 unique rows based on its <kbd class="calibre15">Employee Key</kbd> column. A measure, such as Count of Employees, that references this column will always return the 299 value despite any filters applied to other tables in the model. </p>
<p class="calibre7">There are, of course, valid business scenarios for allowing the filter context of the related fact table to impact dimension measures, such as the <kbd class="calibre15">Count of Employees</kbd> or the <kbd class="calibre15">Distinct Count</kbd> of <kbd class="calibre15">Product Subcategories</kbd>. Dataset designers can support these requirements by default via bidirectional cross-filtering relationships, but in most scenarios this isn't necessary or appropriate. For these DAX measures, the <kbd class="calibre15">CROSSFILTER()</kbd> function can be applied to override the default single-direction cross-filtering. See the following <em class="calibre16">CROSSFILTER</em> section for the function syntax and a use case example.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-159">
<div id="calibre_link-671" class="calibre2">
<div id="calibre_link-672" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Direct flights only</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For the most common and data-intensive report queries, always look to eliminate any unnecessary intermediate relationships between dimension tables and fact tables.</p>
<p class="calibre7">In the following example, the <kbd class="calibre15">Reseller</kbd> table must filter a hidden intermediate table (<kbd class="calibre15">Reseller Keys</kbd>) prior to filtering the <kbd class="calibre15">Reseller Sales</kbd> fact table:</p>
<div class="cdpalignleft"><img src="images/000318.png" class="calibre120" /></div>
<div class="mce-root2">Anti-pattern: intermediate table relationships</div>
<p class="calibre7">Removing the intermediate table (connecting flight), <kbd class="calibre15">Reseller Keys</kbd> in this example, significantly improves performance by reducing the scan operations required of the DAX query engine. The performance benefit is particularly acute with larger fact tables and dimensions with many unique values. For small fact tables, such as a budget or plan table of 3,000 rows, intermediate tables can be used without negatively impacting performance.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-160">
<div id="calibre_link-673" class="calibre2">
<div id="calibre_link-674" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Bidirectional relationships</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Bidirectional cross-filtering enables the filter context of a table on the many side of a relationship to flow to the one side of the relationship. Prior to support for bidirectional relationships, equivalent filter behavior commonly used in many-to-many relationships was only possible via DAX expressions. A common use case for bidirectional relationships is represented in the following data model:</p>
<div class="cdpalignleft"><img src="images/000328.png" class="calibre121" /></div>
<div class="mce-root2">Bidirectional cross-filtering for a many-to-many relationship</div>
<p class="calibre7">In this model, a customer can have many accounts and an individual account can be associated with many customers. Given the many-to-many relationship between <kbd class="calibre15">Customers</kbd> and <kbd class="calibre15">Accounts</kbd>, a bridge table (<kbd class="calibre15">CustomerAccount</kbd>) is created that contains the combinations of customer and account key values. Due to the many-to one relationship between <kbd class="calibre15">CustomerAccount</kbd> and <kbd class="calibre15">Accounts</kbd>, a filter applied to the <kbd class="calibre15">Customers</kbd> table will only impact the <kbd class="calibre15">Transactions</kbd> fact table if bidirectional cross-filtering is enabled from <kbd class="calibre15">CustomerAccount</kbd> to <kbd class="calibre15">Accounts</kbd>. Without this bidirectional relationship, a filter applied to the <kbd class="calibre15">Customers</kbd> table would only impact the <kbd class="calibre15">CustomerAccount</kbd> table as single-direction relationships only flow from the one side of the relationship to the many. </p>
<p class="calibre7">The only bidirectional relationships defined in the dataset for this project were described in the <em class="calibre16">Bridge table</em> section earlier in this chapter. Although powerful, and preferable for certain use cases, such as with bridge tables, bidirectional relationships can lead to unexpected or undesired query results. Additionally, the DAX <kbd class="calibre15">CROSSFILTER()</kbd> function makes it possible to selectively implement bidirectional relationship behavior for specific measures.</p>
<div class="packt_infobox">Detailed documentation and additional examples of bidirectional cross-filtering are included in the <em class="calibre16">Bidirectional cross-filtering in SQL Server Analysis Services 2016 and Power BI Desktop</em> whitepaper by Kasper de Jonge. The document can be downloaded from the Power BI Documentation site: <a href="http://bit.ly/28TGDSS" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/28TGDSS</a>.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-161">
<div id="calibre_link-675" class="calibre2">
<div id="calibre_link-676" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Shared dimensions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In this dataset, the <kbd class="calibre15">Sales Territory</kbd>, <kbd class="calibre15">Product</kbd>, <kbd class="calibre15">Date</kbd>, <kbd class="calibre15">Currency</kbd>, and <kbd class="calibre15">Promotion</kbd> dimension tables are related to both the <kbd class="calibre15">Internet Sales</kbd> and <kbd class="calibre15">Reseller Sales</kbd> fact tables. As shown in<span> the following screenshot from the Relationships View, these relationships and the three dimension tables specific to either fact table all have single-direction cross-filtering enabled:</span></p>
<div class="cdpalignleft"><img src="images/000338.png" class="calibre122" /></div>
<div class="mce-root2">Shared dimension tables</div>
<p class="calibre7"><span>Unlike the shared dimensions, the <kbd class="calibre15">Reseller</kbd> and <kbd class="calibre15">Employee</kbd> dimension tables are exclusively related to the <kbd class="calibre15">Reseller Sales</kbd> fact table and the <kbd class="calibre15">Customer</kbd> dimension is exclusively related to the <kbd class="calibre15">Internet Sales</kbd> fact table. This is a common scenario for larger models in that fact tables will both share dimensions and maintain their own exclusive relationships to certain dimension tables.</span></p>
<p class="calibre7"><span>In general, it's recommended to avoid bidirectional relationships between shared dimensions and fact tables when there are also dimension tables exclusive to certain fact tables. This is because such relationships generate filter contexts that business users often don't expect or desire and that don't add analytical value.</span> <span>For example, if the relationship between <kbd class="calibre15">Promotion</kbd> and <kbd class="calibre15">Reseller Sales</kbd> was revised to allow for bidirectional cross-filtering, a report that analyzed internet sales by customers would be impacted by the filter selections of the <kbd class="calibre15">Reseller</kbd> and <kbd class="calibre15">Employee</kbd> dimension tables even though these two tables are not related to <kbd class="calibre15">Internet Sales</kbd>.</span></p>
<div class="packt_infobox"><span>In this example, the filter context would flow from the <kbd class="calibre43">Reseller</kbd> and/or <kbd class="calibre43">Employee</kbd> tables to <kbd class="calibre43">Reseller Sales</kbd> but then, via the bidirectional relationship with <kbd class="calibre43">Promotion</kbd>, also filter the <kbd class="calibre43">Promotion</kbd> table, and finally filter the <kbd class="calibre43">Internet Sales</kbd> fact table. In almost all scenarios, the business would expect the <kbd class="calibre43">Reseller</kbd> and <kbd class="calibre43">Employee</kbd> tables to only filter the <kbd class="calibre43">Reseller Sales</kbd> measures. For the rare cases in which this filtering behavior is useful or needed, bidirectional cross-filtering can be enabled for specific measures via the <kbd class="calibre43">CROSSFILTER()</kbd> function. </span></div>
<p class="calibre7"><span>A better use case for bidirectional relationships is between the exclusive dimension tables and their fact tables, such as from <kbd class="calibre15">Reseller</kbd> to <kbd class="calibre15">Reseller Sales</kbd> or from <kbd class="calibre15">Customer</kbd> to <kbd class="calibre15">Internet Sales</kbd>. These bidirectional relationships aren't required given the <kbd class="calibre15">CROSSFILTER()</kbd> function and other options available in DAX, but they allow simple measures against these dimensions, such as the count of resellers to reflect the filter selections applied to other <kbd class="calibre15">Reseller Sales</kbd> dimensions, such as <kbd class="calibre15">Sales Territory</kbd> and <kbd class="calibre15">Product</kbd>.</span></p>
<div class="packt_infobox"><span>Bidirectional cross-filtering is also not allowed for certain relationships due to the ambiguity this would create. In this dataset, Power BI Desktop rejects bidirectional relationships between the <kbd class="calibre43">Sales Territory</kbd>, <kbd class="calibre43">Product</kbd>, and <kbd class="calibre43">Date</kbd> dimension tables with the <kbd class="calibre43">Internet Sales</kbd> and <kbd class="calibre43">Reseller Sales</kbd> fact tables because this would create more than one filter path to the <kbd class="calibre43">Sales and Margin Plan</kbd> fact table. For example, a bidirectional relationship between <kbd class="calibre43">Sales Territory</kbd> and <kbd class="calibre43">Reseller Sales</kbd> would allow the <kbd class="calibre43">Product</kbd> table to either filter the <kbd class="calibre43">Sales and Margin Plan</kbd> table via the <kbd class="calibre43">Product Subcategory</kbd> bridge table, or filter the <kbd class="calibre43">Reseller Sales</kbd> table and then utilize the new bidirectional relationship to filter the <kbd class="calibre43">Sales Territory</kbd> table and then its bridge table to the <kbd class="calibre43">Sales and Margin Plan</kbd> table. Rather than guess at the correct or intended filter behavior, Power BI will throw an error and advise of the tables associated with the ambiguous condition.</span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-162">
<div id="calibre_link-677" class="calibre2">
<div id="calibre_link-678" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Date dimensions </h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Relationships between fact tables and date dimension tables should always use single-direction cross filtering. If bidirectional cross filtering is used with date dimension tables, then filter selections of other dimension tables related to the given fact table, such as <kbd class="calibre15">Promotion</kbd> or <kbd class="calibre15">Product</kbd>, will reduce the date table rows available for date intelligence calculations. Similar to the example with shared dimensions, although this adjusted filter context is technically correct, it will often produce unexpected or undesired results, such as only the dates in which internet sales transactions were associated with a specific promotion type.</p>
<div class="packt_infobox">Note that the bidirectional relationship with the <kbd class="calibre43">Date</kbd> dimension table in this dataset is between the <kbd class="calibre43">Date</kbd> table and the bridge table containing unique month values. The bridge tables are hidden from the Report View and will not be used to filter the <kbd class="calibre43">Date</kbd> table. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-163">
<div id="calibre_link-679" class="calibre2">
<div id="calibre_link-680" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">The CROSSFILTER function</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>Similar to the </span><kbd class="calibre15">USERELATIONSHIP()</kbd><span> function that can invoke an inactive relationship for a specific DAX measure, the </span><kbd class="calibre15">CROSSFILTER()</kbd><span> function can be used to implement a specific cross-filtering behavior (single, bidirectional, none) for a specific measure. The cross-filtering behavior specified in the measure overrides the default cross-filtering behavior defined for the relationship. </span></p>
<p class="calibre7"><span>In the following report visual, an <kbd class="calibre15">Employee Count</kbd> measure only references the <kbd class="calibre15">Employee</kbd> dimension table and therefore is not impacted by the filter selections of the <kbd class="calibre15">Sales Territory Country</kbd> slicer due to the single direction relationship between <kbd class="calibre15">Employee</kbd> and <kbd class="calibre15">Reseller Sales</kbd>: </span></p>
<div class="cdpalignleft"><img src="images/000348.png" class="calibre123" /></div>
<div class="mce-root2">Bidirectional cross-filtering via the DAX CROSSFILTER function</div>
<p class="calibre7"><span>The <kbd class="calibre15">Employee Count</kbd> (<kbd class="calibre15">CF</kbd>) measure, however, does adjust to reflect the <kbd class="calibre15">Sales Territory Country</kbd> selections as well as any other dimension table filter selections that impact the <kbd class="calibre15">Reseller Sales</kbd> fact table, such as the <kbd class="calibre15">Date</kbd></span>, <span><kbd class="calibre15">Product</kbd></span>, <span>and <kbd class="calibre15">Promotion</kbd> dimension tables. In this example, the <kbd class="calibre15">Reseller Sales</kbd> fact table is first filtered to the set of <kbd class="calibre15">Reseller Sales</kbd> rows associated with the <kbd class="calibre15">Germany</kbd> and <kbd class="calibre15">United Kingdom</kbd> sales territory countries. This filtered set of <kbd class="calibre15">Reseller Sales</kbd> rows is then used to filter the <kbd class="calibre15">Employee</kbd> table resulting in three distinct employee key values. The value of <kbd class="calibre15">3</kbd> represents the three salespeople associated with the <kbd class="calibre15">Reseller Sales</kbd> of <kbd class="calibre15">Germany</kbd> and <kbd class="calibre15">United Kingdom</kbd>.</span></p>
<div class="packt_tip pcalibre7 pcalibre6"><span>In the absence of any filter selections in the report, the <kbd class="calibre43">Employee Count</kbd> and <kbd class="calibre43">Employee Count (CF)</kbd> measures will return the same results (that is, 299). The bidirectional cross-filtering only occurs when either a filter selection has been applied to a related dimension table in the report or within the DAX measure itself.<br class="calibre3" />
<br class="calibre3" />
If the intent is to only count the employees associated with <kbd class="calibre43">Reseller Sales</kbd> and to respect filter selections on related dimensions, the DAX measure can be written as follows:<br class="calibre3" />
<kbd class="calibre43">CALCULATE(DISTINCTCOUNT(Employee[Employee Alternate Key]),'Reseller Sales')</kbd><br class="calibre3" /></span><span>See the <em class="calibre16">Dimension metrics</em> section of <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em> for more details.</span></div>
<p class="calibre7"><span>The syntax for <kbd class="calibre15">CROSSFILTER()</kbd> is also very similar to <kbd class="calibre15">USERELATIONSHIP()</kbd>, as shown by the following code block:</span></p>
<pre class="cdpaligncenter2"><strong class="calibre6">Employee Count</strong> = DISTINCTCOUNT(Employee[Employee Alternate Key])<br class="calibre3" /><strong class="calibre6"><br class="calibre3" />Employee Count (CF) </strong>= CALCULATE(DISTINCTCOUNT('Employee'[Employee Alternate Key]),<br class="calibre3" />                         CROSSFILTER('Reseller Sales'[Employee Key],'Employee'[Employee Key],Both))<strong class="calibre6"><br class="calibre3" /></strong></pre>
<p class="calibre7">The <kbd class="calibre15">Employee Alternate Key</kbd> column represents the business key or natural key of the employee. The <kbd class="calibre15">Employee Key</kbd> column uniquely identifies each row of the <kbd class="calibre15">Employee</kbd> table and is used in the relationship with <kbd class="calibre15">Reseller Sales</kbd>. Given the slowly changing dimension process, which adds a new employee row when certain attributes of an employee change, it's necessary to reference the Employee Alternate Key column in the <kbd class="calibre15">DISTINCTCOUNT()</kbd> measures to only count each employee once. </p>
<p class="calibre7"><span>The third parameter to <kbd class="calibre15">CROSSFILTER()</kbd> can be set to <kbd class="calibre15">OneWay</kbd>, <kbd class="calibre15">Both</kbd>, or <kbd class="calibre15">None</kbd>. Given the potential for unexpected or undesired results when applying bidirectional cross-filtering relationships to models with multiple fact tables, it's generally recommended to selectively enable bidirectional cross-filtering per measure, such as in the preceding example. </span></p>
<div class="packt_infobox"><span>There may be valid use cases for both single-direction and bidirectional cross-filtering relationships, such as the two measures seen here. Including these alternative measures in the dataset doesn't violate the version control objective but does entail additional user training and documentation. A report developer or business analyst can regularly provide brief tutorials or updated documents on these measures and other dataset customizations.</span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-164">
<div id="calibre_link-681" class="calibre2">
<div id="calibre_link-682" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Model metadata</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The consistent and complete application of metadata properties, such as <span>Default Summarization</span> and <span>Data Category</span>, greatly affect the usability of a dataset. With a solid foundation of tables, column data types, and relationships in place, dataset designers and BI teams should consider all primary metadata properties and their implications for user experience as well as any additional functionality they can provide.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-165">
<div id="calibre_link-683" class="calibre2">
<div id="calibre_link-684" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Visibility</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Every table, column, and measure that isn't explicitly needed in the Report View should be hidden. This usually includes all relationship columns and any measure support tables and measure expressions. If a column is rarely needed or only needed for a specific report, it can be temporarily unhidden to allow for this report to be developed and then hidden again to maximize usability. Numeric fact table columns that are referenced by DAX Measures (for example, quantity) should be hidden from the fields list, as the measures can be used for visualizing this data.</p>
<p class="calibre7">As discussed in the <em class="calibre16">Parameter tables</em> section, when all columns of a table are hidden from the Report View and at least one DAX Measure identifies the given table as its home table, a measure group icon (calculator symbol) will appear in the fields list. This clear differentiation between the measures and dimension columns (attributes) is recommended, especially if business users will be developing their own reports based on the dataset. </p>
<div class="packt_infobox"><span>Tables with both visible columns and measures will force business users and report developers to navigate between these different elements in the fields list. This can be onerous given the volume of DAX Measures for common fact tables. If it's necessary to expose one or a few fact table columns permanently, consider migrating some or all of the DAX Measures for the table to a parameter table to simplify navigation.</span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-166">
<div id="calibre_link-685" class="calibre2">
<div id="calibre_link-686" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Column metadata</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Dataset designers should review the columns of each table exposed to the Report View and ensure that appropriate metadata properties have been configured. These settings, including any custom sorting described earlier, only need to be applied once and can significantly improve the usability of the dataset.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-167">
<div id="calibre_link-687" class="calibre2">
<div id="calibre_link-688" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Default Summarization</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The <span>Default Summarization</span> property should be revised from Power BI's default setting to the <span>Do not summarize</span> value for all columns. Power BI will apply a <span>Default Summarization</span> setting of <span>Sum</span> for all columns with a numeric data type (whole number, fixed decimal number, decimal number) when a table is first loaded to the data model. As shown in the following screenshot, a summation symbol (â) will appear next to the field name in the fields list if a <span>Default Summarization</span> other than <span>Do not Summarize</span> is enabled:</p>
<div class="cdpalignleft"><img src="images/000358.png" class="calibre124" /></div>
<div class="mce-root2">Default Summarization for numeric columns</div>
<p class="calibre7">As illustrated in the previous image, the <span>Default Summarization</span> property for a column can be accessed via the <span>Modeling</span> tab of the Data View. Additionally, as with other metadata properties, <span>Default Summarizaton</span> can also be accessed from the Report View. As mentioned in the <em class="calibre16">Data View</em> section earlier, implementing metadata changes, such as <span>Default Summarization</span> and <span>Data Category</span>, via the <span>Modeling</span> tab from the Report View is the only option for DirectQuery models. </p>
<p class="calibre7">If a user selects a column with <span>Default Summarization</span> enabled, the specific aggregation specified by the property (for example, <span>Sum</span>, <span>Average</span>) will be returned rather than the grouping behavior of <span>Do not summarize</span>. In many cases, the numeric column is only used to group measures, such as <kbd class="calibre15">Internet Net Sales</kbd> by <kbd class="calibre15">Product Dealer Price</kbd>, and DAX Measures can be written for any needed calculation logic. Additionally, <span>Default Summarization</span> can create confusion, such as when a user expects a sum aggregation based on the summation symbol but the model author has applied an alternative default summarization (for example, <span>Minimum</span>, <span>Average</span>). Alternatively, the names assigned to DAX measures, such as <kbd class="calibre15">Average Product Dealer Price</kbd>, make it clear which aggregation is being applied.</p>
<p class="calibre7">For these reasons, it's recommended to convert the default summarization setting to <span>Do not Summarize</span>. A broader concept of this recommendation is to build essential DAX Measure expressions into the dataset, as described in <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles,</em> to make Power BI datasets more flexible and powerful for users and report developers.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-168">
<div id="calibre_link-689" class="calibre2">
<div id="calibre_link-690" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Data format</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The default formatting Power BI applies to columns and measures should also be revised to a corporate standard or a format applicable to the column or measure. For example, the default full date format of 'Friday July 1, 2011' can be revised to the more compact (mm/dd/yyyy) format of 7/1/2011. Likewise, the currency format for measures calculating financial data can be revised to display two decimal places and the thousands separator can be added to numeric measures.</p>
<p class="calibre7">Business users and report developers do not have the ability to change column and measure formatting when connecting to the published dataset from Power BI or Excel. Therefore, it's important to choose widely accepted data formats and formats that lend themselves to intuitive data visualizations.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-169">
<div id="calibre_link-691" class="calibre2">
<div id="calibre_link-692" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Data category</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">By default, Power BI does not assign columns to any of the 13 available data categories. Assigning geographic categories, such as <kbd class="calibre15">City</kbd>, to columns helps Power BI determine how to display these values on map visualizations. For example, certain city names, such as <kbd class="calibre15">Washington</kbd>, are also associated with state or province names and without an assigned data category, map visuals would have to guess whether to plot the city or the state.</p>
<div class="packt_infobox">Currently 10 of the 13 column data categories are related to geography, including <span>County</span>, <span>Country/Region</span>, <span>Continent</span>, <span>City</span>, <span>Latitude</span>, <span>Longitude</span>, <span>Postal Code</span>, <span>Address</span>, <span>Place</span>, and <span>State or Province</span>. </div>
<p class="calibre7">The <span>Web URL</span> <span>Data Category</span> can be used to enable the initiation of emails from Power BI report visuals. In the following table visual, the <kbd class="calibre15">Employee Email Link</kbd> column contains <kbd class="calibre15">mailto</kbd> values (that is, <kbd class="calibre15">mailto://John@adworks.com</kbd>) and the URL icon property under <span>Values</span> has been set to <span>On</span>:</p>
<div class="cdpalignleft"><img src="images/000368.png" class="calibre125" /></div>
<div class="mce-root2">Web URL Data Category for Mailto Link column</div>
<div class="packt_infobox">Without specifying the <span>Web URL</span> <span>Data Category</span> of the <kbd class="calibre43">Employee Email Link</kbd> column, the values will appear as normal text. With the <span>Web URL</span> <span>Data Category</span> specified, the full <kbd class="calibre43">mailto</kbd> link will be displayed in the table visual by default; this can also be used to initiate an email. Both the <span>Web URL</span> <span>Data Category</span> specification and the URL icon property (set to <span>On</span>) are required to display the email icon.</div>
<p class="calibre7">The <span>Image URL</span> <span>Data Category</span> can be used to expose images in report visualizations, such as the following example with the custom <span>Chiclet slicer:</span></p>
<div class="cdpalignleft"><img src="images/000378.png" class="calibre126" /></div>
<div class="mce-root2">Image URL Data Category used for Chiclet slicer visual</div>
<p class="calibre7"><span>See <a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16">Applying Custom Visuals, Animation, and Analytics</em> for additional details on the Chiclet slicer. </span></p>
<p class="calibre7">The <span>Barcode</span> <span>Data Category</span>, the only other non-geographic category beyond <span>Web URL</span> and <span>Image URL</span>, can be used by the Power BI mobile applications to scan individual items from mobile devices. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-170">
<div id="calibre_link-693" class="calibre2">
<div id="calibre_link-694" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Field descriptions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Descriptions can be added to the measures and columns of a data model to aid users during report development. Once descriptions have been applied and the dataset has been published to the Power BI service, users connected to the dataset via reports can view the descriptions as they hover over the fields in the fields list. This feature is particularly useful in communicating the business logic contained in measures, such as whether discounts are included or excluded in the <kbd class="calibre15">Internet Net Sales</kbd> measure. </p>
<div class="packt_tip pcalibre7 pcalibre6">Although field descriptions are recommended, particularly for measures that contain custom or complex logic, they are not a substitute for the formal documentation of a dataset. In most scenarios, the field description will only be used as a convenient reminder of the essential logic or meaning and thus can be more concise than the official corporate definition of the column or measure. A detailed example of developing documentation reports of a Power BI Dataset via <strong class="calibre6">Dynamic Management Views</strong> (<strong class="calibre6">DMVs</strong>) and Power BI Desktop can be found in Chapter 10 of <em class="calibre16">Microsoft Power BI Cookbook</em> (<a href="https://www.packtpub.com/big-data-and-business-intelligence/microsoft-power-bi-cookbook" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://www.packtpub.com/big-data-and-business-intelligence/microsoft-power-bi-cookbook</a>) by <em class="calibre16">Packt Publishing</em>.</div>
<p class="calibre7">In the following example, a report author is connected to a published Power BI dataset and has hovered over the <kbd class="calibre15">Internet Gross Product Margin</kbd> measure:</p>
<div class="cdpalignleft"><img src="images/000387.png" class="calibre127" /></div>
<div class="mce-root2">Field Descriptions as Tooltips in the fields list</div>
<div class="packt_infobox">The descriptions can only be viewed from Power BI Desktop or the Power BI service. Users connecting to the dataset from Excel via the Power BI Publisher for Excel can't see the descriptions. Additionally, field descriptions are exclusive to the fields list and are not displayed in visuals on the report canvas. <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports,</em> contains additional information on Power BI reports created via Live connections to published Power BI datasets.</div>
<p class="calibre7">Descriptions can be applied by enabling the <span>FIELD PROPERTIES</span> pane from the <span>View</span> tab in the Report View. In the following screenshot, the <span>FIELD PROPERTIES</span> pane exposes the <span>Name</span> and <span>Description</span> of the selected measure (<kbd class="calibre15">Internet Gross Product Margin</kbd>):</p>
<div class="cdpalignleft"><img src="images/000397.png" class="calibre128" /></div>
<div class="mce-root2">FIELD PROPERTIES pane</div>
<p class="calibre7">Users connected to the dataset via Live connections can view the descriptions via the <span>FIELD PROPERTIES</span> pane. In this context, the <span>Name</span> and <span>Description</span> properties are read-only.</p>
<div class="packt_tip pcalibre7 pcalibre6">DMVs can be used to retrieve the descriptions applied to measures and columns of a dataset. With the dataset open in Power BI Desktop, the user can connect from a client application, such as DAX Studio, to execute the relevant DMV. The <span>Description</span> field of both the <kbd class="calibre43">MDSCHEMA_MEASURES</kbd> and the <kbd class="calibre43">TMSCHEMA_MEASURES</kbd> DMVs contains the description that has been applied to DAX Measures. The <span>Description</span> field in the <kbd class="calibre43">TMSCHEMA_COLUMNS</kbd> DMV provides the description applied to columns.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-171">
<div id="calibre_link-695" class="calibre2">
<div id="calibre_link-696" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Optimizing performance</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">One of the main reasons for creating a dataset, particularly an import mode dataset, is to provide a performant data source for reports and dashboards. Although Power BI supports traditional reporting workloads, such as email subscriptions and view-only usage, Power BI empowers users to explore and interact with reports and datasets. The responsiveness of visuals for this self-service workload is largely driven by fundamental data model design decisions, such as the granularity of fact and dimension tables. </p>
<p class="calibre7">Additional performance factors outside the scope of this chapter include the hardware resources allocated to the dataset, such as with Power BI Premium capacities (v-cores, RAM), the efficiency of the DAX Measures created for the dataset, the design of the Power BI reports that query the dataset, and the volume and timing of queries generated by users. Beyond the DAX measures described in <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em> these other factors are outside the control of the dataset designer and will be addressed in other chapters, such as <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling up with Power BI Premium and SSAS.</em></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-172">
<div id="calibre_link-697" class="calibre2">
<div id="calibre_link-698" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Import</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>The performance of an import mode dataset is largely driven by fundamental design decisions, such as the granularity of fact and dimension tables. For example, large dimension tables with more than a million unique values, such as customer IDs or product IDs will produce much less performant report queries than small dimensions with only 100 to 1,000 unique values. Likewise, DAX Measures that access columns containing thousands of unique values will perform much more slowly than measures that reference columns with a few unique values. A simplistic but effective understanding is that higher levels of cardinality (unique values) result in greater memory consumption via reduced compression and CPUs require additional time to scan greater amounts of memory. </span></p>
<div class="packt_tip pcalibre7 pcalibre6"><span>An import mode designer should be cautious about the performance implications of relationships to large dimension tables. Although usability is somewhat compromised, a separate but less granular dimension containing only the most common columns can be created to drive more efficient report queries. For example, business users may rarely need to access individual product SKUs and would prefer the performance benefit provided by a smaller dimension table that contains only product categories and product subcategories.</span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-173">
<div id="calibre_link-699" class="calibre2">
<div id="calibre_link-700" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Columnar compression</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>It's important to understand the columnar layout and internal storage of the import mode datasets. Power BI creates individual segments of approximately one million rows and stores separate memory structures for column data, the dictionary of unique values for columns, relationships, and hierarchies.</span></p>
<p class="calibre7"><span>In the following diagram, three segments are used to store a fact table of 2.8 million rows:</span></p>
<div class="cdpalignleft"><img src="images/000407.png" class="calibre129" /></div>
<div class="mce-root2">Columnar storage of import mode datasets</div>
<p class="calibre7">Since only the columns required for a query are scanned during query execution, a relatively expensive column in terms of memory consumption <span>(due to many unique values),</span> such as <kbd class="calibre15">Order #</kbd>, can be stored in the dataset without negatively impacting queries that only access other columns. Removing fact table columns or reducing the cardinality of fact table columns that are not used in queries or relationships will nonetheless benefit the storage size and resources required to refresh the dataset. Fewer fact table columns may also enable Power BI to find a more optimal sort order for compression and thus benefit the query performance. </p>
<div class="packt_tip pcalibre7 pcalibre6">Eliminate any DAX-calculated column on fact tables as these columns are not compressed as efficiently as imported columns. If necessary, replace DAX-calculated columns with the equivalent expression in the source M Query or SQL View. Additionally, per the <em class="calibre16">Fact table columns</em> section earlier in this chapter, remove columns that can be computed within DAX Measures via simple expressions (+,-,/,*). For example, the <kbd class="calibre43">Sales</kbd> column from the <kbd class="calibre43">Columnar Storage</kbd> example image can be excluded from the <kbd class="calibre43">Import</kbd> dataset given the <kbd class="calibre43">Price</kbd> and <kbd class="calibre43">Qty</kbd> columns.</div>
<p class="mce-root3">During query execution over tables with more than one segment, one CPU thread is associated per segment. This parallelization is limited by the number of CPU threads available to the dataset (for example, Power BI Premium P1 with four backend v-cores), and the number of segments required to resolve the query. Therefore, ideally, the rows of fact tables can be ordered such that only a portion of the segments are required to resolve queries. Using the example of the 2.8M-row fact table, a query that's filtered on the year 2017 would only require one CPU thread and would only scan the required column segments within <kbd class="calibre15">Segment 3</kbd>. </p>
<div class="packt_tip pcalibre7 pcalibre6">The internal order of fact table rows cannot be dictated by the dataset designer as Power BI determines the optimal order that will lead to the highest compression during dataset refreshes. However, dataset designers can add a sorting transformation to the M query of a fact table (<kbd class="calibre43">Table.Sort()</kbd>) such that Power BI will, at a minimum, consider this particular order during its processing. Whether Power BI used the particular sort order can be determined by analyzing the memory footprint of the sorted column before and after the data is loaded. If the size of the <kbd class="calibre43">sort by</kbd> column is significantly reduced following the refresh operation, Power BI took advantage of the <kbd class="calibre43">order by</kbd>. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-174">
<div id="calibre_link-701" class="calibre2">
<div id="calibre_link-702" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Memory analysis via DMVs</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The same DMVs that provide information about SSAS Tabular databases are also available for Power BI datasets. Querying these DMVs can provide schema information, such as the columns used to define relationships, the definitions of DAX Measures, and the memory usage of columns and other structures. From a memory analysis standpoint, the two most important DMVs are <kbd class="calibre15">DISCOVER_STORAGE_TABLE_COLUMNS</kbd> and <kbd class="calibre15">DISCOVER_STORAGE_TABLE_COLUMN_SEGMENTS</kbd>.</p>
<p class="calibre7">In the following query from DAX Studio, the dictionary size of each column of a Power BI dataset is retrieved via the <kbd class="calibre15">DISCOVER_STORAGE_TABLE_COLUMNS</kbd> DMV:</p>
<div class="cdpalignleft"><img src="images/000417.png" class="calibre130" /></div>
<div class="mce-root2">Dictionary size by Column</div>
<p class="calibre7">With the Power BI dataset (the PBIX file) open on the local machine, the DAX Studio application can connect to the dataset and SQL queries can be executed against the DMVs, just like normal DAX queries.</p>
<p class="calibre7">The <kbd class="calibre15">DISCOVER_STORAGE_TABLE_COLUMN_SEGMENTS</kbd> DMV contains information on four separate memory structures: user hierarchies, system hierarchies, relationships, and the compressed data segments per column. Dataset designers are generally most interested in the size and distribution of data segments by column and this can be retrieved with the following SQL query:</p>
<div class="cdpalignleft"><img src="images/000016.png" class="calibre131" /></div>
<div class="mce-root2">Data size per Column Segment</div>
<p class="calibre7">The first two characters of the <kbd class="calibre15">Table_ID</kbd> column identify the data structure represented by the row. For example, <kbd class="calibre15">H$</kbd> refers to system column hierarchies, <kbd class="calibre15">U$</kbd> refers to user-defined hierarchies, and <kbd class="calibre15">R$</kbd> refers to relationships. All other rows of the DMV, the rows in which the second character is not a dollar sign, refer to column data segments. In this query, the <kbd class="calibre15">WHERE</kbd> clause containing the <kbd class="calibre15">LEFT()</kbd> and <kbd class="calibre15">RIGHT()</kbd> text functions and the <kbd class="calibre15">&lt;&gt;'$'</kbd> condition is used to retrieve only the column data segments.</p>
<div class="packt_infobox"><span>The </span><kbd class="calibre43">Dictionary_Size</kbd> <span>column and the <kbd class="calibre43">Used_Size</kbd> column from the two respective DMVs are stored in bytes. For a more intuitive analysis of this data, particularly with large datasets, it can be helpful to convert from bytes to megabytes by dividing by 1,048,576. </span></div>
<p class="calibre7">Fact and dimension tables with over a million rows will contain more than one segment with each segment representing approximately one million rows. To analyze the DMV query results with multiple segments, it's necessary to group the result set by column and use aggregation functions (sum, average) against the <kbd class="calibre15">Used_Size</kbd> column. Analyzing the memory usage data from SSAS DMVs is generally performed outside of DAX Studio in tools such as Excel or Power BI.</p>
<div class="packt_tip pcalibre7 pcalibre6">A separate Power BI dataset (the PBIX file) exclusively dedicated to analyzing the memory usage of Power BI datasets can be an effective method of streamlining the data retrieval and visualization process. A detailed example for developing and maintaining one of these datasets is included in Chapter 10 of the <em class="calibre16">Microsoft Power BI Cookbook</em> (<a href="https://www.packtpub.com/big-data-and-business-intelligence/microsoft-power-bi-cookbook" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://www. packtpub. com/big-data-and-businessintelligence/microsoft-power-bi-cookbook</a>). At a high level, this solution involves executing M Queries against a running Power BI dataset to retrieve DMVs, such as the two DMVs idenfified, and then model and visualize this data. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-175">
<div id="calibre_link-703" class="calibre2">
<div id="calibre_link-704" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">DirectQuery </h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The dataset designer has less control over the performance of DirectQuery datasets given that data storage and query execution is the responsibility of the source system. However, dataset designers can ensure that the DAX functions used in measures take advantage of the source system resources and can partner with source system owners and experts to test alternative data source optimizations, such as the columnstore index for SQL Server. Additionally, as advised earlier regarding the Assume Referential Integrity relationship property, performance can be significantly improved by generating inner-join SQL statements.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-176">
<div id="calibre_link-705" class="calibre2">
<div id="calibre_link-706" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Optimized DAX functions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">If the allow unrestricted measures for DirectQuery mode setting is enabled in Power BI Desktop, all DAX functions can be used in measures. However, only certain DAX functions are natively converted to SQL expressions for execution by the source system. The list of these optimized functions is available in the MS documentation: <a href="http://bit.ly/2oK8QXB" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2oK8QXB</a>. To the greatest extent possible, dataset designers should ensure that optimized functions are leveraged in measures and that non-optimized functions are only used on small, pre-filtered or aggregated query results. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-177">
<div id="calibre_link-707" class="calibre2">
<div id="calibre_link-708" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Columnstore and HTAP</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Business intelligence queries generated from tools such as Power BI are more suited for columnar data stores and most DirectQuery source systems offer a columnar feature to deliver improved query performance. For Microsoft SQL Server, the columnstore index is recommended for large fact tables and this index eliminates the need to maintain traditional B-tree indexes or to apply row or page compression. Additionally, a combination of non-clustered columnstore indexes and in-memory table technologies can be used to support <strong class="calibre6">hybrid transactional and analytical processing</strong> (<strong class="calibre6">HTAP</strong>) workloads. For example, the Power BI queries against the DirectQuery dataset would utilize the columnstore index without impacting the OLTP workload of the database.</p>
<p class="calibre7">The details of these features and configurations are outside the scope of this book but at a minimum the owners or experts on the DirectQuery data source should be engaged on the performance of the Power BI dataset. The following URL provides guidance on designing columnstore indexes for SQL Server database services (for example, Azure SQL Database, Azure SQL Data Warehouse) and on-premises SQL Server database environments: <a href="http://bit.ly/2EQon0q" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2EQon0q</a>.</p>
<p class="calibre7">The <span>Related Tasks</span> section of the <em class="calibre16">Columnstore indexes &ndash; Design guidance</em> documentation referenced in the preceding URL contains links for the T-SQL DDL statements associated with implementing the columnstore index. In most scenarios, the dataset designer in a Power BI project or the author of an Analysis Services model is not responsible or authorized to optimize data sources such as with the columnstore index. However, the dataset designer can regularly collaborate with this subject matter expert or team as the demands and requirements of the dataset change. For example, the dataset designer can use tools, such as DAX Studio and SQL Server Profiler as described in the <em class="calibre16">Microsoft Power BI Cookbook</em> (<a href="https://www.packtpub.com/big-data-and-business-intelligence/microsoft-power-bi-cookbook" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://www.packtpub.com/big-data-and-business-intelligence/microsoft-power-bi-cookbook</a>), to capture the common or important SQL queries generated by Power BI reports and then share this information with the data warehouse team.</p>
<p class="calibre7">Alternatively, the database or data warehouse team can run a trace against a data source system per the <em class="calibre16">DirectQuery report execution</em> section of <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M,</em> during a test query workload from Power BI. This trace data could be used to identify the specific columns, tables, or expressions associated with slow queries and thus inform database modification decisions.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-178">
<div id="calibre_link-709" class="calibre2">
<div id="calibre_link-710" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">This chapter built on the queries from <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M,</em> to implement import and DirectQuery analytical data models. Relationships were created between fact and dimension tables as well as between bridge tables and the <kbd class="calibre15">Sales and Margin Plan</kbd> to enable actual versus plan reporting and analysis. Additionally, the fundamentals of designing Power BI models and all top features were reviewed, including bidirectional cross-filtering, inactive relationships, and hierarchies. Moreover, detailed guidance on metadata, such as data categories and DMVs available for analyzing memory usage, was provided. </p>
<p class="calibre7">The following chapter continues to build on the dataset for this project by developing analytical measures and security models. The DAX expressions implemented in this chapter will directly leverage the relationships defined in this chapter and ultimately drive the visualizations and user experience demonstrated in later chapters. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-25">
<div id="calibre_link-711" class="calibre2">
<div id="calibre_link-712" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Developing DAX Measures and Security Roles</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">This<span> </span>chapter<span> will </span>detail the implementation of DAX measures and security roles for the dataset developed in the<span> </span>previous<span> </span>two chapters. First, a set of base measures for each business process are created, representing business definitions such as gross and net sales, cost of sales, and margin percentages. The base measures are then leveraged in the development of date intelligence calculations including <strong class="calibre6">year-to-date</strong> (<strong class="calibre6">YTD</strong>) and <strong class="calibre6">year-over-year</strong> (<strong class="calibre6">YOY</strong>) growth. Additionally, a set of customs measures are created, <span>including exceptions, rankings, and KPI targets </span>to further extract insights from the dataset and simplify report visualizations.</p>
<p class="calibre7">This chapter will also contain examples of dynamic security models in which the identity of the logged in user is used to filter the dataset. Finally, guidance will be provided on testing the performance of DAX expressions with DAX Studio.</p>
<p class="calibre7">In this chapter, we will review the following topics:</p>
<ul class="calibre12">
<li class="calibre13">DAX measures</li>
<li class="calibre13">Filter and row contexts</li>
<li class="calibre13">DAX variables</li>
<li class="calibre13">Base measures</li>
<li class="calibre13">Date intelligence metrics</li>
<li class="calibre13">Dimension metrics</li>
<li class="calibre13">Ranking metrics</li>
<li class="calibre13">Security roles</li>
<li class="calibre13">Dynamic row-level security</li>
<li class="calibre13">Performance testing</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-179">
<div id="calibre_link-713" class="calibre2">
<div id="calibre_link-714" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">DAX measures</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">All analytical expressions ranging from simple sums and averages to custom, complex statistical analyses are implemented within DAX measures. Most measure expressions will reference and aggregate the numeric columns of fact tables, which are hidden from the Report View, as we have seen in per the previous chapter. Additional DAX measures can include filtering conditions which supplement or override any filters applied in Power BI reports, such as the net sales amount for first-year customers only. Measures can also evaluate text columns from dimension tables, such as the count of states or provinces with sales and return text and date values.</p>
<p class="calibre7">Just like the M query language, DAX is a rich, functional language that supports variables and external expression references. Multiple variables can be defined within a DAX measure to improve readability, and the results of other measures can be referenced as well, such as the <kbd class="calibre15">Plan Grain Status</kbd> measure in <a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em>. These layers of abstraction and the built-in code editing features of Power BI Desktop including IntelliSense and colorization, enabling dataset designers to embed powerful yet sustainable logic into datasets.</p>
<div class="packt_infobox">In addition to the DAX measures authored for a Power BI Dataset, Power BI Desktop's <span>Analytics</span> pane can be used to create metrics specific to a given visual, such as the trend line, min, max, an average of a metric on a line chart. The <span>Analytics</span> pane is reviewed in <a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16">Applying Custom Visuals, Animation and Analytics</em>.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-180">
<div id="calibre_link-715" class="calibre2">
<div id="calibre_link-716" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Filter context</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A fundamental knowledge for authors of DAX measures is the filter context in which the calculation logic of DAX measures is executed. The filter context is the set of rows for each table in the data model which are available to be evaluated for each value displayed in report visualizations. For example, each value of a Power BI chart that analyzes a sales amount measured by a <kbd class="calibre15">Product Category</kbd> column will usually be unique because a different set of rows (filter context) of the sales fact table was available to the measure when calculating each value.</p>
<p class="calibre7">In the following Power BI report, five distinct filters representing five dimension tables have been applied to a matrix visual of the <kbd class="calibre15">Internet Gross Sales</kbd> measure:</p>
<div class="cdpalignleft"><img src="images/000176.png" class="calibre132" /></div>
<div class="mce-root2">Filtered power BI report</div>
<p class="calibre7">Filters applied to the <kbd class="calibre15">Promotion</kbd>, <kbd class="calibre15">Date</kbd>, <kbd class="calibre15">Product</kbd>, <kbd class="calibre15">Customer</kbd>, and <kbd class="calibre15">Sales Territory</kbd> dimension tables all flow across their relationships to filter the <kbd class="calibre15">Internet Sales</kbd> fact table. The <kbd class="calibre15">Internet Gross Sales</kbd> measure is a simple <kbd class="calibre15">SUMX()</kbd> expression described in the base measures and is thus evaluated against the <kbd class="calibre15">Internet Sales</kbd> rows remaining from these filters.</p>
<div class="packt_tip pcalibre7 pcalibre6">
<p class="calibre7">Each individual value in Power BI reports is computed independently. For example, the <kbd class="calibre43">$315,028</kbd> subtotal value is not filtered by the <kbd class="calibre43">Product Category</kbd> column like other values in the matrix, and it's not calculated as the sum of the three cells in the <kbd class="calibre43">Married</kbd> column. This value is computed using the customer marital status column value of <kbd class="calibre43">Married</kbd> and the other filters from the report. See the following <em class="calibre16">Measure evaluation process</em> section for details on the DAX engine's execution process.</p>
</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-181">
<div id="calibre_link-717" class="calibre2">
<div id="calibre_link-718" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">SQL equivalent</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">To help understand filter context and to validate certain reports or DAX measures, it can be helpful to compare Power BI reports to SQL statements. The following SQL statement returns the same six values of the Power BI matrix (excluding the subtotals) via standard inner joins and <kbd class="calibre15">WHERE</kbd> clause conditions: </p>
<pre class="calibre19">SELECT<br class="calibre3" />  P.[Product Category]<br class="calibre3" />, C.[Customer Marital Status]<br class="calibre3" />, FORMAT(SUM(F.[Unit Price] * F.[Order Quantity]), '$#,###') AS [Internet Gross Sales]<br class="calibre3" />FROM BI.vFact_InternetSales as F<br class="calibre3" />  INNER JOIN BI.vDim_FinDate as D on F.[Order Date Key] = D.[Date Key]<br class="calibre3" />  INNER JOIN BI.vDim_Promotion as Promo on F.[Promotion Key] = Promo.[Promotion Key]<br class="calibre3" />  INNER JOIN BI.vDim_Product as P on F.[Product Key] = P.[Product Key]<br class="calibre3" />  INNER JOIN BI.vDim_Customer as C on F.[Customer Key] = C.[Customer Key]<br class="calibre3" />  INNER JOIN BI.vDim_SalesTerritory as S on F.[Sales Territory Key] = S.[Sales Territory Key]<br class="calibre3" />WHERE D.[Calendar Year Status] in ('Prior Calendar Year', 'Current Calendar Year')<br class="calibre3" />  and S.[Sales Territory Group] = 'Europe' and <br class="calibre3" />Promo.[Promotion Type] in ('Excess Inventory', 'Volume Discount')<br class="calibre3" />GROUP BY <br class="calibre3" />  P.[Product Category], C.[Customer Marital Status]</pre>
<p class="calibre7">In this example, the SQL statement's <kbd class="calibre15">WHERE</kbd> clause implements the Power BI report's slicer visual filter and its report and page level filters. The <kbd class="calibre15">GROUP BY</kbd> clause accounts for the row and column filters of the matrix visual.</p>
<div class="packt_tip pcalibre7 pcalibre6">Although certain SQL concepts and examples are applicable, DAX is distinct from SQL and other languages, such as MDX. Additionally, since Power BI import mode datasets are stored in a columnar format, SQL developers experienced with row-based tables and B-tree indexes have to revise their design patterns in developing DAX measures and queries.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-182">
<div id="calibre_link-719" class="calibre2">
<div id="calibre_link-720" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Measure evaluation process</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Each value in the report, such as the $600 from the matrix visual, is computed according to the following four-step process:</p>
<ol class="calibre12">
<li class="chapter"><strong class="calibre6">Initial Filter Context</strong>:
<ul class="calibre17">
<li class="chapter">This includes all filters applied within and outside the report canvas by the report author</li>
<li class="chapter">Selections on slicer visuals and the rows and columns of the table and matrix visuals represent on-canvas filters</li>
<li class="chapter">Report, page, visual, and drillthrough filters represent off-canvas filters that also contribute to the initial filter context</li>
</ul>
</li>
<li class="chapter"><strong class="calibre6">Filter Context Modified via DAX</strong>:
<ul class="calibre17">
<li class="chapter">For base measures and other simplistic expressions, the initial filter context from the report is left unchanged</li>
<li class="chapter">For more complex measures, the <kbd class="calibre15">CALCULATE()</kbd> function is invoked to further modify the initial filter context:
<ul class="calibre17">
<li class="chapter">Via <kbd class="calibre15">CALCULATE()</kbd>, the initial filter context can be removed, replaced, or supplemented with an additional filter condition</li>
<li class="chapter">In the event of a conflict between the initial filter context from the report (for example, slicers, report level filters) and the filter condition embedded in the DAX measure, by default, the DAX measure will override the report filter condition</li>
</ul>
</li>
</ul>
</li>
<li class="chapter"><strong class="calibre6">Relationship Cross-Filtering</strong>:
<ul class="calibre17">
<li class="chapter">With each table filtered from steps <em class="calibre16">1</em> and <em class="calibre16">2</em>, the filter context is transferred across cross-filtering relationships</li>
<li class="chapter">In most cases, the filtered dimension tables filter the related fact tables via single direction cross-filtering</li>
<li class="chapter">However, as described in <a href="#calibre_link-23" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em>, bidirectional cross-filtering allows the filter context to also transfer from the many side of a relationship to the one side </li>
</ul>
<ol start="4" class="calibre17"></ol>
</li>
</ol>
<ol start="4" class="calibre12">
<li class="chapter"><strong class="calibre6">Measure Logic Computation</strong>:</li>
</ol>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13">The computation logic of the measure (for example, <kbd class="calibre15">DISTINCTCOUNT()</kbd>, <kbd class="calibre15">COUNTROWS()</kbd>) is finally evaluated against the remaining active rows for the given table or column referenced</li>
<li class="calibre13">For common and base measures, this is simply the set of remaining or active fact table rows</li>
<li class="calibre13">However, as shown in the following <em class="calibre16">Dimension metrics</em> section, other DAX measures will reference dimension tables, and thus it's important to understand how these tables are impacted by relationship filtering and DAX expressions </li>
</ul>
</li>
</ul>
<p class="calibre7">This four-step process is repeated for each value of the report independently. Consequently, reports and visuals which are dense in values require more computing resources to refresh and update based on user filter selections. Large tabular report visuals with many columns and rows are particularly notorious for slow performance, as this forces the DAX engine to compute hundreds or thousands of individual values.</p>
<div class="packt_tip pcalibre7 pcalibre6">Although report authors and business analysts will not create DAX measures, it's important that they have a basic understanding of the filter context and measure evaluation processes. For example, the report author should understand the cross-filtering relationships of the data model (single or bidirectional) and how certain DAX measures impact the filters applied in reports. Similarly, business analysts should be able to explain to business users why certain report behaviors and results occur.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-183">
<div id="calibre_link-721" class="calibre2">
<div id="calibre_link-722" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Row context</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In addition to filter context, several DAX functions such as <kbd class="calibre15">FILTER()</kbd> and <kbd class="calibre15">SUMX()</kbd> are iterators and execute their expressions per row of a given table. The set of rows to evaluate from this table is always defined by the filter context which was described earlier in this chapter. The expression parameter of iterating functions can aggregate the rows of a table or can invoke the filter context of the specific row being iterated via the <kbd class="calibre15">CALCULATE()</kbd> function or a measure reference.</p>
<p class="calibre7">Calculated DAX columns are used to illustrate row context. In the following screenshot, four calculated columns have been added to a <kbd class="calibre15">Date</kbd> table and reference the <kbd class="calibre15">Weekday Sort</kbd> column:</p>
<div class="cdpalignleft"><img src="images/000423.png" class="calibre133" /></div>
<div class="mce-root2">The row context in calculated columns</div>
<p class="calibre7">All four calculated columns simply add the value <kbd class="calibre15">1</kbd> to the <kbd class="calibre15">Weekday Sort</kbd> column, but achieve their results via distinct expressions:</p>
<pre class="calibre19"><strong class="calibre6">Weekday Sort Plus 1 (SUM)</strong> = SUM('Date'[Weekday Sort]) + 1 <br class="calibre3" /><strong class="calibre6">Weekday Sort Plus 1 CALC</strong> = CALCULATE(SUM('Date'[Weekday Sort])) + 1<br class="calibre3" /><strong class="calibre6">Weekday Sort Plus 1 Measure</strong> = [Weekday Sort Summed] + 1 <br class="calibre3" /><strong class="calibre6">Weekday Sort Plus 1 =</strong> 'Date'[Weekday Sort]+1</pre>
<p class="calibre7"><span>The </span><span><kbd class="calibre15">Weekday Sort Plus 1 CALC</kbd> column and the</span><span> <kbd class="calibre15">Weekday Sort Plus 1 Measure</kbd> column represent the concept of context transition. These two columns invoke the filter context (context transition) of the given row via the </span><kbd class="calibre15">CALCULATE()</kbd><span> function or implicitly via the reference of an existing measure, respectively:</span></p>
<ul class="calibre12">
<li class="calibre13"><kbd class="calibre15">Weekday Sort Plus 1 (SUM)</kbd> computes the sum of the <kbd class="calibre15">Weekday Sort</kbd> column plus one and repeats this value for each row</li>
<li class="calibre13"><kbd class="calibre15">Weekday Sort Plus 1 CALC</kbd> embeds a <kbd class="calibre15">SUM()</kbd> function within the <kbd class="calibre15">CALCULATE()</kbd> function prior to adding one</li>
<li class="calibre13"><kbd class="calibre15">Weekday Sort Plus 1 Measure</kbd> references an existing measure which sums the <kbd class="calibre15">Weekday Sort</kbd> column and then adds one</li>
<li class="calibre13"><kbd class="calibre15">Weekday Sort Plus 1</kbd> references the <kbd class="calibre15">Weekday Sort</kbd> column of the Date table and adds one</li>
</ul>
<p class="calibre7">The <kbd class="calibre15">Weekday Sort Plus 1 (SUM)</kbd> expression demonstrates that aggregation functions, in the absence of <kbd class="calibre15">CALCULATE()</kbd> or the implicit <kbd class="calibre15">CALCULATE()</kbd> when invoking measures, ignore row context. The three other columns all operate on a per-row basis (row context) but achieve their results via three different methods. <span>The <kbd class="calibre15">Weekday Sort Plus 1</kbd> column represents the default behavior of expressions executing in a row context such as calculated columns, <kbd class="calibre15">FILTER()</kbd>, and other iterating DAX functions.</span></p>
<div class="packt_tip pcalibre7 pcalibre6"><span>To develop more complex DAX measures, it can be necessary to ignore the row context of the input table, such as the <kbd class="calibre43">Weekday Sort Plus 1 SUM()</kbd> example or explicitly invoke the row context of the table. </span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-184">
<div id="calibre_link-723" class="calibre2">
<div id="calibre_link-724" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Scalar and table functions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The majority of DAX functions return a single value based on an aggregation or a logical evaluation of a table or column. For example, the <kbd class="calibre15">COUNTROWS()</kbd> and <kbd class="calibre15">DISTINCTCOUNT()</kbd> functions return individual numeric values based on a single table and a single column input parameter, respectively. The DAX functions which return individual values as their output, including information functions, such as <kbd class="calibre15">ISBLANK()</kbd> and <kbd class="calibre15">LOOKUPVALUE()</kbd>, are referred to as scalar functions. For relatively simple datasets and at early stages in projects, most DAX measures will reference a single scalar function with no other modifications, such as with <kbd class="calibre15">CALCULATE()</kbd>. </p>
<p class="calibre7">In addition to scalar functions, many DAX functions return a table as the output value. The tables returned by these functions, such as <kbd class="calibre15">FILTER()</kbd> and <kbd class="calibre15">ALL()</kbd>, are used as input parameters to other DAX measure expressions to impact the filter context under which the measure is executed via the <kbd class="calibre15">CALCULATE()</kbd> function. The DAX language has been extended to support many powerful table functions, such as <kbd class="calibre15">TOPN()</kbd>, <kbd class="calibre15">INTERSECT()</kbd>, and <kbd class="calibre15">UNION()</kbd>, thus providing further support for authoring DAX measures.</p>
<div class="packt_tip pcalibre7 pcalibre6">In addition to serving as table input parameters to DAX measures, the results of DAX table functions can be returned and exposed to client reporting tools. The most common example of this is in developing a paginated reporting services report either with <strong class="calibre6">SQL Server Reporting Services</strong> (<strong class="calibre6">SSRS</strong>) or the Power BI Report Server based on an Analysis Services Tabular model. Additionally, DAX table functions can return a summarized or filtered table within a Power BI dataset based on the other tables in the dataset. </div>
<p class="calibre7">As models grow in complexity and as model authors become more familiar with DAX, new measures increasingly leverage a combination of scalar functions (or existing measures based on scalar functions) and table functions. Per the <em class="calibre16">DAX Variables</em> section later in this chapter, both scalar and table values (based on scalar and table functions, respectively) can be stored as variables to further support abstraction and readability. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-185">
<div id="calibre_link-725" class="calibre2">
<div id="calibre_link-726" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">The CALCULATE() function</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The <kbd class="calibre15">CALCULATE()</kbd> function is the most important function in DAX as it enables the author to modify the filter context under which a measure is evaluated. Regardless of the fields used and filters applied in reports, the filter parameter input(s) to <kbd class="calibre15">CALCULATE()</kbd> will be applied. Specifically, the <kbd class="calibre15">CALCULATE()</kbd> function will either add a filter to a measure expression (for example, <kbd class="calibre15">Color = "Red"</kbd>), ignore the filters from a table or column (for example, <kbd class="calibre15">ALL(Product)</kbd>), or update/overwrite the filters applied within a report to the filter parameter specified in <kbd class="calibre15">CALCULATE()</kbd>. </p>
<p class="calibre7">The syntax of <kbd class="calibre15">CALCULATE()</kbd> is the following <kbd class="calibre15">CALCULATE(&lt;expression&gt;, &lt;filter1&gt;, &lt;filter2&gt;)</kbd>. Any number of filter parameters can be specified including no filter parameters such as <kbd class="calibre15">CALCULATE(SUM(Sales[Sales Amount]))</kbd>. When multiple filter parameters have been specified, the function will respect all of them together as a single condition via internal AND logic. The expression parameter is evaluated based on the new and final filter context applied via the filter parameters.</p>
<p class="calibre7">In the following measure, any filter applied to any column from the <kbd class="calibre15">Product</kbd> or <kbd class="calibre15">Sales Territory</kbd> tables will be ignored by the calculation:</p>
<pre class="calibre19"><strong class="calibre6">ISales Row Count (Ignore Product and Territory)</strong> = <br class="calibre3" />CALCULATE(COUNTROWS('Internet Sales'),ALL('Product'),ALL('Sales Territory'))</pre>
<p class="calibre7">The preceding measure represents one simple example of a table function (<kbd class="calibre15">ALL()</kbd>) being used in conjunction with a scalar function (<kbd class="calibre15">COUNTROWS()</kbd>) via <kbd class="calibre15">CALCULATE()</kbd>, as described in the previous session. </p>
<div class="packt_infobox">There are multiple forms of the <kbd class="calibre43">ALL()</kbd> function beyond <kbd class="calibre43">ALL(table)</kbd>. The <kbd class="calibre43">ALL()</kbd> function can be used to ignore the values from a single column or multiple columns, such as, the following two examples: <kbd class="calibre43">(All('Customer'[Customer City])</kbd> and <kbd class="calibre43">ALL('Customer'[Customer City], 'Customer'[Customer Country])</kbd>. Additionally, the <kbd class="calibre43">ALLEXCEPT()</kbd> function only allows certain columns specified to impact the filter context, and the <kbd class="calibre43">ALLSELECTED()</kbd> function ignores filters from inside a query but allows filters from outside the query.</div>
<p class="calibre7">Just as the <kbd class="calibre15">CALCULATE()</kbd> function is used to modify the filter context of scalar value expressions, the <kbd class="calibre15">CALCULATETABLE()</kbd> function is used to modify the filter context of expressions which return tables. For example, the following query expression returns all columns from the product dimension table and only the rows which match the two filter parameter conditions specified:</p>
<pre class="calibre19">EVALUATE<br class="calibre3" />CALCULATETABLE('Product',<br class="calibre3" />'Product'[Product Category] = "Bikes",<br class="calibre3" />'Product'[Product Dealer Price] &gt; 2100)</pre>
<p class="calibre7">The modified table result from <kbd class="calibre15">CALCULATETABLE()</kbd> can then be used as a parameter input to another table function such as <kbd class="calibre15">FILTER()</kbd> or as a filter parameter to <kbd class="calibre15">CALCULATE()</kbd>. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-186">
<div id="calibre_link-727" class="calibre2">
<div id="calibre_link-728" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Related tables</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">It's possible to reference other tables in the data model from within a row context via the <kbd class="calibre15">RELATED()</kbd> and <kbd class="calibre15">RELATEDTABLE()</kbd> functions. In the following screenshot from Data View of an import mode dataset, three calculated columns have been added to a <kbd class="calibre15">Date</kbd> dimension table with expressions referencing the <kbd class="calibre15">Freight</kbd> column of the <kbd class="calibre15">Internet Sales</kbd> fact table:</p>
<div class="cdpalignleft"><img src="images/000043.png" class="calibre134" /></div>
<div class="mce-root2">Row context with RELATEDTABLE()</div>
<p class="calibre7"> The DAX expressions used for each column are as follows:</p>
<pre class="calibre19"><strong class="calibre6">Related Internet Freight Cost (Sum)</strong> = <br class="calibre3" />SUMX(RELATEDTABLE('Internet Sales'),(SUM('Internet Sales'[Freight])))<br class="calibre3" /><strong class="calibre6">Related Internet Freight Cost (Measure)</strong> = <br class="calibre3" />SUMX(RELATEDTABLE('Internet Sales'),[Internet Sales Freight Cost])<br class="calibre3" /><strong class="calibre6">Internet Sales Freight Cost Measure</strong> = [Internet Sales Freight Cost]</pre>
<p class="calibre7"><span>Only the <kbd class="calibre15">Internet Sales Freight Cost Measure</kbd> returns the correct freight cost amount for each date. </span>The <kbd class="calibre15">Related Internet Freight Cost (Sum)</kbd> column computes the total freight cost on the entire <kbd class="calibre15">Internet Sales</kbd> table and uses this value for each related row before summing the result. For example, nine rows on the <kbd class="calibre15">Internet Sales</kbd> table have a date of <kbd class="calibre15">1/3/2016</kbd> and the sum of the <kbd class="calibre15">Freight</kbd> column on the <kbd class="calibre15">Internet Sales</kbd> table is <kbd class="calibre15">$618,839</kbd>. Given the <kbd class="calibre15">SUMX()</kbd> function, the <kbd class="calibre15">$5,569,554</kbd> value is the result of 9 (rows) multiplied by <kbd class="calibre15">$618,839</kbd>.</p>
<p class="calibre7">The <kbd class="calibre15">Related Internet Freight Cost (Measure)</kbd> also overcounts the freight cost for the day, specifically, whenever multiple rows of the same date have the same freight cost, the sum of these values is counted for each row. For example, five rows on the <kbd class="calibre15">Internet Sales</kbd> table have a date of <kbd class="calibre15">1/2/2016</kbd> and three of these rows have the same freight cost of <kbd class="calibre15">$89.46</kbd>. Given the <kbd class="calibre15">SUMX()</kbd> function, the value <em class="calibre16">$268.37 (3 * $89.46)</em> is added three separate times prior to adding the other two freight cost values (<kbd class="calibre15">$17.48</kbd> and <kbd class="calibre15">$85.00</kbd>) to produce <kbd class="calibre15">$908</kbd>.</p>
<div class="packt_infobox">The <kbd class="calibre43">RELATEDTABLE()</kbd> function is used to reference tables on the many sides of one-to-many relationships. Likewise, the <kbd class="calibre43">RELATED()</kbd> function is used to reference tables on the one side of many-to-one relationships. For example, a calculated column or the row context of an iterating function such as <kbd class="calibre43">SUMX()</kbd> on the Internet Sales fact table would use <kbd class="calibre43">RELATED()</kbd> to access a dimension table and apply logic referencing the dimension table per row of the Internet Sales table. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-187">
<div id="calibre_link-729" class="calibre2">
<div id="calibre_link-730" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">The FILTER() function</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The <kbd class="calibre15">FILTER()</kbd> function is one of the most important and powerful functions in DAX in that it allows complex logic to fully define the set of rows of a table. <kbd class="calibre15">FILTER()</kbd> accepts a table as an input and returns a table with each row respecting its defined condition. The <kbd class="calibre15">FILTER()</kbd> function is almost always used as a parameter to a <kbd class="calibre15">CALCULATE()</kbd> function and can add to the existing filter context or redefine the filter context by invoking <kbd class="calibre15">ALL()</kbd> as its table input. The date intelligence measures described later in this chapter utilize <kbd class="calibre15">FILTER()</kbd> to fully define the set of <kbd class="calibre15">Date</kbd> rows for the filter context.</p>
<p class="calibre7">In the following DAX measure, the <kbd class="calibre15">FILTER()</kbd> function is utilized against the <kbd class="calibre15">Date</kbd> table and implements a condition based on the existing <kbd class="calibre15">Internet Gross Sales</kbd> measure: </p>
<pre class="calibre19"><strong class="calibre6">Days with over 15K Gross Internet Sales</strong> = <br class="calibre3" />  CALCULATE(COUNTROWS('Date'),<br class="calibre3" />    FILTER('Date', [Internet Gross Sales] &gt; 15000))</pre>
<div class="packt_infobox">The ability to directly reference DAX measures is unique to the <kbd class="calibre43">FILTER()</kbd> function. For example, the following measure expression is not allowed by the DAX engine: <kbd class="calibre43">CALCULATE(COUNTROWS('Date'), [Internet Gross Sales] &gt; 15000)</kbd>.</div>
<p class="calibre7">The <kbd class="calibre15">Days with over 15K Gross Internet Sales</kbd> measure and the <kbd class="calibre15">Internet Gross Sales</kbd> base measure are used in the following Power BI report: </p>
<div class="cdpalignleft"><img src="images/000040.png" class="calibre135" /></div>
<div class="mce-root2">DAX measure with FILTER</div>
<p class="calibre7"><span>Given that the </span><kbd class="calibre15">FILTER()</kbd><span> function simply references the <kbd class="calibre15">Date</kbd> table and does not remove any filters via </span><kbd class="calibre15">ALL()</kbd><span>, the measure executes on each date contained in the matrix visual to return a <kbd class="calibre15">1</kbd> or a blank. When no dates are on the visual such as the subtotal row or the card visual, the total number of days that meet the condition (170 for the year 2015) is returned. If the <kbd class="calibre15">Internet Gross Sales</kbd> measure was not included in the table visual, by default Power BI would only display the dates with a <kbd class="calibre15">1</kbd> value for the <kbd class="calibre15">Days with over a 15K Gross Internet Sales</kbd> measure.</span></p>
<div class="packt_tip pcalibre7 pcalibre6">Given both its iterative (row-by-row) execution and the potential to apply complex measures to each row, it's important to use the <kbd class="calibre43">FILTER()</kbd> function carefully. For example, DAX measures should not use <kbd class="calibre43">FILTER()</kbd> directly against large fact tables. Additionally, <kbd class="calibre43">FILTER()</kbd> should not be used when it's not needed for simple measures such as the following two examples <kbd class="calibre43">CALCULATE([Internet Gross Sales],'Product'[Product Category] = "Bikes")</kbd><br class="calibre3" />
<kbd class="calibre43">CALCULATE([Reseller Gross Sales],'Product'[Product Color] IN {"Red", "White"},Promotion[Discount Percentage] &gt; .25)</kbd>.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-188">
<div id="calibre_link-731" class="calibre2">
<div id="calibre_link-732" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">DAX variables</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Variables can be defined within DAX measures and primarily serve to improve the readability of DAX expressions. Rather than creating and referencing separate DAX measures, variables provide an inline option, thereby limiting the volume of distinct measures in a dataset. As a basic example of variable syntax, the <kbd class="calibre15">"Last Refreshed"</kbd> text message described in the <em class="calibre16">Parameter Tables</em> section of <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>, uses a DAX variable in its expression, as follows:</p>
<pre class="calibre19"><strong class="calibre6">Last Refresh Msg</strong> = <br class="calibre3" />  VAR CurrentDateValue = MAX('CurrentDate'[CurrentDate])<br class="calibre3" />  RETURN<br class="calibre3" />  "Last Refreshed: " &amp; CurrentDateValue  </pre>
<p class="calibre7">The <kbd class="calibre15">VAR</kbd> function is used to name a variable and the <kbd class="calibre15">RETURN</kbd> keyword allows for the variable's result to be referenced by this name. In this example, the <kbd class="calibre15">CurrentDateValue</kbd> variable retrieves the date stored in the <kbd class="calibre15">CurrentDate</kbd> parameter table, and a string of text is concatenated with the variable to generate the text message.</p>
<div class="packt_tip pcalibre7 pcalibre6">Variables can sometimes be implemented to improve the performance of slow measures. Variables are only evaluated once and their resulting values (a scalar value or a table) can be referenced multiple times. Measures which produce fewer storage engine queries will almost always execute faster and make better use of hardware resources. Therefore, any DAX measure or query which makes multiple references to the same expression logic can be a good candidate for DAX variables. </div>
<p class="calibre7">A common use case for DAX variables is to split up the components of an otherwise more complex DAX expression. In the following example, six DAX variables are used to produce a filtered distinct count of accessory products and a filtered distinct count of clothing products: </p>
<pre class="calibre19"><strong class="calibre6">Reseller High Value Accessory and Clothing Products</strong> = <br class="calibre3" />/*<br class="calibre3" />Accessory category products with over 20K in net sales and over 32% net margin since last year <br class="calibre3" />Clothing category products with over 55K in net sales and over 28% net margin since last year<br class="calibre3" />Enable filtering from dimension tables related to Reseller Sales<br class="calibre3" />*/<br class="calibre3" />VAR AccessorySales = 20000 VAR AccessoryNetMargin = .32<br class="calibre3" />VAR ClothingSales = 50000 VAR ClothingNetMargin = .28<br class="calibre3" />//Distinct Accessory Products<br class="calibre3" />VAR AccessoryProducts = <br class="calibre3" />CALCULATE(DISTINCTCOUNT('Product'[Product Alternate Key]),<br class="calibre3" />    FILTER(<br class="calibre3" />    SUMMARIZE(<br class="calibre3" />    CALCULATETABLE('Reseller Sales',<br class="calibre3" />      'Date'[Calendar Year Status] IN {"Current Calendar Year", "Prior Calendar Year"},<br class="calibre3" />      'Product'[Product Category] = "Accessories"),<br class="calibre3" />      'Product'[Product Alternate Key]),<br class="calibre3" />      [Reseller Net Margin %] &gt;= AccessoryNetMargin &amp;&amp; [Reseller Net Sales] &gt;= AccessorySales))<br class="calibre3" />//Distinct Clothing Products<br class="calibre3" />VAR ClothingProducts = <br class="calibre3" />CALCULATE(DISTINCTCOUNT('Product'[Product Alternate Key]),<br class="calibre3" />    FILTER(<br class="calibre3" />    SUMMARIZE(<br class="calibre3" />    CALCULATETABLE('Reseller Sales',<br class="calibre3" />      'Date'[Calendar Year Status] IN {"Current Calendar Year", "Prior Calendar Year"},<br class="calibre3" />      'Product'[Product Category] = "Clothing"),<br class="calibre3" />      'Product'[Product Alternate Key]),<br class="calibre3" />      [Reseller Net Margin %] &gt;= ClothingNetMargin &amp;&amp; [Reseller Net Sales] &gt; ClothingSales))<br class="calibre3" />RETURN<br class="calibre3" />AccessoryProducts + ClothingProducts</pre>
<p class="calibre7">With the variables named and evaluated, the <kbd class="calibre15">RETURN</kbd> keyword simply adds the results of the two distinct count expressions contained within the <kbd class="calibre15">AccessoryProducts</kbd> and <kbd class="calibre15">ClothingProducts</kbd> variables. The multi-line comment at the top of the expression denoted by <kbd class="calibre15">/*</kbd> and <kbd class="calibre15">*/</kbd> makes the DAX measure easier to understand in the future. Single-line comments have been added using <kbd class="calibre15">//</kbd> to precede the distinct accessory and clothing products. With the variables declared in this structure, it becomes very easy to adjust the measure to different input thresholds such as a higher or lower net sales value or net margin rates.</p>
<div class="packt_tip pcalibre7 pcalibre6">The most efficient filtering conditions of measures should be implemented in measures first. Efficient filter conditions are those which don't require the <kbd class="calibre43">FILTER()</kbd> function, such as the calendar year status and product category filter conditions in the <kbd class="calibre43">Reseller High Value Accessory and Clothing Products</kbd> measure. Once the sufficient filters have been applied, more complex but less performant filtering conditions can operate on smaller sets of data, thus limiting their impact on query performance.</div>
<p class="calibre7">A Power BI report can leverage the measure in a Visual level filter to only display the specific products that meet the criteria of the measure. In the following table visual, only five products (2 <kbd class="calibre15">Accessories</kbd>, 3 <kbd class="calibre15">Clothing</kbd>) are displayed given the filter on the <kbd class="calibre15">Reseller High Value Accessory and Clothing Products</kbd> measure:</p>
<div class="cdpalignleft"><img src="images/000049.png" class="calibre136" /></div>
<div class="mce-root2">Variable-based DAX measure as a Visual level filter</div>
<p class="calibre7">The filter context of the <kbd class="calibre15">Reseller Sales</kbd> fact table is respected via the <kbd class="calibre15">SUMMARIZE()</kbd> function. Just like bidirectional cross-filtering via the <kbd class="calibre15">CROSSFILTER()</kbd> function and bidirectional relationships, other dimensions related to the <kbd class="calibre15">Reseller Sales</kbd> fact table can be used for filtering the measure. For example, a filter on the <kbd class="calibre15">Sales Territory Country</kbd> column for the <kbd class="calibre15">United States</kbd> would result in only one product.</p>
<div class="packt_infobox">It's necessary to reference the alternate key of the product dimension given the implementation of slowly changing dimension logic, as described in <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>. A single product can have multiple rows in its dimension table, reflecting various changes such as with list prices and product weight. These unique product keys would be reflected in the fact table, and so using the product key column would result in counting different versions of the same product multiple times.</div>
<p class="calibre7">In addition to scalar values like DAX measures, DAX variables can also store table values such as a specific set of customer key values or filter set of product rows. DAX measures can then reference and apply aggregation functions against this set of tables.</p>
<p class="calibre7">In the following example, two distinct sets of customer keys (tables) are computed via variables and then combined via the <kbd class="calibre15">UNION()</kbd> function to drive the filter context of the measure: </p>
<pre class="calibre19"><strong class="calibre6">Internet Sales First Year and Accessory Customers</strong> = <br class="calibre3" />VAR FirstYearCustomers = <br class="calibre3" />SUMMARIZE(<br class="calibre3" />  CALCULATETABLE('Internet Sales',<br class="calibre3" />    'Customer'[Customer History Segment] = "First Year Customer"),<br class="calibre3" />  'Customer'[Customer Alternate Key])<br class="calibre3" />VAR AccessoryCustomersThisYear = <br class="calibre3" />SUMMARIZE(<br class="calibre3" />CALCULATETABLE('Internet Sales',<br class="calibre3" />    'Date'[Calendar Year Status] = "Current Calendar Year",'Product'[Product Category] = "Accessories"),<br class="calibre3" />'Customer'[Customer Alternate Key])<br class="calibre3" />VAR TargetCustomerSet = <br class="calibre3" />DISTINCT(UNION(FirstYearCustomers,AccessoryCustomersThisYear))<br class="calibre3" />RETURN<br class="calibre3" />CALCULATE(DISTINCTCOUNT(Customer[Customer Alternate Key]),TargetCustomerSet)</pre>
<p class="calibre7">The <kbd class="calibre15">DISTINCT()</kbd> function is applied against the result of the <kbd class="calibre15">UNION()</kbd> function since duplicate rows are retained by the <kbd class="calibre15">UNION()</kbd> function in DAX. Just like the previous example with variables, the <kbd class="calibre15">SUMMARIZE()</kbd> function is used to both embed filter conditions and to respect the filter context of the <kbd class="calibre15">Internet Sale</kbd>s fact table. In this example, <kbd class="calibre15">SUMMARIZE()</kbd> allows selections on dimension tables related to the <kbd class="calibre15">Internet Sales</kbd> fact table, such as <kbd class="calibre15">Sales Territory</kbd> to also impact the measure.</p>
<p class="calibre7">In the following matrix visual of a Power BI report, the <kbd class="calibre15">Sales Territory Country</kbd> column from the <kbd class="calibre15">Sales Territory</kbd> dimension is used as the column header and the results from the measure reflect each individual country:</p>
<div class="cdpalignleft"><img src="images/000060.png" class="calibre137" /></div>
<div class="mce-root2">Table-valued DAX variable-based measure</div>
<p class="calibre7">The filter context embedded into both variables (<kbd class="calibre15">FirstYearCustomers</kbd> and <kbd class="calibre15">AccessoryCustomersThisYear</kbd>) of the measure provides the equivalent behavior of bidirectional cross-filtering between <kbd class="calibre15">Internet Sales</kbd> and the <kbd class="calibre15">Customer</kbd> dimension. The <kbd class="calibre15">SUMMARIZE()</kbd> function is used rather than <kbd class="calibre15">CROSSFILTER()</kbd> when given a performance advantage. See the <em class="calibre16">Performance testing</em> section later in this chapter for additional details on performance testing. </p>
<div class="packt_tip pcalibre7 pcalibre6">The combination of table-valued DAX variables and set-based DAX functions such as <kbd class="calibre43">UNION()</kbd>, <kbd class="calibre43">INTERSECT()</kbd>, and <kbd class="calibre43">EXCEPT()</kbd> support a wide variety of analytical operations. Authors of DAX measures should familiarize themselves with the essentials of DAX as a query language, particularly the <kbd class="calibre43">SUMMARIZE()</kbd> and <kbd class="calibre43">SUMMARIZECOLUMNS()</kbd> functions. Custom tables resulting from DAX queries are often needed by DAX measure expressions and can also be used in other applications such as SSRS.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-189">
<div id="calibre_link-733" class="calibre2">
<div id="calibre_link-734" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Base measures</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Before any custom or complex DAX measures can be developed, a set of relatively simple base measures must be implemented first. These measures represent the metrics from the <em class="calibre16">Define the facts</em> section of <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>, and thus contain validated and approved business definitions. For Adventure Works, a set of 12 base measures related to sales, cost, and margins are applicable to both the <kbd class="calibre15">Internet Sales</kbd> and <kbd class="calibre15">Reseller Sales</kbd> fact tables, such as the following:</p>
<pre class="calibre19"><strong class="calibre6">Reseller Gross Sales</strong> = SUMX('Reseller Sales',<br class="calibre3" />    'Reseller Sales'[Unit Price]*'Reseller Sales'[Order Quantity])<br class="calibre3" /><strong class="calibre6">Reseller Net Sales</strong> = [Reseller Gross Sales] - [Reseller Sales Discounts]<br class="calibre3" /><strong class="calibre6">Reseller Sales Product Cost</strong> = SUMX('Reseller Sales',<br class="calibre3" />'Reseller Sales'[Order Quantity]*'Reseller Sales'[Product Standard Cost])  <br class="calibre3" /><strong class="calibre6">Reseller Cost of Sales</strong> = [Reseller Sales Product Cost] + [Reseller Sales Freight Cost]<br class="calibre3" /><strong class="calibre6">Reseller Gross Product Margin</strong> = [Reseller Gross Sales] - [Reseller Sales Product Cost]<br class="calibre3" /><strong class="calibre6">Reseller Gross Product Margin %</strong> = DIVIDE([Reseller Gross Product Margin],[Reseller Gross Sales])<br class="calibre3" /><strong class="calibre6">Reseller Net Product Margin</strong> = [Reseller Net Sales] - [Reseller Sales Product Cost]<br class="calibre3" /><strong class="calibre6">Reseller Net Product Margin %</strong> = DIVIDE([Reseller Net Product Margin],[Reseller Net Sales])<br class="calibre3" /><strong class="calibre6">Reseller Gross Margin</strong> = [Reseller Gross Sales] - [Reseller Cost of Sales]<br class="calibre3" /><strong class="calibre6">Reseller Gross Margin %</strong> = DIVIDE([Reseller Gross Margin],[Reseller Gross Sales])<br class="calibre3" /><strong class="calibre6">Reseller Net Margin</strong> = [Reseller Net Sales] - [Reseller Cost of Sales]<br class="calibre3" /><strong class="calibre6">Reseller Net Margin %</strong> = DIVIDE([Reseller Net Margin],[Reseller Net Sales])</pre>
<p class="calibre7">As shown in the <em class="calibre16">Fact table columns</em> section from <a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em>, three fact table columns (<kbd class="calibre15">Extended Amount</kbd>, <kbd class="calibre15">Sales Amount</kbd>, and <kbd class="calibre15">Total Product Cost</kbd>) were excluded from the Power BI fact table to save resources. The <kbd class="calibre15">SUMX()</kbd> function is used to compute the equivalent values from these three columns to support the <kbd class="calibre15">Gross Sales</kbd>, <kbd class="calibre15">Net Sales</kbd>, and <kbd class="calibre15">Product Cost</kbd> measures, respectively.</p>
<div class="packt_infobox">Sales discounts and freight costs, both simple sums of their respective fact table columns, are the two measures that create differences among the base measures. Discounts separate gross sales from net sales and freight costs separate the cost of sales from product costs only. The distinct definitions of the base measures support common analysis needs, such as the profitability (margin) of sales inclusive or exclusive of freight costs.</div>
<p class="calibre7">With base measures created for both <kbd class="calibre15">Reseller Sales</kbd> and <kbd class="calibre15">Internet Sales</kbd> fact tables, an additional set of base measures can be created for Adventure Works as an organization. Several of these measures can simply sum the <kbd class="calibre15">Reseller Sales</kbd> and <kbd class="calibre15">Internet Sales</kbd> measures as shown in the following examples:</p>
<pre class="calibre19"><strong class="calibre6">AdWorks Net Sales</strong> = [Internet Net Sales] + [Reseller Net Sales] <br class="calibre3" /><strong class="calibre6">AdWorks Cost of Sales</strong> = [Internet Cost of Sales] + [Reseller Cost of Sales]<br class="calibre3" /><strong class="calibre6">AdWorks Net Margin</strong> = [AdWorks Net Sales] - [AdWorks Cost of Sales]<br class="calibre3" /><strong class="calibre6">AdWorks Net Margin %</strong> = DIVIDE([AdWorks Net Margin],[AdWorks Net Sales])</pre>
<p class="calibre7">Additional DAX measures with specific filtering or evaluation logic such as date intelligence metrics can reference the base measures in their expressions. Via this measure branching, any subsequent changes to the definition of the base measures will be automatically reflected in other dependent measures. Additionally, the readability of the custom measures is improved, as these expressions only contain their specific logic.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-190">
<div id="calibre_link-735" class="calibre2">
<div id="calibre_link-736" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Measure support expressions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Large and complex Power BI datasets with many measures may have one or multiple measure support tables. As shown in the previous chapters, these hidden tables don't contain data and aren't refreshed with the dataset, but serve as the home table for commonly used DAX expressions. Unlike DAX variables, hidden DAX measure expressions are globally available to other DAX measures and queries. Measure support expressions, therefore, serve as a staging and consolidation layer to simplify DAX measures. </p>
<p class="calibre7">The measure support table may contain any of the following types of expressions: </p>
<ul class="calibre12">
<li class="calibre13">KPI targets</li>
<li class="calibre13">Current and prior periods</li>
<li class="calibre13">Filter context information</li>
</ul>
<p class="calibre7">The two measures described in the <em class="calibre16">Measure support logic</em> section of <a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em>, represent the filter context information type of measure support. These measures typically use the <kbd class="calibre15">ISFILTERED()</kbd> or <kbd class="calibre15">ISCROSSFILTERED()</kbd> functions and are referenced within conditional expressions of other measures. Additionally, the <kbd class="calibre15">USERPRINCIPALNAME()</kbd> function is a good candidate for the Measure Support table if dynamic RLS is needed, or if other, user-based functionality is built into the dataset. </p>
<div class="packt_infobox">The <kbd class="calibre43">ISFILTERED()</kbd> function is limited to a specific column and only returns a true value when the given column is directly filtered. The <kbd class="calibre43">ISCROSFFILTERED()</kbd> function can reference a column or a table and returns true when one of the following three conditions are met:
<ul class="calibre12">
<li class="calibre13">The column referenced is directly filtered</li>
<li class="calibre13">A column on the same table as the column referenced is filtered</li>
<li class="calibre13">A column on a table which has a cross-filtering relationship to the table or column referenced is filtered</li>
</ul>
</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-191">
<div id="calibre_link-737" class="calibre2">
<div id="calibre_link-738" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">KPI Targets</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The standard <strong class="calibre6">Key Performance Indicator</strong> (<strong class="calibre6">KPI</strong>) visual in Power BI Desktop compares an indicator measure relative to a <kbd class="calibre15">Target</kbd> measure. The variance between the indicator and the target is displayed in the visual and is used to drive the color formatting (for example, red = bad; green = good). For many measures, a corresponding target measure may need to be created that applies some calculation logic to an existing measure. The following measure is simply 10% greater than the previous year's year-to-date net sales:</p>
<pre class="calibre19"><strong class="calibre6">Target: 10% Above PY YTD Internet Sales</strong> = [Internet Net Sales (PY YTD)] * 1.10</pre>
<p class="calibre7">In a standard KPI visual, the target measure is displayed as the goal and used to calculate the variance percentage between the indicator and the target. In the following example, a $9.2M indicator value <kbd class="calibre15">Internet Net Sales</kbd> (YTD) is 5.8% below the 10% growth target measure of $9.8M:</p>
<div class="cdpalignleft"><img src="images/000070.png" class="calibre138" /></div>
<div class="mce-root2">Standard KPI Visual</div>
<p class="calibre7">Several other common visuals in Power BI benefit from target measures, including the bullet chart and the gauge visual. Several of these visuals can use multiple target measures to define alternative thresholds, such as the min and max values displayed.</p>
<div class="packt_tip pcalibre7 pcalibre6">In certain scenarios, a dedicated table of corporate target measures can be added to a dataset. For example, a table may contain columns for expected or target customer counts, products sold, and other metrics at a given date's granularity. Target measures can be created to access the values of this table via utility functions, such as <kbd class="calibre43">LOOKUPVALUE()</kbd>. <br class="calibre3" />
<br class="calibre3" />
The <kbd class="calibre43">LOOKUPVALUE()</kbd> function is particularly useful because it ignores the current filter context. As shown in the examples in the following section, the <kbd class="calibre43">LOOKUPVALUE()</kbd> function can be relied on to provide the same input value to other measures, such as a date or a number referring to specific date rows, regardless of any filters applied in the report.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-192">
<div id="calibre_link-739" class="calibre2">
<div id="calibre_link-740" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Current and prior periods</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A common requirement of date intelligence metrics is to compare the YTD total for a measure versus the equivalent time period of the prior year. For example, on November 14, 2017, the visual would compare January through October of 2017 versus January through October of 2016. Without any external filtering, however, a standard YTD measure would include the 14 days of November in 2017 and would capture the entire year of 2016 if the year 2016 was in the filter context. To deliver equivalent or <em class="calibre16">apples to apples</em> comparisons of equal time periods, the filter context of measures can be further customized. </p>
<p class="calibre7">The following measures retrieve the year-to-date net sales through the prior calendar month and prior calendar week. For example, throughout the month of November, the <kbd class="calibre15">YTD Last Month</kbd> measure would, at most, only retrieve the net sales through the month of October. Likewise, the <kbd class="calibre15">YTD Last Week</kbd> measure would, at most, only include the net sales through the end of the prior week of the year (45):</p>
<pre class="calibre19"><strong class="calibre6">Prior Calendar Month Number</strong> = <br class="calibre3" />VAR CurrentDay = TODAY()<br class="calibre3" />RETURN<br class="calibre3" />IF (<br class="calibre3" />LOOKUPVALUE('Date'[Calendar Month Number],'Date'[Date],CurrentDay) = 1,12,<br class="calibre3" />LOOKUPVALUE('Date'[Calendar Month Number],'Date'[Date],CurrentDay)-1<br class="calibre3" />) <br class="calibre3" /><strong class="calibre6">Prior Calendar Week Number</strong> = <br class="calibre3" />VAR CurrentDay = TODAY()<br class="calibre3" />RETURN<br class="calibre3" />IF(<br class="calibre3" />LOOKUPVALUE('Date'[Calendar Week Number in Year],'Date'[Date],CurrentDay) = 1, CALCULATE(MAX('Date'[Calendar Week Number in Year]),FILTER(ALL('Date'),'Date'[Calendar Year] = MAX('Date'[Calendar Year]) - 1)),<br class="calibre3" />LOOKUPVALUE('Date'[Calendar Week Number in Year],'Date'[Date],CurrentDay)-1)<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Net Sales (YTD Last Month)</strong> = <br class="calibre3" />IF([Prior Calendar Month Number] &lt;&gt; 12,<br class="calibre3" />CALCULATE([Internet Net Sales], FILTER(ALL('Date'),'Date'[Calendar Year] = MAX('Date'[Calendar Year]) &amp;&amp; <br class="calibre3" />   'Date'[Date] &lt;= MAX('Date'[Date]) &amp;&amp; 'Date'[Calendar Month Number] &lt;= [Prior Calendar Month Number])),<br class="calibre3" />CALCULATE([Internet Net Sales], FILTER(ALL('Date'), 'Date'[Calendar Year] = MAX('Date'[Calendar Year])-1 &amp;&amp; 'Date'[Date] &lt;= MAX('Date'[Date]) &amp;&amp; 'Date'[Calendar Month Number] &lt;= [Prior Calendar Month Number])))<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Net Sales (YTD Last Week)</strong> = <br class="calibre3" />VAR CurrentWeek = LOOKUPVALUE('Date'[Calendar Week Number in Year],'Date'[Date],TODAY())<br class="calibre3" />RETURN<br class="calibre3" />IF(CurrentWeek &lt;&gt; 1,<br class="calibre3" />CALCULATE([Internet Net Sales], FILTER(ALL('Date'),'Date'[Calendar Year] = MAX('Date'[Calendar Year]) &amp;&amp; <br class="calibre3" />    'Date'[Date] &lt;= MAX('Date'[Date]) &amp;&amp; 'Date'[Calendar Week Number in Year] &lt;= [Prior Calendar Week Number])),<br class="calibre3" />CALCULATE([Internet Net Sales], FILTER(ALL('Date'),'Date'[Calendar Year] = MAX('Date'[Calendar Year])-1 &amp;&amp; 'Date'[Date] &lt;= MAX('Date'[Date]) &amp;&amp; 'Date'[Calendar Week Number in Year] &lt;= [Prior Calendar Week Number])))</pre>
<p class="calibre7">For any prior calendar year in the filter context, the (<kbd class="calibre15">YTD Last Month</kbd>) measure would only include January through October for this given year. Likewise, the (<kbd class="calibre15">YTD Last Week</kbd>) measure would only include weeks 1 through 45 of the given year. By embedding this dynamic filtering logic, it's possible to use these measures in report visuals without applying any additional filters.</p>
<div class="packt_infobox">The <kbd class="calibre43">TODAY()</kbd> function combined with the <kbd class="calibre43">LOOKUPVALUE()</kbd> function makes it possible to retrieve values at query time relative to the current date. In the previous example, the month and week number columns of the current year <span>(for example, October = 10)</span> are queried via <kbd class="calibre43">LOOKUPVALUE()</kbd> based on the current date. With these values retrieved, subtracting one from the results provides the value associated with the prior month and prior week, respectively. These measures are then referenced in the <kbd class="calibre43">FILTER()</kbd> function of their respective year-to-date measures.</div>
<p class="calibre7">Similar to this simple example, dynamically computed dates and other values make it possible to create measures for the current date and yesterday:</p>
<pre class="calibre19"><strong class="calibre6">Internet Net Sales (Today)</strong> = CALCULATE([Internet Net Sales],<br class="calibre3" />FILTER(ALL('Date'),'Date'[Date] = TODAY()))<br class="calibre3" /><strong class="calibre6"><br class="calibre3" />Internet Net Sales (Yesterday)</strong> = CALCULATE([Internet Net Sales],<br class="calibre3" />FILTER(ALL('Date'),'Date'[Date] = TODAY()-1)) </pre>
<p class="calibre7">Along with the date intelligence metrics described in the following section, a rich set of date-based metrics give users of Power BI reports and dashboards visibility for both short and long-term results.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-193">
<div id="calibre_link-741" class="calibre2">
<div id="calibre_link-742" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Date intelligence metrics</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Date intelligence metrics are typically the first set of measures to be added to a dataset following base measures. These measures reference the base measures and add a custom filtering condition to the <kbd class="calibre15">Date</kbd> dimension table, thus providing visibility to multiple distinct time intervals, such as year-to-date and the previous year-to-date. Given their built-in date filtering logic, Power BI reports and dashboards can be developed faster and without manual maintenance costs of updating date filter conditions.</p>
<p class="calibre7">The following four measures apply custom filter contexts to either return the current year, month, and week by default, or the latest of these time intervals given the date filters applied in a report:</p>
<pre class="calibre19"><strong class="calibre6">Internet Net Sales (CY)</strong> = CALCULATE([Internet Net Sales],FILTER(ALL('Date'),<br class="calibre3" />  'Date'[Calendar Year] = MAX('Date'[Calendar Year]) &amp;&amp; <br class="calibre3" />  'Date'[Date] &gt;= MIN('Date'[Date]) &amp;&amp; 'Date'[Date] &lt;= MAX('Date'[Date])))<strong class="calibre6"><br class="calibre3" /><br class="calibre3" />Internet Net Sales (YTD)</strong> = CALCULATE([Internet Net Sales],<br class="calibre3" />  FILTER(ALL('Date'),'Date'[Calendar Year] = MAX('Date'[Calendar Year]) &amp;&amp; <br class="calibre3" />    'Date'[Date] &lt;= MAX('Date'[Date])))<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Net Sales (MTD)</strong> = CALCULATE([Internet Net Sales],<br class="calibre3" />  FILTER(ALL('Date'),'Date'[Calendar Year Month Number] = MAX('Date'[Calendar Year Month Number]) &amp;&amp; <br class="calibre3" />    'Date'[Date] &lt;= MAX('Date'[Date])))<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Net Sales (WTD)</strong> = CALCULATE([Internet Net Sales],<br class="calibre3" />  FILTER(ALL('Date'),'Date'[Calendar Year Week Number] = MAX('Date'[Calendar Year Week Number]) &amp;&amp; <br class="calibre3" />    'Date'[Date] &lt;= MAX('Date'[Date])))</pre>
<p class="calibre7"><span>The use of the <kbd class="calibre15">MIN()</kbd> and <kbd class="calibre15">MAX()</kbd> functions within the <kbd class="calibre15">FILTER()</kbd> function invokes the filter context of the report query. For example, if a report page is filtered to the second quarter of 2016 (2016-Q2), the <kbd class="calibre15">CY</kbd> measure will only return the sales from these three months while the YTD measure will include both the first and second quarter of 2016. The <strong class="calibre6">month-to-date</strong> (<strong class="calibre6">MTD</strong>) and <strong class="calibre6">week-to-date</strong> (<strong class="calibre6">WTD</strong>) measures will return the sales for June of 2016 and Week 27 of 2016, the last month and week in the filter context.</span></p>
<p class="calibre7"><span>The date dimension table only contains rows through the current date. Therefore, in the absence of any other date filters applied in a report, these measures default to the current YTD, MTD, and WTD totals for net sales per the following multi-row card visual:</span></p>
<div class="cdpalignleft"><span><img src="images/000081.png" width="424" height="53" class="calibre139" /> </span></div>
<div class="mce-root2">Date intelligence metrics for the current year</div>
<p class="calibre7">The (<kbd class="calibre15">CY</kbd>) measure returns the same value as the YTD measure when no other date filters are applied.</p>
<div class="packt_infobox">The MTD and WTD measure both references a numeric column on the date table that corresponds to the given granularity. For example, December of 2016 and January of 2017 are represented by the values 96 and 97 in the <kbd class="calibre43">Calendar Year Month Number</kbd> column. As shown in the previous chapter, these sequential columns are critical for date intelligence and are also used by the Sort By column property.</div>
<p class="calibre7">The following set of DAX measures return the prior year, month, and week given the filter context of the report: </p>
<pre class="calibre19"><strong class="calibre6">Internet Net Sales (PY)</strong> = CALCULATE([Internet Net Sales],FILTER(ALL('Date'),<br class="calibre3" />  CONTAINS(VALUES('Date'[Prior Calendar Year Date]),'Date'[Prior Calendar Year Date],'Date'[Date])))<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Net Sales (PYTD)</strong> = CALCULATE([Internet Net Sales],<br class="calibre3" />  FILTER(ALL('Date'),'Date'[Calendar Year] = MAX('Date'[Calendar Year])-1 &amp;&amp; <br class="calibre3" />    'Date'[Date] &lt;= MAX('Date'[Prior Calendar Year Date])))<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Net Sales (PMTD)</strong> = CALCULATE([Internet Net Sales],<br class="calibre3" />  FILTER(ALL('Date'),'Date'[Calendar Year Month Number] = MAX('Date'[Calendar Year Month Number])-1 &amp;&amp; <br class="calibre3" />      'Date'[Date] &lt;= MAX('Date'[Prior Calendar Month Date])))<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Net Sales (PWTD)</strong> = CALCULATE([Internet Net Sales],<br class="calibre3" />  FILTER(ALL('Date'),'Date'[Calendar Year Week Number] = MAX('Date'[Calendar Year Week Number])-1 &amp;&amp; <br class="calibre3" />      'Date'[Date] &lt;= MAX('Date'[Prior Calendar Week Date])))</pre>
<p class="calibre7">The <kbd class="calibre15">Calendar Year</kbd>, <kbd class="calibre15">Calendar Year Month Number</kbd>, and <kbd class="calibre15">Calendar Year Week Number</kbd> columns used by the current period measures are also referenced by the prior period measures. However, the prior period measures subtract a value of one from the result of the <kbd class="calibre15">MAX()</kbd> function to navigate to the given preceding period.</p>
<p class="calibre7">In the PY measure, the <kbd class="calibre15">CONTAINS()</kbd> function used within the filtering parameter of the <kbd class="calibre15">FILTER()</kbd> function returns a true or false value for each prior calendar year date based on the date column. The date column reflects the filter context of the report query and thus only the corresponding prior year dates are passed to <kbd class="calibre15">FILTER()</kbd> as the modified filter context. </p>
<div class="packt_tip pcalibre7 pcalibre6">DAX provides a number of functions dedicated to date intelligence, such as <kbd class="calibre43">DATEADD()</kbd> and <kbd class="calibre43">SAMEPERIODLASTYEAR()</kbd>. These functions are much less verbose than the techniques from these examples, but they're also generally limited to standard calendars. The approach described in this section leveraging core DAX functions, such as <kbd class="calibre43">FILTER()</kbd> and <kbd class="calibre43">ALL()</kbd>, can also be applied to financial calendars. Additionally, the filter navigation (for example, <kbd class="calibre43">MAX()</kbd> - 1) implemented in the prior period measures is applicable to more advanced date intelligence expressions. </div>
<p class="calibre7">Each prior period measure references a column containing date values that have been adjusted relative to the date column. The following screenshot of the date dimension table in SQL Server highlights these three columns relative to the date column:</p>
<div class="cdpalignleft"><img src="images/000091.png" class="calibre140" /></div>
<div class="mce-root2">Prior date columns in the date dimension</div>
<p class="calibre7">Given the value of date intelligence measures and the relative static nature of the date dimension, it's recommended to develop a robust date dimension table. If the necessary columns cannot be implemented in the source database itself, the columns can be computed within the SQL view or the M query of the <kbd class="calibre15">Date</kbd> table.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-194">
<div id="calibre_link-743" class="calibre2">
<div id="calibre_link-744" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Current versus prior and growth rates</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">With date intelligence measures developed for the current and prior periods, growth or variance measures can be added to the dataset, comparing the two values. In the following example, a <strong class="calibre6">year-over-year</strong> (<kbd class="calibre15">YOY</kbd>) and a <strong class="calibre6">year-over-year year-to-date</strong> (<kbd class="calibre15">YOY YTD</kbd>) measure have been created based on the current year and prior year measures from the preceding section:</p>
<pre class="calibre19"><strong class="calibre6">Internet Net Sales (YOY)</strong> = [Internet Net Sales (CY)] - [Internet Net Sales (PY)] <br class="calibre3" /><strong class="calibre6">Internet Net Sales (YOY YTD)</strong> = [Internet Net Sales (YTD)] - [Internet Net Sales (PY YTD)] </pre>
<p class="calibre7">Finally, growth percentage measures can be added, which express the variance between the current and prior period measures as a percentage of the prior period. The following measures reference the above YOY measures as the numerator within a <kbd class="calibre15">DIVIDE()</kbd> function:</p>
<pre class="calibre19"><strong class="calibre6">Internet Net Sales (YOY %)</strong> = DIVIDE([Internet Net Sales (YOY)],[Internet Net Sales (PY)]) <br class="calibre3" /><strong class="calibre6">Internet Net Sales (YOY YTD %)</strong> = DIVIDE([Internet Net Sales (YOY YTD)],[Internet Net Sales (PY YTD)])</pre>
<div class="packt_tip pcalibre7 pcalibre6">The <kbd class="calibre43">DIVIDE()</kbd> function returns a blank value if the denominator is zero or a blank value by default. The divide operator (<kbd class="calibre43">/</kbd>), however, will return an infinity value when dividing by zero or a blank. Given the superior error-handling behavior and performance advantages of <kbd class="calibre43">DIVIDE()</kbd>, the <kbd class="calibre43">DIVIDE()</kbd> function is recommended for computing division in DAX.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-7">
<div id="calibre_link-745" class="calibre2">
<div id="calibre_link-746" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Rolling periods</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Rolling period and trailing average measures are also very common in datasets, as they help to smooth out individual outliers and analyze longer-term trends. For example, a significant business event or variance 10 months ago will have a relatively small impact on a trailing 12 month total. Additionally, this variance will not impact trailing 30 day or 3, 6, and 9-month rolling period measures.</p>
<p class="calibre7">The following two measures capture the trailing 60 days of sales history and the 60 days of history prior to the trailing 60 days:</p>
<pre class="calibre19"><strong class="calibre6">Internet Net Sales (Trailing 60 Days)</strong> = <br class="calibre3" />VAR MaxDate = MAX('Date'[Date])<br class="calibre3" />VAR StartDate = MaxDate - 59<br class="calibre3" />RETURN<br class="calibre3" />CALCULATE([Internet Net Sales],FILTER(ALL('Date'),'Date'[Date] &gt;= StartDate &amp;&amp; 'Date'[Date] &lt;= MaxDate)) <br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Net Sales Trailing (60 to 120 Days)</strong> = <br class="calibre3" />VAR MaxDate = MAX('Date'[Date])<br class="calibre3" />VAR EndDate = MaxDate - 60<br class="calibre3" />VAR StartDate = EndDate - 59<br class="calibre3" />RETURN<br class="calibre3" />CALCULATE([Internet Net Sales],FILTER(ALL('Date'), 'Date'[Date] &gt;= StartDate &amp;&amp; 'Date'[Date] &lt;= EndDate)) </pre>
<p class="calibre7">The two 60-day measures compute the dates for the filter condition within DAX variables and then pass these values into the <kbd class="calibre15">FILTER()</kbd> function. The two measures help to answer the question "Is Internet sales growth accelerating?". The following table visual in Power BI Desktop displays the measures by date and as a subtotal value:</p>
<div class="cdpalignleft"><img src="images/000102.png" class="calibre141" /></div>
<div class="mce-root2">Trailing 60 and 60 to 120-day measures</div>
<p class="mce-root3">With this logic, the value for the trailing 60 days measure on November 15th, 2017 includes Internet sales since September 17th, 2017. The 60 to 120 days measure, however, includes sales history from July 19th, 2017 through September 16th, 2017. The subtotal value reflects the latest date in the filter context&mdash;November 15th, 2017, in this example.</p>
<div class="packt_infobox">Rolling period or trailing average measures generally require the sequential numeric date dimension columns in the date suggested in both previous chapters. Very similar to the prior period measures from the previous section (for example, PY YTD), rolling period measures can reference sequential columns for the given granularity and modify the date filter by adding or subtracting values. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-20">
<div id="calibre_link-747" class="calibre2">
<div id="calibre_link-748" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dimension metrics</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The majority of DAX measures will apply aggregating functions to numeric columns of fact tables. However, several of the most important metrics of a dataset are those which identify the presence of dimensions in fact tables such as the count of customers who've purchased and those who haven't. It can also be necessary to count the distinct values of a dimension column such as the number of postal codes sold to or the number of distinct marketing promotions over a period of time.</p>
<p class="calibre7">In the dataset for this project, the customer dimension table is exclusive to the <kbd class="calibre15">Internet Sales</kbd> fact table, and the measure should only count customers with internet sales history. Additionally, slowly changing dimension logic has been implemented so that a single customer defined by the <kbd class="calibre15">Customer Alternate Key</kbd> column could have multiple rows defined by the <kbd class="calibre15">Customer Key</kbd> column.</p>
<p class="calibre7">The following two DAX measures count the number of unique customers and products with internet sales history:</p>
<pre class="calibre19"><strong class="calibre6">Internet Sales Customer Count</strong> = <br class="calibre3" />CALCULATE(DISTINCTCOUNT(Customer[Customer Alternate Key]), 'Internet Sales')<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Sales Products Sold Count</strong> = <br class="calibre3" />CALCULATE(DISTINCTCOUNT('Product'[Product Alternate Key]),'Internet Sales') </pre>
<p class="calibre7">By invoking the <kbd class="calibre15">Internet Sales</kbd> fact table as a filtering parameter to <kbd class="calibre15">CALCULATE()</kbd>, any filter applied to a related dimension table such as <kbd class="calibre15">Sales Territory</kbd> will also impact the measure. This behavior is the same as bidirectional cross-filtering between the <kbd class="calibre15">Internet Sales</kbd> and <kbd class="calibre15">Customer</kbd> table. However, in the event that no filters have been applied in the reporting tool (for example, Power BI or Excel), the <kbd class="calibre15">Internet Sales</kbd> table filter ensures that only customers with Internet Sales histories are counted.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-32">
<div id="calibre_link-749" class="calibre2">
<div id="calibre_link-750" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Missing dimensions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Missing dimension measures are commonly used in churn and exception reporting and analyses. For example, a report may be needed which displays the specific products that haven't sold or the past customers who haven't made a purchase in a given filter context. Additionally, missing dimension measures give greater meaning to other dimension measures. For instance, the count of products sold in a period may not be as useful without knowing how many products were not sold over this same period. </p>
<p class="calibre7">The following DAX measure counts the number of unique customers without Internet Sales history:</p>
<pre class="calibre19"><strong class="calibre6">Internet Sales Customers Missing</strong> = <br class="calibre3" />CALCULATE(DISTINCTCOUNT('Customer'[Customer Alternate Key]),<br class="calibre3" />  FILTER(VALUES('Customer'[Customer Alternate Key]),<br class="calibre3" />    ISEMPTY(RELATEDTABLE('Internet Sales'))))<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Sales Products Missing</strong> = <br class="calibre3" />CALCULATE(DISTINCTCOUNT('Product'[Product Alternate Key]),<br class="calibre3" />  FILTER(VALUES('Product'[Product Alternate Key]),<br class="calibre3" />    ISEMPTY(RELATEDTABLE('Internet Sales'))))</pre>
<p class="calibre7">The <kbd class="calibre15">Internet Sales Customers Missing</kbd> measure references the <kbd class="calibre15">'Internet Sales'</kbd> fact table like the customer count measure does, but only within the <kbd class="calibre15">ISEMPTY()</kbd> function. The <kbd class="calibre15">ISEMPTY()</kbd> function operates as the filter parameter of the <kbd class="calibre15">FILTER()</kbd> function and returns a <kbd class="calibre15">true</kbd> or a <kbd class="calibre15">false</kbd> value for each distinct <kbd class="calibre15">Customer Alternate Key</kbd> provided by the <kbd class="calibre15">VALUES()</kbd> function. Only the customer rows without any related rows in the <kbd class="calibre15">Internet Sales</kbd> fact table are marked as true and this filtered set of customer rows is passed to the <kbd class="calibre15">DISTINCTCOUNT()</kbd> function. The same methodology is applied to the <kbd class="calibre15">Internet Sales Products Missing</kbd> measure.</p>
<p class="calibre7">The following matrix visual of a Power BI report has been filtered to four calendar quarters and broken out by the <kbd class="calibre15">Sales Territory Group</kbd>:</p>
<div class="cdpalignleft"><img src="images/000113.png" class="calibre142" /></div>
<div class="mce-root2">Internet Sales Customers and Customers Missing</div>
<p class="calibre7">Any other dimension table with a relationship to the <kbd class="calibre15">Internet Sales</kbd> fact table, such as <kbd class="calibre15">Promotion</kbd> and <kbd class="calibre15">Product</kbd> could also be used to filter the metrics. </p>
<div class="packt_infobox">In this dataset, the customer dimension has 18,484 unique customers as defined by the <kbd class="calibre43">Customer Alternate Key</kbd>. Therefore, the sum of the customer count and customers missing measures is always equal to 18,484. As explained in the <em class="calibre16">Filter context</em> section, the subtotal values execute in their own filter context. For example, only 9,024 did not make an online purchase in any of the four quarters, while over 15,000 customers did not make a purchase in each of the four quarters.</div>
<p class="calibre7">Once core dimension metrics have been established such as in the previous examples, additional metrics can be developed which leverage their logic. The following measures identify the count of first year internet sales customers and the count of accessories products which have not sold online, respectively:</p>
<pre class="calibre19"><strong class="calibre6">Internet Sales First Year Customer Count</strong> = <br class="calibre3" />CALCULATE([Internet Sales Customer Count],'Customer'[Customer History Segment] = "First Year Customer")<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Sales Products Missing (Accessories)</strong> = <br class="calibre3" />CALCULATE([Internet Sales Products Missing],'Product'[Product Category] = "Accessories")</pre>
<p class="calibre7">Dimension metrics, just like the base measures described earlier, may be used in reporting by themselves or may be referenced by other measures. This branching of measures underlines the importance of clearly defining, documenting, and testing the foundational measures of a dataset.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-47">
<div id="calibre_link-751" class="calibre2">
<div id="calibre_link-752" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Ranking metrics</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Many reports and analyses are built around the ranking of dimensions relative to measures, such as the top 10 salespeople based on YTD sales. Ranking measures can also help deliver more clean and intuitive report visualizations as they substitute small integer values for large numbers and decimal places. Ranking measures can be as simple as specifying a column and a measure, or more complex with unique ranking logic applied in distinct filter contexts.</p>
<p class="calibre7">Ranking measures in DAX are implemented via the <kbd class="calibre15">RANKX()</kbd> function, which is an iterator like <kbd class="calibre15">SUMX()</kbd> and <kbd class="calibre15">FILTER()</kbd>. As an iterating function, two required input parameters include a table and the expression to be evaluated for each row of the table. The following two measures rank products based on the <kbd class="calibre15">Internet Net Sales</kbd> measure:</p>
<pre class="calibre19"><strong class="calibre6">Internet Net Sales Product Rank</strong> = <br class="calibre3" />RANKX(ALL('Product'[Product Alternate Key]),[Internet Net Sales],,DESC,Skip)<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Net Sales Product Rank (All Products)</strong> = <br class="calibre3" />VAR ProdRankTable = <br class="calibre3" />ALL('Product'[Product Alternate Key],'Product'[Product Name],'Product'[Product Category Group],'Product'[Product Category],'Product'[Product Subcategory],'Product'[Product Name])<br class="calibre3" />RETURN<br class="calibre3" />RANKX(ProdRankTable, [Internet Net Sales],,DESC,Skip)</pre>
<div class="packt_tip pcalibre7 pcalibre6"><span>As with date intelligence and other measures, </span><kbd class="calibre43">ALL()</kbd><span> is used to remove the filters applied to a table. The <kbd class="calibre43">ALL()</kbd> function both removes a filter and returns a table which can then be evaluated by other functions. <kbd class="calibre43">ALL()</kbd> can remove filters from an entire table, multiple columns of the same table, or a single column from a table. Additionally, the <kbd class="calibre43">ALLEXCEPT()</kbd> function can be used remove filters from the current and any future columns of a table, except for one or a specific set of columns.</span></div>
<p class="calibre7">In the <kbd class="calibre15">Internet Net Sales Product Rank</kbd> measure, the <kbd class="calibre15">ALL()</kbd> function returns a table of the unique product's alternate key values. Since only a single column is referenced by <kbd class="calibre15">ALL()</kbd> in this measure, other columns from the <kbd class="calibre15">Product</kbd> dimension table are allowed into the filter context. For example, in the following table, the <kbd class="calibre15">Product Category</kbd> column impacts the <kbd class="calibre15">Internet Net Sales Product Rank</kbd> measure so that the <kbd class="calibre15">HL-U509-R</kbd> product is ranked first given that it's the highest selling product in the <kbd class="calibre15">Accessories</kbd> category: </p>
<div class="cdpalignleft"><img src="images/000123.png" class="calibre143" /></div>
<div class="mce-root2">Ranking measures</div>
<p class="calibre7">The <kbd class="calibre15">Internet Net Sales Product Rank (All Products)</kbd> measure, however, ranks the product relative to all other products including products in the <kbd class="calibre15">Bikes</kbd> category. The group of columns specified in the <kbd class="calibre15">ALL()</kbd> function (the table parameter to <kbd class="calibre15">RANKX()</kbd>), defines the set of rows that the ranking expression will be evaluated against.</p>
<div class="packt_tip pcalibre7 pcalibre6">For ranking and certain other scenarios, it's necessary to apply alternative logic for subtotals. For example, the total row of the previous table visual would show a ranking value of 1 without any modification to the DAX. A common pattern to address subtotal values is to check whether an individual item of a column is in the filter context via <kbd class="calibre43">HASONEVALUE()</kbd>. The following revised measure uses an <kbd class="calibre43">IF()</kbd> conditional function to apply the ranking for individual products, but otherwise returns a blank value: <br class="calibre3" />
<br class="calibre3" />
<kbd class="calibre43">Internet Net Sales Product Rank = <strong class="calibre6">IF(HASONEVALUE('Product'[Product Alternate Key]),</strong></kbd><br class="calibre3" />
<kbd class="calibre43">RANKX(ALL('Product'[Product Alternate Key]),[Internet Net Sales],,DESC,Skip),<strong class="calibre6">BLANK()</strong>)</kbd></div>
<p class="calibre7">As shown in this example, it's essential to understand the intended ranking logic and it may be necessary to store alternative ranking measures to suit the requirements of different reports and projects.</p>
<div class="packt_infobox">The <kbd class="calibre43">RANKX()</kbd> function has five parameters, but only the first two&mdash;the table and the expression to evaluate&mdash;are required. In this example, the third parameter is skipped via the comma and the measure is set to rank in descending order of the expression. Additionally, the final parameter (<kbd class="calibre43">Skip</kbd> or <kbd class="calibre43">Dense</kbd>) determines how tie values are treated. For example, if two products are tied for the highest sales, both products will be ranked 1, and the next-highest product will be ranked 3. Descending order and the skip tie behavior are both defaults, but it's a good practice to explicitly define these settings in the measures.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-195">
<div id="calibre_link-753" class="calibre2">
<div id="calibre_link-754" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dynamic ranking measures</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The ranking measures in the previous section are specific to individual products. These measures cannot be used, for example, to rank product subcategories or product categories. Rather than develop many separate measures targeted at one specific column, logic can be embedded in DAX measures to dynamically adjust to the columns in the filter context.</p>
<p class="calibre7">In the following measure, a ranking is applied based on the filter context from three levels of a product hierarchy: </p>
<pre class="calibre19"><strong class="calibre6">Internet Net Sales Product Rank (Conditional) =</strong> <br class="calibre3" />VAR ProductFilter = ISFILTERED('Product'[Product Name])<br class="calibre3" />VAR SubCatFilter = ISFILTERED('Product'[Product Subcategory])<br class="calibre3" />VAR CatFilter = ISFILTERED('Product'[Product Category])<br class="calibre3" />RETURN<br class="calibre3" />Switch(TRUE(),<br class="calibre3" />  ProductFilter = TRUE(), RANKX(ALL('Product'[Product Name]),[Internet Net Sales],,DESC,Skip),<br class="calibre3" />  SubCatFilter = TRUE(), RANKX(ALL('Product'[Product Subcategory]),[Internet Net Sales],,DESC,Skip),<br class="calibre3" />  CatFilter = TRUE(), RANKX(ALL('Product'[Product Category]),[Internet Net Sales],,DESC,Skip),<br class="calibre3" />  BLANK())</pre>
<p class="calibre7">The measure checks for the existence of a filter on the <kbd class="calibre15">Product Name</kbd>, <kbd class="calibre15">Product Subcategory</kbd>, and <kbd class="calibre15">Product Category</kbd> columns within a <kbd class="calibre15">SWITCH()</kbd> function via the <kbd class="calibre15">ISFILTERED()</kbd> function. The first logical condition to evaluate as true will result in the corresponding <kbd class="calibre15">RANKX()</kbd> expression being executed. If no condition is found to be true, then the <kbd class="calibre15">BLANK()</kbd> value is returned. </p>
<p class="calibre7">The dynamic ranking measure can be used in report visuals which drill up/down through the product hierarchy or in separate visuals dedicated to specific columns. In the following screenshot, distinct table visuals representing the three levels of the product hierarchy utilize the <kbd class="calibre15">Internet Net Sales Product Rank (Conditional)</kbd> measure:</p>
<div class="cdpalignleft"><img src="images/000133.png" class="calibre144" /></div>
<div class="mce-root2">Dynamic ranking measure</div>
<p class="calibre7">For the visuals in the preceding table, a shorter and more intuitive name was used instead of the full measure name (<kbd class="calibre15">Internet Net Sales Product Rank (Conditional)</kbd>). To change the name of a measure or column used in a report visual, double-click the name of the measure or column in the <span>Values</span> bucket of the <span>Visualizations</span> pane. The revised name only applies to the specific visual, and hovering over the revised name identifies the source measure or column.</p>
<p class="calibre7">Similar to the <kbd class="calibre15">Internet Net Sales Product Rank</kbd> measure from the previous section, the conditional measure allows for other columns to impact the filter context. For example, if both the <kbd class="calibre15">Product Category</kbd> and <kbd class="calibre15">Product Subcategory</kbd> columns are included in the same table visual, the conditional measure will rank the subcategories relative to other subcategories of the same <kbd class="calibre15">Product Category</kbd>. With this dataset, the Tires and Tubes subcategory, which is ranked fourth overall per the above table, would be ranked number one for the <kbd class="calibre15">Accessories</kbd> product category. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-196">
<div id="calibre_link-755" class="calibre2">
<div id="calibre_link-756" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Security roles</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Per <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>, the required data security for this project is to limit the visibility of the Adventure Works sales team users to their respective sales territory groups. There are three sales territory groups (<kbd class="calibre15">North America Sales Group</kbd>, <kbd class="calibre15">Europe Sales Group</kbd>, and <kbd class="calibre15">Pacific Sales Group</kbd>), and, as described in the previous chapter, cross-filtering relationships exist between the <kbd class="calibre15">Sales Territory</kbd> dimension table, and all three fact tables (<kbd class="calibre15">Internet Sales</kbd>, <kbd class="calibre15">Reseller Sales</kbd>, and <kbd class="calibre15">Sales and Margin Plan</kbd>). Therefore, security roles with a filter condition on the given sales territory group will also filter the fact tables, and business users mapped to these roles will only see data associated for their <kbd class="calibre15">Sales Territory</kbd> group.</p>
<p class="calibre7">Security roles are defined in Power BI Desktop via the <span>Manage roles</span> dialog of the <span>Modeling tab</span> as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000143.png" class="calibre145" /></div>
<div class="mce-root2">Managing security roles</div>
<div class="packt_infobox"><span>In this example model, the <kbd class="calibre43">Sales Territory</kbd> dimension table has a single direction one-to-many relationship with the <kbd class="calibre43">Internet Sales</kbd> and <kbd class="calibre43">Reseller Sales</kbd> fact tables. For the <kbd class="calibre43">Sales and Margin Plan</kbd> fact table, the <kbd class="calibre43">Sales Territory</kbd> filter first flows to the bridge table and then uses a bidirectional cross-filtering relationship from the <kbd class="calibre43">Sales Territory</kbd> bridge to <kbd class="calibre43">Sales and Margin Plan</kbd>. Therefore, a user mapped to the <kbd class="calibre43">Europe Sales Group</kbd> role will only have access to the I</span>nternet Sales, R<span>eseller Sales, and Sales Plan data associated with Europe.</span></div>
<p class="calibre7">Just like a filter selection on a column of the <kbd class="calibre15">Sales Territory</kbd> table in a report, a security filter also flows across the cross-filtering relationships of the data model. However, unlike report filters, security filters cannot be overridden by DAX measures. Security filters are applied to all report queries for the given dataset and any additional filtering logic or DAX expression respects the security role definition.</p>
<div class="packt_tip pcalibre7 pcalibre6">Given the automatic filtering of security role conditions, it's important to implement efficient security filters and to test the performance of security roles. For example, a complex filter condition applied against a large dimension table could significantly degrade the performance of reports and dashboards for users or groups mapped to this security role.</div>
<p class="calibre7">In addition to defining security roles, security roles can also be tested in Power BI Desktop via the <span>View as roles</span> command on the <span>Modeling</span> tab. In the following screenshot, a chart that displays sales by the sales territory country is only displaying the countries associated with the European Sales Territory group due to the <span>View as roles</span> selection:</p>
<div class="cdpalignleft"><img src="images/000153.png" class="calibre146" /></div>
<div class="mce-root2">View as roles in Power BI Desktop</div>
<div class="packt_infobox">Similar to the <span>View as roles</span> feature in Power BI Desktop, a <span>Test as role</span> option is available in the Power BI service. This feature can be accessed from the ellipsis next to each RLS role in the <span>Security</span> dialog for the dataset. Additionally, other users can test the security roles by connecting to published Power BI apps. In this testing scenario, the user would not be a member of the app workspace, but a member of an Azure Active Directory Security group which is mapped to a security of the dataset.</div>
<p class="calibre7">Individual users and groups of users are mapped to security roles in the Power BI service. For this project, and as a strongly recommended general practice, <strong class="calibre6">Azure Active Directory</strong> (<strong class="calibre6">AAD</strong>) security groups should be created for the users accessing Power BI content. The following screenshot from AAD displays the properties of a <kbd class="calibre15">North America Sales</kbd> security group:</p>
<div class="cdpalignleft"><img src="images/000163.png" class="calibre147" /></div>
<div class="mce-root2">The Azure Active Directory security group</div>
<div class="packt_infobox">Users can be added or removed from AAD security groups in the Azure portal or via PowerShell scripts. In the previous screenshot, the <span>Assigned</span> membership type is used but alternatively, a <span>Dynamic User</span> membership type can be created based on a membership rule query. With Dynamic User AAD security groups, a user can be automatically added or removed from groups as their role in the organization changes.</div>
<p class="calibre7">The AAD security groups can then be mapped to their respective security roles for the published dataset in Power BI. In the following screenshot, the North America Sales AAD security group is recognized as a potential group to be added as a member of the North America Row-Level Security (RLS) role:</p>
<div class="cdpalignleft"><img src="images/000173.png" class="calibre148" /></div>
<div class="mce-root2">Member assignment to Row-Level Security roles</div>
<p class="calibre7">With the Azure AD security groups created and mapped to their corresponding RLS roles of the Power BI dataset, security filters will be applied based on the user's membership of the Azure AD group. When RLS roles have been applied to a dataset, the users accessing the reports and dashboards based on that dataset will need to be mapped to at least one of the roles. For example, if a Power BI app is distributed to a user who is not included in one of the Azure AD security groups mapped to one of the RLS roles, and this user account is not mapped individually to one of these RLS roles, the user will receive the following error message in the Power BI service:</p>
<div class="cdpalignleft"><img src="images/000183.png" class="calibre149" /></div>
<div class="mce-root2">Error message: User Not mapped to an RLS role</div>
<p class="calibre7"><span>In the event that a user is mapped to multiple RLS roles, such as both the <kbd class="calibre15">North America Sales Group</kbd> and the <kbd class="calibre15">Europe Sales Group</kbd>, that user will see data for both <kbd class="calibre15">Sales Territory</kbd> groups (and not <kbd class="calibre15">Pacific Sales Group</kbd>). For users that require access to the entire dataset, such as administrators or executives, an RLS role can be created on the dataset that doesn't include any filters on any of the tables.</span> <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>, and <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization</em>, contain additional details on Azure AD's relationship to Power BI and the role of security groups in securely distributing Power BI content to users. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-197">
<div id="calibre_link-757" class="calibre2">
<div id="calibre_link-758" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dynamic row-level security</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><strong class="calibre6">Dynamic row-level security</strong> <span>(<strong class="calibre6">DRLS</strong>) </span>models identify the user connected to the dataset via the <kbd class="calibre15">USERPRINCIPALNAME()</kbd> function and apply filters based on this identity. These models can use DAX functions or tables and relationships to implement a filter context specific to the given user. For example, a user and a permissions table could be added to the dataset (and hidden) so that the user table would first filter the permissions table, and the permission table would then filter the dimension to be secured, such as a <kbd class="calibre15">Sales Territory Country</kbd>. </p>
<p class="calibre7">In the following example of a permissions table, <kbd class="calibre15">Jen Lawrence</kbd> is associated with <kbd class="calibre15">Germany</kbd>, <kbd class="calibre15">Australia</kbd>, and the <kbd class="calibre15">United States</kbd>, and thus should only have visibility to these countries in any Power BI report or dashboard built on top of the dataset: </p>
<div class="cdpalignleft"><img src="images/000193.png" class="calibre150" /></div>
<div class="mce-root2">User permissions table</div>
<div class="packt_infobox">The other two tables in the <kbd class="calibre43">Security Tables</kbd> query group include a distinct list of <strong class="calibre6">User Principal Names</strong> (<strong class="calibre6">UPNs</strong>) and a distinct list of <kbd class="calibre43">Sales Territory Country</kbd>. The <kbd class="calibre43">Sales Country</kbd> table is necessary because the <kbd class="calibre43">Sales Territory</kbd> dimension table is more granular than the country one. The <kbd class="calibre43">Sales Country</kbd> table receives the filter context from the permissions table and uses a simple one-to-many cross-filtering relationship with the <kbd class="calibre43">Sales Territory</kbd> dimension table to filter the fact tables.</div>
<p class="calibre7">The dynamic RLS role will be defined with the <kbd class="calibre15">User Principal Name</kbd> column of the <kbd class="calibre15">Users</kbd> table equal to the <kbd class="calibre15">USERPRINCIPALNAME()</kbd> function. The relationships, and, more specifically, the cross-filtering from the <kbd class="calibre15">Permissions</kbd> table, will deliver the intended filter context for the given user. In the following screenshot from the Relationship view, a bidirectional cross-filtering relationship is defined between <kbd class="calibre15">Sales Country Permissions</kbd> and <kbd class="calibre15">Sales Countries</kbd> so that only the countries associated with the user will filter the <kbd class="calibre15">Sales Territory</kbd> dimension table: </p>
<div class="cdpalignleft"><img src="images/000204.png" class="calibre151" /></div>
<div class="mce-root2">Dynamic RLS model relationships</div>
<p class="calibre7">The <span>Apply security filter in both directions</span> property of the bi-directional relationship between <kbd class="calibre15">Sales Country Permissions</kbd> and <kbd class="calibre15">Sales Countries</kbd> is enabled by default. This property and the relationships-based filtering design is applicable to both import and DirectQuery datasets. The gray shading indicates that all three security tables should be hidden from the Report View.</p>
<p class="calibre7">With users or groups assigned to the dynamic security role in the Power BI Service, the role can be tested via the <span>Test as role</span> feature in Power BI. In the following screenshot, the user <kbd class="calibre15">Brett</kbd> is able to test the dynamic role as himself (<kbd class="calibre15">Canada</kbd>, <kbd class="calibre15">United States</kbd>), but can also view the dynamic role as though <kbd class="calibre15">Jennifer</kbd> is logged in, viewing the reports:</p>
<div class="cdpalignleft"><img src="images/000214.png" class="calibre152" /></div>
<div class="mce-root2">Testing dynamic row-level security in Power BI</div>
<p class="calibre7">In this security testing sample, the chart only displays the sales territory countries associated with <kbd class="calibre15">Jennifer</kbd>, and the three tables to the right reflect the three security tables added to the dataset. As expected, all three security tables are filtered based on Jennifer's UPN, and this filter flows through the rest of the data model via relationships among the <kbd class="calibre15">Sales Territory</kbd> dimension and all three fact tables. </p>
<div class="packt_tip pcalibre7 pcalibre6">It can be useful to create a dedicated security testing report that can be leveraged as security roles are created and modified. The report may contain multiple pages of visualizations representing all primary tables and any sensitive metrics or columns from across the dataset. On this project, a business analyst or a QA Tester, such as <kbd class="calibre43">Stacy Loeb</kbd>, can be mapped on to the security role and use the report to confirm that the filter context from the security role has been implemented successfully.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-198">
<div id="calibre_link-759" class="calibre2">
<div id="calibre_link-760" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Performance testing</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">There are often many available methods of implementing business logic and custom filter contexts into DAX measures. Although these alternatives deliver the essential functional requirements, they can have very different performance characteristics, which can ultimately impact user experience and the scalability of a dataset. When migrating a self-service dataset to a corporate solution or preparing a large and highly utilized dataset, it's always a good practice to test common queries and the DAX measures used by those queries.</p>
<p class="calibre7">For example, the same common dimension grouping (for example, <kbd class="calibre15">Product Category</kbd> and <kbd class="calibre15">Year</kbd>) and the same filter context (<kbd class="calibre15">Year = 2018</kbd>) could produce dramatically different performance results based on the measures used in the query, such as <kbd class="calibre15">Net Sales</kbd> versus <kbd class="calibre15">Count of Customers</kbd>. The alternative performance statistics associated with different measures such as duration and the count of storage engine queries generated could then be used to focus performance tuning efforts. </p>
<p class="calibre7"><span>In some cases, the DAX measures associated with slow queries cannot be significantly improved, but the data obtained from the performance testing results can drive other changes. For example, report authors could be advised to only use certain measures in less performance intensive visuals such as Cards, or in reports that have been substantially filtered. In a DirectQuery model, the data source owner of the dataset may be able to implement changes to the specific columns accessed via the slow-performing measures.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-199">
<div id="calibre_link-761" class="calibre2">
<div id="calibre_link-762" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">DAX Studio</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">DAX Studio is a lightweight (5 MB), open source client tool for executing DAX queries against Power BI datasets and other sources which share the Microsoft Analysis Services Tabular database engine, such as SSAS in Tabular mode and Azure Analysis Services. DAX Studio exposes the metadata of the source model (for example, tables, measures, hierarchies), includes reference panes for DAX functions and Tabular <strong class="calibre6">Dynamic Management Views</strong> (<strong class="calibre6"><span>DMVs</span></strong>), and also provides query formatting, syntax highlighting, and IntelliSense for developing DAX queries. Additionally, DAX Studio supports performance tuning as it can execute traces against its data sources and displays useful performance statistics, as well as the query plans used to execute the query.</p>
<div class="packt_tip pcalibre7 pcalibre6">The <span>Server timings</span> and <span>Query plan</span> panes in DAX Studio expose the storage engine and formula engine query plans, respectively. In most performance-testing scenarios, the storage engine versus formula engine results of a trace (for example, 50 ms in the storage engine, 10 ms in the formula engine) will lead the user to focus on either the slowest storage engine queries or the most expensive operations in the formula engine. </div>
<p class="calibre7">For these reasons, despite improvements to DAX authoring in <strong class="calibre6">SQL Server Management Studio</strong> (<strong class="calibre6">SSMS</strong>), DAX Studio is very commonly used by Microsoft BI developers in Analysis Services and Power BI environments. Specifically, BI developers will store the DAX queries created within DAX Studio as <kbd class="calibre15">.dax</kbd> or <kbd class="calibre15">.msdax</kbd> files and later open these files from DAX studio for performance testing or troubleshooting scenarios. For example, a team may have a DAX query that returns the count of rows for three fact tables of a data model by calendar date, and use this query to troubleshoot issues related to a data-loading process. <span>Additionally, just as M queries saved within <kbd class="calibre15">.pq</kbd> files can be added to version control systems, DAX query files can be added to version control systems, such as Visual Studio Team Services.</span></p>
<p class="calibre7"><span>DAX Studio can be downloaded from <a href="http://daxstudio.org" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://daxstudio.org</a>.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-200">
<div id="calibre_link-763" class="calibre2">
<div id="calibre_link-764" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Tracing a Power BI dataset via DAX Studio</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The following steps can be used to trace and analyze a Power BI dataset via DAX Studio:</p>
<ol class="calibre12">
<li class="chapter">Within the Power BI Desktop file containing the dataset (import or DirectQuery), create report pages and visuals which represent the most common reporting and analysis use cases: 
<ul class="calibre17">
<li class="chapter">To simplify this effort, access two or three existing Power BI reports which are highly utilized by business users and create the same visuals in the dataset file.</li>
<li class="chapter">The formatting of these visuals is not important, but it's essential that the visuals include the most common DAX measures, filters, and granularity.</li>
</ul>
</li>
<li class="chapter">Open the Power BI Desktop file containing the dataset and the sample report visuals from step <em class="calibre16">1</em>:<br class="calibre3" />
<ul class="calibre17">
<li class="chapter">Power BI Desktop files which do not include a dataset, such as a file with a Live connection to Analysis Services or a Live connection to a published Power BI dataset, will not be visible to DAX Studio.</li>
</ul>
</li>
</ol>
<ol start="3" class="calibre12">
<li class="chapter">Open DAX Studio and click the Connect icon on the right-hand side of the Home ribbon:</li>
</ol>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13">Specify the Power BI dataset from the <span>Connect</span> dialog as shown in the following screenshot:</li>
</ul>
</li>
</ul>
<div class="cdpalignleft"><img src="images/000224.png" class="calibre153" /></div>
<div class="mce-root2">Connecting to the Power BI dataset via DAX Studio</div>
<ol start="4" class="calibre12">
<li class="chapter">As shown in the preceding image, DAX Studio can connect to <span>Tabular Server</span>, and even P<span>owerPivot Model</span>, if DAX Studio is launched from an Excel Workbook containing a PowerPivot model.</li>
<li class="chapter">Click <span>Connec</span>t and observe the tables of the Power BI dataset displayed in the metadata pane on the left. </li>
<li class="chapter">Click the <span>All Queries</span> icon within the group of Traces icons on the <span>Home</span> tab:
<ul class="calibre17">
<li class="chapter">The <span>Output</span> window at the bottom will explain that the query trace has started.</li>
<li class="chapter">Select the <span>All Queries</span> tab at the bottom (to the right of <span>Query History</span>).</li>
</ul>
</li>
<li class="chapter">In the Power BI Desktop file, apply a filter to a slicer or select one of the values within the visuals to cross-highlight the other visuals:
<ul class="calibre17">
<li class="chapter">The intent of these actions is to mimic normal user behavior when accessing the Power BI report visuals.</li>
<li class="chapter">These actions will generate DAX queries which will be displayed in the <span>All Queries</span> pane of DAX Studio, as shown in the following screenshot:</li>
</ul>
</li>
</ol>
<div class="cdpalignleft"><img src="images/000234.png" class="calibre154" /></div>
<div class="mce-root2">Tracing results in DAX Studio &ndash; All Queries pane</div>
<ol start="8" class="calibre12">
<li class="chapter">The <span>All Queries</span> pane can be sorted by the <kbd class="calibre15">Duration</kbd> column to quickly identify the slowest query, as illustrated in the preceding screenshot. Additionally, hovering over the <kbd class="calibre15">Query</kbd> field displays a formatted version of the DAX query, thus making it easy to identify the DAX measure(s) involved. </li>
<li class="chapter">Stop the trace via the stop icon in the <span>All Queries</span> pane (above <span>StartTime</span>). </li>
<li class="chapter">Double-click a value from the row of the <span>All Queries</span> pane representing the slowest query (for example, Duration = 111) to add this query to the editor window:
<ul class="calibre17">
<li class="chapter">The values in the <kbd class="calibre15">User</kbd>, <kbd class="calibre15">Database</kbd>, and <kbd class="calibre15">Query</kbd> fields can all be used to add the query to the editor window.</li>
<li class="chapter">Alternatively, the Copy All icon (up arrow) in the <span>All Queries</span> pane can be used to add all queries from the trace to the editor window.</li>
</ul>
</li>
<li class="chapter">Select the Server Timings icon in the middle of the <span>Home</span> tab to start a new trace: 
<ul class="calibre17">
<li class="chapter">Select the <span>Server Timings</span> pane that appears at the bottom (to the right of <span>All Queries</span>) </li>
</ul>
</li>
<li class="chapter">With the slowest query from step <em class="calibre16">7</em> in the editor window, click the <span>Run</span> icon, or hit <em class="calibre16">F5</em> to execute the DAX query.</li>
</ol>
<p class="calibre7">In the following screenshot, the query from the original trace against the Power BI Desktop file (<kbd class="calibre15">AdWorksEnterpriseDQ</kbd>), which required 111 ms in duration, was executed in 106 ms from DAX Studio:</p>
<div class="cdpalignleft"><img src="images/000244.png" class="calibre155" /></div>
<div class="mce-root2">The Server Timings window in DAX Studio</div>
<p class="calibre7">As shown in the preceding image, the editor window displays the <kbd class="calibre15">Internet Net Sales Amt</kbd> measure, and the <span>Server Timings</span> pane at the bottom identifies the duration of the query (<span>106 ms</span>). Given that the dataset for this example is in DirectQuery mode against a SQL Server database, the T-SQL statement generated and passed to the database server is displayed in the <kbd class="calibre15">Query</kbd> field and window to the right (not shown). This T-SQL statement can be easily copied into another application, such as <strong class="calibre6">SQL Server Server Management Studio</strong> (<strong class="calibre6">SSMS</strong>), and executed directly against the source or saved as its own <kbd class="calibre15">.sql</kbd> file.</p>
<div class="packt_tip pcalibre7 pcalibre6">For DirectQuery datasets, use traces in DAX Studio to collect the SQL statements associated with the slowest-performing DAX queries. The team responsible for the DirectQuery source (for example, Teradata) may be able to identify the cause of the issue such as the columns referenced in the filter condition. Additionally, if referential integrity is enforced in the DirectQuery data source, ensure that the SQL statements generated use inner join conditions. Inner join SQL statements will be generated if the Assume referential integrity property of the Edit relationship window has been enabled.</div>
<p class="calibre7">As an alternative to the <span>All Queries</span> trace of a Power BI dataset, a new DAX measure could be tested against an existing DAX query. For example, a common grouping query built with the <kbd class="calibre15">SUMMARIZECOLUMNS()</kbd> DAX function and stored in a .dax or .msdax file could be opened in DAX Studio. The new DAX measure contained in the dataset could be referenced in the editor window and the query could be executed with a trace running (via <span>Server Timings</span>). The performance results of the new measure could be compared against the baseline results from common measures (for example, <kbd class="calibre15">Net Sales</kbd> and <kbd class="calibre15">Count of Orders</kbd>) to obtain a sense of relative performance.</p>
<p class="calibre7">Additionally, two DAX measures which return the same results but utilize distinct logic or functions could be tested against each other in DAX Studio to determine which measure is more performant. DAX measures already added to the Power BI dataset can be accessed via the Metadata pane, and DAX measures can also be defined within the Power Query Editor window via the <kbd class="calibre15">DEFINE</kbd> clause.</p>
<p class="calibre7">The following URL contains the full syntax of using DAX as a query language <a href="http://bit.ly/2FoRF2y" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2FoRF2y</a>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-201">
<div id="calibre_link-765" class="calibre2">
<div id="calibre_link-766" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"></p>
<p class="calibre7">This chapter developed and described several common classes of DAX measures, including date intelligence, dimension metrics, and ranking metrics. These measures utilized the fact and dimension tables accessed in <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>, as well as the data model relationships defined in <a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em>. In addition to detailed measure examples, primary concepts of the DAX including filter context, row context, measure evaluation, and DAX variables were also reviewed. Moreover, examples of standard and DRLS models were shared, and DAX Studio was presented as a tool for testing and tuning DAX.</p>
<p class="calibre7">In the following chapter, Power BI reports will be created which leverage the dataset that has been incrementally developed since <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>. Report-authoring features, such as the visualization types in Power BI Desktop, will access the DAX measures from this chapter and the dimensions from previous chapters to deliver business insights and intuitive, self-service functionality.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-202">
<div id="calibre_link-767" class="calibre2">
<div id="calibre_link-768" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Creating and Formatting Power BI Reports</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In this chapter, we will create Power<span> </span>BI reports based on the dataset developed over the past three chapters and published to the Power BI service. We will review a report-planning and design process as well as all primary report formatting features in the context of visualization best practices. Additionally, we will look at report behavior and functionality features, such as alternative filter scopes, slicers, and conditional formatting options.</p>
<p class="calibre7">This chapter also highlights several of the latest and most powerful Power BI report features, including visual interactions, top N, relative date filters, and What-if parameters. The reports developed in this chapter can be further supplemented with custom visuals and advanced analytics<span> </span>from the following chapter<span> </span>to serve as a supporting analysis layer to Power BI dashboards. </p>
<p class="calibre7">In this chapter, we will review the following topics:</p>
<ul class="calibre12">
<li class="calibre13">Report planning</li>
<li class="calibre13">Live connections to Power BI datasets</li>
<li class="calibre13">Visualization best practices</li>
<li class="calibre13">Choosing the visual</li>
<li class="calibre13">Visual interactions</li>
<li class="calibre13">Slicers</li>
<li class="calibre13">What-if parameters</li>
<li class="calibre13">Report filter scopes</li>
<li class="calibre13">Relative date filtering</li>
<li class="calibre13">Conditional formatting</li>
<li class="calibre13">Mobile-optimized reports</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-203">
<div id="calibre_link-769" class="calibre2">
<div id="calibre_link-770" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Report planning</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Power BI reports can take on a variety of forms and use cases, ranging from executive-level dashboard layouts to highly detailed and focused reports. Prior to designing and developing Power BI reports, some level of planning and documentation is recommended to ensure that the reports are well aligned with the needs of the users and the organization. </p>
<p class="calibre7">Effective report planning can be encapsulated in the following five steps:</p>
<ol class="calibre12">
<li class="chapter">Identify the users or consumers of this report:
<ul class="calibre17">
<li class="chapter">Senior managers generally prefer less self-service interactivity and value simple, intuitive visuals, such as KPIs.</li>
<li class="chapter">Analysts often require significant flexibility to filter and interact with more detailed reports. For example, reports used by analysts generally include more slicer visuals and may include table or matrix visuals as well.</li>
</ul>
</li>
</ol>
<p class="calibre156"><span>Separating reports by user role or group serves to keep reports focused for users and more manageable for BI teams. In many scenarios, an organizational hierarchy provides a natural demarcation such that reports can be designed for specific roles or levels within an organization. </span></p>
<p class="calibre156"><span>In the project example for the Adventure Works sales team, reports could align with the <kbd class="calibre15">Sales Territory</kbd> hierarchy (<kbd class="calibre15">Sales Territory Group</kbd> | <kbd class="calibre15">Sales Territory Country</kbd> | <kbd class="calibre15">Sales Territory Region</kbd>). The vice president of group sales will value high-value corporate-wide metrics and intuitive dashboard reports. A sales analyst in the United States, however, will likely need to break out individual regions and even analyze specific zip codes or individual products.</span></p>
<ol start="2" class="calibre12">
<li class="chapter">Define the business question(s) that the report should answer or support:
<ul class="calibre17">
<li class="chapter">Confirm with the business user(s) or project sponsors that this is the appropriate focus and scope of the report:
<ul class="calibre17">
<li class="chapter">A report architecture diagram described in the next section can support this communication.</li>
<li class="chapter">For example, the user could be advised that a particular business question or metric will be included in a different report but will be featured on the same dashboard and will be easily accessible within the same Power BI app.</li>
</ul>
</li>
<li class="chapter">The most important business question (for example, <em class="calibre16">What were our sales?</em>) will be addressed in the top-left corner of the report canvas, likely with a KPI or card visual.</li>
</ul>
</li>
</ol>
<p class="calibre156"><span>Similar to separating reports by user role or group, a report should not attempt to resolve widely disparate business questions. A sales report can, for example, provide high-level metrics on other business processes, such as customer service, inventory, or shipping. However, the supporting visuals of a report should almost always be derived from the same business processes and fact tables as the primary business question, such as <kbd class="calibre15">Internet Sales</kbd> and <kbd class="calibre15">Reseller Sales</kbd>.</span></p>
<ol start="3" class="calibre12">
<li class="chapter">Confirm that the dataset supports the business questions:
<ul class="calibre17">
<li class="chapter"><span>The report author should ensure that the dataset includes measures such as <strong class="calibre6">year-over-year</strong> (<strong class="calibre6">YOY)</strong> sales and the dimension columns (for example, <kbd class="calibre15">Product Category</kbd>) necessary to visualize the business questions.</span></li>
</ul>
</li>
</ol>
<p class="calibre156"><span>It's very important that report authors have a solid understanding of the Power BI dataset. This knowledge includes the logic and business definitions of DAX measures, the relationships defined between fact and dimension tables, and any data transformation logic applied to the source data. </span><span>In many projects, report authors will regularly collaborate with business stakeholders or project sponsors in gathering requirements and demonstrating report iterations. Therefore, the authors will need to explain the values and behaviors of Power BI reports as well as any current limitations in the dataset, such as the years of history supported and any DAX logic or measures not yet created:</span></p>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13">If a gap exists between the dataset and the measures required for the report, the team can determine whether the dataset should be extended or whether the measure should be created local to the report</li>
</ul>
<ul class="calibre17">
<li class="calibre13">Only measures can be created within Power BI Live connection reports</li>
<li class="calibre13">Any new columns, tables, or modifications to existing tables or columns must be implemented within the source dataset</li>
</ul>
</li>
</ul>
<p class="calibre156"><span>The set of base measures described in Chapter 4 (<em class="calibre16">Developing DAX Measures and Security Roles</em>), as well as the dynamic date dimension columns described in <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em> (for example, <kbd class="calibre15">Calendar Month Status = 'Prior Calendar Month'</kbd>), should support the most common needs of reports. If a measure required for a report is considered to be common to other future reports, and if the measure doesn't violate the single corporate definition of an existing measure, the measure should generally be added to the dataset. However, if the report requirement is considered rare or if a measure definition has been approved only for the specific report, then the measure(s) can be created local to the report. </span><span>For version control and manageability reasons, report authors should not have to implement complex filtering logic or develop many local report measures. Report authors should communicate with dataset designers and the overall team if a significant gap exists or is developing between reports and the dataset.</span></p>
<ol start="4" class="calibre12">
<li class="chapter">Determine how the report will be accessed and the nature of any user interactivity:<br class="calibre3" />
<ul class="calibre17">
<li class="chapter">Reports and dashboards can be optimized for mobile device consumption if this use case is expected</li>
<li class="chapter">Power BI Desktop supports slicer visuals, a What-if parameter, and visual interaction options as standard features:
<ul class="calibre17">
<li class="chapter">Reports can, therefore, be designed for static consumption or to support rich data exploration</li>
</ul>
</li>
</ul>
</li>
</ol>
<ol start="5" class="calibre12">
<li class="chapter">Draw a sketch of the report layout:
<ul class="calibre17">
<li class="chapter">At least for the primary page of the report, document how the area of the report canvas will be allocated</li>
</ul>
</li>
</ol>
<p class="calibre156">The following sample sketch is created within a PowerPoint presentation file via the standard shape objects:</p>
<div class="cdpalignleft"><img src="images/000255.png" class="calibre157" /></div>
<div class="mce-root2">Sample report layout sketch</div>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13"><span>Per the sample layout, the critical sales and margin measures are located in the top-left corner of the report page:</span></li>
</ul>
<ul class="calibre17">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13"><span>Slicer (filter) visuals are planned for below these KPI or card visuals and other visuals will add further context</span></li>
<li class="calibre13">Greater space is allocated to the two visuals in the middle of the page given their importance to the report</li>
</ul>
</li>
</ul>
<ul class="calibre17">
<li class="calibre13">The report layout sketch can be used exclusively for planning purposes or can be set as the background for a report page
<ul class="calibre17">
<li class="calibre13">For example, a PowerPoint slide of the same shapes, background shading, and borders can be saved to a network directory as a PNG file</li>
<li class="calibre13">In Power BI Desktop, the PNG file can be imported via the <span>Add Image formatting</span> option under <span>Page Background</span> or via the insert an image icon on the <span>Home</span> tab in Report view</li>
<li class="calibre13">Page background images with proper alignment, spacing, and colors can expedite quality report development</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="calibre7">Be willing to modify a report layout or even start afresh with a new layout based on user feedback. Unlike dataset development, which can require significant time and expertise (for example, DAX, M, SQL), reports can be developed in a rapid, agile delivery methodology. Report authors can engage directly with users on these iterations and, although recommended practices and corporate standards can be communicated, ultimately the functional value to the user is the top priority. It's important to distinguish flexibility in report layout and visualization from the report's target users and business questions. Second and third iterations of reports should not, for example, call for fundamentally different measures or new report pages to support different user groups. Report authors and BI teams can work with users and project sponsors to maintain the scope of IT-supported reports. The interactivity built into Power BI reports and the self-service capabilities provided by Power BI Pro licenses can broaden the reach of projects without requiring new or additional reports.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-204">
<div id="calibre_link-771" class="calibre2">
<div id="calibre_link-772" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI report architecture</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Similar to the data warehouse bus matrix described in <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>, a report architecture diagram can be helpful for planning and communicating Power BI projects with both business and IT stakeholders. This<span> diagram serves to maintain the scope and focus of individual reports. For example, certain business questions or entities (such as <kbd class="calibre15">Customers</kbd>, <kbd class="calibre15">Products</kbd>) can be assigned to dedicated reports and the individual pages of these reports can visualize these questions or entities at varying levels of detail.</span></p>
<p class="calibre7"><span>Most commonly, a single report page will address the top priority of a report at a summary level. This page includes cards and/or KPI visuals at the top-left of the page and charts rather than tables or matrices that visualize these metrics at a high level. Additional report pages, usually 3-4 maximum, would be designed to provide a greater level of detail supporting the summary page. With this report structure, a user can naturally start their analysis from an intuitive and visually appealing summary page and then, if necessary, navigate to pages exposing greater levels of detail.</span></p>
<div class="packt_infobox"><span>In addition to supporting report pages with greater detail, Drillthrough report pages can be designed to display the details for an individual item, such as a specific product or a combination of items, for example the year 2018 and a specific product. The <em class="calibre16">Drillthrough report pages</em> section of <a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16"><span>Applying Custom Visuals, Animation, and Analytics</span></em> provides details and examples of this feature.</span></div>
<p class="calibre7"><span>In the absence of a report architecture or diagram, reports can quickly become less user-friendly as many report pages are added that address unrelated business questions. Additionally, the lack of scope or focus for a report can lead to duplicated efforts with the same business question being visualized in multiple reports.</span></p>
<div class="packt_tip pcalibre7 pcalibre6"><span>Guidance from stakeholders on the visuals to be included in or featured on a dashboard can strongly inform the report design process. If several dashboard tiles, particularly those intended in the top or left section of the dashboard, are closely related (for example, profitability %) then it's likely that multiple reports, each with multiple pages, should be designed to support further related analysis of these tiles. However, if only one dashboard tile relates to a particular business question or entity, such as resellers, then the supporting report may only need 1-2 pages and provide relatively less detail.</span></div>
<p class="calibre7">In the following basic example, four reports and one dashboard are planned for the German sales team:</p>
<div class="cdpalignleft"><img src="images/000265.png" class="calibre158" /></div>
<div class="mce-root2">Sample report architecture diagram</div>
<p class="calibre7">In this sample, at least one visual from each of the four reports would be pinned as a tile on the <kbd class="calibre15">Germany Sales and Margin</kbd> dashboard. By default, this would link the reports to the dashboard such that a user could access the details of any of the four reports by clicking on a related dashboard tile. Visuals from a single report can be pinned as tiles to multiple dashboards. Additionally, a dashboard tile can be linked to a separate dashboard or to a separate report in the Power BI service. <a href="#calibre_link-265" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 7</a>, <em class="calibre16">Designing Power BI Dashboards and Architectures</em> include additional details and examples of Power BI report and dashboard architectures. </p>
<p class="calibre7">The four reports and the dashboard from the preceding example could be included in a dedicated app workspace for the German sales team or within a broader workspace that supports multiple sales teams and related content (for example, marketing) in the organization. If a Power BI dataset is used as the source for Power BI reports, then consolidating reports and dashboards into a broader app workspace avoids the need to duplicate this dataset across other workspaces given the current dependency between Power BI Live connection reports and datasets within the same workspace. Information on app workspaces and content distribution via apps are provided in <a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content</em> and <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>. The following section describes Live connection reports to Power BI datasets published to the Power BI service.</p>
<div class="packt_tip pcalibre7 pcalibre6">Understand and communicate the differences between Power BI reports and dashboards. Although report pages can look like dashboards to users, Power BI dashboards are generally best suited to integrating the essential visuals from multiple reports. Dashboards deliver a holistic, at-a-glance view of strategic metrics while reports are more narrowly focused on specific business questions. Additionally, reports provide interactive, analytical features (for example, slicer visuals) for users to leverage in a self-service.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-205">
<div id="calibre_link-773" class="calibre2">
<div id="calibre_link-774" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Live connections to Power BI datasets</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">One of the most important features released in 2017 was the ability to use published Power BI datasets as a source for Power BI reports. With Live connections to Power BI datasets, report authors can develop reports in Power BI Desktop files containing only the visualization layer (for example, report pages of visuals) while leveraging a single dataset.</p>
<p class="calibre7">The dataset, which is generally developed and managed by a different user or team, already includes the data retrieval supporting tables and columns, the data model relationships, and the DAX measures or calculations as described in previous chapters. Once the Live connection report is developed and published to Power BI, it will maintain its connection to the source dataset and will be refreshed with the refresh schedule configured for the dataset.</p>
<p class="calibre7"><span>Prior to Live connection reports to Power BI datasets, users within teams would frequently create multiple versions of the same dataset in order to create different reports. As both a report and a dataset, each individual report would require its own scheduled refresh process (in import mode), its own data storage, and would create version control problems as the report author could modify the underlying dataset. Live connection reports therefore severely reduce resource requirements and promote a single version of the truth. Moreover, Live connection reports facilitate the isolation of report design and development from dataset design and development. </span></p>
<div class="packt_infobox">Most Power BI report authors will not be interested in or responsible for dataset design topics, such as data retrieval with M queries, data modeling, and DAX measures. Likewise, a dataset designer is often less interested in or responsible for visualization best practices and the engagement with the actual users of reports and dashboards. As advised in <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>, it's important for the alternative roles (dataset designer, report author) to regularly collaborate, such as by identifying measures or columns that need to be added to the dataset to support reports and dashboards. </div>
<p class="calibre7">To create a Live connection report with a published Power BI dataset as the source, the report author needs a Power BI Pro license and will need to be a member of the app workspace hosting the dataset with edit rights.</p>
<p class="calibre7">In the following example, the report author is a member of the <kbd class="calibre15">Corporate Sales</kbd> app workspace and creates a new report in Power BI Desktop by connecting to the <kbd class="calibre15">AdWorks Enterprise</kbd> dataset within this workspace:</p>
<div class="cdpalignleft"><img src="images/000275.png" class="calibre159" /></div>
<div class="mce-root2">Creating a Live connection to the Power BI dataset</div>
<p class="calibre7">After selecting the <span>Power BI service</span> from the list of <span>Online Services</span> within the <span>Get Data</span> dialog, the list of the workspaces of which the report author is a member is prompted. In this example, either double-clicking the <kbd class="calibre15">AdWorks Enterprise</kbd> dataset or clicking the <span>Load</span> button will establish the Live connection per the status bar in Power BI Desktop:</p>
<div class="cdpalignleft"><img src="images/000285.png" class="calibre160" /></div>
<div class="mce-root2">Live connection status bar</div>
<div class="packt_infobox">The same field list of measures and tables is exposed in Report View but the Relationship View and Data View do not appear. Likewise, once the Live connection has been established, the <span>Get Data</span> dialog is also grayed out. Live connection reports to Power BI datasets and <strong class="calibre6">SQL Server Analysis Services</strong> (<strong class="calibre6">SSAS</strong>) databases are always limited to a single data model as a source.</div>
<p class="calibre7">Live connection reports are published to the same app workspace as their source dataset. In the following example, a report file named <kbd class="calibre15">USA Sales and Margin</kbd>, which is connected to the <kbd class="calibre15">AdWorks Enterprise</kbd> dataset in the <kbd class="calibre15">Corporate Sales</kbd> workspace has been published from Power BI Desktop:</p>
<div class="cdpalignleft"><img src="images/000295.png" width="320" height="242" class="calibre161" /> </div>
<div class="mce-root2">Published Live connection report</div>
<p class="calibre7">Per the preceding image, the report will appear in the workspace of the source dataset (<kbd class="calibre15">Corporate Sales</kbd>) in Power BI. Since the report was published from Power BI Desktop, the report (<kbd class="calibre15">.pbix</kbd> file) can be downloaded by opening the report and clicking <span>Download report</span> from the <span>File</span> menu.</p>
<div class="packt_infobox">It's possible to create reports based on Power BI datasets within the Power BI online service. However, the <kbd class="calibre43">.pbix</kbd> files for these reports cannot be downloaded and thus all edits must be implemented within the service without version history. Additionally, several important report authoring features in Power BI Desktop are not supported in the service, including the alignment of objects and local report measures. Given these considerations, Power BI Desktop is recommended for any report development beyond personal or ad hoc use. Guidance on version history for Power BI Desktop files (reports and datasets) is included in <a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content</em><em class="calibre16">.</em> </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-206">
<div id="calibre_link-775" class="calibre2">
<div id="calibre_link-776" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Customizing Live connection reports</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Although data modeling and retrieval capabilities are removed in Live connection reports, report authors have the ability to create new measures specific to the given report via the New Measure icon under the <span>Modeling</span> tab. <span>Additionally, report authors can change the names of measures and columns displayed in reports. In the following example, the <kbd class="calibre15">Internet Net Sales</kbd> measure and the <kbd class="calibre15">Customer Country</kbd> column have been renamed to <kbd class="calibre15">Net Sales</kbd> and <kbd class="calibre15">Country</kbd>, respectively:</span></p>
<div class="cdpalignleft"><img src="images/000305.png" class="calibre162" /></div>
<div class="mce-root2">Renamed measure and column in Visual</div>
<p class="calibre7">Double-clicking the name of the column or measure in the field well(s) for the visual exposes an input box for the revised name. Per the preceding image, the revised names will appear in the report visual and the <span>Tooltips</span> in the field wells will indicate the source column or measure. In this example, the <kbd class="calibre15">Internet Net Sales</kbd> measure, with a home table of the <kbd class="calibre15">Internet Sales</kbd> fact table, is the source for the <kbd class="calibre15">Net Sales</kbd> alias name.</p>
<div class="packt_tip pcalibre7 pcalibre6">Although the flexibility to create measures and apply names within reports is helpful and appropriate in certain scenarios, these revisions can create complexity and version control issues. For example, users can become accustomed to specific measures and names that the dataset designer is not aware of and that may conflict with other measures or names in the dataset. Therefore, it's generally recommended to incorporate the necessary measure logic and standard names into the source dataset. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-207">
<div id="calibre_link-777" class="calibre2">
<div id="calibre_link-778" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Switching source datasets</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In many project scenarios, a Power BI report will initially be built against a development or testing dataset. After this report has been validated or received the proper approvals, the report's source dataset can be switched to a production dataset and the report can then be published to the production app workspace used for distributing Power BI content to users.</p>
<p class="calibre7">To switch the Power BI dataset of a Live connection report, click the <span>Data Source settings</span> icon under the <span>Edit Queries</span> drop-down menu under the <span>Home</span> tab. In the following two steps with supporting images, a report is switched from a dataset in the <kbd class="calibre15">Corporate Sales</kbd> workspace to a dataset in the <kbd class="calibre15">North America Sales</kbd> workspace:</p>
<ol class="calibre12">
<li class="chapter">Open the Power BI service data source window via <span>Data source settings</span>:</li>
</ol>
<div class="cdpalignleft"><img src="images/000315.png" class="calibre163" /></div>
<div class="mce-root2">Data source settings for a Live connection report</div>
<ol start="2" class="calibre12">
<li class="chapter">Select the new dataset to use as the source for the report:
<ul class="calibre17">
<li class="chapter">Either double-click the dataset or click the <span>Load</span> command button to establish the connection:</li>
</ul>
</li>
</ol>
<div class="cdpalignleft"><img src="images/000325.png" class="calibre164" /></div>
<div class="mce-root2">Power BI dataset sources</div>
<ol start="3" class="calibre12">
<li class="chapter">Confirm the source dataset has changed via the status bar:</li>
</ol>
<div class="cdpalignleft"><img src="images/000335.png" width="414" height="22" class="calibre165" /> </div>
<div class="mce-root2">Source Power BI dataset switched</div>
<p class="calibre7">See <a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content </em>for details on Power BI project life cycles, such as migrating from development to production environments and version control.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-208">
<div id="calibre_link-779" class="calibre2">
<div id="calibre_link-780" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Visualization best practices</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Effective reports are much more than simply answering documented business questions with the available measures and columns of the dataset. Reports also need to be visually appealing and provide a logical structure that aids in navigation and readability. Business users of all backgrounds appreciate a report that is clear, concise, and aesthetically pleasing.</p>
<p class="calibre7">Now that the report-planning phase described earlier is complete, the following list of 15 visualization practices can guide the report development process: </p>
<ol class="calibre12">
<li class="chapter">Avoid clutter and minimize nonessential details:
<ul class="calibre17">
<li class="chapter">Each visual should align with the purpose of the report&mdash;to gain insight into a business question:
<ul class="calibre17">
<li class="chapter">Visualizations should not represent wild guesses or functionality that the author finds interesting</li>
</ul>
</li>
<li class="chapter">Eliminate report elements that aren't essential for gaining understanding:
<ul class="calibre17">
<li class="chapter">Gridlines, legends, axis labels, text boxes, and images can often be limited or removed</li>
</ul>
</li>
<li class="chapter">The report should be understandable at a glance, without supporting documentation or explanation.</li>
</ul>
</li>
</ol>
<div class="packt_tip pcalibre7 pcalibre6">A simple but helpful test is to view a Power BI report on a laptop screen from a distance of 12 to 15 feet, such as from the opposite end of a conference room. At this distance, it will be impossible to read any small text and only the shapes, curves, and colors will be useful for deriving meaning. If the report is still meaningful, this suggests the report is effectively designed visually.</div>
<ol start="2" class="calibre12">
<li class="chapter">Provide simple, clear titles on report pages and visuals:
<ul class="calibre17">
<li class="chapter">Text boxes can be used to name or describe the report, report page, and provide the last-refreshed date</li>
</ul>
</li>
<li class="chapter">For chart visuals, use the length of lines and the two-dimensional position of points to aid visual comprehension:
<ul class="calibre17">
<li class="chapter">In line charts, users can easily perceive trends and the divergence of lines relative to each other</li>
<li class="chapter">In column or bar charts, users can easily distinguish relative differences in the length of bars</li>
<li class="chapter">In scatter charts, users can quickly interpret the two-dimensional position of data points relative to each other</li>
</ul>
</li>
</ol>
<div class="packt_infobox"><span>The purpose of these two attributes (line length, 2-D position) as the primary communication mechanism is to guide the user to an accurate assessment with minimal effort. Other visual attributes such as color, shape, and size can also be beneficial, particularly when these properties are driven by the data, such as with conditional formatting and KPIs. However, line length and 2-D position (X, Y coordinates) have a natural advantage in visual perception. For example, the differences between three items on a clustered column chart is much more obvious than the same three items presented on a pie chart.</span></div>
<ol start="4" class="calibre12">
<li class="chapter">Position and group visuals to provide a logical navigation across the canvas:
<ul class="calibre17">
<li class="chapter">The most important visuals should be positioned in the top-left corner of each report page</li>
<li class="chapter">If multiple visuals are closely related, consider grouping them within a shape object</li>
</ul>
</li>
<li class="chapter">Use soft, natural colors for most visuals:
<ul class="calibre17">
<li class="chapter">Avoid overwhelming users with highly saturated bright or dark colors</li>
<li class="chapter">Only use more pronounced colors when it's necessary to make an item stand out, such as conditional formatting</li>
</ul>
</li>
</ol>
<ol start="6" class="calibre12">
<li class="chapter">Only apply distinct colors to items in chart visuals when the colors convey meaning:
<ul class="calibre17">
<li class="chapter">For example, three colors might be useful for the data points of three separate product categories</li>
</ul>
</li>
<li class="chapter">Align visuals to common and <em class="calibre16">X</em> and <em class="calibre16">Y</em> pixel positions:
<ul class="calibre17">
<li class="chapter">For example, if a visual in the top-left corner of a page has <em class="calibre16">X</em> and <em class="calibre16">Y</em> position values of 20 and 40, respectively, then other visuals on the left side of the canvas should also have an <span>X Position</span> of 20</li>
<li class="chapter">Likewise, the top visual(s) on the right side of the canvas should align with the left visuals at a Y position of 40 </li>
</ul>
</li>
<li class="chapter">Distribute visuals vertically and horizontally to create an equal amount of space between visuals:
<ul class="calibre17">
<li class="chapter">The amount of spacing should be adequate to clearly distinguish the visuals as separate entities</li>
</ul>
</li>
</ol>
<p class="mce-root">With one or multiple visuals selected in Power BI Desktop, a <span>Format</span> tab will appear on the ribbon per the following image:</p>
<div class="cdpalignleft"><img src="images/000345.png" class="calibre166" /></div>
<div class="mce-root2">Alignment, distribution, and Z-order format options</div>
<div class="packt_infobox">The three format options (<span>Align</span>, <span>Distribute</span>, and <span>Bring forward</span> and <strong class="calibre6">Send</strong> <span>backward</span> (Z-order)) are consistent with common MS Office applications, such as Excel and PowerPoint. Between these formatting options and the four properties available under the general formatting card for all visuals (<span>X Position</span>, <span>Y Position</span>, <span>Width</span>, and <span>Height</span>). Report authors can ensure that visuals are properly aligned and spaced. The <span>Show gridlines</span> and <span>Snap objects to grid</span> options under the <span>View</span> tab also support alignment. </div>
<ol start="9" class="calibre12">
<li class="chapter">Choose a page background color that will naturally contrast with visuals, such as the default white or a very light gray.</li>
</ol>
<p class="calibre7"> </p>
<ol start="10" class="calibre12">
<li class="chapter">For column and bar charts, sort visuals by their measure to provide an implicit ranking by the given measure:
<ul class="calibre17">
<li class="chapter">This sorting is only applicable to nominal categories, such as product categories, when the individual items in the category don't need to follow a custom sort order</li>
</ul>
</li>
<li class="chapter">Fill the available report canvas space; avoid large blank spaces in report pages.</li>
<li class="chapter">Provide supporting context via tooltips and additional lines in charts, such as target values and the min, max, and average:
<ul class="calibre17">
<li class="chapter">Several measures related to a given visual can be displayed via tooltips without incurring performance penalties</li>
<li class="chapter">The Power BI Analytics pane provides several support lines, including a trend line and a predictive forecast line</li>
</ul>
</li>
<li class="chapter">All report pages should follow a common design theme and color palette:
<ul class="calibre17">
<li class="chapter">Preferably all reports in a project and even for an organization should follow the same basic design guidelines</li>
</ul>
</li>
</ol>
<p class="calibre7">A <span>Switch Theme</span> icon on the <span>Home</span> tab of Power BI Desktop in Report View exposes options for importing a report theme and thus overriding the default color and formatting properties:</p>
<div class="cdpalignleft"><img src="images/000355.png" class="calibre167" /></div>
<div class="mce-root2">Import report theme</div>
<div class="packt_infobox"><span><span>Custom Report Themes</span> are a preview feature as of the November 2017 release of Power BI Desktop and allow organizations to apply a custom set of formatting properties to Power BI reports. For example, an organization can embed its corporate colors into a report theme (a JSON file) to apply this set of colors to all Power BI reports. Additionally, more elaborate formatting properties can be specified in report themes to standardize report development, such as the font family and font sizes. Existing report themes are available for download from the Power BI Report Theme Gallery (<a href="http://bit.ly/2pyUKpl" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2pyUKpl</a>). Additionally, tools and documentation are available for easily generating report themes, such as the Power BI Tips Color Theme Generator (<a href="https://powerbi.tips/tools/color-theme-generator/" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://powerbi.tips/tools/color-theme-generator/</a>). </span></div>
<ol start="14" class="calibre12">
<li class="chapter">The quantitative scale for column and bar charts must start at zero:
<ul class="calibre17">
<li class="chapter">Custom quantitative scales, such as from 12% to 15%, can be applied to line, scatter, and bubble charts to emphasize specific ranges of values</li>
</ul>
</li>
</ol>
<div class="packt_infobox">Consider two items, <kbd class="calibre43">Product A</kbd> and <kbd class="calibre43">Product B</kbd>, of a clustered column chart with margin percentage values of 32% and 34%, respectively. With a base of zero, the two items would correctly appear similar for the given measure. However, if the base value of the visual starts at 31% and the max value of the scale is set to 35%, <kbd class="calibre43">Product B</kbd> would visually appear as a dramatically higher value. This distortion is the reason that quantitative scales for column and bar charts must start at zero.</div>
<ol start="15" class="calibre12">
<li class="chapter">Lines should only be used to connect interval scale data points, such as time series and ordered bins of values:
<ul class="calibre17">
<li class="chapter">A line should not, for example, represent the sales for different product categories</li>
<li class="chapter">A line should, however, represent the sales of products by unit price bins (for example, $0 to $10, $10 to $20, and so forth) </li>
</ul>
</li>
</ol>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-209">
<div id="calibre_link-781" class="calibre2">
<div id="calibre_link-782" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Visualization anti-patterns</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In addition to report planning and generally aligning reports with visualization best practices, it can be helpful to acknowledge and avoid several common visualization anti-patterns. For many reports, particularly when report development time and Power BI experience is limited, simply avoiding these anti-patterns coupled with adequate planning and appropriate visual type choices is sufficient to deliver quality, sustainable content.</p>
<p class="calibre7">Six of the most common visualization anti-patterns include the following:</p>
<ul class="calibre12">
<li class="calibre13">A cluttered interface of many visuals and report elements that's complex or difficult to interpret:
<ul class="calibre17">
<li class="calibre13">This is often the result of too many visuals per report page or too high a precision being displayed</li>
<li class="calibre13">Separate reports, report pages, and the removal of unnecessary details and precision can improve usability</li>
</ul>
</li>
<li class="calibre13">A lack of structure, order, and consistency:
<ul class="calibre17">
<li class="calibre13">Each report page should naturally guide the user from the essential top-left visuals to the supporting visuals</li>
<li class="calibre13">A failure to align visuals or to provide proper spacing and borders can make reports appear disorganized</li>
<li class="calibre13">Mixing widely disparate grains of detail on the same report page can be disorienting to users</li>
</ul>
</li>
<li class="calibre13">High density and/or high detail visualizations, such as large table visuals or thousands of points on a scatter chart or map:
<ul class="calibre17">
<li class="calibre13">The need for a scrollbar is a strong indication that a visual contains too many values</li>
<li class="calibre13">A table visual should not be used as a raw data extract of many columns and rows</li>
<li class="calibre13">High density visuals, such as line and scatter charts with thousands of data points, can cause poor performance</li>
</ul>
</li>
</ul>
<p class="calibre156">The following table visual with six dimension columns and three measures is an example of a data extract anti-pattern:</p>
<div class="cdpalignleft"><img src="images/000365.png" class="calibre168" /></div>
<div class="mce-root2">Data extract anti-pattern</div>
<p class="calibre156">The small scrollbar on the right indicates that many rows are not displayed. Additionally, the export data option prompts the warning message (data exceeds the limit) suggesting the visual contains too much data.</p>
<ul class="calibre12">
<li class="calibre13">The excessive use of fancy or complex visuals and images:<br class="calibre3" />
<ul class="calibre17">
<li class="calibre13">Reports can be aesthetic and engaging but the priority should be to inform users, not to impress them.</li>
<li class="calibre13">For example, a column chart or a stacked column chart will usually be more effective than a treemap.</li>
</ul>
</li>
<li class="calibre13">Suboptimal visual choices such as pie charts, donut charts, and gauges:
<ul class="calibre17">
<li class="calibre13">Column or bar charts are easier to interpret than the circular shapes of pie and donut charts.</li>
<li class="calibre13">KPI visuals provide more context than gauge visuals including the trend of the indicator value.</li>
</ul>
</li>
<li class="calibre13">The misuse of colors, such as utilizing more than five colors and overwhelming users with highly saturated colors:
<ul class="calibre17">
<li class="calibre13">Colors should be used selectively and only when the few alternative colors convey meaning.</li>
</ul>
</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-210">
<div id="calibre_link-783" class="calibre2">
<div id="calibre_link-784" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Choosing the visual</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>With the report planning phase completed, an essential task of the report author is to choose the visual(s) best suited to gain insight into the particular questions within the scope of the report. </span>The choice of the visualization type, such as a column chart or a matrix visual, should closely align with the most important use case, the message to deliver, and the data relationship to represent.</p>
<p class="calibre7">Visualization types have distinct advantages in terms of visual perception and types of data relationships such as part-to-whole and comparisons. Additionally, although several formatting options are common to all visuals, certain options such as the line style (solid, dashed, dotted) of a line chart are exclusive to specific visuals. </p>
<p class="calibre7">A standard visual selection process is as as follows:</p>
<ol class="calibre12">
<li class="chapter">Plan and document the business question(s) and related measures and dimension columns.</li>
<li class="chapter">Determine whether a table, a chart, or both will be needed to best visualize this data.</li>
<li class="chapter">If a chart is needed, choose the chart visual that's best aligned with the relationship (for example, trend, comparison, correlation).</li>
</ol>
<p class="calibre7">Following these three steps helps to ensure that effective reports are developed with efficient resources. Many other visualization and analysis features can be used to further enhance reports but these should only supplement report planning and design.</p>
<div class="packt_infobox">Power BI currently supports 25 standard visualizations, and many more custom visualizations can be imported from the MS Office Store. The standard visuals are aligned with the most common analytical representations including trend, rankings, part-to-whole, exceptions, geospatial, and distribution. Several of these visuals can be further enhanced via the Analytics pane and a vast array of custom visuals can be easily imported to reports from the MS Office Store. See the following chapter for additional details on the <span>Analytics</span> pane in Power BI Desktop and custom visuals.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-211">
<div id="calibre_link-785" class="calibre2">
<div id="calibre_link-786" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Tables versus charts</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">An initial step in the visualization selection process is to determine whether a table, a chart, or a combination of both is most appropriate. Power BI's table visual provides simple row groups of dimension values and measures, and the matrix visual supports both an <em class="calibre16">X</em> and a <em class="calibre16">Y</em> axis field like a pivot table in Excel. Both the table and the matrix visuals are superior to charts in enabling users to look up specific data points. However, despite conditional formatting options available to table and matrix visuals, charts are superior to table and matrix visuals in displaying trends, comparisons, and large volumes of distinct data points.</p>
<p class="calibre7">The following matrix visual breaks down the <kbd class="calibre15">AdWorks Net Sales</kbd> measure by two product dimension columns and two promotion dimension columns:</p>
<div class="cdpalignleft"><img src="images/000375.png" class="calibre169" /></div>
<div class="mce-root2">Matrix visual</div>
<p class="calibre7">The product hierarchy created in <a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em> is used as the rows' input and a promotion table hierarchy is used as the columns' input. Via the expand all down feature for both the rows and the columns, the matrix provides easy access to specific data points, including subtotals by both product categories and promotion types. Although it's clearly possible to visualize the same data with a chart, a matrix visual (or a table visual) makes it easy to locate individual values and to display the exact values with no rounding.</p>
<p class="calibre7">Additionally, if a table or matrix is needed to reference individual values but less precision is required, the field formatting card in the formatting pane allows the report author to define the display units (for example, thousands (K), millions (M)) and the number of decimal places for the measure. The same two formatting properties (display units and value decimal places) are also accessible for chart visuals via the data labels formatting card in the formatting pane.</p>
<div class="packt_infobox"><span>Although they're rarely used in Power BI dashboards, Power BI's table and matrix visuals were significantly enhanced throughout 2017 to provide more granular formatting controls. Matrix features, such as showing values (for example, multiple metrics) as individual rows, as a percentage of column or row totals, and full control over subtotals positions Power BI matrix visuals as an alternative to many Excel pivot tables and matrix reports in <strong class="calibre6">SQL Server Report Services</strong> (<strong class="calibre6">SSRS</strong>). Additionally, table and matrix visuals are interactive such that user selections on a row, a specific value, or a row or column header will filter other visuals. </span></div>
<p class="calibre7">The following line chart visual breaks down the <kbd class="calibre15">AdWorks Net Sales</kbd> measure by the calendar year week:</p>
<div class="cdpalignleft"><img src="images/000384.png" class="calibre170" /></div>
<div class="mce-root2">Line chart visual</div>
<p class="calibre7">With 18 different data points displayed, the periodic spikes of the line help to identify the specific weeks with relatively higher net sales. In this example, the <kbd class="calibre15">AdWorks Net Sales</kbd> measure is highest in the fourth or last week of the month and is especially higher at the end of March&mdash;the first quarter. The drawback or tradeoff of this visual relative to the prior matrix visual is the lack of subtotals and the loss of precision given the rounding to one decimal place. </p>
<p class="calibre7">Line charts are uniquely advantaged to call out patterns, trends, and exceptions in measures across time. More generally, chart visualizations (for example, bar, column, scatter) are recommended over table and matrix visuals when the shape or position of the data, such as trends, comparisons, correlations, and exceptions, is more valuable than the individual values.</p>
<div class="packt_tip pcalibre7 pcalibre6">With a date hierarchy or the date columns in the chart axis input field, the concatenate labels property in the <em class="calibre16">X</em> axis formatting card should be turned off to provide the grouped layout per the preceding line chart example. Additionally, also included in the line chart example visual, the <em class="calibre16">X</em> axis gridlines can be turned on to separate the parent values (for example, <strong class="calibre6">2017-Feb</strong>). </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-212">
<div id="calibre_link-787" class="calibre2">
<div id="calibre_link-788" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Chart selection</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Chart visuals can broadly be categorized into the following four types of data relationships:</p>
<ul class="calibre12">
<li class="calibre13"><strong class="calibre6">Comparison</strong>: How items compare against each other or over time</li>
<li class="calibre13"><strong class="calibre6">Relationship</strong>: How items relate (or correlate) to one another across multiple variables</li>
<li class="calibre13"><strong class="calibre6">Distribution</strong>: The most common values for a variable and the concentration of values within a range</li>
<li class="calibre13"><strong class="calibre6">Composition</strong>: The portion of a total that an item represents relative to other items, possibly over time</li>
</ul>
<p class="calibre7">The following table associates specific visuals to these categories and briefly describes their top use cases:</p>
<div class="cdpalignleft"><img src="images/000394.png" class="calibre171" /></div>
<div class="mce-root2">Chart visuals by category</div>
<p class="calibre7">As a table of chart types, map visuals, and the three standard single number visuals provided in Power BI Desktop&mdash;Cards, Gauge, and KPI, are excluded. Single number visuals are commonly used in dashboards, mobile optimized reports, and in the top-left section of report pages to deliver easy access to important metrics. </p>
<div class="packt_tip pcalibre7 pcalibre6"><span>The standard single number visuals (Card, Gauge, KPI) can also be used to create data alerts when these visuals are pinned to Power BI dashboards. Alerts can be created and managed in both the Power BI service and on the Power BI mobile applications. With an alert set on a dashboard tile representing one of these visuals, whenever the number of the visual crosses a defined condition (for example, above 100), a notification will be raised and optionally an email will be sent as well.</span></div>
<p class="calibre7">Details on standard map visuals are included in the <em class="calibre16">Map visual</em>s section of this chapter and the <em class="calibre16">ArcGIS Map visual for Power BI</em> is reviewed in <a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16">Applying Custom Visuals, Animation and Analytics</em>.</p>
<div class="packt_infobox">There are several publicly available resources on visualization practices and visual selection. The <em class="calibre16">Chart Suggestions</em> diagram from Extreme Presentation (<a href="http://bit.ly/1xlXh1x" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/1xlXh1x</a>) provides additional details on the visuals and visual categories described in this section. Additionally, the SQL BI team provides a <em class="calibre16">Power BI Visuals Reference</em> (<a href="http://bit.ly/2ndtcZj" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2ndtcZj</a>) that categorizes visuals at a more granular level than the table in this section. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-213">
<div id="calibre_link-789" class="calibre2">
<div id="calibre_link-790" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Visual interactions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">By default, the filter selections applied to a single visual, such as clicking a bar on a column chart or a row on a table, will impact all other data visualizations on the given report page with relationships to the selection. In the following example, the bar representing the United States sales territory country has been selected and this causes the product category chart to highlight the portion of each product category related to the United States sales territory country ($31.3M):</p>
<div class="cdpalignleft"><img src="images/000404.png" class="calibre172" /></div>
<div class="mce-root2">Visual Interactions &ndash; Highlighting</div>
<p class="calibre7">Multiple values from the same column can be selected (for example, <kbd class="calibre15">France</kbd> and <kbd class="calibre15">Canada</kbd>) and the values from separate columns of the same visual, such as the dimension columns of a table visual, can also cross-filter other visuals on the report page. The ability to drive visual interactions from the selections of two or more visuals (for example, <kbd class="calibre15">United States</kbd> and <kbd class="calibre15">Bikes</kbd>) is not currently supported excluding slicers. </p>
<p class="calibre7"><span>The highlight interaction option from the preceding example is available and enabled by default for column, bar, treemap, pie, and donut charts. Only the filter and the none interaction options are available for cards, KPIs, and line and scatter chart visuals.</span></p>
<div class="packt_infobox">Per prior chapters, the <kbd class="calibre43">Sales Territory</kbd>, <kbd class="calibre43">Product</kbd>, and <kbd class="calibre43">Date</kbd> dimension tables are related to all three fact tables&mdash;<kbd class="calibre43">Internet Sales</kbd>, <kbd class="calibre43">Reseller Sales</kbd>, and <kbd class="calibre43">Sales and Margin Plan</kbd>. Therefore, the filters and selections applied to the columns of these tables will simultaneously impact measures from other fact tables. This integration within the dataset supports robust analyses but can also require some training or explanation to users as they may not initially expect or understand the cross-filtering behavior.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-214">
<div id="calibre_link-791" class="calibre2">
<div id="calibre_link-792" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Edit interactions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>Report authors can modify the visual interaction behavior such that selections (user clicks) on certain visuals don't impact other visuals or only impact certain visuals.</span> <span>Additionally, for the visuals set to the highlight interaction by default, report authors can revise the interaction behavior to filter.</span></p>
<p class="calibre7">In the following example, the <kbd class="calibre15">United States</kbd> selection in the middle bar chart has no impact on the multi-row car visual but causes a filter interaction (rather than highlight) on the product category chart:</p>
<div class="cdpalignleft"><img src="images/000414.png" class="calibre173" /></div>
<div class="mce-root2">Edit interactions in Power BI Desktop</div>
<p class="calibre7">To edit visual interactions, select the visual that will receive the selections and then enable the <kbd class="calibre15">Edit interactions</kbd> command under the <span>Format</span> tab in Power BI Desktop. In this example, the None interaction icon has been selected for the multi-row card visual and the Filter interaction icon has been selected for the <kbd class="calibre15">Product Category</kbd> column chart. </p>
<div class="packt_tip pcalibre7 pcalibre6">Like the preceding example, it's often appropriate to disable visual interactions from impacting the card or KPI visuals in the top-left corner of the reports. These values can be impacted exclusively by the filters defined outside of the report canvas, such as report and page level filters, and will not change during user sessions like other visuals on the page.<br class="calibre3" />
<br class="calibre3" />
Regardless of the design decision, if users will regularly interact with reports, such as clicking on slicers and other visuals, it's important to briefly review or explain the visual interaction behavior. This is especially necessary with new users and with more customized designs, such as 2-3 visuals with interactions enabled and 2-3 visuals with interactions disabled.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-215">
<div id="calibre_link-793" class="calibre2">
<div id="calibre_link-794" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">What-if parameters</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Power BI Desktop provides a user interface for more easily creating What-if parameters than the custom slicer parameter demonstrated earlier in this chapter. This option is currently limited to numeric parameter values but automatically creates a single column table and a DAX measure that retrieves the input value.</p>
<p class="calibre7"><span>In the following example, two What-if parameters are used to calculate alternative unit price and unit cost values thereby driving a hypothetical product margin % measure:</span></p>
<div class="cdpalignleft"><img src="images/000424.png" class="calibre174" /></div>
<div class="mce-root2">What-if parameters applied in report visuals</div>
<p class="calibre7">By adjusting the two slider bars, a user is able to quickly model an alternative gross product margin % scenario, as illustrated by the dotted line in the line chart visual. The slider bar for modifying a single value is unique to slicers for What-if parameter columns.</p>
<p class="calibre7">To create a <kbd class="calibre15">What-if</kbd> parameter, click the <span>New Parameter</span> icon on the <span>Modeling</span> tab in Report View to launch the following dialog:</p>
<div class="cdpalignleft"><img src="images/000006.png" class="calibre175" /></div>
<div class="mce-root2">Creating a What-if parameter</div>
<p class="calibre7">Based on the minimum, maximum, and increment input values specified, a new table with a single column of values will be created within the Power BI dataset. For the <kbd class="calibre15">Unit Price Growth</kbd> parameter, this column has 20 rows from 0 to .19 with each value representing a full percentage point (for example, 0% to 19%). Additionally, a new DAX measure is created automatically to retrieve the user selection, per the following expressions: </p>
<pre class="calibre19"><strong class="calibre6">Internet Sales Unit Price Growth Value</strong> = <br class="calibre3" />SELECTEDVALUE('Internet Sales Unit Price Growth'[Internet Sales Unit Price Growth], 0)<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Sales Product Unit Cost Growth Value</strong> = <br class="calibre3" />SELECTEDVALUE('Internet Sales Product Unit Cost Growth'[Internet Sales Product Unit Cost Growth], 0)</pre>
<div class="packt_infobox"><span>With the second argument to both f</span><span>unctions set to <kbd class="calibre43">0</kbd>, both growth values will return zero if a selection hasn't been made or if multiple values have been selected. </span>The same <kbd class="calibre43">SELECTEDVALUE()</kbd> function, which was added to the DAX language in 2017, was also used in the custom slicer parameters example earlier in this chapter. </div>
<p class="calibre7">The only remaining step is to create one or more measures that reference the parameter values in their calculation logic. In this example, the <kbd class="calibre15">Unit Price</kbd> and <kbd class="calibre15">Unit Cost</kbd> growth parameters are applied to gross sales and product cost scenario measures, respectively. These two scenario measures are then used to compute a product margin scenario measure and a product margin % scenario measure, per the following expressions:</p>
<pre class="calibre19"><strong class="calibre6">Internet Gross Sales Scenario</strong> = SUMX('Internet Sales','Internet Sales'[Order Quantity]*<br class="calibre3" />  ('Internet Sales'[Unit Price]*(1 + [Internet Sales Unit Price Growth Value])))<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Sales Product Cost Scenario</strong> = SUMX('Internet Sales','Internet Sales'[Order Quantity] * <br class="calibre3" />  ('Internet Sales'[Product Standard Cost] * (1 + [Internet Sales Product Unit Cost Growth Value]))) <br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Gross Product Margin Scenario</strong> = <br class="calibre3" />[Internet Gross Sales Scenario] - [Internet Sales Product Cost Scenario]<br class="calibre3" /><br class="calibre3" /><strong class="calibre6">Internet Gross Product Margin % Scenario</strong> = <br class="calibre3" />DIVIDE([Internet Gross Product Margin Scenario],[Internet Gross Sales Scenario])</pre>
<p class="calibre7"><span>Although it's possible and sometimes necessary to create parameter columns and measures manually, the <span>What-if</span> parameter feature in Power BI Desktop can simplify this process for many modeling scenarios. Additionally, the slider bar slicer exclusive to the <span>What-if</span> parameter columns is the most user-friendly option for selecting parameter values. </span></p>
<div class="packt_tip pcalibre7 pcalibre6">To change the range of values available to the parameter, select the parameter column in the <kbd class="calibre43">Fields</kbd> list and modify the min, max, or increment arguments to the <kbd class="calibre43">GENERATESERIES()</kbd> function. Based on the user interface selections from the <kbd class="calibre43">Unit Price Growth</kbd> parameter, Power BI built the following function: <kbd class="calibre43">GENERATESERIES(0,20,.01)</kbd>. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-216">
<div id="calibre_link-795" class="calibre2">
<div id="calibre_link-796" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Slicers</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Slicer visuals represent a central element of self-service functionality in Power BI in addition to the <em class="calibre16">Visual interactions</em> behavior described in the previous section. The standard slicer visual displays the unique values of a single column enabling report users to apply their own filter selections. Additionally, Power BI Desktop provides several formatting and filter condition options available based on the data type of the column. The following image contains three sample slicer visuals with each slicer representing a different data type (<kbd class="calibre15">text</kbd>, <kbd class="calibre15">number</kbd>, <kbd class="calibre15">date</kbd>):</p>
<div class="cdpalignleft"><img src="images/000017.png" class="calibre176" /></div>
<div class="mce-root2">Slicer visuals</div>
<p class="calibre7">In this example, the three slicers filter for two sales territory countries (<kbd class="calibre15">Australia</kbd> and <kbd class="calibre15">France</kbd>), a range of product list prices ($500 to $2,500), and the last 30 days inclusive of the current date (<span>11/15/2017</span> to <span>12/14/2017</span>). Filter condition rules are available for numeric and date columns in slicers, such as greater than or equal to $500 and after 5/1/2017, respectively.</p>
<div class="packt_infobox">The numeric range slicer, such as the preceding $500 to $2,500 example, is a preview feature as of the November 2017 release for Power BI Desktop. In its current state, the numeric range slicer is exclusive to Power BI Desktop and will appear as a standard list slicer in the Power BI service. Additionally, only numeric columns can be used for the numeric range slicers - DAX measures are not supported. </div>
<p class="calibre7">See the <em class="calibre16">Report filter conditions</em> and <em class="calibre16">Relative date filtering</em> sections later in this chapter for additional details on relative date filters.</p>
<div class="packt_tip pcalibre7 pcalibre6">By default, the <span>Single Select</span> option under the <span>Selection Controls</span> formatting card is enabled and the <span>Show "Select All...</span> option is disabled. These settings require users to hold down the Ctrl key to select multiple items. For slicer visuals with many unique values, and when users regularly need to exclude only one or a few items, enabling the <span>Show "Select All...</span> option can improve usability. Additionally, for slicers based on text data-type columns, users can search for values via the ellipsis in the top-right corner of the visual.</div>
<p class="calibre7"><span>To preserve space on the report canvas, the slicer visual supports a drop-down option for all column data types. In the following example, a single value is selected for the country and date slicers but multiple values are selected for the price slicer:</span></p>
<div class="cdpalignleft"><img src="images/000026.png" class="calibre177" /></div>
<div class="mce-root2">Slicer visuals as dropdown</div>
<p class="calibre7">The drop-down option is most applicable for columns with many unique values. Slicers are generally appropriate to empower users with self-service capabilities such that they're not limited to filter conditions defined outside the report canvas.</p>
<div class="packt_tip pcalibre7 pcalibre6">It's recommended to group slicer visuals together near the edge of a report page. Slicers are most commonly aligned on the left side of the page below the visuals in the top-left corner. If vertical canvas space is limited, slicers displayed in list format can be presented horizontally rather than vertically. The orientation formatting property (vertical or horizontal) is available under the General formatting card. </div>
<p class="calibre7"><span>Unlike other visuals (for example, charts, maps, tables), visual-level filters cannot be applied to slicer visuals. Report and page-level filters are required to reduce the available values displayed on a slicer visual. Additional information on these filter scopes and associated filter conditions supported are included in the <em class="calibre16">Report filter scopes</em> section later in this chapter. </span></p>
<p class="calibre7">One of the most powerful features of slicers is the ability to filter both the current report page and optionally other report pages from a single slicer visual. The details of utilizing this feature, referred to as Slicer synchronization, are included in the following section. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-217">
<div id="calibre_link-797" class="calibre2">
<div id="calibre_link-798" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Slicer synchronization</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">By default, slicer visuals only filter the other visuals on the same report page. However, via the <span>Sync Slicer</span><span>s</span> pane, report designers can synchronize a slicer visual to also filter all other report pages or only specific report pages. This feature eliminates the need to include the same slicer on multiple report pages and thus simplifies the user experience. For example, a common report may utilize three slicers (for example, <kbd class="calibre15">Year</kbd>, <kbd class="calibre15">Product Category</kbd>, <kbd class="calibre15">Sales Country</kbd>) and include four report pages. With slicer synchronization configured, the report user would only need to select values from these slicers on a single report page and the visuals from all four report pages would be updated to reflect these selections.</p>
<p class="calibre7">The <span>Sync slicers</span> pane can be accessed from the <span>View</span> tab of the ribbon in Report View per the following image:</p>
<div class="cdpalignleft"><img src="images/000034.png" class="calibre178" /></div>
<div class="mce-root2">Sync slicers pane</div>
<p class="calibre7">Once selected per the preceding image, the <span>Sync slicers</span> pane will appear to the right of the report page. A slicer visual from the current report page can then be selected to configure its synchronization with other pages. </p>
<p class="calibre7">In the following image, the <kbd class="calibre15">Sales Territory Group</kbd> slicer on the <kbd class="calibre15">AdWorks Sales</kbd> report page has been selected but has not yet been synchronized with other report pages:</p>
<div class="cdpalignleft"><img src="images/000044.png" class="calibre179" /></div>
<div class="mce-root2">Sync slicers Pane with slicer selected</div>
<p class="calibre7">To quickly synchronize the slicer to all other report pages, simply click the <span>Add to all</span> link above the Sync and Visible icons. In this example, the <span>Add to all</span> command would apply checkmarks under the Sync icon for all four report pages. The <kbd class="calibre15">Sales Territory Group</kbd> slicer would<span> now filter all four report pages but would</span> only be visible on the AdWorks Sales page per the single checkmark under the Visible icon.</p>
<div class="packt_infobox">Several other report design features are accessible from the <span>View</span> tab, such as the <span>Bookmarks</span> and <span>Selection</span> panes, <span>Show gridlines</span>, and <span>Snap objects to grid</span>. The <span>Bookmarks</span> and the <span>Selection</span> Pane are described in the <em class="calibre16">Bookmarks</em> section of the following chapter. The <span>Field Properties</span> pane is described in the <em class="calibre16">Metadata management</em> section of <a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content.</em></div>
<p class="calibre7">Alternatively, the <span>Sync slicers</span> pane can be used to customize the synchronization and visibility properties of the slicer per report page. For example, the <kbd class="calibre15">Sales Territory Group</kbd> slicer could be set to only filter (synchronize) three of the four report pages by selecting or unselecting the checkmarks for these pages. Additionally, checkmarks can be added to the Visible property to display the slicer on other pages. With this approach, the user would still only need to make a slicer selection once via synchronization but could view the slicer on other report pages to understand the current slicer selection(s) impacting the given report page.</p>
<p class="calibre7">For reports with several report pages and common slicers, a single report page could be dedicated to slicer selections and not contain any other visuals. Report designers could configure synchronization for each slicer on this page and instruct users to only use this page for applying their filter selections for all pages on the report. Moreover, a back button could be added to report pages allowing the user to easily navigate back to the dedicated slicer report page. An example of using a back button image is included in the <em class="calibre16">Drillthrough Report Pages</em> section of <a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16">Applying Custom Visuals, Animation, and Analytics</em>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-218">
<div id="calibre_link-799" class="calibre2">
<div id="calibre_link-800" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Custom slicer parameters</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A powerful use case for slicer visuals is to expose a custom list of parameter values and drive one or multiple DAX measures based on the user's selection. In the following example, a slicer visual contains six date intelligence periods and a custom DAX measure references the date intelligence measure corresponding to the user's selection:</p>
<div class="cdpalignleft"><img src="images/000054.png" class="calibre180" /></div>
<div class="mce-root2">Slicer as a measure parameter</div>
<p class="calibre7">The table used for the slicer values could be defined within a source system and retrieved during data refresh like other tables. Alternatively, since the parameter values are unlikely to change, the table could be created within Power BI Desktop and loaded to the model but not included in a data refresh. Like all parameter tables, no relationships would be defined with other tables.</p>
<p class="calibre7">The custom measure, <kbd class="calibre15">User Selected Internet Net Sales</kbd>, utilizes the <kbd class="calibre15">SELECTEDVALUE()</kbd> and <kbd class="calibre15">SWITCH()</kbd> functions to retrieve the user selection and then apply the appropriate date intelligence measure. In this implementation, a DAX variable is used to store the period selection value, per the following expression:</p>
<pre class="calibre19"><strong class="calibre6">User Selected Internet Net Sales</strong> = <br class="calibre3" />VAR PeriodSelection = SELECTEDVALUE('Date Parameter'[Date Period Selection],"Year to Date")<br class="calibre3" />RETURN<br class="calibre3" />SWITCH(TRUE(),<br class="calibre3" />  PeriodSelection = "Week to Date", [Internet Net Sales (WTD)],<br class="calibre3" />  PeriodSelection = "Month to Date", [Internet Net Sales (MTD)],<br class="calibre3" />  PeriodSelection = "Year to Date", [Internet Net Sales (YTD)],<br class="calibre3" />  PeriodSelection = "Prior Week to Date", [Internet Net Sales (PWTD)],<br class="calibre3" />  PeriodSelection = "Prior Month to Date", [Internet Net Sales (PMTD)],<br class="calibre3" />  PeriodSelection = "Prior Year to Date", [Internet Net Sales (PYTD)]<br class="calibre3" />  )</pre>
<p class="calibre7">The second parameter to the <kbd class="calibre15">SELECTEDVALUE()</kbd> function ensures that the <kbd class="calibre15">Year to Date</kbd> measure will be used if multiple values have been selected or if no values have been selected. If several additional DAX measures will be driven by the parameter selection, a dedicated measure could be created that only retrieves the selected value. This supporting measure would then eliminate the need for the variable since the support measure could be referenced directly within the <kbd class="calibre15">SWITCH()</kbd> function.</p>
<div class="packt_infobox">See <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em> for example expressions of date intelligence measures as well as measure support expressions. It's of course possible to fully define each date intelligence expression within the parameter-driven measure but, for manageability reasons, it's almost always preferable to leverage an existing measure. This is particularly the recommendation when the required measures represent common logic, such as month-to-date.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-219">
<div id="calibre_link-801" class="calibre2">
<div id="calibre_link-802" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Report filter scopes</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A fundamental skill and practice in Power BI report development is utilizing the report filter scopes and the filter conditions available to each scope. For example, a report intended for the European sales team can be filtered at the report level for the European sales territory group and specific report pages can be filtered for France, Germany, and the United Kingdom. Reports can be further customized by implementing filter conditions to specific visuals, applying more complex filter conditions, and providing drillthrough report pages to reflect the details of a unique item, such as a product or a customer.</p>
<p class="calibre7">Unlike the slicer visuals and visual interactions reviewed earlier in this chapter, report filter scopes are defined outside of the report canvas. Report filter scopes, therefore, provide report authors with the option to eliminate or reduce the need for on-canvas user selections as well as the canvas space associated with slicer visuals.</p>
<div class="packt_tip pcalibre7 pcalibre6">In addition to meeting functional requirements and delivering a simplified user experience, report filter scopes can also benefit performance. Using the European sales report as an example, the simple filter conditions of <kbd class="calibre43">Sales Territory Group = Europe</kbd> (Report-level filter) and <kbd class="calibre43">Sales Territory Country = France</kbd> (Page-level filter) are efficiently implemented by the Power BI in-memory engine (import mode) and almost all DirectQuery data sources. Even if the DAX measures used on the report page for France are complex, the report filters will contribute to acceptable or good performance.</div>
<p class="calibre7">With a visual selected on the canvas in the Report View, a filters pane below the visualizations icon presents the following four input field wells:</p>
<ul class="calibre12">
<li class="calibre13"><strong class="calibre6">Report-level filters</strong>:
<ul class="calibre17">
<li class="calibre13">The filter conditions defined impact all visuals on all report pages</li>
</ul>
</li>
<li class="calibre13"><strong class="calibre6">Page-level filters</strong>:
<ul class="calibre17">
<li class="calibre13">The filter conditions defined impact all visuals on the given report page</li>
<li class="calibre13">Report-level filter conditions are respected by the page-level filters as well</li>
<li class="calibre13">Any Drillthrough filter conditions defined for the report page are also respected</li>
</ul>
</li>
<li class="calibre13"><strong class="calibre6">Visual-level filters</strong>:
<ul class="calibre17">
<li class="calibre13">The filter conditions defined only impact the specific visual selected</li>
<li class="calibre13">Report and page-level filter conditions are respected by the visual-level filters as well</li>
<li class="calibre13">Any Drillthrough filter conditions defined for the report page of the given visual are also respected</li>
</ul>
</li>
<li class="calibre13"><strong class="calibre6">Drillthrough filters</strong>:
<ul class="calibre17">
<li class="calibre13">The filter condition, a single value from a column, impacts all visuals on the given report page.</li>
<li class="calibre13">Report-level filter conditions are respected by the Drillthrough filters as well.</li>
<li class="calibre13">Any page and visual-level filter conditions defined for the given report page are respected</li>
</ul>
</li>
</ul>
<p class="calibre7"><span>Per the prior two chapters, filters are applied to Power BI visuals via the relationships defined in the dataset (via single or bidirectional cross-filtering) as well as any filtering logic embedded in DAX measures. All four of the preceding filters (<span>Report</span>, <span>Page</span>, <span>Visual</span>, <span>Drillthrough</span>) contribute to the initial filter context as described in the </span><em class="calibre16">Measure Evaluation Process</em><span> of <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em>. Therefore, just like filters applied on the report canvas (for example, Slicers), the filter logic of DAX measures can supplement, remove, or replace these filters conditions. In the event of a conflict between any report filter and a DAX measure expression that utilizes the <kbd class="calibre15">CALCULATE()</kbd> function, the DAX expression will supersede or override the report filter.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-220">
<div id="calibre_link-803" class="calibre2">
<div id="calibre_link-804" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Report filter conditions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Different types of filter conditions can be defined for the distinct filter scopes. For example, report and page-level filters are limited to relatively simple filter conditions that reference individual columns of a dataset. However, more complex and powerful conditions such as filtering by the results of a DAX measure and top N filters can be applied via visual level filters.  </p>
<p class="calibre7">The following outline and matrix (filter conditions by filter scope) summarize the filtering functionality supported:</p>
<ul class="calibre12">
<li class="calibre13"><strong class="calibre6">Basic Filtering</strong>:
<ul class="calibre17">
<li class="calibre13">A single equality condition for a column to a single value or set of values, such as "is North America or Europe"</li>
<li class="calibre13">A single inequality condition for a column to a single value or set of values, such as "is not $25 or $35"</li>
</ul>
</li>
<li class="calibre13"><strong class="calibre6">Advanced Filtering</strong>
<ul class="calibre17">
<li class="calibre13">Several condition rules per data type, such as "starts with" for text and "is greater than or equal to" for numbers:
<ul class="calibre17">
<li class="calibre13">Supports filtering for blank and non-blank values</li>
</ul>
</li>
<li class="calibre13">Optionally apply multiple conditions per column via logical operators (and, or)</li>
</ul>
</li>
<li class="calibre13"><strong class="calibre6">Relative Date Filtering</strong>:
<ul class="calibre17">
<li class="calibre13">Supports three filter condition rules <span>(is in </span><span>this, is in the last, is in the next)</span> for days, weeks, months, and years</li>
<li class="calibre13">Partial period and complete period filter conditions can be defined</li>
<li class="calibre13">The same filter condition rules are available to slicers with date data-type columns</li>
</ul>
</li>
<li class="calibre13"><strong class="calibre6">Top N Filtering</strong>:
<ul class="calibre17">
<li class="calibre13">Filter a visual to a defined number of top or bottom values of a column based on their values for a measure</li>
<li class="calibre13">For example, the top 10 products based on net sales can be set as a visual-level filter condition</li>
</ul>
</li>
<li class="calibre13"><strong class="calibre6">Filter by Measure</strong>:
<ul class="calibre17">
<li class="calibre13">Filter a visual by applying advanced filtering conditions to the results of a DAX measure</li>
<li class="calibre13">For example, greater than 45% on the Internet Net Margin % measure can be set as a visual-level filter condition</li>
</ul>
</li>
</ul>
<p class="calibre7">The following table summarizes the preceding filter conditions available to each of the three primary report filter scopes:</p>
<div class="cdpalignleft"><img src="images/000064.png" class="calibre181" /></div>
<div class="mce-root2">Filter conditions by filter scope</div>
<p class="calibre7">Multiple filter conditions can be defined per report filter scope. For example, a report-level filter could include two basic filter conditions and an advanced filter condition. Additionally, the same column can be used in multiple filter scopes, such as a report-level filter and a page-level filter on the product subcategory column. All defined filter conditions are applied to the visuals within their scope provided that the DAX measures included in the visuals don't contain filtering logic in conflict with the report filter conditions. Additionally<span>, the columns and measures referenced in the filter conditions do not need to be displayed in the report visuals. </span><span>For the top N Filtering condition, the column to be filtered only has to be displayed in the visual when the filter condition is initially defined. </span></p>
<p class="calibre7"><span>A good indicator of Power BI development and solution-specific knowledge is the ability to accurately interpret the filters being applied to a given visual on a report page. This includes all Power BI report filters (report-level, page-level, visual-level), any slicer selections or cross-highlighting, the filter logic of the DAX measures, the cross-filtering applied via relationships in the data model, and any filter logic built into the M queries of the dataset. Complex reports and datasets will utilize all or many of these different layers in various combinations to ultimately affect the values displayed in report visuals.</span></p>
<p class="calibre7"><span>BI teams will want to limit the complexity built into reports, both for users and the report authors or developers responsible for the reports. For example, if visual-level filter conditions are applied to many visuals of a report, the filter condition for each visual will need to be modified if the requirement(s) of the report change or the columns or measures used by the filter condition change. Dataset designers and data warehouse teams can often implement changes or enhancements to simplify the filter conditions needed by report authors.</span></p>
<p class="calibre7"><span>As one example, a filter condition implemented in multiple reports that specifies several product categories (hardcoded) could be replaced with a new column on the product dimension table. The new column would distinguish the group of product categories that meet this criteria relative to those that don't, and logic could be built into the data source or retrieval process to dynamically include additional product categories that later meet the given criteria. </span></p>
<div class="packt_infobox">Drillthrough filters, which are used to define drillthrough report pages as described in <a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16">Applying Custom Visuals, Animation, and Analytics</em>, are unique in that they can be used to implement basic filtering conditions at the page level as well as their more common filter of a single column value. For example, three countries can be selected in a Drillthrough filter condition and the visuals on this report page will reflect these three countries. However, a user can only drill to the report page from the context of a single column value. The source drillthrough value (for example, Germany), will replace the three countries in the previous filter condition on the drillthrough page when the drillthrough action is executed. <br class="calibre3" />
<br class="calibre3" />
Additionally, multiple columns can be used as Drillthrough filters and the values of both columns from a separate report page are applied to the drillthrough page when a drillthrough action is executed. If only one value is present from the source report page, the drillthrough action will only filter this column and remove any filter defined for the other Drillthrough filter column. See <a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16">Applying Custom Visuals, Animation, and Analytics</em> for additional details on drillthrough report pages. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-221">
<div id="calibre_link-805" class="calibre2">
<div id="calibre_link-806" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Report and page filters</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Report and page level filters are most commonly used to apply the fundamental filter context for the report. Columns with few unique values such as <kbd class="calibre15">Sales Territory Country</kbd> are good candidates for report level filters while more granular columns such as <kbd class="calibre15">Sales Territory Region</kbd> are better suited for page level filters. </p>
<p class="calibre7">In the following example, the individual report pages are named according to the report and page filters applied:</p>
<div class="cdpalignleft"><img src="images/000074.png" class="calibre182" /></div>
<div class="mce-root2">Power BI report pages</div>
<p class="calibre7">In the absence of any custom DAX measures that retrieve the filter selections applied, users of the report will not see the report, page, and visual-level filters applied. Therefore, it's important to assign intuitive names to each report page per the preceding example and to include a brief title for each report page via text box.</p>
<p class="calibre7">The following image represents the report and page filters applied to the Northeast report page of a <kbd class="calibre15">United States</kbd> sales report:</p>
<div class="cdpalignleft"><img src="images/000085.png" class="calibre183" /></div>
<div class="mce-root2">Report and page-level filters</div>
<p class="calibre7">Each report page would be filtered for a different sales territory region except the USA page, which would not contain a page level filter. The <kbd class="calibre15">Calendar Year Status</kbd> column, which was described in the <em class="calibre16">Date dimension view</em> section of <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>, restricts all visuals to only the current and prior calendar year. One or two years of history is sufficient for many reports given the pace of change in business environments and strategies. Additionally, the report-level date filter promotes both query performance and low maintenance since the dates filtered reflect the latest dataset refresh. </p>
<div class="packt_tip pcalibre7 pcalibre6">Report filters are not a long-term substitute for poor data quality or a suboptimal dataset (data model, retrieval queries). If it's necessary to implement many filter conditions or complex filtering conditions within reports to return accurate results, it's very likely that the dataset or the source system itself should be revised. Similarly, if many filter conditions or complex filter conditions are needed to retrieve the desired results, it's likely that the dataset can be enhanced (for example, new column, new measure) to simplify or eliminate these report filter conditions. <br class="calibre3" />
<br class="calibre3" />
Power BI report authors should communicate to the dataset designer(s) and BI team whenever complex or convoluted report filters are being applied. Given limited team resources, it may be sufficient to use report filters to support rare or uncommon reports. For common reporting needs, however, it's generally appropriate to build or revise the necessary logic in the data source or dataset.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-222">
<div id="calibre_link-807" class="calibre2">
<div id="calibre_link-808" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Page filter or slicer?</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Slicer visuals can serve as an alternative to distinct or dedicated report pages. With a slicer, a user has the flexibility to select one or multiple values on the same report page, such as Northeast and Southwest, without needing to navigate to a dedicated page. Additionally, by consolidating dedicated report pages, slicers can simplify report development and management.</p>
<div class="packt_tip pcalibre7 pcalibre6">Slicers are often the best choice when there's nothing unique to the different values of the slicer. For example, if all sales regions are always analyzed by the same measures, dimensions, and visuals it may be unnecessary to duplicate these pages of visuals. Slicers are also very helpful or necessary when users regularly need to analyze the data by the same dimensions or by custom dimensions, such as price and date ranges. </div>
<p class="calibre7">However, dedicated report pages are valuable for supporting email subscriptions, data alerts, and dashboard visuals specific to a particular value such as a sales region. In the following image from the Power BI service, an email subscription can be set to any of the report pages within the <span>USA SALES AND MARGIN</span> report:</p>
<div class="cdpalignleft"><img src="images/000095.png" class="calibre184" /></div>
<div class="mce-root2">Email subscription in Power BI</div>
<p class="calibre7">As one example, the visuals from the <span>Northeast</span> report page could potentially be pinned to a Northeast dashboard (or other dashboard) and used in data alerts and notifications for the Northeast team as well. These region-specific capabilities are made possible by the distinct report pages of visuals filtered for the given sales territory region.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-223">
<div id="calibre_link-809" class="calibre2">
<div id="calibre_link-810" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Relative date filtering</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Relative date filtering is available for date columns at all filter scopes (report, page, and visual) and for slicer visuals. These dynamic filter conditions, such as the last 30 days (relative to the current date) promote both data freshness and query performance since the minimal amount of history required can be retrieved. Additionally, relative date filters can often avoid the need to create custom DAX measures to support specific date filter conditions.</p>
<p class="calibre7"><span>In the following example, five report pages are dedicated to a specific relative date filter condition:</span></p>
<div class="cdpalignleft"><img src="images/000106.png" class="calibre185" /></div>
<div class="mce-root2">Relative date filter conditions per page</div>
<p class="calibre7">A page-level filter is used for each report page with the following conditions, per the following example:</p>
<div class="cdpalignleft"><img src="images/000117.png" class="calibre186" /></div>
<div class="mce-root2">Relative date filter condition</div>
<p class="calibre7">As of 12/14/2017, the five report pages are filtered to the following date ranges with the Include today option enabled:</p>
<ul class="calibre12">
<li class="calibre13"><span>Is in the last 12 months 12/15/2016 through 12/14/2017</span></li>
<li class="calibre13">Is in the last 12 weeks 9/22/2017 through 12/14/2017</li>
<li class="calibre13">Is in this month 12/1/2017 through 12/31/2017</li>
<li class="calibre13">Is in the next 12 weeks 12/14/2017 through 3/7/2018</li>
<li class="calibre13">Is In the next 12 months 12/14/2017 through 12/13/2018 </li>
</ul>
<p class="calibre7">A report design such as this would make it simple for users to analyze immediate, near-term, and longer-term trends and issues. </p>
<p class="calibre7"><span>Three types of relative date filter conditions can be set&mdash;<span>is in the last</span>, <span>in this</span>, and <span>in the next</span>. Each of these filter conditions supports day, week, month, and year intervals. For the in the last and in the next filter conditions, calendar week, month, and year conditions can also be specified. These conditions represent full or completed calendar periods only. For example, </span><span>as of November 28th, 2017,</span><span> the last one-calendar month and last one-calendar year would include all dates of October 2017 and all dates of 2016, respectively. The week of 11/19/2017 through 11/25/2017 would represent the last one-calendar week. </span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-224">
<div id="calibre_link-811" class="calibre2">
<div id="calibre_link-812" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Visual-level filtering</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Visual-level filters provide the most powerful filter conditions in Power BI exclusive of custom filter conditions specified in DAX expressions. Unlike report and page-level filters, DAX measures can be used in visual-level filter conditions, such as <kbd class="calibre15">Net Sales</kbd> greater than $5,000. Additionally, top N filter conditions can be implemented referencing a column and measure that are included or excluded from the visual per the Top N visual-level filters section following this example.</p>
<p class="calibre7">In the following example, a table visual of customers has been filtered by the <kbd class="calibre15">Internet Net Sales</kbd> and <kbd class="calibre15">Internet Sales Orders</kbd> measures:</p>
<div class="cdpalignleft"><img src="images/000127.png" class="calibre187" /></div>
<div class="mce-root2">Table with visual-level filters applied</div>
<p class="calibre7">Specifically, the visual only displays items (customers) with more than $8,000 in net sales and more than three sales orders. Per the sales-ranking measure, certain customers that meet the net sales condition are excluded based on the sales order condition. Unlike the top N visual-level filter condition, filters based on measures, such as the following conditions, are only applied when items (for example, customers, products) are displayed on the visual:</p>
<div class="cdpalignleft"><img src="images/000137.png" class="calibre188" /></div>
<div class="mce-root2">Visual-level filter conditions</div>
<p class="mce-root3">By removing the two customer columns, the remaining measures (<kbd class="calibre15">Internet Sales Orders</kbd>, <kbd class="calibre15">Internet Net Sales</kbd>) are not filtered by the visual-level filter conditions. In other words, the visual-level filters based on measures are only applied against the dimension column or columns in the visual, such as <kbd class="calibre15">Customer Name</kbd> or <kbd class="calibre15">Customer Postal Code</kbd>. </p>
<p class="calibre7"><span>Although analytically powerful, report authors should exercise caution with visual-level filters. From a usability standpoint, reports can become confusing when visuals on the same report page reflect different filter conditions. Additionally, executing complex filter conditions against large or dense report visuals can result in performance degradation. If a complex filter condition is repeatedly needed at the visual level, it's likely the case that the dataset should be modified to include some or all of this logic.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-225">
<div id="calibre_link-813" class="calibre2">
<div id="calibre_link-814" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Top N visual-level filters</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In the following example, a table visual is filtered based on the top five products for the <kbd class="calibre15">Internet Net Sales (<span>PYTD</span>)</kbd> measure:</p>
<div class="cdpalignleft"><img src="images/000147.png" class="calibre189" /></div>
<div class="mce-root2">Top N visual-level filter</div>
<p class="calibre7">For this visual, the <strong class="calibre6">prior year-to-date</strong> (<strong class="calibre6">PYTD</strong>) measure used for the filter condition is not one of the three measures displayed. Nonetheless, the following <span>Top N</span> condition filters out all products, including the top-selling product for the current year, that weren't one of the top five products in the prior year:</p>
<div class="cdpalignleft"><img src="images/000157.png" width="224" height="160" class="calibre190" /> </div>
<div class="mce-root2">Top N filter condition</div>
<p class="calibre7">With a Top N filter defined between a column and a measure, the report author can optionally remove the column being filtered from the visual or replace it with a different column. For example, the $2,980,475 in <kbd class="calibre15">Internet Net Sales (YTD)</kbd> associated with the top five products from the prior year could be visualized by customer country instead of the product name. Alternatively, all columns except the <kbd class="calibre15">Internet Net Sales (YTD)</kbd> measure could be removed from the table visual and a card or KPI visual could be used to visualize the $2,980,475 value. The column referenced by the Top N filter condition only needs to be included in the visual when the filter condition is originally defined.</p>
<div class="packt_tip pcalibre7 pcalibre6">The <kbd class="calibre43">TOPN()</kbd> DAX function returns a filtered table based on an expression (such as a net sales measure). As a table, the results of this function can be passed as a filter argument to <kbd class="calibre43">CALCULATE()</kbd> in a separate measure. For example, a measure could be created to compute the sales for the top 100 customers based on prior year-to-date sales.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-226">
<div id="calibre_link-815" class="calibre2">
<div id="calibre_link-816" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Visualization formatting</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A final step in report development is configuring the formatting options for each visual. Several of these options, such as data labels, background colors, borders, and title are common to all visuals and are often essential to aid comprehension. Several other formatting options, such as fill point for scatter charts, are exclusive to particular visuals and report authors are well served to be familiar with these features.</p>
<p class="calibre7">In addition to giving reports a professional appearance, features such as tooltips can be used to provide visuals with additional or supporting context. Furthermore, formatting features can be used to implement conditional logic to dynamically drive the color of data points by their values. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-227">
<div id="calibre_link-817" class="calibre2">
<div id="calibre_link-818" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Visual-level formatting</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Formatting visuals primarily refer to modifying the format properties of a visual via the format cards associated with that visual. Additionally, report authors can use the options exposed on the <span>Format</span> tab in the Report View of Power BI Desktop to control the alignment, distribution, and Z-position of visuals. </p>
<p class="calibre7">Whenever a visual is selected on the canvas, the <span>Format</span> pane presents a number of formatting cards specific to the visual. In the following image, the 10 formatting cards currently available to the Power BI column chart visual are displayed:</p>
<div class="cdpalignleft"><img src="images/000167.png" class="calibre191" /></div>
<div class="mce-root2">Visual formatting cards</div>
<p class="calibre7">Expanding and enriching the available formatting options across all visuals has been a priority for the Power BI team. As an example, for the column chart, the <span>X-Axis</span> card includes a concatenate labels property that can be useful for maintaining context while navigating through the levels of a hierarchy. Additionally, the <span>Data labels</span> card contains options for positioning labels inside the base of the column and changing the scale <span>(for example, thousands, millions)</span> and decimal places of the values displayed.</p>
<div class="packt_infobox">For some visuals, such as column, line, and scatter charts, the <span>Analytics</span> pane (next to the <span>Format</span> pane) provides additional formatting options. These options are reviewed in the following chapter. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-228">
<div id="calibre_link-819" class="calibre2">
<div id="calibre_link-820" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Line and column charts</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Line, column, and bar charts are the most common chart visualization types given their advantages in visual perception, as explained in the <em class="calibre16">Visualization best practices</em> section. Power BI includes clustered and stacked versions of column and bar charts in addition to two combination charts that display both a line and either a clustered or stacked column.</p>
<p class="calibre7">The ribbon chart visualization was added to Power BI Desktop in September 2017 and represents a variation of the stacked column chart. Unlike the stacked column chart, the ribbon chart sorts the category items within each column based on their values and connects the items across columns with a ribbon.</p>
<p class="calibre7">In the following example of a ribbon chart, four product subcategories are displayed across months by their net sales:</p>
<div class="cdpalignleft"><img src="images/000177.png" class="calibre192" /></div>
<div class="mce-root2">Ribbon chart</div>
<p class="calibre7">Helmets subcategory overtook the <span>Tires and Tubes</span> category in September 2017 to become the top-selling product subcategory in the visual. Per the tooltip included in the preceding image, hovering over the curved ribbon connecting the months on the <em class="calibre16">X</em>-axis displays the values for each month, the variance and percentage change between the months, and the change in rank for the given category (for example, from first to second for <span>Tires and Tubes</span>). Insights into the rankings of categories and their changes across periods wouldn't be as easily identified in a standard stacked column chart.</p>
<div class="packt_infobox"><span>The ribbons formatting card allows for spacing, transparency, and a border to further aid comprehension. In the example visual, the ribbon border is enabled, the transparency of the ribbon is set to 50, and the ribbon spacing is set to 5.</span> <span>Currently, unlike the stacked column chart, the Ribbon chart doesn't include a <em class="calibre16">Y</em>-axis to identify the total value of each column. Additionally, the individual ribbons are currently distinguished by color. Formatting options available to other visuals, such as customizing each series or the legend using alternative styles and markers, are not yet supported.</span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-229">
<div id="calibre_link-821" class="calibre2">
<div id="calibre_link-822" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Tooltips</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Chart and map visuals include a <span>Tooltips</span> field well in the <span>Fields</span> pane to allow report authors to define additional measures that will display when the user hovers over the items in the visual. These tooltip values will reflect the same filter context of the data labels for the visual and thus provide the user with additional context. In the following example, four measures have been added to the <span>Tooltips</span> field well for a column chart:</p>
<div class="cdpalignleft"><img src="images/000187.png" class="calibre193" /></div>
<div class="mce-root2">Additional measures displayed as tooltips</div>
<p class="calibre7">By hovering over the column for online net sales in August of 2017, the tooltip is displayed, which includes both the <kbd class="calibre15">Internet Net Sales</kbd> measure used for the chart as well as the four tooltip measures.</p>
<p class="calibre7">In this example, the tooltip measures indicate that <kbd class="calibre15">Internet Net Sales</kbd> was below the plan for this month by $72,970 in addition to other potentially useful metrics (<kbd class="calibre15">Intenet Sales Per Customer</kbd>, <kbd class="calibre15">Internet Net Margin %</kbd>). In the absence of the tooltips, the user may have to search for other reports or visuals to find this information or may miss important insights related to the visual.</p>
<p class="calibre7"><span>Tooltips are a great way to enhance the analytical value of a visual without adding complexity or clutter. Additionally, given the features of the DAX query engine, such as measure fusion, the additional measures displayed as tooltips will generally not negatively impact performance. For example, the internet sales and margin measures are based on the same fact table. Therefore, the necessary source columns for both measures will be accessed by one storage engine query via measure fusion.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-230">
<div id="calibre_link-823" class="calibre2">
<div id="calibre_link-824" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Report page tooltips</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The standard tooltips described in the previous section may be sufficient for most reporting scenarios. However, Power BI Desktop also provides report page tooltips that allow report authors to display a custom page of report visuals as an alternative to the default tooltips. The following steps can be used to configure a report page tooltip:</p>
<ol class="calibre12">
<li class="chapter">Add a new blank report page to a report. </li>
<li class="chapter">On the <span>Format</span> pane for the report page, enable the <span>Tooltip</span> property under the <span>Page Information</span> formatting card. </li>
<li class="chapter">Also on the <span>Format</span> pane, specify a <span>Tooltip</span> page size per the following image:</li>
</ol>
<div class="cdpalignleft"><img src="images/000197.png" class="calibre194" /></div>
<div class="mce-root2">Report page tooltip</div>
<ol start="4" class="calibre12">
<li class="chapter">On the Tooltip page from step <em class="calibre16">3</em>, set the <span>Page View</span> to <span>Actual Size</span> via the <span>Page View</span> icon on the <span>View</span> tab.</li>
<li class="chapter">From the <span>Fields</span> pane of the Tooltip page, drag a measure or multiple measures to the tooltip <span>Fields</span> field well:
<ul class="calibre17">
<li class="chapter"> Columns can also be specified as tooltip fields (for example, <kbd class="calibre15">Product Name</kbd>)</li>
</ul>
</li>
<li class="chapter">Create report visuals on the tooltip report page that relate to the tooltip field well measure(s) or column(s):<br class="calibre3" />
<ul class="calibre17">
<li class="chapter">For example, if the tooltip page will support a sales measure, consider building visuals that display sales versus plan, budget, or sales growth measures</li>
<li class="chapter">Given the limited size of the Tooltip report page, KPI and card visuals are recommended</li>
</ul>
</li>
</ol>
<p class="calibre7">By default, other visuals in the report that utilize the measure(s) or column(s) specified as tooltip fields in step <em class="calibre16">5</em> will display the tooltip report page when the user hovers over the items of the visual.</p>
<div class="packt_infobox">The <span>Tooltip Page Size</span> from step <em class="calibre16">3</em> is not required for utilizing tooltip report pages. However, this property makes the purpose of the page clear to the other report authors and has been provided by the Power BI team as at a good starting point for most report page tooltips. Likewise, viewing the report page tooltip in actual size per step <em class="calibre16">4</em> is technically not required but is very helpful in designing these pages.</div>
<p class="calibre7">Alternatively, a tooltip formatting card is available at the bottom of the <span>Format</span> pane for charts and map visuals. This formatting card can be used to specify a particular tooltip report page for the given visual or to disable tooltip report pages. If report page tooltips have been disabled for a visual, the visual will display the default tooltips as described in the previous section. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-231">
<div id="calibre_link-825" class="calibre2">
<div id="calibre_link-826" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Column and line chart conditional formatting</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Column and line charts are two of the most common visuals in reports given their flexibility and advantages in visualizing comparisons and trends. However, these classic visuals don't have to be static or simple&mdash;report authors can embed custom rules to dynamically drive formatting properties based on source data. <span>Similar to tooltips, conditional formatting techniques help users more quickly derive insights from visuals without the added complexity of more data points or additional visuals.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-232">
<div id="calibre_link-827" class="calibre2">
<div id="calibre_link-828" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Column chart conditional formatting</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>Conditional formatting can be applied to column charts by specifying a measure, such as product margin in the color saturation field well. By default, the value of this measure will drive the saturation of color for each column in the visual. To take further control of the formatting or to apply a conditional formatting rule, the <span>Diverging</span> formatting options under the <span>Data colors</span> card can be modified.</span></p>
<p class="calibre7">In the following example of a column chart, a product margin percentage measure is used as the Color saturation field (above tooltips) and threshold values have been entered to define the formatting rule:</p>
<div class="cdpalignleft"><img src="images/000208.png" class="calibre195" /></div>
<div class="mce-root2">Diverging Data colors formatting</div>
<p class="calibre7">With the <span>Diverging</span> property enabled this rule associates three colors (red, yellow, and green) with <span>Minimum</span>, <span>Center</span>, and <span>Maximum</span> values of -6.5%,0%, and 6.5%, respectively. This rule will make it easy for users to distinguish the columns, such as fiscal periods or product categories, associated with low, average, and high product margins.</p>
<div class="packt_infobox">By disabling the <span>Diverging</span> property, a rule can be specified for only a minimum and a maximum value. This can be useful to change the color of a column only when a threshold is reached. In other words, the chart will at most display two distinct colors with one of the colors (for example, red) flagging the exceptions. To implement this rule, simply specify the same value for both minimum and maximum inputs and then associate different colors for each.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-1">
<div id="calibre_link-829" class="calibre2">
<div id="calibre_link-830" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Line chart conditional formatting</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Conditional formatting can be applied to line charts by applying distinct colors to separate DAX measures. In the following example, a DAX measure is created that only returns the sales per order value when its value is below $600:</p>
<pre class="calibre19"><strong class="calibre6">Internet Net Sales Per Order Below $600</strong> = <br class="calibre3" />IF([Internet Net Sales Per Order] &lt; 600,[Internet Net Sales Per Order],BLANK())</pre>
<p class="calibre7">Using this measure and the <kbd class="calibre15">Internet Net Sales Per Order</kbd> measure on the same line chart allows for separate colors to be applied: </p>
<div class="cdpalignleft"><img src="images/000218.png" class="calibre196" /></div>
<div class="mce-root2">Contrasting colors for line chart measures</div>
<p class="calibre7">For this example, a default light green can be used for the <kbd class="calibre15">Internet Net Sales Per Order</kbd> measure and red can be applied for the below $600 measure. Additionally, the below $600 line can be formatted with a slightly larger stroke width and a dotted line style via the customize series formatting options to better contrast these values. </p>
<p class="calibre7">The line chart will appear as a single line that changes colors and styles when it goes below $600:</p>
<div class="mce-root2"><img src="images/000228.png" class="calibre197" /></div>
<div class="mce-root2"><span>Conditionally-for</span>matted line chart</div>
<p class="calibre7"><span>The stroke width, join type, line style, and marker shape formatting properties provide a wide range of options for contrasting lines beyond their colors. These additional properties are recommended to aid general comprehension and to support users who cannot easily distinguish colors.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-13">
<div id="calibre_link-831" class="calibre2">
<div id="calibre_link-832" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Table and matrix</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Per the <em class="calibre16">Choosing the visual </em>section earlier in this chapter, table and matrix visuals are good for looking up individual values and for displaying precise values. For example, all seven digits of the value $7,847,292 would be displayed on a table or matrix visual but this same value would likely need to be rounded to $7.8M in a column or line chart to maintain readability.</p>
<p class="calibre7">Table and matrix visuals support the same <span>Display units</span> and <span>Value decimal places</span> formatting properties as other visuals. In the following example from a table visual, both measures have been formatted to display their values in terms of millions with one decimal place:</p>
<div class="cdpalignleft"><img src="images/000238.png" width="787" height="221" class="calibre198" /> </div>
<div class="mce-root2">Display Units and Decimal Places for Table and Matrix Visuals</div>
<p class="calibre7">Per the preceding example, these properties are available within the <span>Field formatting</span> card of the <span>Format</span> pane. Display unit options range from the thousands (K) to the trillions (T). By default, the <span>Display units</span> property is set to <span>None</span> for table and matrix visuals and thus displays the full value.</p>
<p class="calibre7">Prior to the availability of the <span>Display units</span> and <span>Value decimal places</span> properties, it was necessary to use the <kbd class="calibre15">FORMAT()</kbd> function in separate DAX measures to display custom formats in table or matrix visuals. <span>The following two measures apply a custom rounded currency format to the results of the <kbd class="calibre15">Internet Net Sales</kbd> measure:</span></p>
<pre class="calibre19"><strong class="calibre6">Internet Net Sales (Format Thousands)</strong> = FORMAT([Internet Net Sales],"$0,.0K")<br class="calibre3" /><strong class="calibre6"><br class="calibre3" />Internet Net Sales (Format Millions)</strong> = FORMAT([Internet Net Sales],"$0,,.0M")</pre>
<div class="packt_infobox">Both measures use the <kbd class="calibre43">FORMAT()</kbd> function to convert the input value (the <kbd class="calibre43">Internet Net Sales</kbd> measure) to a string in a custom, rounded format. Specifically, the comma or commas immediately to the left of the decimal are used to divide the value by 1,000 and round as necessary. The zero to the right of the decimal displays a digit or a zero. For example, the $541,613 value would be displayed as $541.6K and $0.5M by the format thousands and format millions of measures, respectively. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-27">
<div id="calibre_link-833" class="calibre2">
<div id="calibre_link-834" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Table and matrix conditional formatting</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>Default and custom conditional formatting rules can be applied to table and matrix visuals to make it easier to identify exceptions and outlier values. </span>Power BI currently supports background color scales, font color scales, and data bar conditional formatting for table and matrix visuals. To apply conditional formatting to a table or matrix, click the drop-down arrow next to the field name of the measure (for example, <kbd class="calibre15">Internet Net Sales</kbd>) in the <kbd class="calibre15">Values</kbd> field well of the <span>Visualizations</span> pane. A conditional formatting menu item will appear with an arrow providing access to the three types of conditional formatting. </p>
<p class="calibre7">In the following table, data bar conditional formatting has been applied to four measures related to internet sales:</p>
<div class="cdpalignleft"><img src="images/000249.png" class="calibre199" /></div>
<div class="mce-root2">Data bars conditional formatting</div>
<p class="calibre7">Although the visual has been filtered to the top 10 customer state provinces for France, it would be difficult or time-consuming to gain insight from the 40 distinct data values. The length of the data bars helps to call out high or low values and alternative colors can be applied per measure.</p>
<div class="packt_infobox">The direction of data bars is particularly helpful in distinguishing negative from positive values per the <kbd class="calibre43">Internet Net Sales (YOY YTD %)</kbd> measure in the preceding example visual. For large table and matrix visuals with many values, or when the relative differences between values are more important than the individual values themselves, the option to show only the data bar can be very useful. </div>
<p class="calibre7">Custom conditional formatting rules can be applied to the background and font color scales of table and matrix visual cells similar to Microsoft Excel. In the following example, the <span>Color by rules</span> option is enabled and <span>Rules</span> are defined to format the cells of a measure as green if over 25%, yellow when between -25% and 25%, and red if the value is less than -25%:</p>
<div class="cdpalignleft"><img src="images/000259.png" class="calibre200" /></div>
<div class="mce-root2">Custom conditional formatting rules</div>
<p class="calibre7">The conditional formatting rules are evaluated from the bottom to the top. Therefore, if a cell meets the condition of multiple rules, the lower rule will be applied. The order of rules can be adjusted via the up and down arrows to the right of the color icons.</p>
<p class="calibre7">Multiple conditional formatting types can be applied against the same measure. For example, the same three conditional rules used for the background color scales in the preceding image could also be implemented as font color scale rules. However, the font colors specified for each rule (for example, white) could be chosen to contrast with the conditional background colors (for example, red) to further help call attention to the value.</p>
<div class="packt_infobox">As of the November 2017 release of Power BI Desktop, only hardcoded values can be specified in the custom formatting rules. In a future release, DAX measures will likely be supported as inputs to conditional formatting rules. This functionality would make it easier to implement more complex rules, such as greater than the prior year-to-date sales value. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-38">
<div id="calibre_link-835" class="calibre2">
<div id="calibre_link-836" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Values as rows</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">An additional and highly requested enhancement to matrix visuals is the ability to show measures as rows. The following matrix visual breaks out six DAX measures by a date hierarchy across the columns:</p>
<div class="cdpalignleft"><img src="images/000269.png" class="calibre201" /></div>
<div class="mce-root2">Values on rows in matrix visual</div>
<p class="calibre7">Displaying multiple measures as rows, particularly with one or multiple date dimension fields across the columns, is a very common layout for Excel pivot table reports. To enable this feature in Power BI, simply enable the Show on rows feature within the values formatting card of the matrix visual. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-50">
<div id="calibre_link-837" class="calibre2">
<div id="calibre_link-838" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Scatter charts</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Scatter charts are very effective at explaining the relationship or correlation between items against two variables. Optionally, a third variable can be used to drive the size of the data points and thereby convert the visual to a bubble chart.</p>
<p class="calibre7">In the following example, three countries from the <kbd class="calibre15">Sales Territory Country</kbd> column are used as the details input to a scatter chart:</p>
<div class="cdpalignleft"><img src="images/000279.png" class="calibre202" /></div>
<div class="mce-root2">Scatter chart</div>
<p class="calibre7">To provide additional detail, three product subcategories are included in the legend input, such that nine total points (3 X 3) are plotted on the chart. The scatter chart naturally calls out the differences among the items based on their <span>X Position</span> (<kbd class="calibre15">Reseller Net Sales</kbd>) and <span>Y Position</span> (<kbd class="calibre15">Internet Net Sales</kbd>). Moreover, to make the visual even easier to interpret, the marker shapes have been customized for each product subcategory (for example, triangles, diamonds, squares) and the size of the shapes have been increased to 40%. </p>
<div class="packt_infobox"><span>By default, Power BI applies different colors to the items in the legend. If the legend is not used, the report author can customize the colors of the individual items from the details input column. Although color can be effective for differentiating values, customized marker shapes, such as this example, are helpful for users with visual disabilities.</span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-233">
<div id="calibre_link-839" class="calibre2">
<div id="calibre_link-840" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Map visuals</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As of the November 2017 release, Power BI currently provides four map visuals including the bubble map, filled map, shape map (in preview), and the ArcGIS Map. The bubble map plots location points over a world map and varies the size of the bubbles based on a value. The points on bubble maps can also be broken out across a dimension to provide additional context. The filled map and shape map visuals are forms of heat maps that use color and color intensity to distinguish specific areas of a map by a value, such as postal codes by population. </p>
<div class="packt_infobox"><span>The ArcGIS Map visual is the most powerful of the available geospatial visualizations and several custom map visuals are available in the Office Store including the Globe Map and the Flow Map. See <a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16">Applying Custom Visuals, Animation, and Analytics</em> for details on the ArcGIS Map visual and using custom visuals. The <span>Shape Map</span> visual is currently still in preview and thus should only be used for testing purposes. The following URL provides documentation on the <span>Shape Map</span> <a href="http://bit.ly/2zS2afU" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2zS2afU</a>. </span></div>
<p class="calibre7">Per the <em class="calibre16">Data category</em> section in <a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em>, it's important to assign geographic data categories to columns. This information aids the map visuals in plotting the correct location when a value is associated with multiple locations (ambiguous locations). The following image from the Data view highlights the city category for a column:</p>
<div class="cdpalignleft"><img src="images/000289.png" class="calibre203" /></div>
<div class="mce-root2">Data category per column</div>
<div class="packt_infobox">Data categories can be assigned to columns from the modeling tab in Data view or the Report View. For DirectQuery datasets, these metadata properties can only be assigned from the Report View. Report authors should engage the dataset designer or BI team responsible for a dataset if data categories have not been assigned to columns needed for report development.</div>
<p class="calibre7">Additionally, for bubble and filled map visuals, hierarchies can be added to the location field well to avoid ambiguous results. For example, by adding the following hierarchy to the <kbd class="calibre15">Location</kbd> field well, the map visuals will only use the locations associated with their parent values, such as only the states of Australia. </p>
<div class="cdpalignleft"><img src="images/000299.png" class="calibre204" /></div>
<div class="mce-root2">Geographic hierarchies in map visuals</div>
<div class="packt_tip pcalibre7 pcalibre6">For greater precision and performance with map visuals (excluding the Shape Map), latitude and longitude input field wells are available as alternative inputs to <span>Location</span>.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-234">
<div id="calibre_link-841" class="calibre2">
<div id="calibre_link-842" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Bubble map</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Bubble maps are particularly useful when embedding an additional dimension column or category to the legend input. When a geographic boundary column, such as country or postal code, is used as the location input, the added dimension converts the bubbles to pie charts of varying sizes. Larger pie charts reflect the measure used for the <kbd class="calibre15">Size</kbd> input field and the components of each pie are color-coded to a value from the legend column providing even greater context.</p>
<p class="calibre7">The following bubble map example uses the postal code as the location input, the <kbd class="calibre15">Internet Net Sales</kbd> measure as the size input, and the <kbd class="calibre15">Customer History Segment</kbd> column as the legend input:</p>
<div class="cdpalignleft"><img src="images/000309.png" class="calibre205" /></div>
<div class="mce-root2">Map visual</div>
<p class="calibre7">For this map, the <span>Grayscale</span> theme is applied from the Map styles formatting card and the <span>a</span><span>uto-zoom</span> property under the <span>Map controls card</span> has been disabled. These two settings, along with a bubble size of 15% via the <span>Bubbles</span> card, makes it easy for users to analyze the data associated with postal codes north of Los Angeles.</p>
<div class="packt_infobox">The bubble map also includes a color saturation input to help distinguish bubbles beyond their relative sizes. This input, however, can only be used when the legend field well is not used. <br class="calibre3" />
<br class="calibre3" />
See the <span>Customer history</span> column section of <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M </em>for details on creating a history segment column within an M query. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-235">
<div id="calibre_link-843" class="calibre2">
<div id="calibre_link-844" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Filled map</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A filled map visual includes several of the same formatting properties of a bubble map but utilizes color as its primary means to contrast the locations. In the following filled map, a diverging color scheme has been applied via the <span>Data colors</span> formatting card to highlight individual states based on their online net sales:</p>
<div class="cdpalignleft"><img src="images/000319.png" class="calibre206" /></div>
<div class="mce-root2">Filled map visual with diverging colors</div>
<p class="calibre7">Exactly like the color scheme described in the column and line chart conditional formatting section, three distinct numeric values and colors are assigned to the <span>Minimum</span>, <span>Center</span>, and <span>Maximum</span> properties. For this visual, the values of $1M, $2M, and $3M are associated with red, yellow, and green; this causes the South Australia state to appear as red while the New South Wales states are green. </p>
<p class="calibre7">Additionally, like the previous bubble map example, a grayscale map-style theme has been applied and the <span>auto-zoom </span>property has been disabled. Other map themes, such as dark, light, road, and aerial, are also available for filled and bubble maps. These alternative themes, particularly when contrasted with the bright or rich colors of a filled map, can significantly add to the aesthetic appeal of a report.</p>
<div class="packt_infobox">Per the drill-up/down icons above the visual, a hierarchy of geographical columns (<kbd class="calibre43">Country</kbd>, <kbd class="calibre43">State</kbd>, <kbd class="calibre43">City</kbd>) has been added to the location field well. These additional columns help the Bing Maps API to display the correct location, such as only Victoria in Australia. To ensure that Bing Maps respects the parent column (for example, <kbd class="calibre43">Country</kbd>) when plotting child locations (for example, States/Provinces), the user can enable the drill mode via the drill-down button in the top-right corner of the visual. With drill mode enabled, the user can click the specific parent value on the map, such as the United States, and Bing will plot states by only searching for states within the United States.<br class="calibre3" />
<br class="calibre3" />
Alternatively, with drill mode not enabled, the user can click the expand all down one level icon in the top-left of the visual. From the initial state of the parent value (country), this will also plot the states within each parent value. The other drill option at the top-left of the visual, the go to the next level drill, only plots the child values without the context of the parent value.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-236">
<div id="calibre_link-845" class="calibre2">
<div id="calibre_link-846" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Mobile-optimized reports</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A critical use case for many reports is mobile access via the Power BI mobile applications for iOS, Android, and Windows platforms. A report that is perfectly designed for a laptop or PC monitor may be difficult to use on a tablet or mobile device. To account for multiple form factors, including both small and largescreen phones, report authors can create mobile-optimized reports via the <span>Phone Layout</span> view in Power BI Desktop.</p>
<p class="calibre7">In the following example, the <span>Phone Layout</span> of a report page in Power BI Desktop is accessed via the <span>View</span> tab:</p>
<div class="cdpalignleft"><img src="images/000329.png" class="calibre207" /></div>
<div class="mce-root2">Phone Layout</div>
<p class="calibre7">From the <span>Phone Layout</span> view, the visuals created and formatted for the report page can be arranged and sized on a mobile layout grid. In the following example, the two KPI and card visuals included in the preceding image from the Report View, as well as a line chart, are arranged on the phone canvas:</p>
<div class="cdpalignleft"><img src="images/000339.png" class="calibre208" /></div>
<div class="mce-root2">Phone Layout</div>
<div class="packt_tip pcalibre7 pcalibre6"><span>Single-number visuals, such as cards and KPIs, are natural candidates for mobile-optimized layouts. More complex and data-intensive visuals, such as scatter charts and combination charts, are generally less effective choices for mobile layouts. Given the one-to-one relationship between report pages and the phone layout, one design option is to create a dedicated report page with the visuals needed for the phone layout. </span></div>
<p class="calibre7">The size and position of visuals can be adjusted by dragging visual icons along the phone layout grid. <span>A mobile-optimized layout can be defined for each report page or any number of the pages contained in a report. The formatting and filter context of report visuals is always aligned between the <span>Phone Layout</span> and the default Report View. For example, to change the format or filter for a visual accessed via the <span>Phone Layout</span>, the visual can be modified from the standard Desktop Layout view.</span></p>
<p class="calibre7"><span>When a report page is accessed from the Power BI mobile application, the <span>Phone Layout</span> created in Power BI Desktop will be rendered by default in the phone report mode. If a phone-optimized layout doesn't exist, the report opens in landscape view.</span></p>
<div class="packt_infobox">Power BI dashboards can also be optimized for mobile devices. The mobile layout for dashboards is implemented in the Power BI service and is reviewed in <a href="#calibre_link-265" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 7</a>, <em class="calibre16">Designing Power BI Dashboards and Architectures</em>.<em class="calibre16"> </em></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-237">
<div id="calibre_link-847" class="calibre2">
<div id="calibre_link-848" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Responsive visuals</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Certain Power BI visuals, such as line, column, and scatter charts, can be configured to dynamically display the maximum amount of data possible given the available screen size. For example, a responsive column chart visual will display fewer gridlines and columns as the height and width properties of the visual are reduced. This setting can benefit the mobile layouts for both reports and dashboards as visuals will retain their most valuable elements as they're resized. </p>
<p class="calibre7">To enable the responsive feature, select the visual on the report page in Desktop Layout and enable the <span>Responsive (Preview)</span> property under the <span>General</span> formatting card, per the following example:</p>
<div class="cdpalignleft"><img src="images/000349.png" class="calibre209" /></div>
<div class="mce-root2">Responsive visuals property</div>
<p class="calibre7"><span>The <span>Responsive (Preview)</span> formatting property, currently in preview, is disabled by default and can only be enabled per report visual. </span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-238">
<div id="calibre_link-849" class="calibre2">
<div id="calibre_link-850" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Report design summary</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As a data visualization and analytics platform, Power BI provides a vast array of features and functionality for report authors to develop compelling content to help users derive insights. Given the volume of features and possible formatting configurations, report authors and BI teams will want to follow a set of report planning and design practices to ensure consistently, quality report content is delivered to stakeholders. These practices include report planning in terms of scope, users and use cases, data visualization practices, and the selection of visuals. </p>
<p class="calibre7">The <em class="calibre16">Report planning</em>, <em class="calibre16">Visualization best practices</em>, and <em class="calibre16">Choosing the visual</em> sections earlier in this chapter provided details on many of the recommended practices to develop effective and sustainable report content. At a standard summary-level review of a report and the implementation of these practices, perhaps at the conclusion of a development phase and prior to deployment, the following list of questions can be asked:</p>
<ol class="calibre12">
<li class="chapter">Does the report have a clear scope and use case?
<ul class="calibre17">
<li class="chapter">The report addresses specific business questions of value to specific users or teams that will consume the report</li>
<li class="chapter">The relationship and distinction between this report and other reports or dashboards that the users will have access to is understood </li>
<li class="chapter">The pages of the report naturally relate to one another to address the same or closely-related business questions, perhaps at alternative levels of detail</li>
</ul>
</li>
<li class="chapter">Have standard visualization practices been followed?
<ul class="calibre17">
<li class="chapter">The visuals have proper spacing, alignment, and symmetry </li>
<li class="chapter">The reports use colors selectively and there are clear titles on report pages and visuals </li>
<li class="chapter">The report is intuitive and not cluttered with unnecessary details</li>
</ul>
</li>
<li class="chapter">Have the right visuals been chosen to represent the data?
<ul class="calibre17">
<li class="chapter">Tables and matrices were used when cross-referencing or looking up individual values was necessary</li>
<li class="chapter">The type of data relationship to represent (for example, comparison) and the relative advantages of the different visuals, such as line charts for the trends of a value, drove the visual choice</li>
</ul>
</li>
<li class="chapter"> Does the report enable the user to easily apply filters and explore the data?
<ul class="calibre17">
<li class="chapter">Slicer visuals for common or important columns have been utilized and are easily accessible to users</li>
<li class="chapter">The filtering and cross-highlighting interactions between the visuals on the report pages have been considered and configured appropriately</li>
<li class="chapter">Hierarchies of columns have been built into certain visuals to allow a simple drill-up and drill-down experience</li>
</ul>
</li>
<li class="chapter">Does the report aid the user in identifying insights or exceptions?
<ul class="calibre17">
<li class="chapter">Dynamic formatting, such as with KPI visuals and conditional formatting rules and techniques, has been applied</li>
<li class="chapter">Tooltips have been added to report visuals to provide the user with additional context hovering over the visual such as the columns in a column chart or the data points in a line chart.</li>
</ul>
</li>
<li class="chapter">Have simple and sustainable filter conditions been applied at the appropriate scope?
<ul class="calibre17">
<li class="chapter">Report and page-level filter scopes have been applied to minimize the resources required by the queries generated by the report:
<ul class="calibre17">
<li class="chapter">Visual-level filters are only used when the visual needs to reflect an alternative filter context of the report and page-level filter scopes</li>
</ul>
</li>
<li class="chapter">Report filter conditions are not being used to address issues with data quality or the source dataset: 
<ul class="calibre17">
<li class="chapter"> Efforts have been made (or will be made) to enhance the source dataset to better support the report</li>
</ul>
</li>
<li class="chapter">Filter conditions on the date dimension are dynamic and sustainable (for example, <kbd class="calibre15">Current Year</kbd> and <kbd class="calibre15">Prior Year</kbd>) rather than hardcoded values (for example, 2018 and 2017)</li>
</ul>
</li>
</ol>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-239">
<div id="calibre_link-851" class="calibre2">
<div id="calibre_link-852" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In this chapter, we walked through the fundamental components of Power BI report design, including visualization best practices, Live connections to Power BI datasets, and the filter scopes available in Power BI Desktop. We reviewed top report development techniques and examples, <span>such as conditional formatting, tooltips, and user parameters. Furthermore, we looked at powerful self-service and mobile report features, including slicers, visual interactions, and mobile-optimized reports.</span></p>
<p class="calibre7"><span>The following chapter is also dedicated to the report development but goes well beyond the fundamental design concepts and features introduced in this chapter. That chapter will leverage the latest, most powerful report authoring features of Power BI, including drillthrough report pages, bookmarks, the analytics pane, and custom visuals. </span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-44">
<div id="calibre_link-853" class="calibre2">
<div id="calibre_link-854" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Applying Custom Visuals, Animation, and Analytics</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The previous chapter's emphasis on report planning, visualization best practices, and standard visuals in Power BI Desktop serve as a foundation for effective Power BI report development. However, more advanced visualization and report development features, such as the Analytics pane, Bookmarks, and drillthrough report pages are available to create even more compelling and insightful content. Additionally, a vast array of custom visuals created by Microsoft and a community of third parties can be leveraged to address specific use cases or provide extended functionality.</p>
<p class="calibre7">This chapter reviews many of the latest and most powerful analytical and visualization features in Power BI. This includes the design and utilization of drillthrough report pages, the ArcGIS Map for Power BI, and the use of Bookmarks and related features to easily store and share the insights contained in reports. Additionally, several of the more powerful and popular custom visuals are described including the Power KPI by Microsoft and the Impact Bubble Chart.</p>
<p class="calibre7">In this chapter, we will review the following topics:</p>
<ul class="calibre12">
<li class="calibre13">Drillthrough report pages</li>
<li class="calibre13">Bookmarks</li>
<li class="calibre13">Custom report navigation</li>
<li class="calibre13">The Analytics Pane</li>
<li class="calibre13"><span><span>Quick Insights</span></span></li>
<li class="calibre13">Trend and prediction lines</li>
<li class="calibre13">Custom visuals</li>
<li class="calibre13">ArcGIS Map visual for Power BI</li>
<li class="calibre13">Waterfall chart</li>
<li class="calibre13">Microsoft Power KPI visual</li>
<li class="calibre13">Animation and storytelling visuals</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-240">
<div id="calibre_link-855" class="calibre2">
<div id="calibre_link-856" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Drillthrough report pages</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Drillthrough report pages enable report authors to anticipate the needs of users to view the details associated with a particular item such as a product or customer. Since it's unknown which specific item the user will need to analyze during a self-service session in Power BI, generic drillthrough report pages can be designed that highlight the most relevant dimensions and metrics such as the product list price or the first purchase date of the customer. Drillthrough report pages update to reflect the filter context of the user's selection (for example, <kbd class="calibre15">Product ABC</kbd>) on a separate report page. </p>
<div class="packt_infobox">Drillthrough was one of the most requested features in 2017 and its availability closes a gap with other Microsoft BI products. In paginated <strong class="calibre6">SQL Server Reporting Services</strong> (<strong class="calibre6">SSRS</strong>) reports, drillthrough actions can be defined in a source report to open a target report based on the parameters of the source report. The <span>Drillthrough filters</span> defined in Power BI report pages serve the same purpose as the parameters defined in the target reports of SSRS drillthrough actions. </div>
<p class="calibre7">In the following example, a report page has been designed with a drillthrough filter set to the <kbd class="calibre15">Product Name</kbd> column: </p>
<div class="cdpalignleft"><img src="images/000359.png" class="calibre210" /></div>
<div class="mce-root2">Drillthrough report page </div>
<p class="calibre7">The drillthrough report page provides a mix of high-level sales and margin metrics as well as seven product dimension columns in the <kbd class="calibre15">Product Details</kbd> table at the bottom. With the drillthrough report page configured, when the <kbd class="calibre15">Product Name</kbd> column is exposed on a separate page within the report, the user will have a right-click option to drill to this page as per the following image:</p>
<div class="cdpalignleft"><img src="images/000369.png" class="calibre211" /></div>
<div class="mce-root2">Drillthrough source page</div>
<div class="packt_infobox">Only the column or columns specified as <span>Drillthrough filters</span> can be used as drill columns. For example, even if the product's Alternate key column has a 1-to-1 relationship with the <kbd class="calibre43">Product Name</kbd> column, the drillthrough option will not be available to visuals based on the product alternate key column unless it's also been specified as a drillthrough filter like the <kbd class="calibre43">Product Name</kbd> column. Therefore, if some report visuals use <kbd class="calibre43">Product Name</kbd> and others use the product alternate key, both columns can be configured as <span>Drillthrough filters</span> on the drillthrough report page to support both scenarios.    </div>
<p class="calibre7">In the preceding example, the user has drilled down through the four levels of the product hierarchy created in <a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em> (<kbd class="calibre15">Product Category Group</kbd>, <kbd class="calibre15">Product Category</kbd>, <kbd class="calibre15">Product Subcategory</kbd>, <kbd class="calibre15">Product Name</kbd>) to display a bar chart by the <kbd class="calibre15">Product Name</kbd> column. The same right-click drillthrough option is exposed via table, matrix, and other chart visuals including the scatter chart and the stacked column and bar charts. </p>
<p class="calibre7"><span>The <kbd class="calibre15">Bottom level</kbd> column of a hierarchy such as the preceding <kbd class="calibre15">Product Name</kbd> example is often a good candidate to support with a drillthrough report page. For example, a common analysis pattern is to apply a few slicer selections and then to drill down through the hierarchy levels built into chart and matrix visuals. Each level of the hierarchy provides supporting context for its parent value, but ultimately the report user will want to investigate a specific value (for example, <kbd class="calibre15">Customer 123</kbd>) or a specific combination of values (<kbd class="calibre15">Customer 123</kbd> and <kbd class="calibre15">Calendar Year 2018</kbd>).</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-241">
<div id="calibre_link-857" class="calibre2">
<div id="calibre_link-858" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Custom labels and the back button</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Two of the most important components of the drillthrough report page include the <kbd class="calibre15">Custom Product Name</kbd> and back button image at the top of the report page. The <kbd class="calibre15">Product Name</kbd> message at the top of the page uses the following DAX Measure expression:</p>
<pre class="calibre19">Selected Product Name = <br class="calibre3" />VAR ProdName = SELECTEDVALUE('Product'[Product Name], "Multiple Product Names")<br class="calibre3" />RETURN "Product Name: " &amp; ProdName</pre>
<p class="calibre7">The <kbd class="calibre15">SELECTEDVALUE()</kbd> function returns either the single value currently selected for a given column or an alternative expression if multiple values have been selected. For drillthrough report pages, it's a given that the <kbd class="calibre15">drill</kbd> column will only have a single value as each <kbd class="calibre15">drillthrough</kbd> column is limited to a single value. To provide a dynamic label or title to the page, the DAX variable containing the <kbd class="calibre15">Product Name</kbd> expressions is concatenated with a text string. In this example, the <kbd class="calibre15">Selected Product Name</kbd> measure is displayed in a similar card visual. </p>
<p class="calibre7">The custom back button image was added to the report via the insert image command on the <span>Home</span> tab of the Report view. Once positioned in the top left of the page, selecting the image exposes the format image formatting cards. As per the following image, the <span>Link</span> formatting card is enabled and the <span>Type</span> is set to <span>Back</span>: </p>
<div class="cdpalignleft"><img src="images/000388.png" class="calibre212" /></div>
<div class="mce-root2">Back button image</div>
<p class="calibre7">The Power BI Desktop adds a back button arrow shape by default when a drillthrough page is created, but this shape is less intuitive for users than the custom image. With the back button configured, <em class="calibre16">Ctrl</em> + click is used to return to the source page in Power BI Desktop. Only a single click is needed to use the back button in the Power BI service.  </p>
<div class="packt_infobox">The single row <kbd class="calibre43">Product Details</kbd> table at the bottom of the drillthrough report page has been filtered to only display the current, active values of the product. As described in the <em class="calibre16">Slowly changing dimensions</em> section of <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>, the <kbd class="calibre43">Products</kbd> table contains multiple rows per product, representing different points in time. To ensure that only one row is displayed by the table visual, a visual level filter was applied, setting the <kbd class="calibre43">Product Status</kbd> column equal to <kbd class="calibre43">Current</kbd>. Alternatively, the visual level filter condition could specify that the <kbd class="calibre43">Product End Date</kbd> column is blank via the advanced filter condition type.  </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-242">
<div id="calibre_link-859" class="calibre2">
<div id="calibre_link-860" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Multi-column drillthrough</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In many scenarios, a more specific filter context is needed for drillthrough report pages to resolve analyses. For example, the user may be interested in one specific year for a given <kbd class="calibre15">Product Subcategory</kbd>. To support these needs, multiple columns can be added as drillthrough page filters. When one or both columns are exposed in a report visual on a separate page, the drillthrough right-click option can be used to apply multiple filter selections to the drillthrough page.</p>
<p class="calibre7">In the following stacked column chart of <kbd class="calibre15">Internet Sales</kbd> by year and <kbd class="calibre15">Product Subcategory</kbd>, right-clicking on the <kbd class="calibre15">Road Bikes</kbd> column for <kbd class="calibre15">2015</kbd> (<kbd class="calibre15">$4.2M</kbd>) exposes the <span>Drillthrough</span> option to the <span>Subcategory-Year Details</span> drillthrough report page: </p>
<div class="cdpalignleft"><img src="images/000398.png" class="calibre213" /></div>
<div class="mce-root2">Drillthrough by multiple columns</div>
<p class="calibre7"><span>The <span>Subcategory-Year Details</span> report page contains <span>Drillthrough filters</span> for both the <kbd class="calibre15">Calendar Year</kbd> and the <kbd class="calibre15">Product Subcategory</kbd> columns. Report visuals which only expose one of these two columns can still drill to this multi-column drillthrough report page. In this scenario, no filter would be applied to the column not contained in the source visual.  </span></p>
<p class="calibre7">Executing the drillthrough action from the preceding chart results in the drillthrough report page filtered for both column values:</p>
<div class="cdpalignleft"><img src="images/000408.png" class="calibre214" /></div>
<div class="mce-root2">Multi-column drillthrough report page</div>
<p class="calibre7">The drillthrough report page (<span>Subcategory-Year Details</span>) in this scenario would be designed to display the values of the two drillthrough columns and provide supporting analysis for this given filter context. In the following example, the <kbd class="calibre15">$4.2M</kbd> of <kbd class="calibre15">Internet Net Sales</kbd> from the source page is identified in a card visual and also visualized by the calendar months of 2015 in a stacked column chart to break out the product models for the <kbd class="calibre15">Road Bikes</kbd> subcategory: </p>
<div class="cdpalignleft"><img src="images/000418.png" class="calibre215" /></div>
<div class="mce-root2">Multi-column drillthrough report page</div>
<p class="calibre7">In the preceding drillthrough report example, the user obtains details on both <kbd class="calibre15">Internet Net Sales</kbd> and <kbd class="calibre15">Reseller Net Sales</kbd> for the given year and <kbd class="calibre15">Product</kbd> category. Visuals which utilize measures from any fact table (for example, <kbd class="calibre15">Sales Plan</kbd>) with a cross-filtering relationship to the drillthrough column tables can be added to the drillthrough report page to provide additional context.  </p>
<p class="calibre7">In addition to stacked column charts, matrix visuals are also a common choice for initiating a drillthrough action based on two columns. For example, the <kbd class="calibre15">Calendar Year</kbd> column could be the columns input and the <kbd class="calibre15">Product Subcategory</kbd> could be the rows input. Additionally, a pie chart with the two columns used in the legend and detailed input fields can also be used to drillthrough based on two columns. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-243">
<div id="calibre_link-861" class="calibre2">
<div id="calibre_link-862" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Bookmarks</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Bookmarks enable report authors to save specific states of reports for easy access and sharing with others. For example, an important or common view of a report page which involves filter conditions across several columns can be saved as a bookmark for easy access at a later time. By persisting the exact state of a report page, including any cross-highlighting, drilling, and sorting, each bookmark can serve as a distinct report page, thus amplifying the scope and usability of Power BI reports.  </p>
<p class="calibre7">By default, bookmarks represent the entire state of a report page, including all filter selections and the properties of the visuals (for example, hidden or not). However, bookmarks can also optionally be associated with only a few visuals on a report page. Additionally, report authors can choose to avoid persisting any filter or slicer selections and rather only save visual properties on the page. These granular controls, along with the Selections pane and linking support from images and shapes, enable report authors to create rich and compelling user experiences.</p>
<p class="calibre7">In the following example, 12 Bookmarks have been created for a European sales report:</p>
<div class="cdpalignleft"><img src="images/000000.png" class="calibre216" /></div>
<div class="mce-root2">Bookmarks Pane</div>
<p class="calibre7">Bookmarks are created via the <span>Add</span> icon at the top of the <span>Bookmarks</span> <span>Pane</span>. With the <span>Bookmarks</span> <span>Pane</span> visible via the <span>View</span> tab in Report view, a report author can develop a report page with the filters and visual layout required and then click the <span>Add</span> icon to save these settings as a bookmark. As per the preceding image, the ellipsis at the right of the bookmark's name can be used to update Bookmarks to reflect the current state and to rename and delete visuals. Additionally, the second and third groups of bookmark options allow report authors to customize what is stored by the bookmark.</p>
<div class="packt_infobox">The <span>Data</span> category includes report, page, and visual level filters, slicer selections, the drill location if a visual has been drilled into, any cross-highlighting of other visuals, and any sort orders applied to visuals. The <span>Display</span> category includes whether a visual is hidden or not, the Spotlight property, focus mode, and the Show Data view. By disabling the <span>Data</span> category for a bookmark, a user's selections on slicers or other visuals will not be overridden when the bookmark is accessed.   </div>
<p class="calibre7">In the preceding report, three Bookmarks have been applied for each of four report pages&mdash;<kbd class="calibre15">Europe</kbd>, <kbd class="calibre15">United Kingdom</kbd>, <kbd class="calibre15">Germany</kbd>, and <kbd class="calibre15">France</kbd>. For example, selecting the <span>France: Bikes Only</span> bookmark from the <span>Bookmarks</span> <span>Pane</span> displays the France report page filtered for both France and Bikes, as per the following image:</p>
<div class="cdpalignleft"><img src="images/000009.png" class="calibre217" /></div>
<div class="mce-root2">Bookmarks and Filters Pane</div>
<p class="calibre7">Switching to the <span>France: Excluding Bikes</span> book simply changes the filter condition on the <kbd class="calibre15">Product Category Group</kbd> column to <kbd class="calibre15">Non-Bikes</kbd> and selecting the <span>France: Summary</span> bookmark removes the <kbd class="calibre15">Product Category Group</kbd> filter. By using <span>Page level filters</span> within Bookmarks, a single report page (France) can more easily be re-used to address additional business questions. Additionally, Bookmarks and off-canvas filters avoid the need for users to interact with slicer visuals and also eliminates the canvas space that slicer visuals would otherwise consume. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-244">
<div id="calibre_link-863" class="calibre2">
<div id="calibre_link-864" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Selection pane and the Spotlight property</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The <span>Selection Pane</span> and the Spotlight property for visuals are both closely related features to Bookmarks. For example, with the <span>Selection Pane</span> exposed via the <span>View</span> tab of the Report view, certain textboxes on a report page can be hidden while a specific text box associated with a bookmark is left visible.</p>
<p class="calibre7">In the following example, three textboxes have been created for the Europe report page, but only one of the three textboxes is visible for each of the three Europe Bookmarks:</p>
<div class="cdpalignleft"><img src="images/000020.png" class="calibre218" /></div>
<div class="mce-root2">Selection Pane and Bookmarks Pane</div>
<div class="packt_infobox">The <span>Selection Pane</span> can be accessed via the <span>View</span> tab in Report view and displays all objects of the selected report page including visuals, images, and shapes. Although most commonly used with Bookmarks, the <span>Selection Pane</span> is also helpful when developing report pages that contain many visuals and objects. Selecting an object from the <span>Selection Pane</span> provides access to the properties associated with that object (for example, field inputs, formatting cards) as though the object was selected on the report canvas.     </div>
<p class="calibre7">The icons next to the objects can be toggled between visible (eye symbol) and hidden (dash symbol). In the preceding example, only the text box containing the title <kbd class="calibre15">Europe Sales and Margin: Summary</kbd> is visible for the <span>Europe: Summary</span> bookmark. The other two textboxes on the Europe report page contain a title corresponding to the other two Europe Bookmarks (<span>Europe: Bikes Only</span>, <span>Europe: Excluding Bikes</span>). Like the <span>Europe: Summary</span> bookmark, only the text box containing the title associated with the given bookmark is visible for these two other Bookmarks.  </p>
<p class="calibre7">The Spotlight property, accessed via the ellipsis in the top-right corner of each visual, draws attention to the specific visual by making all other visuals on the report page fade into the background.</p>
<div class="packt_tip pcalibre7 pcalibre6">Spotlight is particularly useful in supporting presentations via Bookmarks. For example, in the View mode described later in this section, one bookmark could display a report page of visuals normally and the following bookmark could highlight a single visual to call out a specific finding or an important trend or result. Spotlight may also be helpful for presenters to explain more complex visuals with multiple metrics and/or dimension columns.   <br class="calibre3" />
<br class="calibre3" />
As an alternative to Spotlight, Focus mode can also be saved as a bookmark. Focus mode can be applied via the diagonal arrow icon in the top right corner of chart visuals and fills the entire report canvas with the single visual. </div>
<p class="calibre7">In the following example, the Spotlight property has been enabled for a scatter chart on the Europe report page:</p>
<div class="cdpalignleft"><img src="images/000028.png" class="calibre219" /></div>
<div class="mce-root2">Report page with Spotlight enabled on the scatter chart</div>
<p class="calibre7">In the preceding report page, four other visuals (three cards and a bar chart) are still visible, but the scatter chart is emphasized via the Spotlight property. With Spotlight enabled, the report author could add a bookmark with an intuitive name (for example, <kbd class="calibre15">Europe Summary: Customer Segment and Country Scatter</kbd>) to save this specific view. Referencing this bookmark in a meeting or presentation makes it easier to explain the meaning and insights of the scatter chart. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-245">
<div id="calibre_link-865" class="calibre2">
<div id="calibre_link-866" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Custom report navigation</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Bookmarks can also be assigned as links to shapes and images. With multiple Bookmarks created across multiple report pages, a visual table of contents can be created to aid the user's navigation of a report. Rather than opening and browsing the <span>Bookmarks Pane</span>, users can simply click images or shapes associated with specific Bookmarks, and a back button can be used to return to the table of contents page.  </p>
<p class="calibre7">In the following example, nine images have been positioned within a rectangle shape and linked to Bookmarks in the report:</p>
<div class="cdpalignleft"><img src="images/000037.png" class="calibre220" /></div>
<div class="mce-root2">Custom navigation to Bookmarks</div>
<div class="packt_infobox">The rectangle shape and three line shapes are used to form the matrix of icons. Shapes and images can be added from the insert group of icons on the <span>Home</span> tab of Report view. With a shape or image selected, the <span>Format</span> tab appears, allowing the author to align and distribute the objects as well as move certain objects forward or backward on the canvas. Grouping similar objects within shapes is a common practice to improve usability.  </div>
<p class="calibre7">With an image or a shape selected, a <span>Link</span> formatting card can be enabled to choose between a <span>Bookmark</span> link and a <span>Back</span> link. In the following example, the France flag image positioned in the top right of the table of contents is linked to the <span>France: Excluding Bikes</span> bookmark: </p>
<div class="cdpalignleft"><img src="images/000046.png" class="calibre221" /></div>
<div class="mce-root2">Link formatting card for images and shapes</div>
<p class="calibre7">In this report, the back button image introduced in the <em class="calibre16">Drillthrough report pages</em> section earlier in this chapter is also inserted in each page of the report. Rather than return to the source page of a drillthrough action, a <span>Back</span> type link is set to allow users to return to the table of contents.</p>
<p class="calibre7">In the following image, a custom back button image has been inserted and set as a <span>Back</span> type link to aid navigation:</p>
<div class="cdpalignleft"><img src="images/000057.png" class="calibre222" /></div>
<div class="mce-root2">Back link for an image</div>
<p class="calibre7">The combination of custom navigation and Bookmarks representing many specific views or reports contributes to an easier, more productive experience for users. When designed properly, the user often doesn't need to know which page or bookmark to navigate to or which filters to apply as this logic is already built into the report. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-246">
<div id="calibre_link-867" class="calibre2">
<div id="calibre_link-868" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">View mode</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The <span>View</span> icon in the <span>Bookmarks Pane</span> can be used in both Power BI Desktop and in the Power BI service to navigate between visuals similar to a slideshow. When <span>View</span> mode is enabled, the following navigation bar appears at the bottom of the screen and the user can close other panes and/or launch full screen mode in the Power BI service to further support the presentation:</p>
<div class="cdpalignleft"><img src="images/000067.png" class="calibre223" /></div>
<div class="mce-root2">View mode navigation</div>
<p class="calibre7">As per the preceding image, the number and order of Bookmarks, bookmark names, and navigation arrows are included in the <span>View</span> mode navigation. Bookmarks are ordered based on their position in the <span>Bookmarks Pane</span> from the top to the bottom. To revise the order, Bookmarks can be dragged and dropped to higher or lower positions in the <span>Bookmarks</span> <span>Pane</span>. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-247">
<div id="calibre_link-869" class="calibre2">
<div id="calibre_link-870" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">ArcGIS Map visual for Power BI</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The ArcGIS Map visual for Power BI enables report authors to develop map visualizations far beyond the capabilities of the bubble and filled map visuals described in <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>. Created by Esri, a market leader in <strong class="calibre6">Geographic Information Systems</strong> (<strong class="calibre6">GIS</strong>), the ArcGIS Map supports all standard map types (for example, bubble and heatmap), but also provides many additional features including a clustering map theme for grouping individual geographic points and the ability to filter a map by the points within a geographical area. The ArcGIS Map also enables deep control over the logic of the size and color formatting, such as the number of distinct sizes (classes) to display and the algorithm used to associate locations to these classes. Additionally, reference layers and cards of demographic and economic information can be embedded into visuals to provide greater context.</p>
<p class="calibre7"><span>The ArcGIS Map visual is included in the standard visualizations pane and enabled by default in Power BI Desktop. However, as noted in <a href="#calibre_link-11" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 10</a>, </span><em class="calibre16">Deploying the Power BI Report Server</em><em class="calibre16">,<span> </span></em><span>the ArcGIS Map visual is not currently supported for the Power BI Report Server and thus is not available in the Power Desktop application optimized for the Power BI Report Server. Additionally, an option is available in the <span>Tenant settings</span> page of the Power BI admin portal to enable or disable the use of the ArcGIS Maps visual. Details on utilizing the Power BI admin portal to configure tenant settings and other options are included in <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization</em><em class="calibre16">. </em> </span></p>
<p class="calibre7">In the following example, customer addresses in the state of Washington have been plotted as diamonds of different sizes and colors based on the <kbd class="calibre15">Internet Sales</kbd> measure and the <kbd class="calibre15">Customer History Segment</kbd> column, respectively:  </p>
<div class="cdpalignleft"><img src="images/000078.png" class="calibre224" /></div>
<div class="mce-root2">ArcGIS Map visual for Power BI</div>
<div class="packt_tip pcalibre7 pcalibre6">For the most visually engaging ArcGIS Map, use the <span>Dark Gray Canvas</span> basemap and bright, saturated colors for the data points plotted. The <span>Light Gray Canvas</span> basemap, however, avoids the risk of overwhelming the user with colors, as described in the previous chapter. The <span>Streets</span> and <span>OpenStreetMap</span> basemap types are practical choices whenever transportation between the data points or pinned locations is expected. In the preceding example, the <span>Streets</span> basemap supports the sales team that may drive from the pinned office location on 11th street in Bremerton, Washington to the plotted customer addresses.   </div>
<p class="calibre7">The visual has been zoomed into the Bremerton, Washington area near several large customers and a fictional sales office location denoted by a red pin icon on 11th street near downtown Bremerton. Pin locations are often used in conjunction with the <span>Drive Time</span> feature to plot an area relative to specific locations such as the group of customers who are within a 20-minute drive of an office. </p>
<p class="calibre7">To configure these options and all other layout and formatting settings, click the ellipsis in the top right corner and select <span>Edit</span>. The following image displays the edit mode of an ArcGIS visual with the <span>Pins</span> menu selected: </p>
<div class="cdpalignleft"><img src="images/000089.png" class="calibre225" /></div>
<div class="mce-root2">ArcGIS Map for Power BI toolbar options</div>
<p class="calibre7">For this visual, the <span>Streets</span> basemap type has been selected and the <span>Map theme</span> is set to <span>Size &amp; Color</span>. The reference layer <span>USA Median Age</span> is used to distinguish areas based on age (via color intensity). Finally, two infographic cards have been selected&mdash;population and age by gender&mdash;to display these specific metrics as the user selects and hovers over the map.     </p>
<div class="packt_infobox">A column named <kbd class="calibre43">Customer Full Address</kbd> has been applied to the <span>Location</span> input field. This column includes the street address, city, state, and postal code such as the following example: 1097 Kulani Lane, Kirkland, WA, 98033.<br class="calibre3" />
<br class="calibre3" />
The <span>Data Category</span> for this column has been set to <span>Address</span> in Power BI Desktop to further improve the accuracy of the geocoding process in which the location input value (the address) is converted to a latitude and longitude. Latitude and longitude fields are available as well, and these inputs are recommended over street addresses for greater performance and scale. A max of 1,500 street addresses can be geocoded without a plus subscription and up to 5,000 addresses can be geocoded with a monthly plus subscription. </div>
<p class="calibre7">The <kbd class="calibre15">Customer History Segment</kbd> column, described in <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data</em> <em class="calibre16">with M</em>, evaluates to one of four values based on the relationship between the <kbd class="calibre15">Current Date</kbd> and the <kbd class="calibre15">Customer First Purchase</kbd> date column. In this example, first year, second year, and third year customers are assigned the colors purple, green, and blue, respectively. Legacy customers have been formatted as orange. <span>The size and color formatting can be customized via the <span>Symbol Style</span> menu, and these options alone make it relatively easy for users to gain insights from the visual such as identifying the location of first year customers. </span></p>
<p class="calibre7">To provide greater analytical flexibility and to support presentations, the <kbd class="calibre15">Date</kbd> column from the <kbd class="calibre15">Date dimension</kbd> table has been applied to the <kbd class="calibre15">Time</kbd> input field, thus creating the timeline scrollbar. Similar to the play axis of the scatter chart described later in this chapter, the timeline for the ArcGIS Map supports both animation via the play and pause buttons and slider controls to define a specific time frame. </p>
<div class="packt_tip pcalibre7 pcalibre6">The left and right end points of the timeline can be used in combination with the animated playback. For example, a time frame of three months can be defined at the beginning of the timeline, and each frame of the animation will represent a distinct three month time frame. At each frame, the user can optionally pause the animation to call attention to specific points on the visual. These intervals can be set for 3, 6, 9, and 12 months.</div>
<p class="calibre7">The timeline and two measures are further supplemented with two date intelligence measures in the <span>Tooltips</span> field input. In the following example, the user has hovered over the address location of a <kbd class="calibre15">First Year Customer</kbd> (a purple diamond) and the two date intelligence measures (year-to-date and prior year-to-date), as well as the <kbd class="calibre15">Date</kbd> column from the timeline, which leads to them being exposed: </p>
<div class="cdpalignleft"><img src="images/000099.png" class="calibre226" /></div>
<div class="mce-root2">ArcGIS visual with Tooltips</div>
<div class="packt_tip pcalibre7 pcalibre6">To avoid the limit of addresses geocoded (1,500, or 5,000 with a Plus subscription), and to focus the visual on more meaningful data points, a visual level filter can be applied to a measure. In this example, a visual level filter has been applied to the <kbd class="calibre43">Internet Net Sales</kbd> measure to only include data points (customer addresses) with over $100. By removing the small customers, this filter reduced the count of addresses from 1,799 to 921 and retained over 97 percent of the <kbd class="calibre43">Internet Sales</kbd>. </div>
<p class="calibre7">Selections of ArcGIS Map locations also impact other visuals on the report page. For example, the selection of one address location on the map could cause a bar chart visual to filter or highlight the specific product subcategories associated with that location. Additionally, rather than selecting one location at a time, areas of locations can be selected via the <span>Select Multiple Locations</span> option and the areas of a reference layer can also be used to select locations. The multi-select options under the cursor icon and the cross-filtering of other related Power BI visuals provide powerful self-service geospatial analysis capabilities. </p>
<div class="packt_infobox"><span>The <span>Use ArcGIS Maps for Power BI</span> option should be checked in the Global <span>Security</span> options of Power BI Desktop. An equivalent option is exposed in the Power BI service via the <span>Settings</span> menu (Gear icon | <span>Settings</span> | <span>ArcGIS Maps for Power BI</span>), and this should be checked as well to render ArcGIS Maps in the online service.<br class="calibre3" />
<br class="calibre3" />
Additionally, a <span>Use ArcGIS Maps for Power BI</span> setting is available in the <span>Tenant settings</span> page of the Power BI admin portal. Power BI service administrators can optionally disable this feature to prevent all users from using <span>ArcGIS Maps for Power BI</span>. The configuration of <span>Tenant settings</span> in the Power BI admin portal is described in <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization.</em> The<em class="calibre16"> </em>ArcGIS Map visual is the only standard Power BI visual not currently supported by the Power BI Report Server. </span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-248">
<div id="calibre_link-871" class="calibre2">
<div id="calibre_link-872" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">ArcGIS Maps Plus subscriptions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The ArcGIS Map visual is free, and Power BI reports using the ArcGIS Map visual can be published for users to view in the Power BI service and on mobile devices at no extra cost. However, in many scenarios, the limit of 1,500 geocoding addresses may prove insufficient. Additionally, the four basemaps available (<span>Light Gray Canvas</span>, <span>Dark Gray Canvas</span>, <span>Streets</span>, and <span>OpenStreetMap</span>) may not provide the desired details, such as satellite imagery. </p>
<p class="calibre7">With an ArcGIS Plus subscription, currently priced at $5 per user, per month, up to 5,000 addresses can be geocoded and plotted on a map. In the following image, the Plus icon appears above the zoom buttons of an ArcGIS Map visual: </p>
<div class="cdpalignleft"><img src="images/000110.png" class="calibre227" /></div>
<div class="mce-root2">ArcGIS Plus subscription icon</div>
<p class="calibre7">Plus subscriptions also enable eight additional basemaps, several of which including satellite imagery and access to many additional reference layers and infographics. The following site maintained by Esri provides further details on Plus subscriptions: <a href="http://arcg.is/2jG5DnG" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://arcg.is/2jG5DnG</a>. </p>
<div class="packt_infobox">It's necessary for both report authors and users or consumers of the Power BI reports containing the ArcGIS Map visual to have Plus subscriptions. When an ArcGIS Maps visual contains premium content (via a Plus subscription), that content is only visible to other subscribed Plus users. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-249">
<div id="calibre_link-873" class="calibre2">
<div id="calibre_link-874" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Waterfall chart breakdown</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The waterfall chart is one of the most powerful standard visuals in Power BI given its ability to compute and format the variances of individual items between two periods by default. The items representing the largest variances are displayed as columns of varying length, sorted and formatted with either an increase (green) or decrease (red) color. This built-in logic and conditional formatting makes waterfall charts both easy to create and intuitive for users.</p>
<p class="calibre7">In the following example, the <kbd class="calibre15">Internet Sales</kbd> of the last two completed months is broken down by <kbd class="calibre15">Sales Territory Country</kbd>: </p>
<div class="cdpalignleft"><img src="images/000121.png" class="calibre228" /></div>
<div class="mce-root2">Waterfall chart with breakdown</div>
<div class="packt_infobox">The waterfall chart naturally walks the user from the starting point category on the left (<strong class="calibre6">2017-Oct</strong>) to the ending point category on the right (<span>2017-Nov</span>). As per the preceding image, hovering the cursor over a bar results in the details for this item being displayed as a tooltip. In this example, hovering over the (<span>$15K</span>) red bar for the <span>United States</span> displays the <kbd class="calibre43">Internet Sales</kbd> for both months, the variance, and the variance as a percentage. These four tooltip values are provided by default and report authors can optionally add measures to the <span>Tooltips</span> field to deliver even greater context.</div>
<p class="calibre7">The <kbd class="calibre15">Internet Net Sales</kbd> measure is applied to the <em class="calibre16">y</em> axis input field, and the <kbd class="calibre15">Calendar Yr-Mo</kbd> and <kbd class="calibre15">Sales Territory Country</kbd> columns are applied to the <kbd class="calibre15">Category</kbd> and <kbd class="calibre15">Breakdown</kbd> input fields, respectively. For this visual, the Max breakdowns property available under the Breakdown formatting card is set to <span>4</span> and thus only four countries are displayed. The other breakdown item, formatted in yellow by default, is used to summarize the variances for all items not displayed as a breakdown column. In the preceding example, the relatively smaller variances from Australia and Germany are automatically rolled into the other item.</p>
<div class="packt_tip pcalibre7 pcalibre6">As with other visuals, a <span>Show Data</span> and an <span>Export data</span> option is available in both Power BI Desktop and when viewing the visual in the Power BI service. These options are exposed under the ellipsis (three dots) in the top right corner of each visual. As one example, the user could select <span>Show Data</span> for the waterfall chart to view the sales data for all the countries (including Germany and Australia) in a table format. Report authors can adjust the Max breakdowns property to display greater detail and reduce the size of the other breakdown. However, waterfall charts with fewer breakdown columns are easier for users to interpret. </div>
<p class="calibre7">As per the following image, a filter is applied to the <kbd class="calibre15">Calendar Month Status</kbd> column to only include the <kbd class="calibre15">Prior Calendar Month</kbd> and the <kbd class="calibre15">2 Mo Prior Calendar Month</kbd> values: </p>
<div class="cdpalignleft"><img src="images/000131.png" class="calibre229" /></div>
<div class="mce-root2">Filter impacting the waterfall chart</div>
<p class="calibre7">This filter results in only two month values being available to the visual and ensures that the visual will update over time. For example, in March of 2018, the visual will automatically update to compare January of 2018 versus February of 2018. This filter can be applied at the report level, page level, or visual level scope, depending on the scenario. </p>
<div class="packt_infobox">Details on building date dimension columns such as <kbd class="calibre43">Calendar Month Status</kbd> into a Power BI dataset are included in the <em class="calibre16">Date dimension view</em> section of <a href="#calibre_link-22" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3"><em class="calibre16">Connecting to Sources and Transforming Data with M</em></a><em class="calibre16">. </em>Additionally, filter scopes and the filter conditions available to each scope was reviewed in the <em class="calibre16">Report filter scopes</em> section in <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-250">
<div id="calibre_link-875" class="calibre2">
<div id="calibre_link-876" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Analytics pane</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In addition to the Field and Formatting panes used to create report visuals, an Analytics pane is also available for cartesian visuals such as Line and clustered column charts. This pane allows report authors to add constant and dynamic reference lines such as average, max, and min to visuals to provide greater context and analytical value. Additionally, trend and forecast lines can be added to display the results of advanced analytical techniques such as exponential smoothing to support predictive analytics.</p>
<p class="calibre7">A simple but important use case of the Analytics pane, exemplified in the <em class="calibre16">Trend lines</em> section below, is to add a constant line that represents a goal or threshold to compare a measure against. Dynamic reference lines representing an aggregation (for example, a median) behave just like DAX measures and thus, in some scenarios, avoid the need to create new DAX measures into the source dataset.</p>
<div class="packt_infobox">The reference lines available in the Analytics pane depend on the type of visual. For example, reference lines are currently not supported for any custom visuals and only a constant line can be applied to the stacked column and bar charts. Additionally, the trend line is exclusive to the Line and clustered column chart, while the forecast line is exclusive to the line chart. Moreover, a date or a numeric column is required in the axis to utilize the trend and forecast lines. </div>
<p class="calibre7">New features and capabilities are planned for the Analytics pane, including an expanded list of visuals supported. Similar to the <span>Tooltips feature described in the previous chapter, <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, </span><em class="calibre16">Creating and Formatting Power BI Reports</em><em class="calibre16">,</em> Power BI report authors should be conscious of the Analytics pane and its ability to enhance report visuals with additional context and insights. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-251">
<div id="calibre_link-877" class="calibre2">
<div id="calibre_link-878" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Trend Line</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A <span>Trend Line</span> is available in the Analytics pane for the clustered column chart and the line chart. The <span>Trend Line</span> is particularly valuable when a chart contains many data points and significant variation exists among the points, making it difficult to observe the trend of the metric visually. </p>
<p class="calibre7">In the following example, a trend line and two additional reference lines (average and constant) have been added to a clustered column chart to provide greater insight and context:</p>
<div class="cdpalignleft"><img src="images/000141.png" class="calibre230" /></div>
<div class="mce-root2">Trend, constant, and average reference lines </div>
<div class="packt_infobox">The <span>Label Density</span> property of the <span>Data labels</span> formatting card has been set to 100 percent. Additionally, the position property of the data labels has been set to an inside end with a white color and text size of 11. Clear visibility of the data labels for each column, in addition to the two reference lines (Average and Goal), avoids the need to display the <span>Y-AXIS</span> and gridlines.</div>
<p class="calibre7">Excluding the three reference lines from the Analytics pane, the clustered column chart simply plots the <kbd class="calibre15">Internet Sales Customer Count</kbd> measure against the <kbd class="calibre15">Calendar Month Ending Date</kbd> column. The <kbd class="calibre15">Calendar Month Ending Date</kbd> column (for example, <kbd class="calibre15">11/30/2017</kbd>) is required for the axis input in this scenario as both the trend line and the forecast line require either a date or a number data type for the axis. For example, if the <kbd class="calibre15">Calendar Yr-Mo</kbd> column was used for the axis (for example, <kbd class="calibre15">2017-Oct</kbd>), both the trend line and the forecast line cards would not appear in the Analytics pane.</p>
<div class="packt_infobox"><span>The DAX expression used for this measure is included in the <em class="calibre16">Dimension metrics</em> section of <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em>. </span>To ensure that the current month's data does not impact on the trend line, the <kbd class="calibre43">Calendar Month Status</kbd> column was used as a page level filter. The filter condition applied (<span>Is Not Current Calendar Month</span>) excludes the latest month from the visual and any other visuals on the report page. Additional information on the <kbd class="calibre43">Calendar Year</kbd> and <kbd class="calibre43">Month Status</kbd> columns is included in <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>.</div>
<p class="calibre7">With the essential column chart built, the three reference lines can be added from the Analytics pane per the following image:</p>
<div class="cdpalignleft"><img src="images/000151.png" class="calibre231" /></div>
<div class="mce-root2">Analytics pane</div>
<p class="calibre7">As per the preceding image, the <span>Style</span> of the <span>Trend Line</span> is set to <span>Dashed</span> with a transparency of <span>0</span> percent. This formatting ensures that the trend reference line can be easily distinguished from other data on the chart such as the other two reference lines. The <span>Combine Series</span> property is not relevant to this visual as there is only one series (<kbd class="calibre15">Internet Sales Customer Count</kbd>), and <span>Use Highlight Values</span> is the default setting for calculating the <span>Trend Line</span>.</p>
<p class="calibre7">The numeric symbols (<span>1</span>) next to the <span>Constant Line</span> and <span>Average Line</span> cards denote that a reference line of each type has also been applied to the visual. For these reference lines, a <span>Dotted line</span> style has been used, and custom names have been configured (for example, <span>Goal</span>, <span>Average</span>) to be displayed via <span>Data labels</span>. These two additional lines make it easy for users to identify the columns which are above or below the average value for the visual (89) and the constant goal value of 120.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-252">
<div id="calibre_link-879" class="calibre2">
<div id="calibre_link-880" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Forecast line</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The <span>Forecast</span> line, exclusive to standard line chart visuals, utilizes predictive forecasting algorithms to generate both specific forecast data points as well as upper and lower boundaries. The report author has control over the number of data points to forecast, the confidence interval of the forecast (for example, 80 percent, 95 percent), and can apply formatting to distinguish the forecast from the actual data points. Additionally, the forecasting feature allows authors to optionally exclude a number from the last data points. This <span>Ignore last</span> property is useful for excluding incomplete periods as well as evaluating the accuracy of the forecast relative to recently completed periods.</p>
<p class="calibre7">In the following example, the clustered column chart from the <em class="calibre16">Trend Lines</em> section has been switched to a Line chart and a <span>Forecast</span> line for the next two months has been added:</p>
<div class="cdpalignleft"><img src="images/000161.png" class="calibre232" /></div>
<div class="mce-root2"><strong class="calibre6">Forecast line</strong></div>
<div class="packt_infobox">By hovering over the first forecast point, December of 2017, the <span>Forecasted Customer Count</span> value of <span>139</span> is displayed along with the upper (<span>167</span>) and lower (<span>112</span>) boundaries. The user can easily distinguish the last actual data point, 131 for November of 2017, from the forecast via the <span>Dotted</span> style of the <span>Forecast</span> line and the dark fill of the <span>Confidence band style</span>. The <span>Trend</span>, <span>Average</span>, and <span>Goal</span> reference lines applied in the previous section provide further context to the <span>Forecast</span>.</div>
<p class="calibre7">Like the <em class="calibre16">Trend Lines</em> section example, the <kbd class="calibre15">Calendar Month Ending Date</kbd> column is used as the axis, and the <kbd class="calibre15">Current Month</kbd> (2017-Dec) has been excluded with a page level filter condition on the <kbd class="calibre15">Calendar Month Status</kbd> column. This filter condition avoids the need to utilize the <span>Ignore last</span> property of the forecast analytics card. The <span>Label Density</span> property has been reduced to 72 percent to reduce clutter given in the additional reference line.</p>
<p class="calibre7">As per the following image, the <span>Forecast length</span>, <span>Confidence interval</span>, and a custom name (<kbd class="calibre15">Forecasted Customer Count</kbd>) have been applied to the <span>Forecast</span> line:</p>
<div class="cdpalignleft"><img src="images/000171.png" class="calibre233" /></div>
<div class="mce-root2">Forecast properties in the Analytics pane</div>
<p class="calibre7">The <span>Seasonality</span> property is optional, but since the data reflects calendar months, a value of <span>12</span> overrides the automatically detected season value. Likewise, for quarterly data, a value of 4 could be applied.</p>
<p class="calibre7">The <span>Confidence interval</span> property defines the distance between the upper and lower boundaries from the forecasted data points. For example, the minimum confidence interval of 75 percent would produce a more narrow range, and the maximum confidence interval of 99 percent would widen the boundaries of the first forecast point to an upper limit of 194 and a lower limit of 84.</p>
<div class="packt_tip pcalibre7 pcalibre6">The <span>Ignore last</span> property can be used to evaluate how accurately the forecast would've predicted recent data points. In this example, an <span>Ignore last</span> value of <span>2</span> would result in forecast values for October and November of 2017&mdash;the last two completed months. The forecast algorithm would use all available data points through September of 2017 to generate the two forecast points. <br class="calibre3" />
<br class="calibre3" />
If the actual data points for these two months fall outside the confidence interval (upper and lower bounds) of the forecast, the forecast may not be valid for the given data, or the <span>Confidence Interval</span> may be too narrow. <span>This testing technique is referred to as <strong class="calibre6">hindcasting</strong>. </span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-253">
<div id="calibre_link-881" class="calibre2">
<div id="calibre_link-882" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Quick Insights </h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>Quick Insights</span> is one of the most analytically advanced features in Power BI as it enables sophisticated machine learning algorithms to be executed against datasets or specific subsets of those datasets. The results of these computations automatically generate highly formatted Power BI visuals which can be integrated into reports as though they were created from scratch. <span>Quick Insights</span> is only generally available in the Power BI service for import mode datasets and dashboard tiles reflecting those datasets. However, the essential capabilities of <span>Quick Insights</span> are also now available in preview for Power BI Desktop.</p>
<p class="calibre7">In <span>the following image, <span>Quick Insights</span> has been executed against the <kbd class="calibre15">AdWorks Enterprise</kbd> dataset in the Power BI service: </span></p>
<div class="cdpalignleft"><img src="images/000181.png" class="calibre234" /></div>
<div class="mce-root2">Quick Insights for a dataset in the Power BI Service</div>
<p class="calibre7"><span>To execute <span>Quick Insights</span> against an entire dataset, see the <span>Get quick insights</span> option under the Actions ellipsis menu in the Power BI service. Once the insights have been generated, a <span>View insights</span> menu option replaces the <span>Get quick insights</span> option. The visuals generated from the insights, such as the clustered bar chart on the left, advise of the algorithm used (for example, outlier, cluster, and correlation). Most importantly, the visuals can be pinned to dashboards and are displayed without the supporting text like normal dashboard tiles. In Power BI Desktop, <span>Quick Insights</span> are currently limited to specific data points represented by report visuals.</span></p>
<div class="packt_infobox"><span>Quick Insights</span> cannot be executed against datasets which contain row-level security roles as described in <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Designing DAX Measures and Security Roles</em><em class="calibre16">.</em> Additionally<em class="calibre16">, </em><span>Quick Insights</span> cannot be executed against DirectQuery datasets, Live connection datasets to Analysis Services models, and realtime streaming datasets. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-254">
<div id="calibre_link-883" class="calibre2">
<div id="calibre_link-884" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Explain the increase/decrease</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>Quick Insight</span> features are enabled in Power BI Desktop by default, allowing users to right-click data points in visuals and execute the relevant analysis. In the following example, the user has right-clicked the data point for <span>2017-Apr</span>, and as a result, an option to explain the decrease is exposed in the <span>Analyze</span> menu: </p>
<div class="cdpalignleft"><img src="images/000191.png" class="calibre235" /></div>
<div class="mce-root2">Explaining the decrease in Power BI Desktop</div>
<p class="calibre7">Clicking <span>Explain the decrease</span> executes machine learning algorithms against the dataset and populates a window with visuals representing the insights retrieved. The user can scroll vertically to view the different insights obtained such as the <kbd class="calibre15">Customer Gender</kbd> column accounting for a majority of the decrease, or <kbd class="calibre15">Product Name XYZ</kbd>, which had the largest decrease among all products.</p>
<p class="calibre7">By default, a waterfall visual is used to display each insight, but other visuals such as the scatter chart and the 100 percent stacked column chart are available too. In the following example, the user has scrolled to an insight based on the <kbd class="calibre15">Customer History Segment</kbd> column and views the data as a waterfall chart:</p>
<div class="cdpalignleft"><img src="images/000201.png" class="calibre236" /></div>
<div class="mce-root2">Explain the decrease in Power BI Desktop</div>
<p class="calibre7">Clicking the plus sign at the top right corner of the text box explaining the insight adds the visual to the report page. Adding the visual to the report page automatically populates the associated field wells and visual level filters as though the visual was created manually. If necessary, the report author can apply further formatting to align the visual with the design and layout of the page. </p>
<div class="packt_infobox">Currently, <span>Quick Insights</span> in Power BI Desktop is limited to the local dataset and is exclusive to import mode datasets. For example, the <span>Explain the decrease</span> option will not appear when connecting to a published Power BI dataset or a SSAS database via Live connection. Given the importance of isolating reports from a central dataset as described in the previous chapter, <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em> this limitation represents a significant obstacle to utilize this feature in corporate deployments.<br class="calibre3" />
<br class="calibre3" />
Additionally, there are several limitations on the kinds of measures and filters supported. For example, measures which use the <kbd class="calibre43">DISTINCTCOUNT()</kbd> and <kbd class="calibre43">SUMX()</kbd> functions are not supported, and measures containing conditional logic (for example, <kbd class="calibre43">IF()</kbd>) cannot be either.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-255">
<div id="calibre_link-885" class="calibre2">
<div id="calibre_link-886" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Custom visuals</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In addition to the standard visuals included in the <span>Visualizations</span> pane of Power BI Desktop, a vast array of custom visuals can be added to reports to deliver extended functionality or to address specific use cases. These visuals, many of which have been created by Microsoft, are developed with the common framework used by the standard visuals and are approved by Microsoft prior to inclusion in Microsoft AppSource. Given the common framework, custom visuals can be integrated into Power BI reports with standard visuals and will exhibit the same standard behaviors such as filtering via slicers and report and page filters.</p>
<p class="calibre7">This section highlights four powerful custom visuals and the distinct scenarios and features they support. Power BI report authors and BI teams are well-served to remain conscience of both the advantages and limitations of custom visuals. For example, when several measures or dimension columns need to be displayed within the same visual, custom visuals such as the Impact Bubble Chart and the Dot Plot by Maq Software may exclusively address this need. In many other scenarios, a trade-off or compromise must be made between the incremental features provided by a custom visual and the rich controls built into a standard Power BI visual. </p>
<p class="calibre7"><span>Custom visuals available in AppSource and within the integrated custom visuals store for Power BI Desktop are all approved for running in browsers and on mobile devices via the Power BI mobile apps. A subset of these visuals have been certified by Microsoft and support additional Power BI features such as email subscriptions and export to PowerPoint. Additionally, certified custom visuals have met a set of code requirements and have passed strict security tests. The list of certified custom visuals and additional details on the certification process is available at the following link: <a href="http://bit.ly/2AFAC9W" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2AFAC9W</a>.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-256">
<div id="calibre_link-887" class="calibre2">
<div id="calibre_link-888" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Adding a custom visual</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Custom visuals can be added to Power BI reports by either downloading <kbd class="calibre15">.pbiviz</kbd> files from Microsoft <span>AppSource</span> or via the integrated Office Store of custom visuals in Power BI Desktop. Utilizing <span>AppSource</span> requires the additional step of downloading the file; however, it can be more difficult to find the appropriate visual as the visuals are not categorized. However, <span>AppSource</span> provides a link to download a sample Power BI report (<kbd class="calibre15">.pbix</kbd> file) to learn how the visual is used, such as how it uses field inputs and formatting options. Additionally, <span>AppSource</span> includes a short video tutorial on building report visualizations with the custom visual.</p>
<p class="calibre7">The following image reflects Microsoft <span>AppSource</span> filtered by the <span>Power BI visuals</span> <span>Add-ins</span> category: </p>
<div class="cdpalignleft"><img src="images/000212.png" class="calibre237" /></div>
<div class="mce-root2">Power BI custom visuals in AppSource</div>
<div class="packt_infobox">The following link filters <span>AppSource</span> to the Power BI custom visuals per the preceding image: <a href="http://bit.ly/2BIZZbZ" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2BIZZbZ</a>.<br class="calibre3" />
The search bar at the top and the vertical scrollbar on the right can be used to browse and identify custom visuals to download. Each custom visual tile in <span>AppSource</span> includes a <span>Get it now</span> link which, if clicked, presents the option to download either the custom visual itself (<kbd class="calibre43">.pbiviz</kbd> file) or the sample report for the custom visual (<kbd class="calibre43">.pbix</kbd> file). Clicking anywhere else in the tile other than <span>Get it now</span> prompts a window with a detailed overview of the visual, a video tutorial, and customer reviews. </div>
<p class="calibre7">To add custom visuals directly to Power BI reports, click the <span>Import from store</span> option via the ellipsis of the Visulaizations pane, as per the following image:</p>
<div class="cdpalignleft"><img src="images/000222.png" class="calibre238" /></div>
<div class="mce-root2">Importing custom visuals from the store</div>
<div class="packt_infobox">If a custom visual (<kbd class="calibre43">.pbiviz</kbd> file) has been downloaded from <span>AppSource</span>, the <span>Import from file</span> option can be used to import this custom visual to the report. Additionally, both the <span>Import from store</span> and <span>Import from file</span> options are available as icons on the <span>Home</span> tab of the Report view in Power BI Desktop. </div>
<p class="calibre7">Selecting <span>Import from store</span> launches an MS Office Store window of <span>Power BI</span> <span>Custom Visuals</span>. Unlike <span>AppSource</span>, the visuals are assigned to categories such as <span>KPIs</span>, <span>Maps</span>, and <span>Advanced Analytics</span>, making it easy to browse and compare related visuals. More importantly, utilizing the integrated <span>Custom Visuals</span> store avoids the need to manage <kbd class="calibre15">.pbiviz</kbd> files and allows report authors to remain focused on report development.</p>
<p class="calibre7">As an alternative to the <span>VISUALIZATIONS</span> pane, the <span>From Marketplace</span> and <span>From File</span> icons on the <span>Home</span> tab of the Report view can also be used to add a custom visual. Clicking the <span>From Marketplace</span> icon in the follow image launches the same MS Office Store window of <span>Power BI</span> <span>Custom visuals</span> as selecting <span>Import from store</span> via the <span>VISUALIZATIONS</span> pane:</p>
<div class="cdpalignleft"><img src="images/000232.png" class="calibre239" /></div>
<div class="mce-root2"><strong class="calibre6">From Marketplace ribbon icon</strong></div>
<p class="calibre7">In the following image, the <span>KPIs</span> category of <span>Custom visuals</span> is selected from within the MS Office store:</p>
<div class="cdpalignleft"><img src="images/000242.png" width="769" height="461" class="calibre240" /> </div>
<div class="mce-root2">Custom visuals via the Office Store in the Power BI Desktop</div>
<p class="calibre7"><span>The <span>Add</span> button will directly add the custom visual as a new icon in</span> the Visualizations pan<span>e. Selecting the custom visual icon will provide a description of the custom visual and any customer reviews. The Power BI team regularly features new custom visuals in the blog post and video associated with the monthly update to Power BI Desktop. The visual categories, customer reviews, and supporting documentation and sample reports all assist report authors in choosing the appropriate visual and using it correctly.</span></p>
<p class="calibre7">Organizations can also upload custom visuals to the Power BI service via the organization visuals page of the Power BI Admin portal. Once uploaded, these visuals are exposed to report authors in the <span>MY ORGANIZATION</span> tab of the custom visuals <span>MARKETPLACE</span> as per the following example:</p>
<div class="cdpalignleft"><img src="images/000253.png" class="calibre241" /></div>
<div class="mce-root2">My Organization custom visuals</div>
<p class="calibre7">This feature can help both organizations and report authors simplify their use of custom visuals by defining and exposing a particular set of approved custom visuals. For example, a policy could define that new Power BI reports must only utilize standard and organizational custom visuals. The list of organizational custom visuals could potentially only include a subset of the visuals which have been certified by Microsoft. Alternatively, an approval process could be implemented so that the use case for a custom visual would have to be proven or validated prior to adding this visual to the list of organizational custom visuals. Additional details on managing organizational custom visuals are included in <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization. </em></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-257">
<div id="calibre_link-889" class="calibre2">
<div id="calibre_link-890" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power KPI visual</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><strong class="calibre6">Key Performance Indicators</strong> (<strong class="calibre6">KPIs</strong>) are often prominently featured in Power BI dashboards and in the top left area of Power BI report pages, given their ability to quickly convey important insights. Unlike card and gauge visuals which only display a single metric or a single metric relative to a target respectively, KPI visuals support trend, variance, and conditional formatting logic. For example, without analyzing any other visuals, a user could be drawn to a red KPI indicator symbol and immediately understand the significance of a variance to a target value as well as the recent performance of the KPI metric. For some users, particularly executives and senior managers, a few KPI visuals may represent their only exposure to an overall Power BI solution, and this experience will largely define their impression of Power BI's capabilities and the Power BI project.</p>
<p class="calibre7">Given their power and important use cases, report authors should become familiar with both the standard KPI visual and the most robust custom KPI visuals such as the Power KPI Matrix, the Dual KPI, and the Power KPI. Each of these three visuals have been developed by Microsoft and provide additional options for displaying more data and customizing the formatting and layout.</p>
<div class="packt_infobox">The <span>Power KPI Matrix</span> supports scorecard layouts in which many metrics can be displayed as rows or columns against a set of dimension categories such as Operational and Financial. The <span>Dual KPI</span>, which was featured in the <em class="calibre16">Microsoft Power BI Cookbook</em> (<a href="https://www.packtpub.com/big-data-and-business-intelligence/microsoft-power-bi-cookbook" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://www.packtpub.com/big-data-and-business-intelligence/microsoft-power-bi-cookbook</a>), is a good choice for displaying two closely related metrics such as the volume of customer service calls and the average waiting time for customer service calls.<br class="calibre3" />
<br class="calibre3" />
One significant limitation of custom KPI visuals is that data alerts cannot be configured on the dashboard tiles reflecting these visuals in the Power BI service. Data alerts are currently exclusive to the standard card, gauge, and KPI visuals.</div>
<p class="calibre7">In the following Power KPI visual, <kbd class="calibre15">Internet Net Sales</kbd> is compared to <kbd class="calibre15">Plan</kbd>, and the prior year <kbd class="calibre15">Internet Net Sales</kbd> and <span>Year-over-Year Growth percent</span> metrics are included to support the context: </p>
<div class="cdpalignleft"><img src="images/000263.png" class="calibre242" /></div>
<div class="mce-root2">Power KPI custom visual</div>
<div class="packt_infobox">The <kbd class="calibre43">Internet Net Sales</kbd> measure is formatted as a solid, green line whereas the <kbd class="calibre43">Internet Sales Plan</kbd> and <kbd class="calibre43">Internet Net Sales (PY)</kbd> measures are formatted with <span>Dotted</span> and <span>Dot-dashed</span> line styles respectively. To avoid clutter, the <span>Y-Axis</span> has been removed and the <span>Label Density</span> property of the <span>Data labels</span> formatting card has been set to 50 percent. This level of detail (three measures with variances) and formatting makes the Power KPI one of the richest visuals in Power BI. </div>
<p class="calibre7">The Power KPI provides many options for report authors to include additional data and to customize the formatting logic and layout. Perhaps its best feature, however, is the Auto Scale property, which is enabled by default under the Layout formatting card. Similar to the responsive visuals feature described in the <em class="calibre16">Mobile optimized reports</em> section of the previous chapter, <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>, Auto Scale causes the visual to make intelligent decisions about which elements to display given the available space.</p>
<p class="calibre7">For example, in the following image, the Power KPI visual has been pinned to a Power BI dashboard and resized to the smallest tile size possible: </p>
<div class="cdpalignleft"><img src="images/000273.png" class="calibre243" /></div>
<div class="mce-root2">Minimal Power BI dashboard tile</div>
<p class="mce-root3">As per the preceding dashboard tile, the less critical data elements such as July through August and the year-over- year % metric were removed. This auto scaling preserved space for the KPI symbol, the axis value (<span>2017-Nov</span>), and the actual value (<span>$296K</span>). With Auto Scale, a large Power KPI custom visual can be used to provide granular details in a report and then re-used in a more compact format as a tile in a Power BI dashboard.</p>
<p class="calibre7">Another advantage of the Power KPI is that minimal customization of the data model is required. The following image displays the dimension column and measures of the data model mapped to the field inputs of the aforementioned Power KPI visual:</p>
<div class="cdpalignleft"><img src="images/000283.png" class="calibre244" /></div>
<div class="mce-root2">Power KPI field inputs</div>
<p class="calibre7">As described in previous chapters, the <kbd class="calibre15">Sales and Margin Plan</kbd> data is available at the monthly grain and thus the <kbd class="calibre15">Calendar Yr-Mo</kbd> column is used as the <span>Axis</span> input. In other scenarios, a <kbd class="calibre15">Date</kbd> column would be used for the <span>Axis</span> input provided that the actual and target measures both support this grain.</p>
<p class="calibre7">The order of the measures used in the <span>Values</span> field input is interpreted by the visual as the actual value, the target value, and the secondary value.</p>
<p class="calibre7">In this example, <kbd class="calibre15">Internet Net Sales</kbd> is the first or top measure in the <span>Values</span> field and thus is used as the actual value (for example, <span>$296K</span> for November). A secondary value as the third measure in the <span>Values</span> input (<kbd class="calibre15">Internet Net Sales (PY)</kbd>) is not required if the intent is to only display the actual value versus its target. </p>
<p class="calibre7">The <span>KPI Indicator Value</span> and <span>Second KPI Indicator Value</span> fields are also optional. If left blank, the Power KPI visual will automatically calculate these two values as the percentage difference between the actual value and the target value, and the actual value and the secondary value respectively. In this example, these two calculations are already included as measures in the data model and thus applying the <kbd class="calibre15">Internet Net Sales Var to Plan %</kbd> and <kbd class="calibre15">Internet Net Sales (YOY %)</kbd> measures to these fields further clarifies how the visual is being used.</p>
<div class="packt_infobox">If the metric being used as the actual value is truly a critical measure (for example, revenue or count of customers) to the organization or the primary user, it's almost certainly appropriate that related target and variance measures are built into the Power BI dataset. In many cases, these additional measures will be used independently in their own visuals and reports. Additionally, if a target value is not readily available, such as the preceding example with the <kbd class="calibre43">Internet Net Sales Plan</kbd>, BI teams can work with stakeholders on the proper logic to apply to a target measure, for example, 10 percent greater than the previous year.</div>
<p class="calibre7">The only customization required is the <span>KPI Indicator Index</span> field. The result of the expression used for this field must correspond to one of five whole numbers (1-5) and thus one of the five available KPI Indicators. In the following example, the KPI Indicators <span>KPI 1</span> and <span>KPI 2</span> have been customized to display a green caret up icon and a red caret down icon respectively:</p>
<div class="cdpalignleft"><img src="images/000293.png" class="calibre245" /></div>
<div class="mce-root2">KPI Indicator formatting card</div>
<p class="calibre7">Many different <span>KPI Indicator</span> symbols are available including up and down arrows, flags, stars, and exclamation marks. These different symbols can be formatted and then displayed dynamically based on the <span>KPI Indicator Index</span> field expression. In this example, a KPI index measure was created to return the value 1 or 2 based on the positive or negative value of the <kbd class="calibre15">Internet Net Sales Var to Plan %</kbd> measure respectively:</p>
<pre class="calibre19"><strong class="calibre6">Internet Net Sales vs Plan Index</strong> = IF([Internet Net Sales Var to Plan %] &gt; 0,1,2)</pre>
<p class="calibre7">Given the positive <span>4.6 percent</span> variance for November of 2017, the value <span>1</span> is returned by the index expression and the green caret up symbol for <span>KPI 1</span> is displayed. With five available KPI Indicators and their associated symbols, it's possible to embed much more elaborate logic such as five index conditions (for example, poor, below average, average, above average, good) and five corresponding KPI indicators.</p>
<div class="packt_infobox">Four different layouts (<span>Top</span>, <span>Left</span>, <span>Bottom</span>, and <span>Right</span>) are available to display the values relative to the line chart. In the preceding example, the <span>Top</span> layout is chosen as this results in the last value of the <span>Axis</span> input (<span>2017-Nov</span>) to be displayed in the top left corner of the visual. Like the standard line chart visual in Power BI Desktop, the line style (for example, <span>Dotted</span>, <span>Solid</span>, <span>Dashed</span>), color, and thickness can all be customized to help distinguish the different series. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-258">
<div id="calibre_link-891" class="calibre2">
<div id="calibre_link-892" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Chiclet Slicer</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As per the previous chapter, the standard slicer visual can display the items of a source column as a list or as a dropdown. Additionally, if presented as a list, the slicer can optionally be displayed horizontally rather than vertically. The custom Chiclet Slicer, developed by Microsoft, allows report authors to take even greater control over the format of slicers to further improve the self-service experience in Power BI reports.</p>
<p class="calibre7">In the following example, a Chiclet Slicer has been formatted to display calendar months horizontally as three columns:</p>
<div class="cdpalignleft"><img src="images/000303.png" class="calibre246" /></div>
<div class="mce-root2">Chiclet Slicer</div>
<p class="calibre7">Additionally, a dark green color is defined as the <span>Selected Color</span> property under the Chiclets formatting card to clearly identify the current selections (<span>May</span> and <span>June</span>). The <span>Padding</span> and <span>Outline Style</span> properties, also available under the Chiclets card, are set to <span>1</span> and <span>Square</span> respectively, to obtain a simple and compact layout. </p>
<p class="calibre7"><span>Like the slicer controls in Microsoft Excel, Chiclet Slicers also support cross highlighting. To enable cross highlighting, specify a measure which references a fact table as the <span>Values</span> input field to the Chiclet Slicer. For example, with the <kbd class="calibre15">Internet Net Sales</kbd> measure set as the <span>Values</span> input of the Chiclet Slicer, a user selection on a bar representing a product in a separate visual would update the Chiclet Slicer to indicate the calendar months without <kbd class="calibre15">Internet Sales</kbd> for the given product. The <span>Disabled Color</span> property can be set to control the formatting of these unrelated items.</span></p>
<p class="calibre7">Chiclet Slicers also support images. In the following example, one row is used to display four countries via their national flags:</p>
<div class="cdpalignleft"><img src="images/000313.png" class="calibre247" /></div>
<div class="mce-root2">Chiclet Slicer with images</div>
<p class="calibre7">For this visual, the <span>Padding</span> and <span>Outline Style</span> properties under the Chiclets formatting card are set to <span>2</span> and <span>Cut</span> respectively. Like the <span>Calendar Month</span> slicer, a dark green color is configured as the <span>Selected Color</span> property helping to identify the country or countries selected&mdash;<span>Canada</span>, in this example.</p>
<p class="calibre7"><span>The Chiclet Slicer contains three input field wells&mdash;<span>Category</span>, <span>Values</span>, and <span>Image</span>. All three input field wells must have a value to display the images. The <span>Category</span> input contains the names of the items to be displayed within the Chiclets. The <span>Image</span> input takes a column with URL links corresponding to images for the given category values. In this example, the <kbd class="calibre15">Sales Territory Country</kbd> column is used as the <span>Category</span> input and the <kbd class="calibre15">Internet Net Sales</kbd> measure is used as the <span>Values</span> input to support cross highlighting. The <kbd class="calibre15">Sales Territory URL</kbd> column, which is set as an <span>Image URL</span> data category, is used as the <span>Image</span> input. For example, the following <kbd class="calibre15">Sales Territory URL</kbd> value is associated with the United States: <a href="http://www.crwflags.com/fotw/images/u/us.gif" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://www.crwflags.com/fotw/images/u/us.gif</a>.</span></p>
<div class="packt_infobox">A standard slicer visual can also display images when the data category of the field used is set as <span>Image URL</span>. However, the standard slicer is limited to only one input field and thus cannot also display a text column associated with the image. Additionally, the standard slicer lacks the richer cross-highlighting and formatting controls of the Chiclet Slicer.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-259">
<div id="calibre_link-893" class="calibre2">
<div id="calibre_link-894" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Impact Bubble Chart</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">One of the limitations with standard Power BI visuals is the number of distinct measures that can be represented graphically. For example, the standard scatter chart visual is limited to three primary measures (<span>X-AXIS</span>, <span>Y-AXIS</span>, and <span>SIZE</span>), and a fourth measure can be used for color saturation. The Impact Bubble Chart custom visual, released in August of 2017, supports five measures by including a left and right bar input for each bubble. </p>
<p class="calibre7">In the following visual, the left and right bars of the Impact Bubble Chart are used to visually indicate the distribution of <kbd class="calibre15">AdWorks Net Sales</kbd> between <kbd class="calibre15">Online</kbd> and <kbd class="calibre15">Reseller Sales</kbd> channels:</p>
<div class="cdpalignleft"><img src="images/000323.png" class="calibre248" /></div>
<div class="mce-root2">High Impact Bubble Chart</div>
<div class="packt_infobox"><span>The Impact Bubble Chart supports five input field wells: <span>X-AXIS</span>, <span>Y-AXIS</span>, <span>SIZE</span>, <span>LEFT BAR</span>, and <span>RIGHT BAR</span>. In this example, the following five measures are used for each of these fields respectively: <kbd class="calibre43">AdWorks Net Sales</kbd>, <kbd class="calibre43">AdWorks Net Margin %</kbd>, <kbd class="calibre43">AdWorks Net Sales (YTD)</kbd>, <kbd class="calibre43">Internet Net Sales</kbd>, and <kbd class="calibre43">Reseller Net Sales</kbd>. </span></div>
<p class="calibre7">The length of the left bar indicates that Australia's sales are almost exclusively derived from online sales. Likewise, the length of the right bar illustrates that Canada's sales are almost wholly obtained via <kbd class="calibre15">Reseller Sales</kbd>. These graphical insights per item would not be possible for the standard Power BI scatter chart. Specifically, the <kbd class="calibre15">Internet Net Sales</kbd> and <kbd class="calibre15">Reseller Net Sales</kbd> measures could only be added as Tooltips, thus requiring the user to hover over each individual bubble.</p>
<p class="calibre7">In its current release, the Impact Bubble Chart does not support the formatting of data labels, a legend, or the axis titles. Therefore, a supporting text box can be created to advise the user of the additional measures represented. In the top right corner of this visual, a text box is set against the background to associate measures to the two bars and the size of the bubbles. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-260">
<div id="calibre_link-895" class="calibre2">
<div id="calibre_link-896" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dot Plot by Maq Software</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Just as the Impact Bubble Chart supports additional measures, the Dot Plot by Maq Software allows for the visualization of up to four distinct dimension columns. With three <span>Axis</span> fields and a <span>Legend</span> field, a measure can be plotted to a more granular level than any other standard or custom visual currently available to Power BI. Additionally, a rich set of formatting controls are available to customize the Dot Plot's appearance, such as orientation (horizontal or vertical), and whether the <span>Axis</span> categories should be split or stacked.</p>
<p class="calibre7">In the following visual, each bubble represents the internet sales for a specific grouping of the following dimension columns: <kbd class="calibre15">Sales Territory Country</kbd>, <kbd class="calibre15">Product Subcategory</kbd>, <kbd class="calibre15">Promotion Type</kbd>, and <kbd class="calibre15">Customer History Segment</kbd>: </p>
<div class="cdpalignleft"><img src="images/000333.png" class="calibre249" /></div>
<div class="mce-root2">Dot Plot by Maq Software</div>
<p class="calibre7">For example, one bubble represents the <kbd class="calibre15">Internet Sales</kbd> for the <kbd class="calibre15">Road Bikes</kbd> <kbd class="calibre15">Product Subcategory</kbd> within the United States <kbd class="calibre15">Sales Territory Country</kbd>, which is associated with the volume discount promotion type and the first year <kbd class="calibre15">Customer History Segment</kbd>. In this visual, the <kbd class="calibre15">Customer History Segment</kbd> column is used as the legend and thus the color of each bubble is automatically formatted to one of the three customer history segments.</p>
<div class="packt_infobox">In the preceding example, the <span>Orientation</span> property is set to <span>Horizontal</span> and the <span>Split labels</span> property under the <span>Axis</span> category formatting card is enabled. The <span>Split labels</span> formatting causes the <kbd class="calibre43">Sales Territory Country</kbd> column to be displayed on the opposite axis of the <kbd class="calibre43">Product Subcategory</kbd> column. Disabling this property results in the two columns being displayed as a hierarchy on the same axis with the child column (<kbd class="calibre43">Product Subcategory</kbd>) positioned inside the parent column (<kbd class="calibre43">Sales Territory Country</kbd>).</div>
<p class="calibre7"><span>Despite its power in visualizing many dimension columns and its extensive formatting features, data labels are currently not supported. Therefore, when the maximum of four dimension columns are used, such as in the previous example, it's necessary to hover over the individual bubbles to determine which specific grouping the bubble represents, such as in the following example:</span></p>
<div class="cdpalignleft"><span><img src="images/000343.png" width="547" height="153" class="calibre250" /> </span></div>
<div class="mce-root2">Four dimension columns per bubble of the Dot Plot visual</div>
<div class="packt_tip pcalibre7 pcalibre6">If only three dimension columns are used, which is still a detailed grain, then the lack of data labels is much less of a limitation. For example, the <kbd class="calibre43">Sales Territory Country</kbd> and <kbd class="calibre43">Product Subcategory</kbd> columns could be applied to the Axis category I and Axis category II field wells respectively, and the promotion type column could be added to the <span>Legend</span>. The two axis labels and the color of each bubble (per promotion type) would visually indicate the three-column grouping each bubble represents. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-261">
<div id="calibre_link-897" class="calibre2">
<div id="calibre_link-898" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Animation and data storytelling</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A top responsibility for many data professionals is the ability to convey their findings to others in a clear and compelling fashion. Common scenarios for data storytelling include recurring performance review meetings (for example, fiscal period close) and special project or ad hoc meetings with senior managers and executives. For these meetings, the data professional or team has already identified the insights to highlight, but must plan to properly communicate this message to the specific stakeholders or audience.</p>
<p class="calibre7">Power BI animation features, including bookmarks described earlier in this chapter, provide powerful support for data storytelling. In addition to the play axis available to the standard Scatter chart visual, many custom visuals support animation features such as the LineDot Chart and the Pulse Chart.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-262">
<div id="calibre_link-899" class="calibre2">
<div id="calibre_link-900" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Play axis for scatter charts</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The scatter chart is the only standard visual in Power BI Desktop which supports animation. By applying a time series column to the scatter chart's <span>Play Axis</span> field, animated playback and trace features are enabled. For example, a visual can be paused at a specific point along the time series, allowing the user to provide additional context. The user can also select one or multiple items which have been plotted (for example, product categories) to display data points representing the previous time periods. </p>
<p class="calibre7">In the following visual, the user has paused the animation on the month of September via the <span>Play Axis</span> and selected the icon associated with the <kbd class="calibre15">Touring Bikes</kbd> product subcategory:</p>
<div class="cdpalignleft"><img src="images/000353.png" class="calibre251" /></div>
<div class="mce-root2">Scatter chart with Play axis</div>
<p class="calibre7">With the <kbd class="calibre15">Touring Bikes</kbd> subcategory selected, a trace line appears connecting the latest data point for this subcategory to its preceding data points. In this example, the user can explain that <kbd class="calibre15">Touring Bikes</kbd> weren't introduced until May of 2017 (the first data point), but by September was almost equal to the <kbd class="calibre15">Road Bikes</kbd> subcategory for both <kbd class="calibre15">Online</kbd> and <kbd class="calibre15">Reseller Sales</kbd>. Additionally, the user can hover the cursor over the four preceding data points representing May through August to provide the details for these months.</p>
<div class="packt_infobox">Date, number, and text columns can be used in the <span>Play Axis</span> for the scatter chart. As per <a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models,</em> the <span>Sort By</span> column property can be used to define a logical sort order for text columns such as sorting a <kbd class="calibre43">Month name</kbd> column by a <kbd class="calibre43">Month number</kbd> column.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-263">
<div id="calibre_link-901" class="calibre2">
<div id="calibre_link-902" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Pulse Chart</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The Pulse Chart custom visual, developed by Microsoft, provides both animation and annotation features to support data storytelling. The Pulse Chart animates the value of a single measure over time and pauses at dates associated with events to display pop-up boxes of annotations describing these events. During this pause, which can also be applied manually via playback buttons, other Power BI visuals on the same report page are filtered by the event date. Additionally, a second measure can be visualized as a counter at the top of the chart via the <span>Runner Counter</span> field. </p>
<p class="calibre7">In the following example, a <strong class="calibre6">year-to-date</strong> (<strong class="calibre6">YTD</strong>) online sales measure and four events with annotations are plotted on a Pulse Chart:</p>
<div class="cdpalignleft"><img src="images/000363.png" class="calibre252" /></div>
<div class="mce-root2">Pulse Chart</div>
<div class="packt_infobox">The YTD sales measure is visualized via the animated line (and dots) in relation to the <em class="calibre16">Y</em> axis. For this example, a YTD customer count measure has also been applied to the <span>Runner Counter</span> field input. With the visual paused on the shipping promotion event of October 12, 2017, the Y axis indicates a sales value of approximately $<span>8.00 M</span>, and the <span>Runner Counter</span> displays a count of 8,344 customers. Alternatively, the same measure can be applied to both the <span>Values</span> and <span>Runner Counter</span> fields, thus providing the precise value at each pause in addition to the trend via the line. Examples of defining YTD and customer count measures are included in <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em>. </div>
<p class="calibre7">If event annotations are not needed, only the <span>Timestamp</span> and <span>Values</span> input fields are required to render the Pulse Chart. <kbd class="calibre15">Event Title</kbd>, <kbd class="calibre15">Event Description</kbd>, and <kbd class="calibre15">Event Size</kbd> input fields are available to display events and annotations as pop-up boxes. Additionally, the formatting pane provides several cards for defining the look and behavior of the Pulse Chart, including the size and color of the pop-up textboxes and the speed of the animation. For example, white text at size 14 can be formatted against a black fill background and the pause at each event can be set to four seconds.</p>
<p class="calibre7">To support the Pulse Chart in the preceding example, a separate table of events has been added to the dataset as per the following image:</p>
<div class="cdpalignleft"><img src="images/000373.png" class="calibre253" /></div>
<div class="mce-root2"><strong class="calibre6">Events table</strong></div>
<p class="calibre7">The <kbd class="calibre15">Event Date</kbd> column is used to define a one-to-many relationship from the <kbd class="calibre15">Events</kbd> table to the <kbd class="calibre15">Date dimension</kbd> table with single direction cross-filtering. The <kbd class="calibre15">Date</kbd> column from the <kbd class="calibre15">Date dimension</kbd> table is applied to the Pulse Chart's <span>Timestamp</span> input field, and the <kbd class="calibre15">Event Title</kbd> and <kbd class="calibre15">Event Description</kbd> columns from the events table are applied to their respective input fields. </p>
<div class="packt_infobox">The formatting options for the X and Y axes of the Pulse Chart are much less robust than the standard line chart. As one example, the <span>Y Axis</span> gridlines cannot be disabled. Gridlines are not visible in the preceding example purely because the axis color was set to match the background color. Additionally, the second and later lines of event descriptions in pop-up boxes are displayed without spaces. Report authors can adjust the width of pop-ups or reduce the length of event descriptions to account for this.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-264">
<div id="calibre_link-903" class="calibre2">
<div id="calibre_link-904" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">This chapter reviewed many advanced analytical and visualization features that are available to deliver powerful and compelling report content. This included the design of drillthrough report pages, the configuration of custom navigation controls via Bookmarks, and advanced analytics such as predictive forecasting with the Analytics pane. Additionally, the ArcGIS Map visual for Power BI and custom visuals was introduced as a means to support specific use cases and to extend solutions beyond the capabilities of Power BI's standard visuals. </p>
<p class="calibre7">The next chapter utilizes the report visualizations and design patterns described in this chapter and the previous chapter to create Power BI dashboards. This includes simple, single dashboard projects and more elaborate multi-dashboard architectures representing different levels of detail. Although some users may only view or interact with Power BI via dashboards, the quality and sustainability of this content, and particularly the ability to analyze the supporting details, is largely driven by the report design concepts and features from <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-265">
<div id="calibre_link-905" class="calibre2">
<div id="calibre_link-906" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Designing Power BI Dashboards and Architectures</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">This chapter leverages the dataset and report development features and concepts from prior chapters to plan and develop Power BI dashboards. Alternative dashboard architectures are described, including an organizational methodology that seeks to align business teams at various levels within an organization to a common set of corporate KPIs. The design and implementation of these dashboards, including layout, custom links, and mobile-optimized dashboards are described in this chapter. Additionally, other top features and capabilities of dashboards are reviewed, including live report pages and the integration of content from other report types, including <strong class="calibre6">SQL Server Reporting Services</strong> (<strong class="calibre6">SSRS</strong>) paginated reports and Microsoft Excel workbooks.</p>
<p class="calibre7">In<span> </span>this chapter, we will review the following topics:</p>
<ul class="calibre12">
<li class="calibre13">Dashboards versus reports</li>
<li class="calibre13">Dashboard design</li>
<li class="calibre13">Multi-dashboard architectures</li>
<li class="calibre13">Dashboard tiles</li>
<li class="calibre13">Custom links</li>
<li class="calibre13">Live report pages</li>
<li class="calibre13">Mobile-optimized dashboards</li>
<li class="calibre13">SQL Server Reporting Services integration</li>
<li class="calibre13">Excel Workbook integration</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-266">
<div id="calibre_link-907" class="calibre2">
<div id="calibre_link-908" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dashboards versus reports</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>Executives and high-level stakeholders require a holistic yet streamlined view of the top metrics, or <strong class="calibre6">Key Performance Indicators</strong> (<strong class="calibre6">KPIs</strong>), established by their organization. While Power BI reports deliver a rich, self-service analytical experience, optionally at a very detailed level, Power BI dashboards provide an integrated and simplified consumption layer. From a technical architecture standpoint, </span><span>Power BI dashboards are exclusive to the Power BI online service and are primarily composed of tiles representing visuals from one or many reports. Although each Power BI report is limited to a single source dataset, a dashboard's tiles can represent multiple datasets from highly disparate sources to help provide a 360 degree view on a single canvas.</span></p>
<p class="calibre7">To less experienced users and BI team members, the terms and capabilities associated with dashboards and reports can be misunderstood.</p>
<p class="calibre7">For example, the data-driven alert is exclusive to Power BI dashboards, while embedding in SharePoint online is specific to reports. More fundamentally, the user experience with slicer selections, bookmarks, and cross-highlighting available in reports and Power BI Desktop is not available in dashboards, exclusive of pinned live report pages.</p>
<p class="calibre7">Although several capabilities, such as email subscriptions and printing, are common to reports and dashboards, BI teams are well served to design dashboards and reports according to their distinct roles in Power BI. For example, a dashboard should not contain granular details or complex visuals, but rather the essential metrics describing the stakeholder's area of responsibility or influence. </p>
<p class="calibre7">The following table compares dashboards to reports across 19 capabilities:</p>
<table class="calibre254">
<tbody class="calibre22">
<tr class="calibre23">
<td class="calibre255">
<div class="cdpalignleft">Capability</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Dashboard</div>
</td>
<td class="calibre255">
<div class="cdpalignleft">Report</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Visualization pages</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">One page</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">One or multiple pages</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Authoring environment</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Power BI service</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Power BI Desktop and Power BI service</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Viewing environment</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Power BI service and Power BI mobile apps</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Power Desktop, Power BI service, and Power BI mobile apps</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Pinning</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can pin existing dashboard tiles to other dashboards in the current workspace</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can pin report visualizations as tiles in dashboards, and can also pin report pages as tiles in dashboards</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Email subscriptions</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can subscribe to a dashboard</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can subscribe to a report page or multiple report pages</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Filtering</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can only filter or interact with live report page tiles</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can filter, cross-highlight, and slice</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Data alerts</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can configure data-driven alerts for standard KPI, card, and gauge tiles</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Canât set alerts on report visuals</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Customization</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can alter <span>layout</span>, tile size, names, and links, and also the data and visualization types are <span>read-only</span></div>
<div class="cdpalignleft">.</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can control visual types, visualization data field inputs, and report formatting in <span>Edit</span> mode of the Power BI service and Power BI Desktop</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Natural language queries (Q and A)</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Available for dashboards based on import mode Power BI datasets and Live connections to SSAS Tabular Models.Not available for DirectQuery datasets</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Currently available as a preview in Power BI Desktop</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Visibility to data detail</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can export data for a dashboard tile</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can export both summarized and underlying data, a<span>lso </span>have <span>Show Data</span> option to view data of visual in a tabular format.</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Printing</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can print currently-selected dashboard</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can print current report page</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Featured and favorites</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">A dashboard can be set as featured and as a favorite. A user's default landing page in Power BI is a featured dashboard. </div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Reports can only be set as favorites</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Publish to web</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Not supported&mdash;exclusive to reports</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">All pages of a report can be published online for public access</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Embed in SharePoint</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Not supported&mdash;exclusive to reports</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">A report page can be embedded in a SharePoint online site page via the Power BI web part</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Mobile optimized</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can optimize dashboards for phones</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can optimize reports for phones</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Create visuals</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Limited to adding tiles containing text, image, video, web content, and streaming data</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Can create many report visuals using both standard and custom visuals</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Dataset sources</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">A dashboard can contain tiles pinned from Excel Workbooks, SSRS, and Power BI datasets</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">A Power BI report exclusively creates Power BI visuals</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Datasets</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">The tiles on a dashboard can reflect one or multiple datasets</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">A Power BI report is limited to a single source dataset, however, this dataset can represent the integration of multiple data sources</div>
</td>
</tr>
<tr class="calibre93">
<td class="calibre24">
<div class="cdpalignleft">Data caching</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Dashboard tiles store and represent cached query results, and the cache is updated on a schedule</div>
</td>
<td class="calibre24">
<div class="cdpalignleft">Power BI reports generate queries against their source dataset when opened and based on user interactions with the visuals</div>
</td>
</tr>
</tbody>
</table>
<p class="calibre7"> </p>
<p class="calibre7"><span>Per the preceding table, data-driven alerts are exclusive to Power BI dashboards in the Power BI service. Data alerts and their corresponding notifications are not available to Power BI reports, including reports published to the Power BI Report Server. The ability to embed custom alert rules and the deep integration of data alerts with the Power BI mobile apps is a top reason to leverage dashboards in the Power BI service. Data alerts and email subscriptions to reports and dashboards in the Power BI service is reviewed in <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>.</span></p>
<p class="calibre7">The subsequent sections of this chapter describe many core dashboard features and capabilities including dashboard tiles, mobile optimizations, and alternative sources, including Excel and SSRS.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-267">
<div id="calibre_link-909" class="calibre2">
<div id="calibre_link-910" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dashboard design</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>The design of dashboards and their relationship to both reports and other dashboards is critical to provide a consistent and robust package of information assets for an organization. Report authors and BI teams can use visual selection, layout, and supporting tiles to maximize the value and usability of dashboards.</span></p>
<p class="calibre7"><span>Report authors are best positioned to produce initial drafts of dashboards based on their knowledge of the most utilized or valued report visuals. </span><span>Ultimately, a well-designed dashboard delivers both at-a-glance visibility to the most important metrics for the consumer as well as accessibility to supporting and related details.</span></p>
<p class="calibre7"><span>Particularly for executives and senior management, the dashboard should support all essential business questions and metrics, thus not requiring any user clicks. If an executive or senior manager regularly has to access underlying reports, make filter selections on live pages, or utilize several dashboards to answer core questions, the architecture and scope of the Power BI app should be reconsidered.</span></p>
<p class="calibre7">The following dashboard leverages the Power KPI custom visual from Microsoft, described in <a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16">Applying Custom Visuals, Animation, and Analytics</em>, and custom images to organize the dashboard by <kbd class="calibre15">Sales Territory Group</kbd>:</p>
<div class="cdpalignleft"><img src="images/000382.png" class="calibre256" /></div>
<div class="mce-root2">Global sales dashboard</div>
<p class="calibre7">In this example, three KPIs are displayed at a global or corporate level and for each of the three sales territory groups. The Power KPI custom visual is chosen for these metrics as it presents greater detail and context than other related visuals, such as the standard KPI. For example, the <kbd class="calibre15">Total Net Sales vs. Plan</kbd> tile at the global level provides the actual value for the latest month ($2.5M for 2017-Nov) as well as the YOY growth for this month (2.3%) in addition to the ability to hover over points on the line to see individual values for particular months.</p>
<div class="packt_infobox">Distinct line styles are applied to each of the three lines displayed by the Power KPI visuals. Solid, dotted, and dot-dashed line styles are associated with the net sales, net sales plan, and net sales (PY) lines, respectively. The solid style of the net sales line, the actual KPI value, helps to highlight this line relative to the two other less important lines. The distinct line styles are particularly helpful when the tile is being viewed in focus mode or the visual is being viewed with greater space in a report.</div>
<p class="calibre7">The user, such as the vice president of global sales, can quickly monitor overall performance relative to plan via the KPI symbol icons in the top-right corner of the tiles (green caret up, red caret down). Additionally, two standard KPI visuals and a 100% stacked column chart have been added specific to the global level to deliver YTD sales and margin performance information and the recent mix of reseller and internet sales channels.</p>
<p class="calibre7"><span>To view the details of a dashboard tile, such as the individual monthly values of one of the smaller tiles, a user can open the tile in focus mode. Focus mode fills the entire screen with the single visual and thus makes it easy to perceive differences in the length and shape of columns and lines, respectively. Focus mode can be accessed by hovering over the top-right corner of a dashboard tile and then clicking the more options ellipsis (three dots) command. The following example exposes the more options available for the <kbd class="calibre15">Total Net Sales vs. Plan</kbd> dashboard tile:</span></p>
<div class="cdpalignleft"><span><img src="images/000392.png" width="1150" height="395" class="calibre257" /></span></div>
<div class="mce-root2">Dashboard tile options</div>
<div class="packt_infobox">The <span>Open in f</span><span>ocus mode</span>, <span>Export to Excel</span>, and <span>Manage alerts</span> options (if applicable for the visual) are also available when the dashboard is being viewed in the full screen mode. The other tile options (<span>Edit details</span>, <span>Pin tile</span>, <span>Delete tile</span>) are not available in full screen mode.<br class="calibre3" />
<br class="calibre3" />
The 12 Power KPI dashboard tiles, combined with focus mode, provide the user with a simple interface for a robust suite of information. For a user at the global level of the sales organization, this level of detail may be more than sufficient for most scenarios, precluding the need to access other dashboards or reports. </div>
<p class="calibre7">Most importantly, the same three KPIs (<kbd class="calibre15">Total Net Sales vs. Plan</kbd>, <kbd class="calibre15">Reseller Net Sales vs. Plan</kbd>, <kbd class="calibre15">Internet Net Sales vs. Plan</kbd>), are also featured in separate, dedicated dashboards for each sales territory group.</p>
<p class="calibre7">For example, the total net sales visual for North America indicating a miss to plan of -2.3% is also displayed in a <span>North America</span> sales dashboard. Simply clicking this tile on the <span>Global</span> sales dashboard opens the <span>North America</span> dashboard, providing several additional visuals specific to this <kbd class="calibre15">Sales Territory Group</kbd>. Additionally, the <span>North America</span> sales dashboard follows the same structure as the <span>Global</span> sales dashboard and thus contains sets of tiles dedicated to the United States and Canada.</p>
<p class="calibre7">If necessary, a third layer of dashboards could be created for each country within each sales territory group, thus enabling even greater dashboard navigation flexibility (for example, <span>Global</span> | <span>Europe</span> | <span>Germany</span>). With the same Power BI dataset being used for all reports and dashboards in the app workspace, the row-level security roles described in <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em>, can ensure users do not have access to KPIs outside the scope of their assigned role. Additional details and considerations for planning multiple dashboards and creating links between dashboards and reports are described later in this chapter.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-268">
<div id="calibre_link-911" class="calibre2">
<div id="calibre_link-912" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Visual selection</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Although any report visual can be pinned to a dashboard, only the visuals that either align with a corporate standard or that represent a critical insight or starting point should be represented on dashboards. Additionally, dense or relatively complex visuals, such as tables, matrices, and scatter charts should rarely be pinned to dashboards. Per the <span>Global</span> sales dashboard in the previous section, KPI visuals with built-in conditional formatting logic and supporting context are usually the best choices for dashboards. </p>
<p class="calibre7">For example, if a table or matrix is considered to be the most valuable visual within a report, a KPI or card visual could be created targeting, but summarizing, the same business question. The KPI or card visual would be more intuitive on the dashboard and single-click access to the underlying report with the detailed table or matrix could be retained. Additionally, the KPI or card visual would support a data-driven alert as well. </p>
<div class="packt_tip pcalibre7 pcalibre6"><span>The visual in the top-left corner of a report page, the user's logical starting point for understanding the report, is often a good candidate to be pinned to a dashboard. Every report should have at least one summary level visual (for example, card, KPI, gauge) aligned to the primary business question or purpose of the report.</span></div>
<p class="calibre7"><span>Additionally, given that dashboards are limited to a single page (one canvas), visuals that provide supporting context, such as the standard KPI and the Power KPI custom visuals, should generally be favored over simple cards and gauges. The additional details provided by these visuals may not be visible in small dashboard tiles but are very valuable if additional space is allocated to the tile and when tiles are accessed in focus mode. </span></p>
<p class="calibre7">In the following example, the <kbd class="calibre15">Total Net Sales vS. Plan</kbd> KPI dashboard tile at the Global level (top set of tiles) is accessed in focus mode:</p>
<div class="cdpalignleft"><img src="images/000402.png" class="calibre258" /></div>
<div class="mce-root2">Focus mode of dashboard tile &ndash; Power KPI custom visual</div>
<p class="calibre7">In the preceding scenario, the user accessed focus mode by hovering over the top-right corner of the visual, clicking the <span>More options</span> command that appears, and then selecting <span>Open in focus mode</span>. For example, as perhaps the most important tile on the dashboard, the user could observe the (3.4%) miss to the sales plan (via the red down arrow KPI icon) and choose to open this tile in focus mode. Given the full pane of additional space provided by focus mode, the supporting metric lines of the Power KPI visual and the individual data points of those lines are exposed to the user.</p>
<div class="packt_infobox">Focus mode is also available in reports via the Focus mode icon in the top-right corner of each report visual. This can certainly be useful as well, but remember, per the dashboards versus reports table shared earlier in this chapter, that opening reports always results in new queries being generated. With the exception of streaming dataset tiles, dashboards tiles store the cached results of prior queries. Therefore, leveraging focus mode in dashboards, and dashboards generally (rather than reports), to address a significant portion of user analysis needs can reduce the query workload on the underlying dataset and resources (for example, the Power BI Premium capacity) and help ensure a more optimal user experience. </div>
<p class="calibre7">The Power KPI visual in the preceding example automatically adjusts to the additional space of focus mode to display data labels for all months. The distinct line styles (solid, dotted, dot-dashed) of the actual net sales, sales plan, and prior year's sales measures are also more transparent to the user. Additionally, the three measures (net sales, sales plan, prior year sales) and the two variances (actual versus plan, actual versus prior year) are displayed as tooltips via hovering over the data points.</p>
<p class="calibre7">These additional data details, formatting options, and other capabilities are not available in the standard KPI visual and therefore, although the Power KPI visual requires additional configuration, it ultimately delivers more analytical value and serves to reduce the need for users to search for additional visuals and reports to resolve their questions. However, only the standard KPI, Card, and Gauge visuals are supported for data alerts so this could be a factor in choosing the standard KPI. Additional details on configuring data alerts in the Power BI service are included in <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-4">
<div id="calibre_link-913" class="calibre2">
<div id="calibre_link-914" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Layout</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The position and size of dashboard tiles should align with the primary purpose or priorities of the dashboard and standard visual comprehension techniques. For example, the <kbd class="calibre15">Total Net Sales vs. Plan</kbd> KPI at the global level is the most important tile of the <span>Global</span> sales dashboard. Therefore, this tile is positioned at the top-left corner of the dashboard and twice as much width is allocated to it relative to reseller sales and internet sales tiles. Via this layout, the user can naturally start at the top-left of the dashboard and navigate to the right (<kbd class="calibre15">Reseller and Internet Sales</kbd>) and down (<span>North America</span>, <span>Europe</span>, <span>Pacific</span>) to add greater context to the <kbd class="calibre15">Total Net Sales vs. Plan</kbd> KPI. </p>
<p class="calibre7">Another top consideration for layout is to maximize the available canvas space. Unlike reports, which can contain multiple pages and bookmarks, a dashboard is always a single canvas of tiles. Therefore, although a dashboard should not contain empty space, <span>users should not have to scroll vertically or horizontally to view dashboard tiles. Given the limited space, typically a compromise must be made between larger tile sizes for more important visuals versus the inclusion or exclusion of tiles for less essential visuals. As one example, the trailing six month channel mix tile (Stacked Column chart) in the Global sales dashboard could be removed thereby allowing the internet and reseller net sales KPI visuals to be enlarged to the same size as the total net sales KPI tile.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-18">
<div id="calibre_link-915" class="calibre2">
<div id="calibre_link-916" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Navigation pane</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Additional space for dashboard tiles can be obtained by hiding the navigation pane. To toggle between hiding or showing the navigation pane, click the three lines above the Favorite icon (star symbol), per the following image:</p>
<div class="cdpalignleft"><img src="images/000412.png" class="calibre259" /></div>
<div class="mce-root2">Hidden navigation pane</div>
<p class="calibre7">URL parameters can also be used to open dashboards with the navigation pane hidden by default. In the following example, a string of text from the question mark through the <kbd class="calibre15">true</kbd> property has been appended to the end of the URL for a dashboard:</p>
<pre class="calibre19">https://app.powerbi.com/groups/abc123/dashboards/d8465<strong class="calibre6">?collapseNavigation=true</strong></pre>
<p class="calibre7">The modified URL could be shared with users such that users of the dashboard aren't required to click on the navigation pane icon.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-30">
<div id="calibre_link-917" class="calibre2">
<div id="calibre_link-918" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Full screen mode</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Another technique for obtaining more space on dashboards is to utilize the full screen mode. The full screen mode can be accessed via the diagonal arrow icon in the top menu bar next to the notifications text box icon, per the following image:</p>
<div class="cdpalignleft"><img src="images/000421.png" class="calibre260" /></div>
<div class="mce-root2">Full screen mode icon</div>
<p class="calibre7">The full screen mode removes all chrome including the the navigation pane, Power BI menus, and the bars associated with the web browser (for example, tabs, address bar, bookmarks bar). This view alone substantially increases the available space for larger tiles or a higher volume of dashboard tiles. If certain dashboard tiles are still not visible in the full screen Mode, a Fit to Screen option is available in the lower-right corner via the four diagonal arrows, per the following image:</p>
<div class="cdpalignleft"><img src="images/000003.png" class="calibre261" /></div>
<div class="mce-root2">Fit to Screen</div>
<p class="calibre7">The Fit to Screen option, exclusive to the full screen mode, is also referred to as TV mode and is frequently used to to display Power BI dashboards on large monitors in corporate hallways. Additionally, URL parameters can also be used to access dashboards in full screen mode by default. In the following example, a text string from the question mark through the true property has been appended to the URL of the dashboard such that the dashboard will be opened in full screen mode:</p>
<pre class="calibre19">https://app.powerbi.com/groups/abc123/dashboards/d8465<strong class="calibre6">?chromeless=true</strong></pre>
<p class="calibre7">Ultimately, BI teams must align the layout of tiles with the use cases for the dashboard and the preferences of the stakeholders.</p>
<p class="calibre7">For example, if a dashboard is almost exclusively going to be used in full screen mode, a layout that requires some level of scrolling to view all tiles outside of full screen mode may be acceptable. Alternatively, if users will regularly access the dashboard via the browser on their laptops or desktop monitors, they may not want to have to collapse the navigation pane or view the dashboard in full screen mode to see all the tiles. As the position and size of dashboard tiles can be easily adjusted via drag-and-drop handles within the Power BI service, multiple iterations of dashboard layouts can be quickly evaluated.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-41">
<div id="calibre_link-919" class="calibre2">
<div id="calibre_link-920" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Supporting tiles</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Custom images can be pinned from reports to dashboards to help structure and organize dashboard tiles. In the Global sales dashboard described earlier, four custom images were used to distinguish the global tiles from those associated with each of the three sales territory groups (<span>North America</span>, <span>Europe</span>, <span>Pacific</span>). The position and size of the supporting tiles help to clarify the priority and scope of the dashboard.</p>
<p class="calibre7">For example, without any knowledge of the dashboard's title, the top position of the global tile and the additional space allocated to the global section of the dashboard helps to confirm that the dashboard is primarily focused on the global level.</p>
<p class="calibre7">Supporting tiles used for organizational purposes in dashboards, such as those in the <span>Global</span> sales dashboard, can be created with basic shape and image tools in Office and Windows applications, such as Excel, PowerPoint, Paint, and Paint 3D. Specifically, a rectangle shape can be inserted into an Excel worksheet or a PowerPoint slide and the necessary text (for example, <span>North America</span>) and fill background color can then be applied. Most importantly, the dimensions of the formatted shape can be set in accordance with the 4 X 3 aspect ratio or a multiple of this ratio such that the image clearly fills the space of a dashboard tile. </p>
<p class="calibre7">For example, the three sales territory group shapes are created with a width and height of 1.4" and 1.05" (4 X 3), respectively. The global shape, however, has a width and height of 1.4" and 2.1" (4 X 6), respectively, per the following image:</p>
<div class="cdpalignleft"><img src="images/000013.png" class="calibre262" /></div>
<div class="mce-root2">Support tile shapes</div>
<p class="calibre7">Once the shapes have been created with the proper formatting and size ratios given their role on the dashboard, they can be saved as PNG files (images) with image-editing applications, such as MS Paint and Paint 3D for Windows.</p>
<div class="packt_infobox">As images, the three sales territory groups have 136 X 102 pixel dimensions (4 X 3). The global image has 136 X 203 pixel dimensions (4 X 6).</div>
<p class="calibre7">Finally, the images can be inserted into a Power BI report that will be published in the same app workspace of the dashboard. To further eliminate any white space in the dashboard tiles, the <span>Scaling</span> property of the image can be set to <span>Fit</span>, per the following example:</p>
<div class="cdpalignleft"><img src="images/000024.png" class="calibre263" /></div>
<div class="mce-root2">Image scaling property: Fit</div>
<p class="calibre7">With the <span>Scaling</span> property for all images set to <span>Fit</span>, the report can be published to the Power BI service and each image can be pinned to the dashboard. Like all tiles in Power BI dashboards, the diagonal arrow handles in the lower-right corner of each tile containing an image can be used to change the size of the tile. Additionally, a tile can be selected and dragged to a different location on the canvas.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-269">
<div id="calibre_link-921" class="calibre2">
<div id="calibre_link-922" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Custom date filters</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>For this package of dashboards, the requirement was for each KPI visual to include the last 12 completed months. Additionally, the sales channel mix visual was to display the last six completed months. These two filter conditions ensure that only complete months are included and help to focus the dashboard on recent trends. </span></p>
<p class="calibre7">The exclusion of the current month can be implemented via the <kbd class="calibre15">Calendar Month Status</kbd> described in the <em class="calibre16">Date dimension view</em> section of <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>. However, to support the last 12 completed periods condition, an additional dynamic column (<kbd class="calibre15">Trailing 3 Calendar Month Periods</kbd>) was added to the SQL view of the date dimension. These two columns can be utilized as page-level filters in the reports containing the KPI visuals, per the following image:</p>
<div class="cdpalignleft"><img src="images/000031.png" class="calibre264" /></div>
<div class="mce-root2">Page-level filters: dynamic date columns</div>
<p class="calibre7">Per the preceding page-level filter condition, the <kbd class="calibre15">Trailing 3 Calendar Month Periods</kbd> column contains eight custom trailing values representing 3-month intervals relative to the current month. For example, when the current month is December of 2017, the <kbd class="calibre15">Trailing 1-3 Calendar Months</kbd> value includes September, October, and November of 2017. Selecting four of the values as page-level filters ensure that each visual on the given report page will not contain more than the last 12 completed months.</p>
<p class="calibre7">The <kbd class="calibre15">DATEDIFF()</kbd> T-SQL function and the standard <kbd class="calibre15">CURRENT_TIMESTAMP()</kbd> SQL function is utilized within a case expression to produce the <kbd class="calibre15">Trailing 3 Calendar Month Periods</kbd> column. <span>The logic for this additional column is embedded in the SQL view object accessed by the date dimension table of the Power BI dataset, per the following example:</span></p>
<pre class="calibre19">CASE <br class="calibre3" />    WHEN DATEDIFF(MONTH,D.[Date],CAST(CURRENT_TIMESTAMP AS date)) = 0 <br class="calibre3" />        THEN 'Current Calendar Month'<br class="calibre3" />    WHEN DATEDIFF(MONTH,D.[Date],CAST(CURRENT_TIMESTAMP AS date)) IN (1,2,3) <br class="calibre3" />        THEN 'Trailing 1-3 Calendar Months' <br class="calibre3" />    WHEN DATEDIFF(MONTH,D.[Date],CAST(CURRENT_TIMESTAMP AS date)) IN (4,5,6) <br class="calibre3" />        THEN 'Trailing 4-6 Calendar Months'<br class="calibre3" />    WHEN DATEDIFF(MONTH,D.[Date],CAST(CURRENT_TIMESTAMP AS date)) IN (7,8,9) <br class="calibre3" />        THEN 'Trailing 7-9 Calendar Months'<br class="calibre3" />    WHEN DATEDIFF(MONTH,D.[Date],CAST(CURRENT_TIMESTAMP AS date)) IN (10,11,12) <br class="calibre3" />        THEN 'Trailing 10-12 Calendar Months'<br class="calibre3" />    WHEN DATEDIFF(MONTH,D.[Date],CAST(CURRENT_TIMESTAMP AS date)) IN (13,14,15) <br class="calibre3" />        THEN 'Trailing 13-15 Calendar Months'<br class="calibre3" />    WHEN DATEDIFF(MONTH,D.[Date],CAST(CURRENT_TIMESTAMP AS date)) IN (16,17,18) <br class="calibre3" />        THEN 'Trailing 16-18 Calendar Months'<br class="calibre3" />    WHEN DATEDIFF(MONTH,D.[Date],CAST(CURRENT_TIMESTAMP AS date)) IN (19,20,21) <br class="calibre3" />        THEN 'Trailing 19-21 Calendar Months'<br class="calibre3" />    WHEN DATEDIFF(MONTH,D.[Date],CAST(CURRENT_TIMESTAMP AS date)) IN (22,23,24) <br class="calibre3" />        THEN 'Trailing 22-24 Calendar Months'<br class="calibre3" />    ELSE 'Older Periods'<br class="calibre3" />  END AS [Trailing 3 Calendar Month Periods]</pre>
<div class="packt_infobox">The <kbd class="calibre43">Current Calendar Month</kbd> value of the <kbd class="calibre43">Trailing 3 Calendar Month Periods</kbd> column is not visible in the page-level filter due to the existing filter on the <kbd class="calibre43">Calendar Month Status</kbd> column (is not <kbd class="calibre43">Current Calendar Month</kbd>). The <kbd class="calibre43">Trailing 3 Calendar Month Periods</kbd> column has also been used as a visual-level filter on the 100% stacked column chart. For this visual, only the trailing 1 through 3 and trailing 4 through 6 values have been selected to display the last 6 completed months. </div>
<p class="calibre7">The <em class="calibre16">Date dimension view</em> section of <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em> includes additional details on the SQL view for the date dimension table. This includes the <kbd class="calibre15">WHERE</kbd> clause (filter condition) and the <kbd class="calibre15">Calendar Year</kbd> and <kbd class="calibre15">Calendar Month Status</kbd> columns. Filter conditions associated with the report, page, and visual-level filters were described in the <em class="calibre16">Report filter scopes</em> section of <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-270">
<div id="calibre_link-923" class="calibre2">
<div id="calibre_link-924" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Multi-dashboard architectures</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For small projects and the early iterations of an agile BI project, a single dashboard and a few supporting reports may be sufficient. <span>For many dashboard users, however, multiple dashboards with their own distinct reports are needed to adequately reflect the broader set of metrics they're responsible for. Both of these approaches, single dashboard, and multiple dashboards are geared towards a specific stakeholder or group of consumers, such as the vice presidents of sales group. Although these methodologies may meet the needs of their intended users, a potential risk </span><span>is a lack of coordination across teams.</span></p>
<p class="calibre7"><span>For example, business units would reference distinct metrics included in their dashboard and these metrics may not be included in the dashboards of senior managers or other business units.</span></p>
<p class="calibre7"><span>To promote greater consistency and coordination across groups of users, BI teams can pursue an integrated, organizational dashboard architecture. In this approach, the same metrics and KPIs considered strategic for the organization are available in multiple dashboards specific to levels in an organizational hierarchy or distinct business units. The <span>Global</span> sales dashboard, described in the <em class="calibre16">Dashboard design</em> section earlier, represents this methodology as separate dashboards specific to individual sales territory groups that would include the same KPIs as the global dashboard. This approach ensures that dashboard tiles are relevant to the specific users and make it possible to analyze up and down a natural organizational hierarchy. Additionally, a common dashboard layout with integrated KPIs makes Power BI solutions much easier to manage with limited BI resources.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-271">
<div id="calibre_link-925" class="calibre2">
<div id="calibre_link-926" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Single-dashboard architecture</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In the following diagram, a single dashboard focused on <kbd class="calibre15">Reseller Sales</kbd> contains tiles representing report visuals from four separate Power BI reports:</p>
<div class="cdpalignleft"><img src="images/000041.png" class="calibre265" /></div>
<div class="mce-root2">Single-dashboard architecture</div>
<p class="calibre7">By default, a user selection on any of the dashboard tiles opens the report page of the underlying report. For example, a dashboard tile reflecting the percentage of bike sales versus other product categories would be linked to the <kbd class="calibre15">Reseller Product Mix</kbd> report and the specific page of this report containing the source visual. </p>
<p class="calibre7">Each Power BI report is based on a Live connection to the <kbd class="calibre15">AdWorks Enterprise</kbd> dataset. As described in the <em class="calibre16">Live connections to Power BI datasets</em> section in <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>, leveraging this feature avoids the duplication of datasets since each Power BI Desktop report file <span>(PBIX)</span> only contains the visualization layer (for example, visuals, formatting). Although relatively simple to build and support, the single <kbd class="calibre15">Reseller Sales</kbd> dashboard architecture provides both a summary overview of a diverse set of essential metrics and visuals (represented as dashboard tiles) as well as an entry point to reports containing the details supporting this dashboard. As described in the previous two chapters, the Power BI reports could include multiple report pages of visuals related to the dashboard and leverage interactive features, such as slicers and bookmarks, to enable users to more easily explore these reports. </p>
<div class="packt_infobox">All of the content in this architecture - the dashboard, reports, and dataset would be hosted in a single app workspace in the Power BI service. <a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content</em> explains the role and configuration of app workspaces.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-272">
<div id="calibre_link-927" class="calibre2">
<div id="calibre_link-928" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Multiple-dashboard architecture</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>In the following diagram, a</span> <kbd class="calibre15">Reseller Margin</kbd> <span>dashboard and a <kbd class="calibre15">Reseller Margin Trends</kbd> report have been added to the solution described in the previous section: </span></p>
<div class="cdpalignleft"><img src="images/000050.png" class="calibre266" /></div>
<div class="mce-root2">Multiple-dashboard architecture</div>
<p class="calibre7"><span>In this design, a visual from the <kbd class="calibre15">Reseller Margin Analysis</kbd> report has been pinned to both the <kbd class="calibre15">Reseller Sales</kbd> and the <kbd class="calibre15">Reseller Margin</kbd> dashboards, per the preceding diagram. This is not required but is recommended for usability such that users can maintain context as they navigate between both dashboards. The new <kbd class="calibre15">Reseller Margin Trends</kbd> report, built via a Live connection to the published <kbd class="calibre15">AdWorks Enterprise</kbd> dataset, exclusively supports the <kbd class="calibre15">Reseller Margin</kbd> dashboard. </span></p>
<p class="calibre7">This architecture extends the scope of the solution to provide greater visibility to margin metrics and trends not available via the single dashboard. For example, rather than navigating through the multiple pages of the two reseller margin reports (<kbd class="calibre15">Reseller Margin Analysis</kbd>, <kbd class="calibre15">Reseller Margin Trends</kbd>), users could access the <kbd class="calibre15">Reseller Margin</kbd> dashboard for a more simplified dashboard experience. In addition to user convenience and the limited scope of a single dashboard, utilizing dashboards and their cached data helps to reduce the workload on the underlying dataset and resources.</p>
<div class="packt_infobox">Like the single dashboard architecture, all content (<strong class="calibre6">Dashboards</strong>, <strong class="calibre6">Reports</strong>, <strong class="calibre6">Datasets</strong>) from this multi-dashboard architecture is included in the same app workspace in the Power BI service. Given this common workspace, each dashboard tile can be linked to a report or dashboard in the same workspace. For example, the one margin-related tile on the sales dashboard could be linked to the margin dashboard rather than the default source report. The <em class="calibre16">Dashboard tiles</em> section later in this chapter contains an example of configuring custom links. </div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-273">
<div id="calibre_link-929" class="calibre2">
<div id="calibre_link-930" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Organizational dashboard architecture</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In the following diagram, four dashboards contain corporate KPIs at the global level and for the three sales territory groups: </p>
<div class="cdpalignleft"><img src="images/000061.png" class="calibre267" /></div>
<div class="mce-root2">Organizational dashboard architecture</div>
<p class="calibre7">Since the same KPIs or metrics are included in each of the four dashboards, users of these dashboards are able to remain aligned with the same goals and can more clearly share their findings and results across teams and levels in the organization. From the perspective of an executive at the global level, the <span>Global Sales</span> dashboard provides an intuitive entry point into the individual sales territory groups and potentially further layers, if necessary.</p>
<p class="calibre7">For example, the <kbd class="calibre15">Europe Sales</kbd> territory group missed the total net sales plan by 11.6% for the month of November 2017, per the <span>Global Sales</span> dashboard described in the <em class="calibre16">Dashboard design</em> section. The executive could simply click this tile to access the <span>Europe Sales</span> dashboard to determine whether the sales miss was driven by a particular country (for example, France, Germany, United Kingdom) and how European sales performed across the online and reseller sales channels. </p>
<p class="calibre7">The following <span>European</span> sales dashboard follows the design (layout, visual selection) of the <span>Global</span> sales dashboard:</p>
<div class="cdpalignleft"><img src="images/000071.png" class="calibre268" /></div>
<div class="mce-root2">Europe sales dashboard</div>
<p class="calibre7">The three tiles aligned at the top of the <span>Europe</span> sales dashboard are exactly the same tiles as presented on the <span>Global</span> sales dashboard. The only difference is that the values are formatted in thousands rather than millions, given the smaller numbers for several of the <span>European</span> sales dashboard tiles. In this example, the executive interested in the -11.6% miss to sales plan for November of 2017 could access the Europe sales dashboard with a single click from the <span>Global</span> sales dashboard and determine that <span>Germany</span> and <span>France</span> were responsible for the underperformance with misses of -15% and -19.8%, respectively.</p>
<p class="calibre7"><span>The three tiles representing the second row of the <span>Global</span> and <span>Europe</span> sales dashboard (<kbd class="calibre15">Net Sales YTD versus Plan</kbd>, <kbd class="calibre15">Net Margin % YTD versus Plan</kbd>, <kbd class="calibre15">Sales Channel Mix</kbd>) do not have to be the same across the dashboards since these are not the approved KPIs for the organization. Maintaining a 1:1 match in terms of tiles across the dashboards can be beneficial as this allows users to navigate between dashboards for further analysis of any given tile. However, in many scenarios, there are metrics or visuals that are more pertinent to the given business unit and users may rarely need to analyze non-KPIs across multiple dashboards.</span></p>
<p class="calibre7">Per the organizational dashboard architecture diagram, a set of three dedicated European sales reports support the <span>Europe</span> sales dashboard. The pages of these reports may provide sufficient detail or, depending on the organizational structure and requirements, an additional layer of dashboards dedicated to each sales territory country could be added. Other forms of the organizational dashboard architecture include dedicated dashboards by product group, such as <kbd class="calibre15">Bikes</kbd>, <kbd class="calibre15">Clothing</kbd>, and <kbd class="calibre15">Accessories</kbd> in the case of <kbd class="calibre15">Adventure Works</kbd>. Ultimately, these implementations serve to align the different business units on common corporate goals while also providing a rich set of insights relevant to each business unit or organizational level.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-274">
<div id="calibre_link-931" class="calibre2">
<div id="calibre_link-932" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Multiple datasets</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A single dataset, <kbd class="calibre15">AdWorksEnterprise</kbd>, was utilized to support all reports and dashboards in each of the three dashboard architectures reviewed in the previous sections. This level of integration is not technically necessary and there are valid scenarios where multiple datasets could be used in the same Power BI solution and even by the same dashboard. However, additional or multiple datasets can quickly create problems due to separate data refresh processes, separate data source dependencies, and separate data security rules to implement.</p>
<p class="calibre7">Additionally, version control issues can arise as each dataset may include differences in the structure and definitions of tables common to both datasets. Moreover, the integration of visuals from the separate dataset on a dashboard may be insufficient to support analytical requirements.</p>
<div class="packt_infobox">In many cases, business users eventually need to analyze the data stored in separate datasets in the same report. For example, viewing dashboard tiles based on shipment and sales reports may be a helpful starting point but ultimately a user will need to filter both tables by product category, date, department, and other dimensions common to both business processes. A Power BI report is always limited to a single dataset as its source and thus an integrated dataset is always required whenever cross-analysis is required. </div>
<p class="calibre7">As one use case for multiple datasets, an organization may not have a particular data source, such as an Oracle database, integrated into its data warehouse system (for example, Teradata) but still wish to provide essential visualizations of this data in Power BI to supplement other reports and dashboards. In this scenario, a Power BI dataset could be built against the Oracle database, and reports utilizing this dedicated dataset could then support one or multiple dashboards. Once the necessary data warehouse integration was completed, the dedicated dataset could be retired and its reporting replaced with new reports based on an Analysis Services model (which uses Teradata as its source) that supports other Power BI reporting content for the organization.</p>
<div class="packt_infobox">The import versus DirectQuery dataset decision described earlier in this book significantly impacts the need for multiple datasets. For example, if the default import mode is used, a BI team could choose to load the separate data source (for example, Oracle) into the same dataset containing data from Teradata or another source. If a DirectQuery model was created, however, this model would be limited to its own source and database thus implying a separate dataset to support the Oracle database source.</div>
<p class="calibre7">In other scenarios, a dataset is chosen (or was already implemented) for one or a few business processes that aren't closely related to other business processes. For example, one dataset was built to include sales- and marketing-related data, while a separate dataset includes inventory and shipment data. The reasoning for this isolation may have been that the users of each dataset don't need access to the other dataset or that a large, integrated dataset would be complex to develop and use.</p>
<p class="calibre7">For example, it's not uncommon for datasets with multiple fact tables to require hundreds of DAX measures and Power BI Desktop currently doesn't support display folders or perspectives, such as Analysis Services, to help simplify the user interface. Additionally, if the Power BI Premium capacity is not available and Power BI datasets are used, the 1 GB file limit could force a team to utilize separate Power BI files to store the required data.</p>
<p class="calibre7">In general, corporate BI projects should limit the use of multiple datasets for the reasons described and the long-term value of a centralized data store. However, in environments lacking a data warehouse and other scalable resources, such as an Analysis Services instance or Power BI Premium capacity, multiple datasets can be considered as an option and potentially the only option to support one or multiple dashboards in the same Power BI solution.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-275">
<div id="calibre_link-933" class="calibre2">
<div id="calibre_link-934" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dashboard tiles</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Most dashboard tiles are created in the Power BI service by pinning a visual, image, or shape from a report to a new or existing dashboard in the same app workspace. However, dashboard tiles can also be created by adding a tile directly from the dashboard itself and by pinning from an Excel Workbook or an SSRS report.</p>
<p class="calibre7">With a report open in the Power BI service, hovering over the top-right corner of a visual exposes the Pin visual icon, per the following image from the <kbd class="calibre15">Global Reseller Sales</kbd> report:</p>
<div class="cdpalignleft"><img src="images/000082.png" class="calibre269" /></div>
<div class="mce-root2">Pin visual icon for report visual</div>
<p class="calibre7">Report visuals can be pinned to dashboards from both the <span>Reading view</span> and the <span>Editing view</span>. The preceding image is from the <span>Reading view</span>, but clicking the <span>Edit report</span> button next to the <span>File</span> and <span>View</span> drop-downs menus opens the <span>Editing view</span>. Reports generally open by default in the <span>Reading view</span>, and the <span>Editing view</span> is only available to the user who created the report or members and admins of the app workspace for the report, such as AdWorks Enterprise Sales in this example.</p>
<p class="calibre7">The following URL from MS Docs provides a complete comparison of the functionality differences between the <span>Reading view</span> and <span>Editing view</span> for Power BI reports <a href="http://bit.ly/2HztVsY" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2HztVsY</a>.</p>
<div class="packt_tip pcalibre7 pcalibre6">Power BI Desktop is always in the <span>Editing view</span> and offers more report-editing functionality than the <span>Editing view</span> in the Power BI service, such as the ability to write DAX-measure expressions scoped to the specific report. Additionally, since reports created in the Power BI service cannot be downloaded as PBIX files, almost all report creation and edit activities occur in Power BI Desktop. Dashboards, workspaces and all content distribution options, such as Power BI apps are configured in the Power BI service, described in later chapters. </div>
<p class="calibre7"><span>Once pinned to the dashboard, several options are available for configuring tiles depending on the type of tile and the content it contains. In the <span>Global</span> and <span>Europe</span> sales dashboards described in previous sections, for example, a subtitle was added to each tile (for example, France) and custom links were applied to allow direct navigation from the <span>Global</span> dashboard to the <span>Europe</span> dashboard.</span></p>
<div class="packt_infobox"><span><span>SSRS 2016, and later versions, support integration with the Power BI service. Once integration has been configured in the Report Server Configuration Manager, certain SSRS report items, such as charts and maps, can be pinned to Power BI dashboards. A reporting services subscription is automatically created for pinned report items to manage the data refresh of the dashboard tile. <br class="calibre3" />
<br class="calibre3" />
The Power BI publisher for Excel add-in, available for Excel 2007 and later, allows users to pin Excel ranges and objects, such as pivot tables and charts, directly from Excel workbooks to dashboards. This add-in includes the ability to update pinned items and to connect to published datasets in the Power BI service to create pivot-table Excel reports. Additionally, ranges within Excel workbooks uploaded to the Power BI service can also be pinned to dashboards. </span></span> <span><br class="calibre3" />
<br class="calibre3" />
The details of creating SSRS and Excel-based dashboard tiles is beyond the scope of this chapter. However, several examples of these integrations were included in the <em class="calibre16">Microsoft Power BI Cookbook</em></span> (<a href="https://www.packtpub.com/big-data-and-business-intelligence/microsoft-power-bi-cookbook" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://www.packtpub.com/big-data-and-business-intelligence/microsoft-power-bi-cookbook</a>). <span>Additionally, the Power BI Report Server, which includes the full SQL Server Reporting Services functionality, is described in <a href="#calibre_link-11" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 10</a>, <em class="calibre16">Deploying the Power BI Report Server</em>.</span></div>
<p class="calibre7">Dashboard tiles can be thought of as snapshots of a specific visual and filter context. When a visual is pinned from a report to a dashboard, the specific filter context (for example, slicers, page-level filters), visualization, and formatting at that time are captured by the dashboard. Subsequent changes to the report, such as a modified filter or a different visualization type, are not reflected by the dashboard tile. The dashboard tile will, however, continue to reflect the latest data refreshes of the underlying dataset. Additionally, by default, the dashboard tile will continue to be linked to the report from which the visual was pinned.</p>
<p class="calibre7">To maintain the synchronization between report visuals and dashboard tiles, changes to reports that impact the pinned visuals require the updated report visual to be pinned again. The existing dashboard tile, reflecting the original filter context and visualization, can be deleted. One exception to the snapshot behavior of dashboard tiles is live report pages, as described later in this chapter.</p>
<div class="packt_infobox">One exception to the snapshot behavior of dashboard tiles is live report pages. When an entire report page has been pinned as a single tile to a dashboard, any changes to the report page are automatically reflected on the dashboard as well. The <em class="calibre16">Live report pages</em> section later in this chapter includes additional details and an example.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-276">
<div id="calibre_link-935" class="calibre2">
<div id="calibre_link-936" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Tile details and custom links</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Custom links are an important component of multi-dashboard architectures, and particularly the organizational dashboard architecture described in the previous section. In the absence of custom links, clicking a dashboard tile opens the report page from which the visual was pinned to the dashboard. Custom links allow BI teams to take control of the navigation experience and enable users to navigate directly to another dashboard with related information or even to an external site, such as a team site on SharePoint Online.</p>
<p class="calibre7">Tile details can be accessed by hovering over the top-right corner of a dashboard tile, clicking the ellipsis, and then selecting <span>Edit details</span>. In the following image from the <span>Tile details</span> window, a <span>Subtitle</span> (<kbd class="calibre15">Europe</kbd>) is added to one of the <kbd class="calibre15">Total Net Sales vs. Plan</kbd> KPI tiles:</p>
<div class="cdpalignleft"><img src="images/000092.png" class="calibre270" /></div>
<div class="mce-root2">Tile details</div>
<p class="calibre7">Additionally, per the preceding <span>Tile details</span> image, the <span>Set custom link</span> property has been enabled and the <span>Europe Sales (dashboard)</span> has been selected for the target of the link. Clicking <span>Apply</span> at the bottom of the dialog (not included in the preceding screenshot) confirms the selection. Different options are available in the tile details window for widgets added directly on the dashboard (not pinned), such as text boxes and images, per the following section.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-277">
<div id="calibre_link-937" class="calibre2">
<div id="calibre_link-938" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Images and text boxes</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In addition to pinning custom images with text, as described in the <em class="calibre16">Supporting tiles</em> section, it may be necessary to add supporting widget tiles directly on the dashboard. These widgets, created via the Add tile icon above each dashboard, can include web content, images (via URL), text boxes, video, and real-time data.</p>
<p class="calibre7">The following three tiles represent the video, image, and text box widgets created via the <span>Add tile</span> functionality:</p>
<div class="cdpalignleft"><img src="images/000103.png" class="calibre271" /></div>
<div class="mce-root2">Image and text box tiles</div>
<p class="calibre7">The tile details for the video and image flag include a required URL input box to reference. For the video, the URL must reference either YouTube or Vimeo. <span>Other common tile details can be configured as well, including title, subtitle, and a custom link. Likewise, the video widget tile includes a required video URL to either Youtube or Vimeo (<a href="https://vimeo.com/210508392" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://vimeo.com/210508392</a>). </span></p>
<p class="calibre7">The text box tile supports common text formatting options as well as hyperlinks, per the following image:</p>
<div class="cdpalignleft"><img src="images/000114.png" class="calibre272" /></div>
<p class="calibre7">In the preceding text box, hyperlinks are provided to IS Support, a company data and analytics site, and a data governance site. A common text box with essential links to documentation and support can be applied to all corporate BI-supported dashboards.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-278">
<div id="calibre_link-939" class="calibre2">
<div id="calibre_link-940" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">SQL Server Reporting Services</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>SSRS 2016, and later versions as well as the Power BI Report Server, supports integration with the Power BI service. Once integration has been configured between the on-premises report server and the Power BI tenant, certain SSRS report items, such as charts and maps, can be pinned to Power BI dashboards. Additionally, a reporting services subscription is automatically created for pinned report items, allowing for report server administrators to manage the data refresh schedule of the dashboard tile. </span></p>
<p class="calibre7">In the following image of the <span>Report Server Configuration Manager</span>, a Power BI Report Server has been configured:</p>
<div class="cdpalignleft"><img src="images/000124.png" class="calibre273" /></div>
<div class="mce-root2">Power BI integration with Power BI Report Server</div>
<p class="calibre7">In the preceding image, the <strong class="calibre6">Power BI Report Server</strong> <span>(</span><strong class="calibre6">PBIRS</strong><span>) </span>instance installed on the ATLAS server has been configured for integration with the Power BI service. The same Power BI integration is available for SQL Server Reporting Services 2016 and 2017 via the same interface in the Report Server Configuration Manager. The following documentation includes all the requirements for integration with the Power BI service as well as technical details on the integration and pinning process <a href="http://bit.ly/2CnCkOU" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2CnCkOU</a>.</p>
<div class="packt_infobox">As described in <a href="#calibre_link-11" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 10</a>, <em class="calibre16">Deploying the Power BI Report Server</em>, the Power BI Report Server includes all the functionality of the SSRS, including paginated (RDL) reports, report subscriptions, folder security, and the reporting services web portal. Power BI Report Server, however, provides several additional features and benefits, with the ability to view and interact with Power BI reports (PBIX files) topping this list.</div>
<p class="calibre7">In the following image from the Power BI Report Server web portal, a paginated (RDL) report containing a map has been opened:</p>
<div class="cdpalignleft"><img src="images/000134.png" class="calibre274" /></div>
<div class="mce-root2">Pin to Power BI icon in Power BI Report Server</div>
<p class="calibre7">Selecting the Pin to Power BI Dashboard icon in the top-right window prompts the user to select the specific report item to pin. In this report, the map is selected and this launches the following dialog for identifying the dashboard in the Power BI service as well as defining the refresh schedule of the tile:</p>
<div class="cdpalignleft"><img src="images/000144.png" class="calibre275" /></div>
<div class="mce-root2">Pin SSRS item to Power BI Dashboard</div>
<p class="calibre7">In this example, the map is pinned to the <span>Customer Distribution</span> dashboard in the <kbd class="calibre15">Corporate Sales</kbd> app workspace. The <span>Daily</span>, <span>Hourly</span>, and <span>Weekly</span> tile refreshes can be configured via the <span>Frequency of updates</span> drop-down menu and this setting defines the report subscription supporting the tile. Report subscriptions can be managed via the <span>My Subscriptions</span> (<span>Settings</span> | <span>My Subscriptions</span>) interface on the Reporting Services web portal. </p>
<div class="packt_infobox"><span>App workspaces replaced group workspaces in 2017 and are utilized by Power BI Pro users to create and manage content. App workspaces and related topics (for example, version control) are explained in <a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>,</span> <em class="calibre16">Managing Application Workspaces and Content</em>.</div>
<p class="calibre7">Unlike visuals from Power BI reports, which can only be pinned to dashboards in the workspace of the given report, SSRS report items can be pinned to any dashboard in any workspace. In the following image from the Power BI service, the dashboard tile reflecting the pinned SSRS report item has been moved and sized to the top-left corner of the canvas:</p>
<div class="cdpalignleft"><img src="images/000154.png" class="calibre276" /></div>
<div class="mce-root2">SSRS report item as Power BI Dashboard tile</div>
<p class="calibre7"><span>By default, the SSRS-based dashboard tile is linked back to the on-premises SSRS report. This link, as well as the title and subtitle for the tile, can be modified via the <span>Tile details</span> window like other dashboard tiles.</span></p>
<p class="calibre7">Paginated SSRS reports (RDL files) created with <strong class="calibre6">SQL Server Data Tools</strong> (<strong class="calibre6">SSDT</strong>) for Visual Studio or SQL Server Report Builder cannot currently be published to the Power BI service. However, just as Power BI reports (PBIX files) can now be published to the Power BI Report Server, the Power BI and Reporting Services teams have advised that support for RDL files in the Power BI service is planned. Once this is accomplished, the three primary Microsoft report types (Power BI, Excel, and SSRS) will all be available in both the Power BI cloud service as well as on-premises via the Power BI Report Server. </p>
<div class="packt_infobox">Additional information on the Power BI Report Server including the deployment and scheduled refresh of Power BI reports is included in <a href="#calibre_link-11" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 10</a>, <em class="calibre16">Deploying the Power BI Report Server</em>.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-279">
<div id="calibre_link-941" class="calibre2">
<div id="calibre_link-942" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Excel workbooks</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>The Power BI Publisher for Excel add-in, available for Excel 2007 and later, allows Power BI Pro users to pin Excel ranges and objects, such as pivot tables and charts, directly from local Excel workbooks to Power BI dashboards in app workspaces. This add-in includes the ability to update pinned items and to connect to published datasets in the Power BI service to create pivot-table Excel reports. Additionally, report content from Excel workbooks published to the Power BI service can also be pinned to dashboards.</span></p>
<p class="calibre7"><span>Scheduled data refreshes can be configured in the Power BI service for Excel workbooks containing data models. However, given the size limitations of Excel data models as well as the additional capabilities of Power BI reports, such as custom visuals, role security, and advanced analytics, it's generally recommended to migrate Excel data models to Power BI datasets (PBIX files). Per the following image, the Power BI content contained in an Excel workbook can be imported to a Power BI Desktop file:</span></p>
<div class="cdpalignleft"><img src="images/000164.png" class="calibre277" /></div>
<div class="mce-root2">Import Excel to Power BI</div>
<p class="calibre7">The migration process includes the data retrieval M queries, data model tables and relationships, DAX measures, and even any Power View report pages contained in the source workbook.</p>
<div class="packt_tip pcalibre7 pcalibre6">Only when Excel reports are deeply dependent on Excel-specific functionality, such as worksheet formulas and customized conditional formatting rules, should the model not be migrated to Power BI. Power BI Desktop's enhanced table and matrix visuals and conditional formatting options now support many of the most common Excel report use cases. Therefore, the usually limited effort is required to develop the equivalent or a preferable report in Power BI Desktop relative to Excel. </div>
<p class="calibre7">In the following image, the filtered Excel pivot table is pinned to the <span>Customer Distribution</span> dashboard in the <kbd class="calibre15">Corporate Sales</kbd> workspace via the Power BI Publisher for Excel:</p>
<div class="cdpalignleft"><img src="images/000174.png" class="calibre278" /></div>
<div class="mce-root2">Pin Excel content to Power BI Dashboard</div>
<p class="calibre7">Just like SSRS report items, Excel content can also be pinned to any dashboard in any workspace in the Power BI service. However, when pinning from a local workbook, such as this example, the owner of the Excel workbook is responsible for updating the dashboard tile with any data refreshes or changes in filter conditions. The push updates from the user's workbook to the dashboard in the Power BI service can be executed via the <span>Pin Manager</span> dialog. This interface, which also provides visibility to pinned Excel items in any workspace, is accessed via the Power BI ribbon of the Power BI Publisher for Excel add-in, per the preceding image. </p>
<p class="calibre7">In the following image of the <span>Customer Distribution</span> dashboard, a custom title and subtitle have been applied to the tile containing the pinned Excel pivot table:</p>
<div class="cdpalignleft"><img src="images/000184.png" width="574" height="591" class="calibre279" /> </div>
<div class="mce-root2">Power BI Dashboard with Excel and SSRS content</div>
<p class="calibre7">Also like SSRS-based dashboard tiles, the details of dashboard tiles containing Excel content can be configured, including title, subtitle, and a custom link. Moreover, Excel and SSRS dashboard tiles can also be included in dashboard layouts dedicated to consumption via smartphones. The <em class="calibre16">Mobile-optimized dashboards</em> section later in this chapter describes this feature.</p>
<p class="calibre7">Although Excel and SSRS report content are not designed to be as visually engaging as Power BI visuals, the ability to leverage these common reporting tools and to consolidate their distinct content on the same dashboard is a unique capability of Power BI. Additionally, the data refresh of Excel workbooks containing external connections to sources, such as Power BI datasets and Analysis Services data models, is a highly requested feature that may be delivered by the fall of 2018.</p>
<p class="calibre7">Per the following image, only workbooks containing data models can currently be refreshed:</p>
<div class="cdpalignleft"><img src="images/000194.png" class="calibre280" /></div>
<div class="mce-root2">External workbook connections not supported</div>
<p class="calibre7">Given this current limitation, the two slicers above the pivot table (<kbd class="calibre15">Country</kbd>, <kbd class="calibre15">Calendar Year Status</kbd>) from the earlier example cannot be used in the Power BI service. This is because the Excel report was based on a connection to a published Power BI dataset via Power BI Publisher for Excel.</p>
<div class="packt_infobox"><span>The details of developing SSRS and Excel-based content as complements to a Power BI solution is beyond the scope of this chapter. However, several examples of these integrations, as well as considerations in choosing among the three tools, were included in the </span><em class="calibre16">Microsoft Power BI Cookbook</em> (<a href="https://www.packtpub.com/big-data-and-business-intelligence/microsoft-power-bi-cookbook" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://www.packtpub.com/big-data-and-business-intelligence/microsoft-power-bi-cookbook</a>).</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-280">
<div id="calibre_link-943" class="calibre2">
<div id="calibre_link-944" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Live report pages</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For some users, the self-service data exploration experience provided within Power BI report pages is the most valuable use case of Power BI content. Although a dashboard of tiles may initiate or contribute to an analysis, these users often have more complex and unpredictable analytical needs such that greater flexibility is needed. Additionally, these users are generally much more comfortable and experienced in interacting with Power BI content, such as modifying slicer selections and drilling up and down through hierarchies. </p>
<p class="calibre7">To provide both the self-service experience of a report page as well as the consolidation benefits of a dashboard, an entire report page can be pinned as a single tile to a dashboard. In the following dashboard for the <span>United States</span>, a live report page of eight visuals has been pinned to supplement the corporate standard KPI tiles:</p>
<div class="cdpalignleft"><img src="images/000205.png" class="calibre281" /></div>
<div class="mce-root2">Dashboard with live report page</div>
<p class="calibre7">In this dashboard, the user can leverage the robust filtering options on the sales and margin live page to explore the dataset while maintaining visibility to standard metrics via the top six tiles. In the preceding example, the user has filtered on the Southwest sales territory region, the second and third quarters of the year (2017-Q2 and 2017-Q3), and also selected the <kbd class="calibre15">Bikes</kbd> product category via the bar chart. These selections impact the other five visuals on the page via either highlighting, in the case of the <kbd class="calibre15">Net Sales</kbd> by <kbd class="calibre15">Calendar Month</kbd> column chart, or filtering, in the case of the other four visuals. Filter selections on the live page do not, however, impact the dashboard tiles outside of the live page. </p>
<div class="packt_infobox"><span>Defining the interaction behavior between visuals, such as switching between highlight and filter, is described in the <em class="calibre16">Visual interactions</em> section of <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em></span>.</div>
<p class="calibre7">Like standard dashboard tiles, a live page tile can be moved around the canvas and the title and subtitle can be configured via the <span>Tile details</span> window. However, custom links cannot be configured for live report pages. In the <span>United States</span> dashboard example, the report page itself included a textbox with a title and thus the display title and subtitle property of the dashboard tile has been disabled. </p>
<p class="calibre7">Unlike the snapshot behavior of normal dashboard tiles, any saved changes to the report containing the live report page, such as a different filter condition, are automatically reflected by the live page tile on the dashboard. This automatic synchronization avoids the need to delete dashboard tiles reflecting the original state of the report and re-pinning visuals to reflect changes in the source report.</p>
<p class="calibre7">Just like individual visuals within reports, a report page can be pinned from both the <span>Reading view</span> and the edit mode in the Power BI service. The Pin Live Page menu icon, next to the refresh icon in <span>Reading view</span>, generates the following window:</p>
<div class="cdpalignleft"><img src="images/000215.png" class="calibre282" /></div>
<div class="mce-root2">Pin Live Page</div>
<p class="calibre7">Live report page tiles can also be included in mobile-optimized views of dashboards. However, given their size, live pages are generally more valuable in larger form factors and with full screen mode.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-281">
<div id="calibre_link-945" class="calibre2">
<div id="calibre_link-946" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Mobile-optimized dashboards</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Just like the phone layout view in Power BI Desktop described in <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>, the Power BI service provides a phone view to customize a mobile-optimized layout for dashboards. With a phone view configured for a dashboard, the specific tiles, sizes, and order of tiles defined for the phone view will be presented to the user when the dashboard is accessed via the Power BI mobile app on their phone. </p>
<p class="calibre7">The <span>Phone view</span> can be accessed via the drop-down menu of <span>Web view</span> in the top-right corner of the dashboard, per the following image:</p>
<div class="cdpalignleft"><img src="images/000225.png" class="calibre283" /></div>
<div class="mce-root2">Dashboard Phone view</div>
<p class="calibre7">Once in <span>Phone view</span>, the same drag and resize options available in phone layout for Power BI Desktop are also available for the dashboard. In the following example, the three most important total net sales KPI visuals from the <span>Global Sales</span> dashboard have been positioned at the top of the phone view (<span>Global</span>, <span>North America</span>, <span>Europe</span>) and several less important tiles have been unpinned:</p>
<div class="cdpalignleft"><img src="images/000235.png" class="calibre284" /></div>
<div class="mce-root2">Phone view of dashboard in Power BI service</div>
<p class="calibre7">Power BI saves the phone layout automatically and the defined <span>Phone view</span> will be the new default view for phones accessing the dashboard. However, the user can still turn their phone sideways to view the dashboard in the standard web view. </p>
<p class="calibre7">The subtitles applied to the dashboard tiles are particularly valuable in <span>Phone view</span>. In the standard web view, the four supporting tiles with custom images (<span>Global</span>, <span>North America</span>, <span>Europe</span>, <span>Pacific</span>) make it easy to determine the scope of each tile. These image tiles are likely not, however, desired in <span>Phone view</span> and thus the subtitles can be relied on to convey the scope of each tile. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-282">
<div id="calibre_link-947" class="calibre2">
<div id="calibre_link-948" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">This chapter demonstrated how dashboards can be planned and developed as part of a large, integrated corporate BI solution. All essential features and processes of Power BI dashboards were highlighted, including the configuration of dashboard tiles, their links to other dashboards and reports, and mobile-optimized dashboards. Additionally, the unique capability of dashboards to integrate BI content from the SSRS reports and Excel workbooks was reviewed. </p>
<p class="calibre7">The next chapter transitions from the development of Power BI content to the management of Power BI content. This includes the application of version control to Power BI Desktop files and the migration of content across test and production environments with app workspaces.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-10">
<div id="calibre_link-949" class="calibre2">
<div id="calibre_link-950" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Managing Application Workspaces and Content</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The preceding six chapters have focused on the design and development of Power BI datasets, reports, and dashboards. While the creation of impactful and sustainable content is essential, this chapter reviews the processes and features that IT organizations can leverage to manage and govern this content through project life cycles and ongoing operational support. This includes application workspaces in the Power BI service, staged deployments between test and production environments, and maintaining version control of Power BI Desktop files. Additional features and practices highlighted in this chapter include data classifications for dashboards, documenting Power BI datasets, and utilizing the Power BI REST API to automate and manage common processes.</p>
<p class="calibre7">In this chapter, we will review the following topics:</p>
<ul class="calibre12">
<li class="calibre13">Application workspaces</li>
<li class="calibre13">Workspace roles and rights</li>
<li class="calibre13">Staged deployments</li>
<li class="calibre13">Power BI REST API</li>
<li class="calibre13">OneDrive for Business version history</li>
<li class="calibre13">Source control for M and DAX code</li>
<li class="calibre13">Dashboard data classifications</li>
<li class="calibre13">Dataset field descriptions</li>
<li class="calibre13">Metadata reporting</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-283">
<div id="calibre_link-951" class="calibre2">
<div id="calibre_link-952" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Application workspaces</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Application workspaces are containers in the Power BI service <span>of related content (reports and dashboards)</span>. As a Power BI Pro feature as discussed in the <em class="calibre16">Power BI </em>l<em class="calibre16">icenses</em> section of <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>, members of application workspaces, are able to create and test content, such as new dashboards and changes to reports, without impacting the content being accessed by users outside of the workspace. Once the new or revised content in the workspace is determined to be ready for consumption, the workspace can be published or updated as a Power BI app, as described in <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>.</p>
<div class="packt_quote">"We intend workspaces just for creation...it's the place where content gets created in Power BI."</div>
<div class="packt_quote">&ndash; Ajay Anandan, Senior Program Manager.</div>
<p class="calibre7">In addition to the default isolation or staging between content creation (workspaces) and content consumption (apps), BI teams can utilize multiple app workspaces to stage their deployments as per the <em class="calibre16">Staged deployments</em> section later in this chapter. For example, reports and dashboards can be initially created in a development workspace, evaluated against requirements in a test workspace, and finally deployed to a production workspace. The production app workspace would support the app which large numbers of business users would access and therefore could be assigned to Power BI Premium capacity to provide dependable performance and the flexibility to scale resources according to the needs of the workload.</p>
<div class="packt_infobox"><span><a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling with Premium and Analysis Services, </em>provides details on the features and benefits of Power BI Premium. These include the cost advantage of capacity-based pricing versus per-user licensing in large-scale deployments, managing Premium capacities (hardware), such as scaling up or out, and assigning workspaces to Premium capacities. Additional capabilities exclusive to content stored in Premium capacity, such as incremental data refresh, larger Power BI datasets, and more frequent scheduled data refreshes (for example, every 30 minutes), are also described in <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling with Premium and Analysis Services</em>.</span></div>
<p class="calibre7">The following diagram and four-step process depicts the essential role of app workspaces in the life cycle of Power BI content:</p>
<div class="cdpalignleft"><img src="images/000245.png" class="calibre285" /></div>
<div class="mce-root2">App workspaces and apps</div>
<ol class="calibre12">
<li class="chapter">A Power BI Pro user creates an <strong class="calibre6">App Workspace</strong> and adds other Power BI Pro users as members with edit rights</li>
<li class="chapter">The members of the <strong class="calibre6">App Workspace</strong> publish reports to the workspace and create dashboards in the workspace</li>
<li class="chapter">All content or a subset of the content in the <strong class="calibre6">App Workspace</strong> is published as a Power BI app</li>
<li class="chapter">Users or groups of users access content in the published app from any device</li>
</ol>
<p class="calibre7">All users within the <strong class="calibre6">app workspace</strong> will need a Power BI Pro license. All users consuming the published Power BI app will also need a Power BI Pro license, unless the <strong class="calibre6">app workspace</strong> has been assigned to Power BI Premium capacity. If the <strong class="calibre6">app workspace</strong> has been assigned to Power BI Premium capacity, users with Power BI (free) licenses and, optionally, external guest users from outside the organization with free licenses, can read or consume the Power BI app. As described in <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling with Premium and Analysis Services</em>, it is, of course, necessary to provision the appropriate resources (for example, CPU cores and RAM) to support the workload generated by the Power BI app.</p>
<div class="packt_infobox">In small team scenarios (5&ndash;15 users) in which maximum self-service flexibility is needed, all users can be assigned Pro licenses and collaborate on content within the app workspace. This approach negates the isolation benefit of workspaces from apps but provides immediate visibility to the latest versions of the content. Additionally, Power BI Pro users within the workspace can create their own Power BI and Excel reports based on connections to the published dataset in the workspace.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-284">
<div id="calibre_link-953" class="calibre2">
<div id="calibre_link-954" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Workspace roles and rights</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Every app workspace has one or multiple administrators who manage the access of other Power BI Pro users to the workspace. The user who initially creates the app workspace is the workspace admin by default and can add other users as members of the workspace, thus providing access to the datasets contained in the workspace. With the privacy level of the workspace set to allow members to edit content, workspace members can create and store content in the workspace as well as publishing content from the workspace to a Power BI app.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-285">
<div id="calibre_link-955" class="calibre2">
<div id="calibre_link-956" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Workspace admins</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Workspace admins can modify the name of the workspace, the privacy level for workspace members (edit or view only), and the role of each member (admin or member). For example, once users have been added to the workspace as members, the workspace admin can revise the role of one or multiple users from members to admins so that this user(s) can add other members and contribute to the management of the workspace.</p>
<p class="calibre7">If Power BI Premium capacity has been provisioned for the organization and if the workspace administrator has been granted assignment permissions to Premium capacity, the workspace admin can assign the workspace to a Premium capacity. This action moves the content in the workspace to dedicated hardware (capacity) exclusive to the organization and enables many additional features, such as the distribution of apps to Power BI free users. Further information on the assignment of app workspaces to Power BI Premium capacity is included in <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization</em><em class="calibre16">. </em>The additional capabilities provided by Power BI Premium and considerations in allocating Premium capacity are included in <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling with Premium and Analysis Services.</em></p>
<p class="calibre7">Workspace admins also have the exclusive right to delete an app workspace and thus remove all of its content (dashboards, reports, and datasets) from the Power BI service. Additionally, workspace admins can only leave an app workspace if another user has been assigned as an admin of the workspace.</p>
<div class="packt_tip pcalibre7 pcalibre6">Prior to deleting an app workspace, check to see if an app has been published from the workspace. If an app has been published, unpublish this app via the ellipis (three dots) next to the <span>Update app</span> button. If the app workspace has been deleted but the published app has not been unpublished, users of the published app will see errors when attempting to access or refresh its content.</div>
<p class="mce-root3">The following screenshot displays the app workspace options available to a workspace administrator:</p>
<div class="cdpalignleft"><img src="images/000256.png" class="calibre286" /></div>
<div class="mce-root2">App Workspace options for workspace admin</div>
<p class="calibre7">The <span>Edit workspace</span> dialog, as illustrated in the following section, is exclusively available to workspace administrators. <span>Workspace members (non-admins) with edit rights, however, can also update and unpublish apps as well as leave the app workspace.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-286">
<div id="calibre_link-957" class="calibre2">
<div id="calibre_link-958" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Workspace members</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The members added to the workspace are most commonly report authors who will connect to dataset(s) to develop reports in Power BI Desktop. These reports can then be published back to the app workspace and their visuals can be pinned to dashboards in the Power BI service as per the previous <a href="#calibre_link-265" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 7</a>, <em class="calibre16">Designing Power BI Dashboards and Architectures</em>.</p>
<p class="calibre7">Since app workspaces have a one-to-one relationship with Power BI apps, workspace administrators are often familiar with the users or groups of users who will consume the content as well as other subject matter experts, such as the dataset designer described in the <em class="calibre16">Project roles</em> section of <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>.</p>
<p class="calibre7">In the following screenshot, <strong class="calibre6">Jennifer</strong> has created an app workspace and added Mark as a member with edit rights:</p>
<div class="cdpalignleft"><img src="images/000266.png" class="calibre287" /></div>
<div class="mce-root2">Edit app workspace</div>
<p class="calibre7">The <span>Edit workspace</span> dialog is exclusive to workspace admins. In this example, Mark's edit rights as a member may be sufficient or Jennifer can revise Mark's role from <span>Member</span> to <span>Admin</span> so that he can also add other members. A security group in Azure Active Directory cannot be used to add members to a workspace. However, security groups can be referenced when publishing an app workspace as a Power BI app to enable groups of users to view the content of the workspace.</p>
<div class="packt_infobox">In almost all scenarios, only users who create and manage Power BI content are added as members of app workspaces. However, if a report page from the app workspace is going to be embedded in a SharePoint Online site, the members of the SharePoint Online site will need to be added as members of the app workspace. Both Power BI Pro and Power BI free users can view embedded Power BI content from SharePoint Online. In the case of Power BI free users, however, the app workspace containing the embedded content needs to be assigned to Power BI Premium capacity. Additional information on embedding Power BI content in SharePoint Online is included in <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution.</em></div>
<p class="calibre7"><span>Users with Power BI free licenses can technically be added to app workspaces via the</span> <span>Edit workspace</span> <span>dialog. The free user will see the name of the app workspace in the Power BI service but the following dialog will be prompted when trying to access the workspace:</span></p>
<div class="cdpalignleft"><img src="images/000276.png" class="calibre288" /></div>
<div class="mce-root2">Power BI free user attempting to access an app workspace</div>
<p class="calibre7">The preceding dialog is also prompted to free users when trying to utilize other Power BI Pro features, such as sharing a dashboard, accessing a shared dashboard from shared (non-Premium) capacity, or creating an email subscription to a report or dashboard.</p>
<div class="packt_infobox">Administrators of Power BI deployments have the ability to view the creation of Pro trial versions via the Office 365 audit logs. For example, a user assigned to the Power BI admin role (a role in Office 365), could analyze the level of activity for Pro trial users and assign available Pro licenses. Additionally, the process of assigning Pro licenses to users can be automated via PowerShell scripts so that administrators can focus on other governance and security issues. The Office 365 audit logs and options for accessing this data is described in Chapter 12, <em class="calibre16">Administering Power BI for an Organization</em>.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-287">
<div id="calibre_link-959" class="calibre2">
<div id="calibre_link-960" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">My Workspace</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">All Power BI users, including those with free licenses, are assigned a <span>My Workspace</span> in the Power BI service. This workspace should only be used and thought of as a private scratchpad for content specific to the individual user. <span>My Workspace</span> can be accessed via the same <span>Workspaces</span> menu as <span>APP WORKSPACES</span>, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000286.png" class="calibre289" /></div>
<div class="mce-root2">My Workspace</div>
<p class="calibre7">Any Power BI content which requires access by other users should be stored in an app workspace and distributed from the app workspace. Although <span>My Workspace</span> can host the same content types as <span>APP WORKSPACES</span>, any content distributed from <span>My Workspace</span>, such as via the dashboard sharing feature described in <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>, is dependent on the individual user's account. Additionally, Power BI apps are exclusive to <span>APP WORKSPACES</span> and the Power BI team has advised that future administration and governance features will also be exclusive to <span>APP WORKSPACES</span>.</p>
<div class="packt_infobox">The Power BI team has advised of a future setting in the Power BI admin portal allowing administrators to disable the <span>My Workspace</span> for Power BI free users. If enabled, Power BI free users would only see the four consumption-related menu items (<span>Favorites</span>, <span>Recent</span>, <span>Apps</span>, <span>Shared with me</span>) and the user experience for these items will remain simple and intuitive. Application workspaces, denoted by the darker shading, will increasingly contain more options for report authors and content creators to customize their solutions.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-288">
<div id="calibre_link-961" class="calibre2">
<div id="calibre_link-962" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Staged deployments</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Multiple application workspaces and their corresponding apps can be used to stage and manage the life cycle of Power BI content. Similar to the development, test, and production release cycles familiar to IT professionals, staged deployments in the Power BI service are used to isolate data, users, and content appropriate to each stage of the process. Effectively implementing a staged Power BI deployment serves to raise the quality of the content delivered as well as the productivity of project team members.</p>
<p class="calibre7">The following diagram and nine-step process describe the primary elements of a staged deployment life cycle:</p>
<div class="cdpalignleft"><img src="images/000296.png" class="calibre290" /></div>
<div class="mce-root2">Staged deployment life cycle</div>
<ol class="calibre12">
<li class="chapter">A development app workspace is created and Power BI content is built into the workspace:</li>
</ol>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13">A Power BI Desktop file containing the dataset is published to the development workspace</li>
<li class="calibre13">Reports are developed in Power BI Desktop based on Live connections to the development workspace dataset</li>
<li class="calibre13">Dashboards are created within the development workspace in the Power BI service</li>
</ul>
</li>
</ul>
<ol start="2" class="calibre12">
<li class="chapter">An app is published or updated and made available to a small number of users for their review</li>
<li class="chapter">The BI manager or project lead reviews the status of content being developed and provides feedback to the developers:</li>
</ol>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13">In other scenarios, certain business stakeholders are allowed early access to content under development</li>
</ul>
</li>
</ul>
<ol start="4" class="calibre12">
<li class="chapter">The Power BI REST API is used to migrate completed content from the development workspace to the test workspace:</li>
</ol>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13">Supported REST API operations, such as a clone report and a rebind report, are called via PowerShell scripts</li>
</ul>
</li>
</ul>
<ol start="5" class="calibre12">
<li class="chapter">A <strong class="calibre6">TEST App</strong> is published or updated and made available to a small number of users for their review</li>
<li class="chapter">A <strong class="calibre6">user acceptance testing</strong> (<strong class="calibre6">UAT</strong>) user or team reviews the content relative to requirements and provides feedback:</li>
</ol>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13">If necessary, revisions are implemented in the <strong class="calibre6">TEST</strong><strong class="calibre6"> Workspace</strong> and the <strong class="calibre6">TEST</strong><strong class="calibre6"> App</strong> is updated for further review</li>
</ul>
</li>
</ul>
<ol start="7" class="calibre12">
<li class="chapter">The Power BI REST API is used to migrate approved content from the <strong class="calibre6">TEST</strong><strong class="calibre6"> Workspace</strong> to the production workspace:</li>
</ol>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13">Supported REST API operations, such as a clone report and rebind report, are called via PowerShell scripts</li>
</ul>
</li>
</ul>
<ol start="8" class="calibre12">
<li class="chapter">A production app is published or updated and made available to groups of users for their consumption:</li>
</ol>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13">Publishing and accessing apps is described in <a href="#calibre_link-36" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em></li>
</ul>
</li>
</ul>
<ol start="9" class="calibre12">
<li class="chapter">Groups of business users access and consume the dashboards and reports via the production app from any device:</li>
</ol>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13">Measuring and monitoring the usage of the published app is also described in <a href="#calibre_link-36" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em></li>
</ul>
</li>
</ul>
<p class="calibre7">Creating and managing app workspaces as well as publishing apps for testing or consumption are all simple processes that can be handled via the user interface in the Power BI service. Properly utilizing the Power BI REST API to copy or migrate content across workspaces, however, requires some level of custom scripting. IT organizations familiar with managing Azure and on-premises resources via Windows PowerShell can leverage these skills as well as sample scripts provided by the Power BI team as per the <em class="calibre16">Power BI REST API</em> section later in this chapter.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-289">
<div id="calibre_link-963" class="calibre2">
<div id="calibre_link-964" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Workspace datasets</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As per the staged deployment life cycle diagram, this architecture requires distinct Power BI datasets per app workspace. To minimize resource usage and for data security reasons, the development workspace dataset could include the minimal amount of data necessary and exclude all sensitive data. This would allow the organization to comfortably provide development access to teams of content developers, potentially from outside of the organization. Access to the test workspace could be limited to a small number of trusted or approved users within the organization and thus could include sensitive data. Finally, the production workspace dataset would have the same schema as the other datasets but include the full volume of data as well as sensitive data.</p>
<p class="calibre7"><span>If a common schema exists between the different datasets in each workspace, the source dataset of a Power BI Desktop report file can be revised to a dataset in a separate workspace as per the <em class="calibre16">Switching source datasets</em> section in <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>.</span></p>
<p class="calibre7"><span>For example, the report file (<kbd class="calibre15">.pbix</kbd>) approved for migration from the development workspace to the test workspace could be opened, modified to reference the test workspace dataset, and then published to the test workspace. This approach represents a manual alternative to the Power BI REST API described in the following section.</span></p>
<p class="calibre7"><span>A new feature is expected in 2018 that will allow a Power BI report to reference a dataset in an external app workspace. The availability of this feature will help eliminate the resource cost and manageability issues of duplicated datasets across multiple app workspaces.</span></p>
<p class="calibre7"><span>For example, distinct Power BI apps developed for the finance, sales, and marketing teams could all leverage a single production dataset in a dedicated workspace rather than individual datasets within each workspace. The availability and implementation of this feature will revise the architecture of staged deployments of Power BI content via large Power BI datasets.</span></p>
<p class="calibre7">Another alternative to avoid the duplication of a dataset across multiple apps is Analysis Services. With Analysis Services, either on-premises via SSAS or in the cloud via AAS, Power BI reports can be created with Live connections to development, test, and production data models. Information on utilizing Analysis Services and its advantages as the data modeling tool and engine for Power BI is included in <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling with Premium and Analysis Services.</em></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-290">
<div id="calibre_link-965" class="calibre2">
<div id="calibre_link-966" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI REST API</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The Power BI REST API provides programmatic access to resources in the Power BI service including content (datasets, reports, and dashboards), application workspaces, and the users of these resources. This access enables organizations to automate common workflows, such as cloning a report to a different workspace or triggering a dataset refresh operation via familiar tools, such as Windows PowerShell. The goal of the REST API is to fully support all functionality available in the Power BI service, including capabilities exclusive to the Power BI admin portal, thus providing complete administrative and automation capabilities. The following URL provides updated documentation on the REST API including the request syntax and a sample result set for each operation: <a href="http://bit.ly/2AIkJyF" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2AIkJyF</a>.</p>
<p class="calibre7"><span>As more REST API operations are developed, they will initially be exposed exclusively via REST API calls. This allows organizations comfortable with the programmatic interface to get started with automation scripts and for a user interface to be developed on top of the API operations. The following sections describe the components needed to get started with the REST API, including the ID for a registered application, the IDs for core Power BI objects, and sample PowerShell scripts provided by the Power BI team.</span></p>
<div class="packt_infobox">Windows PowerShell is a task-based command-line shell and scripting language. It's primarily used by system administrators to automate administrative tasks. For example, PowerShell script files (<kbd class="calibre43">.ps1</kbd>) are commonly used in scheduled data refresh processes for SSAS models.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-291">
<div id="calibre_link-967" class="calibre2">
<div id="calibre_link-968" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Client application ID</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">To use the Power BI REST API, a client application ID must be obtained by registering an application with Azure Active Directory. This registration can be completed via the four-step process at the following portal: <a href="https://dev.powerbi.com/apps" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://dev.powerbi.com/apps</a>:</p>
<ol class="calibre12">
<li class="chapter">Sign in with the Azure Active Directory account:</li>
</ol>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13">This is the account used for logging into the Power BI service</li>
</ul>
</li>
</ul>
<ol start="2" class="calibre12">
<li class="chapter">Describe the application being registered:</li>
</ol>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13">Provide an application name and <span>Home Page URL</span></li>
<li class="calibre13">Select <span>Native app</span> from the <span>App Type</span> dropdown</li>
<li class="calibre13">Use the following <span>Redirect URL</span>: <kbd class="calibre15">urn:ietf:wg:oauth:2.0:oob</kbd></li>
</ul>
</li>
</ul>
<ol start="3" class="calibre12">
<li class="chapter">Choose the Power BI APIs to access:</li>
</ol>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13">Select all available boxes (<span>Dataset APIs</span>, <span>Report and Dashboard APIs</span>, and <span>Other APIs</span>)</li>
</ul>
</li>
</ul>
<ol start="4" class="calibre12">
<li class="chapter">Click <span>Register App</span></li>
</ol>
<p class="calibre7">Once the app is registered, the <span>Client ID</span> required for authentication will be exposed at the bottom, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000306.png" class="calibre291" /></div>
<div class="mce-root2">Power BI app Registration portal</div>
<p class="calibre7">Alternatively, an application can be registered via the <span>App registrations</span> menu of Azure Active Directory. Registered applications can be managed in the Azure portal, as shown in the following screenshot of the <span>Frontline Power BI Automation</span> app:</p>
<div class="cdpalignleft"><img src="images/000316.png" class="calibre292" /></div>
<div class="mce-root2">Registered app in Azure Active Directory</div>
<p class="calibre7">In addition to the <span>Application ID</span> property, which is the <span>Client ID</span> to use for authentication, the <span>Required permissions</span> menu in Azure Active Directory provides access to all Power BI APIs including those currently in preview. For example, the permissions of the <span>Frontline Power BI Automation</span> app from the preceding image could be expanded to include the view all reports API currently in preview.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-292">
<div id="calibre_link-969" class="calibre2">
<div id="calibre_link-970" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Workspace and content IDs</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In addition to the client ID of the registered application, the REST API operations require an ID associated with the given object or collection of objects referenced by the API operation. For example, to clone a report to a separate app workspace and then bind the report to a dataset in the new workpace, the IDs (GUID values) associated with the report, the source and target workspace, and the dataset must be obtained. These ID values can then can be passed into the variables of PowerShell script files and executed on demand or as part of a scheduled process, such as with dataset refresh operations.</p>
<p class="calibre7">The IDs for Power BI objects can be obtained by executing scripts which reference the appropriate REST API, such as Get Reports. Alternatively, the necessary IDs can be found by navigating to the specific object or collection of objects in the Power BI service and noting the URL.</p>
<p class="calibre7">For example, to retrieve both the group ID and the dataset ID, navigate to an app workspace and open the <span>Settings</span> menu for a dataset, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000326.png" class="calibre293" /></div>
<div class="mce-root2">Access to dataset Settings</div>
<p class="calibre7">In this example, opening the <span>Settings</span> menu for the <kbd class="calibre15">AdWorks Enterprise</kbd> dataset of the <kbd class="calibre15">AdWorks Global Sales</kbd> workspace results in the following URL in the address bar of the browser <kbd class="calibre15">https://app.powerbi.com/groups/c738f14c-648d-47f5-91d2-ad8ef234f49c/settings/datasets/61e21466-a3eb-45e9-b8f3-c015d7165e57</kbd></p>
<p class="calibre7">Based on this URL, the following two IDs can be used in PowerShell scripts calling the REST APIs:</p>
<ul class="calibre12">
<li class="calibre13"><kbd class="calibre15">AdWorks Global Sales</kbd> (app workspace): <kbd class="calibre15">c738f14c-648d-47f5-91d2-ad8ef234f49c</kbd></li>
<li class="calibre13"><kbd class="calibre15">AdWorks Enterprise</kbd> (dataset): <kbd class="calibre15">61e21466-a3eb-45e9-b8f3-c015d7165e57</kbd></li>
</ul>
<p class="calibre7">Just as the terms <em class="calibre16">groups </em>and <em class="calibre16">datasets </em>precede the IDs for these objects, respectively, the term <em class="calibre16">reports </em>precedes the ID for a specific report the URL when a report is selected in the Power BI service.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-293">
<div id="calibre_link-971" class="calibre2">
<div id="calibre_link-972" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">PowerShell sample scripts</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Several self-documenting sample PowerShell scripts that leverage the Power BI REST API are available at the following GitHub repository <a href="https://github.com/Azure-Samples/powerbi-powershell" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://github.com/Azure-Samples/powerbi-powershell</a>.</p>
<p class="calibre7">As shown in the following screenshot, this repository includes PowerShell scripts (<kbd class="calibre15">.ps1</kbd> files) for the refresh of a dataset, the rebinding of a report (to a dataset), and other common use cases:</p>
<div class="cdpalignleft"><img src="images/000336.png" class="calibre294" /></div>
<div class="mce-root2">Power BI REST API samples</div>
<p class="calibre7">In addition to Windows PowerShell or the PowerShell <strong class="calibre6">Integrated Scripting Environment</strong> (<strong class="calibre6">ISE</strong>), Azure PowerShell cmdlets must also be installed to execute the REST API scripts. The following links can be used to install the necessary components:</p>
<ul class="calibre12">
<li class="calibre13">Windows PowerShell: <a href="http://bit.ly/2FkaSmc" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">http://bit.ly/2FkaSmc</a></li>
<li class="calibre13">Azure PowerShell cmdlets: <a href="https://aka.ms/webpi-azps" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">https://aka.ms/webpi-azps</a></li>
</ul>
<p class="calibre7"><span>The necessary cmdlets can also be installed from PowerShell via the following commands:</span></p>
<pre class="calibre19"><strong class="calibre6">Install-Module AzureRM</strong><br class="calibre3" /><strong class="calibre6">Install-Module AzureAD</strong></pre>
<p class="calibre7">The variables in each sample advise of the parameters needed to successfully execute the script, such as the client ID of the registered application. The following sample script includes a variable for the client ID of the registered application described earlier and a function for authenticating against Azure Active Directory with this client ID:</p>
<pre class="calibre19">$clientId = " FILL ME IN " <br class="calibre3" />function GetAuthToken<br class="calibre3" />{<br class="calibre3" />    $adal = "${env:ProgramFiles}\WindowsPowerShell\Modules\AzureRM.profile\4.1.1\Microsoft.IdentityModel.Clients.ActiveDirectory.dll"<br class="calibre3" />    $adalforms = "${env:ProgramFiles}\WindowsPowerShell\Modules\AzureRM.profile\4.1.1\Microsoft.IdentityModel.Clients.ActiveDirectory.WindowsForms.dll"<br class="calibre3" />    [System.Reflection.Assembly]::LoadFrom($adal) | Out-Null<br class="calibre3" />    [System.Reflection.Assembly]::LoadFrom($adalforms) | Out-Null<br class="calibre3" />    $redirectUri = "urn:ietf:wg:oauth:2.0:oob"<br class="calibre3" />    $resourceAppIdURI = "https://analysis.windows.net/powerbi/api"<br class="calibre3" />    $authority = "https://login.microsoftonline.com/common/oauth2/authorize";<br class="calibre3" />    $authContext = New-Object "Microsoft.IdentityModel.Clients.ActiveDirectory.AuthenticationContext" -ArgumentList $authority<br class="calibre3" />    $authResult = $authContext.AcquireToken($resourceAppIdURI, $clientId, $redirectUri, "Auto")<br class="calibre3" />    return $authResult<br class="calibre3" />}<br class="calibre3" />$token = GetAuthToken</pre>
<p class="calibre7">The sample PowerShell script files can be edited to contain the appropriate variable (for example, client IDs and group IDs) and then saved to a secure network location. The user with rights to the Power BI resources, such as a BI manager or an IT administrator assigned the Power BI admin role, can run the PowerShell scripts as an administrator.</p>
<p class="calibre7">A top use case for the Power BI REST API is to synchronize the data refresh of Power BI datasets with the refresh process of data sources utilized by those datasets. For example, the refresh for certain production datasets in the Power BI service can be dynamically triggered to begin once the update process for a data source is completed, such as a nightly data warehouse <strong class="calibre6">extract-transform-load</strong> (<strong class="calibre6">ETL</strong>) or <strong class="calibre6">extract-load-transform</strong> (<strong class="calibre6">ELT</strong>) process or job. This synchronization ensures that Power BI reports and dashboards reflect the latest possible updates.</p>
<p class="calibre7">Additionally, the dynamic refreshes help to eliminate variances between Power BI reports and dashboards and any reporting tools which generate queries directly against the data source. Data refresh synchronization, along with incremental data refresh (expected in 2018), reduces one of the advantages of DirectQuery datasets relative to import mode datasets.</p>
<div class="packt_infobox">The refresh dataset API requires the group ID for the given app workspace and the dataset ID. These values can be obtained manually as per the <em class="calibre16">Workspace and content IDs</em> section earlier or via the Get Groups and Get datasets API operations, respectively. The following URL contains documentation on the <em class="calibre16">Refresh dataset</em> operation: <a href="http://bit.ly/2EpWLKL" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2EpWLKL</a></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-294">
<div id="calibre_link-973" class="calibre2">
<div id="calibre_link-974" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dashboard data classifications</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Dashboard data classifications allow administrators of Power BI to define data security classifications for dashboards in the Power BI service. Once configured in the Power BI admin portal, Power BI Pro users responsible for creating and editing dashboards in app workspaces can associate one of the available classifications to each dashboard. Additionally, the classification tags can be linked to external URLs to provide users with additional information, such as the organization's definitions and policies for each data classification.</p>
<p class="calibre7"><span>The data security tags, such as <span>Confidential</span> or <span>Public</span>, serve to raise awareness regarding the sensitivity of the content and thus reduce the risk that protected data is inappropriately exposed or distributed.</span></p>
<p class="calibre7"><span>For example, an organization could allow certain security groups of users to share Power BI content with users outside of the organization but, as an organizational policy, require that this content matches certain data classifications, such as public or low business impact.</span></p>
<p class="calibre7"><span>In the following screenshot from the Pow</span>er BI admin portal, fo<span>ur dashboard data classifications have been configured:</span></p>
<div class="cdpalignleft"><img src="images/000346.png" class="calibre295" /></div>
<div class="mce-root2">Dashboard data classifications</div>
<p class="calibre7">In the preceding example, the <span>Organizational</span> classification has been defined as the default data classification. This setting causes all new dashboards and any existing dashboard which have not been assigned to a different classification to be tagged as <span>Organizational</span>. For usability and reference purposes, a three-letter shorthand acronym and a URL link to a corporate site have been assigned to each classification, respectively.</p>
<div class="packt_infobox"><span>The Powe</span>r BI admin portal <span>can be accessed via the Settings (gear) icon in the top-right corner of the Power BI service. Only Office 365 global admins or users mapped to the Power BI admin role will have visibility to tenant settings within the Power BI a</span>dmin portal, wh<span>ich includes data classification for dashboards.<br class="calibre3" />
<br class="calibre3" />
<a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization</em>, reviews the Power BI admin role as well as the settings available in the Power BI </span>admin portal <span>extensively. Additionally, the <em class="calibre16">Power BI project roles</em> section in <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>, introduces the Power BI admin role and contains an example of assigning the Power BI service administrator role to a user in the Office 365 admin center.</span></div>
<p class="calibre7">With the data classifications for the organization configured, a user with edit rights to a dashboard can assign a classification via the <span>Dashboard settings</span> menu, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000356.png" class="calibre296" /></div>
<div class="mce-root2">Dashboard settings</div>
<p class="calibre7">In the preceding example for the <kbd class="calibre15">Global Sales</kbd> dashboard, the default <span>Organizational</span> classification is switched to <span>Confidential</span>. The <span>Dashboard settings</span> menu can be accessed from within a dashboard by clicking the ellipsis (three dots) to the right of the <span>Web view</span>/<span>Phone view</span> dropdown. Alternatively, the settings for a dashboard can be accessed from outside the dashboard via the gear icon in the <span>ACTIONS</span> group within the app workspace.</p>
<p class="calibre7">In the following screenshot, the shorthand tag of the <span>Data classification</span> assigned to each dashboard is populated in the workspace:</p>
<div class="cdpalignleft"><img src="images/000366.png" class="calibre297" /></div>
<div class="mce-root2">Dashboards in app workspace</div>
<p class="calibre7">Just like the icons under the <span>ACTIONS</span> group, hovering the cursor over the <span>CLASSIFICATION</span> tag (for example, <span>CON</span>,) creates a pointing icon and displays the full name of the classification (<span>Confidential</span>) as a tool tip. Clicking the tag will open the URL associated with the given classification in a separate browser tab.</p>
<div class="packt_infobox">Data classifications are deleted if the feature is turned off in the the Power <span>Admin Portal</span>. Additionally, if a classification is removed, any dashboards assigned to the removed classification will be assigned back to the default until the dashboard owner changes the classification. Finally, if the default classification is changed, all dashboards that weren't already assigned a classification type will change to the new default.<br class="calibre3" />
<br class="calibre3" />
Given the importance of data security and the risk involved in re-creating work for both the Power BI Admin(s) and report and dashboard authors, the teams responsible for deploying Power BI should ensure these classifications align with corporate data governance standards.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-295">
<div id="calibre_link-975" class="calibre2">
<div id="calibre_link-976" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Version control</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Version history and source control are very common, highly valued elements of an IT organization's <strong class="calibre6">application lifecycle management</strong> (<strong class="calibre6">ALM</strong>).</p>
<p class="calibre7">For example, changes to an Analysis Services data model, such as new DAX measures, are typically committed to a source control repository and tools such as <strong class="calibre6">Visual Studio Team Services</strong> (<strong class="calibre6">VSTS</strong>) provide features for teams to manage and collaborate on these changes. Perhaps most importantly, these tools enable teams to view and revert back to prior versions.</p>
<p class="calibre7">Power BI Desktop files (<kbd class="calibre15">.pbix</kbd>) do not integrate with these robust systems and are not expected to in the foreseeable future. As an alternative, Microsoft recommends <span>OneDrive for Business, given it's support for version history and its current 15 GB file size limit. Additionally, for longer term and larger scale projects, BI teams can optionally persist the core DAX and M code contained in a dataset into a structure suitable for implementing source control.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-296">
<div id="calibre_link-977" class="calibre2">
<div id="calibre_link-978" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">OneDrive for Business version history</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In the following screenshot, a Power BI Desktop file containing an import mode dataset has been uploaded to a <kbd class="calibre15">OneDrive for Business</kbd> folder:</p>
<div class="cdpalignleft"><img src="images/000376.png" class="calibre298" /></div>
<div class="mce-root2">OneDrive for Business file options</div>
<p class="calibre7">Selecting the ellipsis (three dots) exposes several file options including <span>Version history</span>. As changes are implemented and saved in the PBIX file, such as a revised DAX measure or a new M query, the updated PBIX file could be uploaded to <kbd class="calibre15">OneDrive for Business</kbd>. Given the same name as the existing file, <kbd class="calibre15">OneDrive for Business</kbd> will require the user to confirm that the file should be replaced, as illustrated in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000385.png" class="calibre299" /></div>
<div class="mce-root2">Uploading updated PBIX file</div>
<p class="calibre7">Once the replacement is confirmed, only the new file is accessible from the folder but the prior file and other versions of the file are still accessible via <span>Version history</span>. As shown in the following screenshot, t<span>he <span>Version History</span> window makes it easy to view the history of changes to a file and to restore an earlier version:</span></p>
<div class="cdpalignleft"><img src="images/000395.png" class="calibre300" /></div>
<div class="mce-root2">File options in Version History</div>
<p class="calibre7">In this example, selecting the ellipsis (three dots) for the Version <span>1.0</span> row exposes three file options, including <span>Restore</span>. Selecting <span>Restore</span> creates a new version (Version 4.0), which is an exact copy of the file restored. This restored file replaces the current file accessible in the <kbd class="calibre15">OneDrive for Business</kbd> folder. Finally, from the standard folder view in <kbd class="calibre15">OneDrive for Business</kbd>, the <span>Download</span> option displayed in the first image of this section can be used to retrieve the restored PBIX file.</p>
<div class="packt_infobox">As described in the <em class="calibre16">Live connections to Power BI datasets</em> section in <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>, reports should be created with Power BI Desktop files rather than within the Power BI service to enable <span>Version history</span>. However, as per the previous chapter, dashboards are exclusively created within the Power BI service. Therefore, while <span>Version history</span> can be maintained with datasets and reports, <span>Version history</span> is currently not possible with dashboards.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-297">
<div id="calibre_link-979" class="calibre2">
<div id="calibre_link-980" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Source control for M and DAX code</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Although the version history of M and DAX code within Power BI Desktop files is technically available via OneDrive for Business, some BI organizations may also choose to utilize more robust version control tools on essential queries and measures. For example, the M query used to retrieve the Customer dimension table could be saved as a <kbd class="calibre15">.pq</kbd> file and synchronized with a team project code repository in VSTS. This approach would improve the visibility of the code to project team members and, for M queries, provide the code editing benefits of colorization and IntelliSense.</p>
<p class="calibre7">In the following screenshot, a Power Query project containing multiple folders of PQ files (M queries) has been added to a solution in Visual Studio and synchronized with a Git repository in a VSTS project:</p>
<div class="cdpalignleft"><img src="images/000405.png" class="calibre301" /></div>
<div class="mce-root2">Power Query project in Visual Studio</div>
<p class="calibre7">In this example, all M queries (<kbd class="calibre15">.pq</kbd> files) are checked into source control via the lock icon in the <span>Solution Explorer</span> window except for the Customer query which is pending an edit (checkmark icon). The revised Customer dimension table query would be implemented within the Power BI Desktop file first but also saved within the Power Query project in Visual Studio.</p>
<p class="calibre7">As an enterprise tool, many version control options are available in Visual Studio, including <span>Compare with Unmodified...</span> and <span>Blame (Annotate)</span>. By clicking <span>Commit</span>, a message describing the change can be entered and the updated file can be synced to the source control repository in VSTS.</p>
<p class="calibre7">In the following screenshot from VSTS, the updated Customer dimension query file (<kbd class="calibre15">Customer.pq</kbd>), including the latest commit date (<span>5 minutes ago</span>), is visible:</p>
<div class="cdpalignleft"><img src="images/000415.png" class="calibre302" /></div>
<div class="mce-root2"><strong class="calibre6">Files view in VSTS</strong></div>
<p class="calibre7">Given the additional maintenance overhead, enterprise source control tools may not be suitable for smaller, simpler Power BI projects or the very early stages of projects. In addition to sound requirement gathering efforts, teams can minimize the maintenance effort required of the version control project by only including the essential M queries and DAX measures. For example, only the DAX measures containing fundamental business logic, such as the base measures described in <a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em>, could be saved as (<kbd class="calibre15">.msdax</kbd>) files.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-298">
<div id="calibre_link-981" class="calibre2">
<div id="calibre_link-982" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Metadata management</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As Power BI projects grow to support more teams and business processes, the dataset(s) supporting the reports and dashboards for these projects will also grow. For example, integrating the general ledger into the existing <kbd class="calibre15">AdWorks Enterprise</kbd> dataset would require new fact and dimension tables, new relationships, and additional measures with their own unique business rules or definitions. Additionally, it's common for hundreds of DAX measures to be built into datasets over time to support more advanced analytics and address new requirements.</p>
<p class="calibre7">Given this added complexity, BI teams and specifically the dataset designer described in <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects </em>can embed descriptions to aid report authors incorrectly utilizing the data model. Additionally, the <strong class="calibre6">dynamic management views</strong> (<strong class="calibre6">DMVs</strong>) for Analysis Services models can be leveraged to generate metadata reports providing detailed visibility to all essential objects of the dataset. The combination of field descriptions and metadata reporting can help drive consistent report development as well as facilitate effective collaboration within the project team and between the project team and other stakeholders.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-299">
<div id="calibre_link-983" class="calibre2">
<div id="calibre_link-984" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Field descriptions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>A <span>FIELD PROPERTIES </span>pane in the Report view of Power BI Desktop allows dataset designers to enter descriptions for the measures, columns, and tables of a dataset. This metadata is then exposed to report authors who connect to this dataset as they hover over these objects in the <span>FIELDS</span> list and within the input field wells of visualizations. Although field descriptions are not a full substitute for formal documentation, descriptions of the logic, definition, or calculation of various objects enable report authors to develop content more efficiently. For example, rather than searching an external resource such as a data dictionary or contacting the dataset designer, the report author could simply hover over measures and column names from within Power BI Desktop.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-300">
<div id="calibre_link-985" class="calibre2">
<div id="calibre_link-986" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Creating descriptions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">To create a description, open the Power BI Desktop file containing the dataset and enable the <span>FIELD PROPERTIES </span>pane under the <span>View</span> tab of the Report view. In the following screenshot, the <kbd class="calibre15">Internet Gross Sales</kbd> measure is selected on the <span>FIELDS</span> List and a sentence is entered into the description box of the <span><span>FIELD PROPERTIES</span></span> pane:</p>
<div class="cdpalignleft"><img src="images/000425.png" class="calibre303" /></div>
<div class="mce-root2"><span>FIELD PROPERTIES </span>pane</div>
<p class="calibre7">Just like the preceding example with measures, selecting a table or a column in the <span>FIELDS</span> list will expose the name of this object and a description box in the <span><span>FIELD PROPERTIES</span></span> pane. Table and column descriptions can be valuable but measures are likely the best use case for this feature given the volume of measures in a dataset and the variety of calculations or logic they can contain.</p>
<div class="packt_tip pcalibre7 pcalibre6">Identify the most important measures in a dataset and apply concise, consistent descriptions using business-friendly terms. The set of measures described in the <em class="calibre16">Base measures</em> section of <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em>,would represent good candidates for descriptions as these measures are often reused in many other custom measures, such as date intelligence measures. For example, it's essential that the report author knows that the net sales measure includes discounts while the gross sales measure does not.</div>
<p class="calibre7">Although the <span>Name</span> field in the <span><span>FIELD PROPERTIES</span></span> pane can also be used to revise the names for measures, columns, and tables, this is rarely necessary as these changes can be implemented in other ways. Particularly for tables and columns, the Power Query Editor described in <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>, should be used to define table and column names<em class="calibre16">.</em></p>
<div class="packt_infobox">It's likely that a future release of Power BI Desktop will expose the <span><span>FIELD PROPERTIES</span></span> window to the Data view and/or the Relationships view as well. Additionally, other metadata properties may be added to the <span><span>FIELD PROPERTIES</span></span> pane, such as formatting and data categories, giving dataset designers a more centralized and robust means to configure dataset objects.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-301">
<div id="calibre_link-987" class="calibre2">
<div id="calibre_link-988" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">View field descriptions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The descriptions embedded in Power BI datasets can be viewed in the <span>FIELDS</span> lists, the input field wells of visualizations, and the <span><span>FIELD PROPERTIES</span></span> pane as well. With a Power BI report based on a Live connection to a published Power BI dataset, as described in the <em class="calibre16">Live connections to Power BI datasets</em> section in <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>, the report author can view but not edit the descriptions.</p>
<p class="calibre7">In the following screenshot, the report author has built a matrix visual and hovers over the <kbd class="calibre15">Customer History Segment</kbd> column used in the <span>Rows</span> input field well:</p>
<div class="cdpalignleft"><img src="images/000007.png" class="calibre304" /></div>
<div class="mce-root2">Field description via visualization field wells</div>
<p class="calibre7">As shown in the preceding image, the report author can view the description of the field (column or measure) via the tool tip to understand the essential definition, such as first purchase date relative to current date in this example. Likewise, the author can also hover over the <kbd class="calibre15">Internet Gross Sales</kbd> measure in the <span>Values</span> field well to view this description or hover over the measures, columns, and table names in the in the <span>FIELDS</span> list, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000018.png" class="calibre305" /></div>
<div class="mce-root2">Description of measure via FIELDS list</div>
<p class="calibre7">For the <kbd class="calibre15">Internet Gross Product Margin</kbd> measure and other measures in the dataset, the description applied uses proper casing when referring to DAX measures. This approach helps to keep each description concise and advises the user of the other measures they may need to review. In this example, the user may need to hover over the <kbd class="calibre15">Internet Gross Sales</kbd> measure and/or the <kbd class="calibre15">Internet Sales Product Cost</kbd> measure to fully understand the <kbd class="calibre15">Internet Gross Product Margin</kbd> measure.</p>
<div class="packt_infobox"><span>Although it's likely unnecessary, the report author can also view the descriptions via the <span>FIELD PROPERTIES</span> pane. When the <span>FIELD PROPERTIES</span> pane is enabled from a Live connection report, Power BI Desktop advises that these properties are read-only given that they are from a model stored outside of the Power BI Desktop file.</span></div>
<p class="calibre7"><span>Field descriptions cannot be viewed by hovering over names or values in the visuals themselves on the report canvas. However, as per the <em class="calibre16">Visualization </em>f<em class="calibre16">ormatting</em> section of <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>, chart visuals contain a <span>Tooltips</span> input field well that provide a very similar experience to viewing field descriptions. <span>Tooltips</span> are typically used to display DAX measures related to the measures in the visual, such as the net margin percentage for a chart that visualizes net sales. However, measures can also return text strings and, thus, if necessary to aid the users viewing reports, measures can be created containing field descriptions and utilized as <span>Tooltips</span>.</span></p>
<p class="calibre7">In the following screenshot, a DAX measure containing the description of the <kbd class="calibre15">Internet Gross Product Margin</kbd> measure is used as an input to the <span>Tooltips</span> field well:</p>
<div class="cdpalignleft"><img src="images/000027.png" class="calibre306" /></div>
<div class="mce-root2">Field description measure as tooltip</div>
<p class="calibre7">In the preceding screenshot, hovering over the individual columns (or points if a line chart) displays the description built into the dedicated measure (<kbd class="calibre15">Internet Gross Product Margin</kbd> description). Although potentially useful for report consumers, BI teams should be cautious that the DAX measures used for descriptions are isolated from the actual field descriptions. Therefore, in the event of a change in description, both the description measure and the field description would need to be updated. Additionally, if measures containing descriptions are used extensively, a dedicated measure support table, as described in <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>, and <a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em>, may be necessary to organize these measures.</p>
<div class="packt_infobox">Field descriptions applied to Analysis Services data models will also flow through to Power BI reports just like the examples in this section with a Power BI dataset. However, <span>field descriptions applied to Power BI datasets are not visible when connecting via Microsoft Excel.</span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-302">
<div id="calibre_link-989" class="calibre2">
<div id="calibre_link-990" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Metadata reporting</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Analysis Services DMVs are available to retrieve the descriptions applied to datasets and related information. These DMVs can be leveraged for both simple, ad hoc extracts via common dataset tools, such as DAX Studio, as well as more robust and standardized reports in Power BI or Excel. Official documentation of Analysis Services DMVs, including a reference and description of each DMV, query syntax, and client-tool access is available via the following link: <a href="http://bit.ly/2A81lek" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2A81lek</a></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-303">
<div id="calibre_link-991" class="calibre2">
<div id="calibre_link-992" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Query field descriptions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The following query can be used to retrieve the measures in a dataset with descriptions as well as their DAX expression:</p>
<pre class="calibre19"><span>SELECT</span> <br class="calibre3" /><span>       [Name]</span> as <span>[Measure Name]</span><br class="calibre3" />  ,    <span>[Description]</span> as <span>[Measure Description]</span> <br class="calibre3" />  ,    <span>[Expression]</span> as <span>[DAX Expression]</span><br class="calibre3" /><span>FROM</span><br class="calibre3" /><span>$SYSTEM</span>.TMSCHEMA_MEASURES<br class="calibre3" />WHERE <span>LEN</span>(<span>[Description]</span>) &gt; <span>1</span><br class="calibre3" /><span>ORDER</span> <span>BY</span> <span>[NAME]</span>; </pre>
<p class="calibre7">As shown in the following screenshot, the query can be executed from DAX Studio against the open Power BI Desktop file:</p>
<div class="cdpalignleft"><img src="images/000035.png" class="calibre307" /></div>
<div class="mce-root2">Measure descriptions via DMV query in DAX Studio</div>
<p class="calibre7">The <kbd class="calibre15">WHERE</kbd> clause in this query ensures that only measures with a description applied are returned. Removing or commenting out this clause (for example, <kbd class="calibre15">--WHERE LEN([Description]) &gt; 1</kbd>) will return all measures whether they have a description or not. Additionally, column aliases of <kbd class="calibre15">Measure Name</kbd>, <kbd class="calibre15">Measure Description</kbd>, and <kbd class="calibre15">DAX Expression</kbd> improve the usability of the DMV columns.</p>
<p class="calibre7">Just as measure descriptions can be retrieved via the the <kbd class="calibre15">TMSCHEMA_MEASURES</kbd> DMV, the following query retrieves the column descriptions from the <kbd class="calibre15">TMSCHEMA_COLUMNS</kbd> DMV:</p>
<pre class="cdpaligncenter2"><span>SELECT</span><br class="calibre3" />       <span>[ExplicitName]</span> as <span>[Column Name]</span><br class="calibre3" />  ,    <span>[Description]</span> as <span>[Column Description]</span><br class="calibre3" /><span>FROM</span> <span>$SYSTEM</span>.TMSCHEMA_COLUMNS<br class="calibre3" />WHERE <span>LEN</span>(<span>[Description]</span>) &gt; <span>1</span><br class="calibre3" /><span>ORDER</span> <span>BY</span> <span>[ExplicitName]</span>;  </pre>
<p class="calibre7">As per the official documentation referenced earlier in this section, the query engine for DMVs is the Data Mining parser and the DMV query syntax is based on the <kbd class="calibre15">SELECT (DMX)</kbd> statement. Therefore, although the queries appear to be standard SQL statements, the full SQL <kbd class="calibre15">SELECT</kbd> syntax is not supported, including the <kbd class="calibre15">JOIN</kbd> and <kbd class="calibre15">GROUP BY</kbd> clauses. For example, it's not possible to join the <kbd class="calibre15">TMSCHEMA_COLUMNS</kbd> DMV with the <kbd class="calibre15">TMSCHEMA_TABLES</kbd> DMV within the same <kbd class="calibre15">SELECT</kbd> statement to retrieve columns from both DMVs. Given these limitations, it can be helpful to build lightweight data transformation processes on top of DMVs, as described in the following section.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-304">
<div id="calibre_link-993" class="calibre2">
<div id="calibre_link-994" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Standard metadata reports</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For larger datasets with many measures, relationships, and tables, a dedicated metadata report can be constructed using Power BI. In this approach, the Analysis Services data connector is used to access the DMVs of the Power BI dataset and this data is transformed via M queries. Finally, a set of report pages are created to visualize the primary objects of the model and support common ad hoc questions, such as which relationships use bidirectional cross-filtering?</p>
<p class="calibre7">Implementing the DMV-based Power BI report consists of the following four steps:</p>
<ol class="calibre12">
<li class="chapter">Obtain the server and database parameter values of the Power BI dataset</li>
<li class="chapter">Query the DMVs of the Power BI dataset from a separate Power BI Desktop file</li>
<li class="chapter">Integrate and enhance the DMV data to support the visualization layer</li>
<li class="chapter">Develop the report pages</li>
</ol>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-305">
<div id="calibre_link-995" class="calibre2">
<div id="calibre_link-996" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Server and database parameters</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The server value of the Power BI dataset is visible in the status bar (bottom-right corner) when connected to the dataset from DAX Studio, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000045.png" class="calibre308" /></div>
<div class="mce-root2">Server value of Power BI dataset via DAX Studio</div>
<p class="calibre7">In the following code, the server parameter is <span>localhost:52809</span>. To obtain the database parameter, run the following query in DAX Studio:</p>
<pre class="calibre19"> SELECT <br class="calibre3" />     <span>[CATALOG_NAME]</span><br class="calibre3" /> ,    <span>[DATABASE_ID]</span><br class="calibre3" /> FROM <span>$SYSTEM</span>.DBSCHEMA_CATALOGS </pre>
<p class="calibre7">Both columns will retrieve the same GUID value that can be used as the database parameter.</p>
<div class="packt_infobox">There are other methods of obtaining the server parameter, such as finding the process ID (PID) in <span>Task Manager</span> and then running <kbd class="calibre43">netstat -anop tcp</kbd> from Command Prompt to find the port associated with the PID. Connecting to the dataset from DAX Studio is more straightforward and it's assumed that experienced Power BI dataset designers will have at least a basic familiarity with DAX Studio.<br class="calibre3" />
<br class="calibre3" />
The server parameter (for example, <span>localhost:52809</span>) can also be used to connect to the running Power BI dataset via SQL Server Profiler. This can be useful for identifying the DAX queries generated by report visuals and user interactions. Alternatively, Power BI Desktop can generate a trace file via the <span>Enable tracing</span> setting within the <span>Diagnostics option</span> (<span>File </span>| <span>Options and Settings </span>| <span>Diagnostics</span>).</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-306">
<div id="calibre_link-997" class="calibre2">
<div id="calibre_link-998" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Querying the DMVs from Power BI</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">With the server and database known, parameters and queries can be created in Power BI Desktop to stage the DMV data for further transformations. In the following screenshot from the Power Query Editor, three query groups are used to organize the parameters, the DMV queries, and the enhanced queries (<kbd class="calibre15">Metadata Report Tables</kbd>) used by the report:</p>
<div class="cdpalignleft"><img src="images/000055.png" class="calibre309" /></div>
<div class="mce-root2">Power Query Editor in Power BI Desktop</div>
<p class="calibre7">As per the <kbd class="calibre15">TablesDMV</kbd> query, the two parameters (<kbd class="calibre15">AnalysisServicesServer</kbd> and <kbd class="calibre15">AnalysisServicesDatabase</kbd>) are passed to the <kbd class="calibre15">AnalysisServices.Database()</kbd> function for each DMV query. As indicated by the gray font of the DMV queries and the parameters, these queries are not loaded to the data model layer.</p>
<div class="packt_infobox">To update the metadata report in a future session to reflect changes to the dataset, the server and database parameter values would need to be retrieved again. These values could then be passed to the data model parameters, thus allowing all queries to update. This manual update process is necessary with Power BI Desktop files, given changes to the port and database ID, but is not necessary for metadata reports based on Analysis Services models.<br class="calibre3" />
<br class="calibre3" />
Given the small size of the DMV data and the limitations of SQL <kbd class="calibre43">SELECT</kbd> queries against DMV data, a simple <kbd class="calibre43">SELECT *</kbd> is used to expose all columns and rows. The <kbd class="calibre43">Metadata Report Table</kbd> queries contain all the joins and transformations to prepare the data for reporting.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-8">
<div id="calibre_link-999" class="calibre2">
<div id="calibre_link-1000" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Integrating and enhancing DMV data</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The following M query produces the <kbd class="calibre15">Relationships</kbd> table by implementing joins to retrieve the table and column names on each side of each relationship:</p>
<pre class="calibre19">let<br class="calibre3" />   FromTableJoin = Table.NestedJoin(<br class="calibre3" />      RelationshipsDMV,{"FromTableID"},TablesDMV,{"ID"},"TableDMVColumns", JoinKind.Inner),<br class="calibre3" />   FromTable = Table.ExpandTableColumn(FromTableJoin, "TableDMVColumns", {"Name"}, {"From Table"}),<br class="calibre3" />   ToTableJoin = Table.NestedJoin(<br class="calibre3" />      FromTable,{"ToTableID"},TablesDMV,{"ID"},"TableDMVColumns", JoinKind.Inner),<br class="calibre3" />   ToTable = Table.ExpandTableColumn(ToTableJoin, "TableDMVColumns", {"Name"}, {"To Table"}),<br class="calibre3" />   FromColumnJoin = Table.NestedJoin(<br class="calibre3" />      ToTable,{"FromColumnID"},ColumnsDMV,{"ID"},"ColumnsDMVColumns", JoinKind.Inner),<br class="calibre3" />   FromColumn = Table.ExpandTableColumn(FromColumnJoin, "ColumnsDMVColumns", <br class="calibre3" />      {"ExplicitName"}, {"From Column"}),<br class="calibre3" />   ToColumnJoin = Table.NestedJoin(<br class="calibre3" />      FromColumn,{"ToColumnID"},ColumnsDMV,{"ID"},"ColumnsDMVColumns", JoinKind.Inner),<br class="calibre3" />   ToColumn = Table.ExpandTableColumn(ToColumnJoin, "ColumnsDMVColumns", <br class="calibre3" />      {"ExplicitName"}, {"To Column"}),<br class="calibre3" />   CrossFilteringColumn = Table.AddColumn(ToColumn, "Cross-Filtering Behavior", each<br class="calibre3" />      if [CrossFilteringBehavior] = 1 then "Single Direction"<br class="calibre3" />      else if [CrossFilteringBehavior] = 2 then "Bidirectional" else "Other", type text),<br class="calibre3" />   RenameActiveFlag = Table.RenameColumns(CrossFilteringColumn,{{"IsActive", "Active Flag"}})<br class="calibre3" />in<br class="calibre3" />    RenameActiveFlag</pre>
<p class="calibre7">The Relationships DMV (<kbd class="calibre15">TMSCHEMA_RELATIONSHIPS</kbd>) includes table and column ID columns, which are used for the joins to the tables (<kbd class="calibre15">TMSCHEMA_TABLES</kbd>) and columns (<kbd class="calibre15">TMSCHEMA_COLUMNS</kbd>) DMVs, respectively. Additionally, a more intuitive cross-filtering behavior column is added based on a conditional (<kbd class="calibre15">if..then</kbd>) expression.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-21">
<div id="calibre_link-1001" class="calibre2">
<div id="calibre_link-1002" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Metadata report pages</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">With the enhanced DMV data loaded, report pages can be created, visualizing the most important columns. In the following screenshot, the table and column names retrieved via the M query joins in the previous section, <em class="calibre16">Integrating and</em> <em class="calibre16">enhancing the DMV data</em>, are included in a simple table visual:</p>
<div class="cdpalignleft"><img src="images/000065.png" class="calibre310" /></div>
<div class="mce-root2">Metadata report page</div>
<p class="calibre7">In the slicer visual on the left, the table is filtered to only display relationships in which the <kbd class="calibre15">Internet Sales</kbd> and <kbd class="calibre15">Product</kbd> tables are on the <span>From Table</span> side of the relationship. In other words, only the relationships in which the <kbd class="calibre15">Internet Sales</kbd> and <kbd class="calibre15">Product</kbd> tables are on the many side of a one-to-many relationship are displayed. The <kbd class="calibre15">Active Flag</kbd> column identifies the two inactive date relationships based on <kbd class="calibre15">Due Date</kbd> and <kbd class="calibre15">Ship Date</kbd>. Additionally, the cross-filtering behavior column and slicer makes it easy to identify any relationships with bidirectional cross-filtering enabled.</p>
<div class="packt_infobox">A Power BI Desktop file containing the M queries and report pages from this example is included with the code bundle for this book. Additionally, <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>, <em class="calibre16">Connecting to Sources and Transforming Data with M</em>, and <a href="#calibre_link-23" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em>, describe the essential concepts of M queries and relationships contained in this section, respectively.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-33">
<div id="calibre_link-1003" class="calibre2">
<div id="calibre_link-1004" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">This chapter introduced application workspaces and their fundamental role in managing and delivering Power BI content to groups of users in the Power BI service. A staged deployment architecture across development, test, and production workspaces was described, including calls to the Power BI REST API to manage this process. Additionally, several features and processes related to content management and governance were reviewed, including version history via OneDrive for Business, field descriptions, and accessing the DMVs of datasets to document datasets.</p>
<p class="calibre7">The next chapter examines the On-premises data gateway and the configuration of data refresh processes in the Power BI service. This includes the administration of the gateway, such as authorizing users and data sources, as well as monitoring gateway resource utilization.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-15">
<div id="calibre_link-1005" class="calibre2">
<div id="calibre_link-1006" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Managing the On-Premises Data Gateway</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For many organizations, the data sources for Power BI datasets or reports are located in on-premises environments. The On-premises data gateway provides a means to securely connect to these sources to support scheduled data refreshes or, in the case of DirectQuery and Analysis Services Live connections, only return the results of queries requested by users in the Power BI service. As a critical component of many Power BI solutions and potentially other solutions utilizing Microsoft cloud services, such as Azure Analysis Services, MS Flow, and PowerApps, a sound understanding of the On-premises data gateway is essential. </p>
<p class="calibre7">This chapter reviews the architecture and behavior of the On-premises data gateway in the context of Power BI. End-to-end guidance and best practices are provided across the primary stages of deployment, from planning to installation, and setup to management and monitoring.</p>
<p class="calibre7">In this chapter, we will review the following topics:</p>
<ul class="calibre12">
<li class="calibre13">On-premises data gateway planning </li>
<li class="calibre13">Gateway clusters and architectures</li>
<li class="calibre13">Configuration of the On-premises data gateway</li>
<li class="calibre13">Scheduled data refresh</li>
<li class="calibre13">Dashboard tile cache refresh</li>
<li class="calibre13">Managing gateway clusters</li>
<li class="calibre13">Monitoring gateway usage</li>
<li class="calibre13">Live connections to Analysis Services models</li>
<li class="calibre13">Single sign-on DirectQuery</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-307">
<div id="calibre_link-1007" class="calibre2">
<div id="calibre_link-1008" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">On-premises data gateway planning</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Planning for the On-premises data gateway involves identifying which data sources require a gateway and understanding the role of the gateway in each deployment scenario. For example, if an import mode Power BI dataset or an import mode Azure Analysis Services model simply needs to be refreshed with on-premises data every night, then gateway resources (hardware) should be provisioned to support this specific nightly workload. This deployment scenario, with the refreshed and in-memory data model hosted in the cloud, is preferable from a user experience or query performance standpoint, as the queries generated in the Power BI service do not have to access the on-premises source via the On-premises data gateway. </p>
<p class="calibre7">Alternatively, when the data model or data source accessed directly by Power BI reports is located in an on-premises environment, the On-premises data gateway is used to facilitate data transfer between the data source and the queries from the Power BI service. For example, a DirectQuery Power BI dataset built against an on-premises Teradata database results in report queries being sent from the Power BI service to the Teradata database via the On-premises data gateway and the results of those queries being returned to the Power BI service via the On-premises data gateway. This deployment scenario <span>can naturally require alternative gateway resources, such as additional CPU cores, given the</span> potentially high volume of queries being generated dynamically based on user activity.</p>
<div class="packt_infobox"><span>In addition to on-premises data sources, data sources residing in <strong class="calibre6">Infrastructure-as-a-Service</strong> (<strong class="calibre6">IaaS</strong>) <strong class="calibre6">virtual machines</strong> (<strong class="calibre6">VMs</strong>) also require a data gateway. This is an important exception as cloud data sources generally do not require a gateway. For example, <strong class="calibre6">Platform-as-a-Service</strong> (<strong class="calibre6">PaaS</strong>) sources, such as Azure SQL Database, and <strong class="calibre6">Software-as-a-Service</strong> (<strong class="calibre6">SaaS</strong>) solutions, such as Google Analytics, do not require a gateway.</span></div>
<p class="calibre7"><span>The following two sets of questions address essential, high-level planning topics including the administration of the installed gateway. The following section, <em class="calibre16">Top gateway planning tasks</em>, as well as the <em class="calibre16">Gateway architectures</em> section later in this chapter, contain higher detail to support gateway deployment:</span></p>
<ol class="calibre12">
<li class="chapter">Where is the data being used by the Power BI dataset?<br class="calibre3" />
<ul class="calibre17">
<li class="chapter">Confirm that a gateway is needed to access the data source from Power BI</li>
<li class="chapter">This access includes both scheduled data refresh and any DirectQuery or Live connections to the data source </li>
<li class="chapter">Additional details on sources requiring a gateway are provided in the next section</li>
</ul>
</li>
<li class="chapter">If a gateway is needed, is the data source supported with a <strong class="calibre6">generally available</strong> (<strong class="calibre6">GA</strong>) data connector? 
<ul class="calibre17">
<li class="chapter">If a source-specific connector is not available, the gateway supports <strong class="calibre6">Open Database Connectivity</strong> (<strong class="calibre6">ODBC</strong>) and OLE DB connections as well</li>
<li class="chapter">The current list of supported data sources is available at <a href="http://bit.ly/2EN1BCg" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">http://bit.ly/2EN1BCg</a></li>
<li class="chapter">Data connectors labeled as (<kbd class="calibre15">Beta</kbd>) in the <span>Get Data</span> window of Power BI Desktop should only be used for testing</li>
</ul>
</li>
<li class="chapter">Is the on-premises data or the IaaS data being imported to the Power BI dataset(s) or an Azure Analysis Services model?
<ul class="calibre17">
<li class="chapter">If yes, the gateway will support the scheduled refresh/processing activities for these datasets</li>
<li class="chapter">If no, the gateway will support user queries of the data source via DirectQuery or Live connections</li>
</ul>
</li>
<li class="chapter">Will a standard On-premises data gateway be used or will a personal gateway (personal mode) be used?
<ul class="calibre17">
<li class="chapter">In all corporate BI deployments, the default and recommended on-premises gateway will be installed by the IT organization on IT-owned and maintained servers. </li>
<li class="chapter">However, in certain business-led self-service projects or in scenarios in which an IT-owned gateway server is not available, the personal gateway could be installed on a business user's machine, allowing that user to configure scheduled refreshes of import mode datasets. </li>
</ul>
</li>
</ol>
<p class="calibre7"><span>A single gateway can be used to support multiple datasets, both import and DirectQuery. However, it can be advantageous to isolate the alternative Power BI workloads across distinct gateway clusters, such as with an import gateway cluster and a DirectQuery or Live connection gateway cluster. Without this isolation, the scheduled refresh activities of import mode datasets (Power BI or Azure Analysis Services) could potentially impact the performance of user queries submitted via DirectQuery and Live connection datasets. Additionally, as mentioned earlier, scheduled refresh activities can require far different gateway resources (for example, memory) than the queries generated via DirectQuery datasets or Live connections to on-premises <strong class="calibre6">SQL Server Analysis Services</strong> (<strong class="calibre6">SSAS</strong>) databases. </span></p>
<p class="calibre7">In addition to provisioning hardware and installing the gateway(s) for each scenario, BI teams must also plan for the administration and management of the gateway. Answering the following five questions contributes to planning the implementation:</p>
<ol class="calibre12">
<li class="chapter">Which users will administer the gateway in Power BI?
<ul class="calibre17">
<li class="chapter">This should be more than one user; preferably, a security group of multiple gateway admins can be configured</li>
<li class="chapter">These users do not need Power BI Pro licenses if they're only administering gateway clusters</li>
</ul>
</li>
</ol>
<div class="packt_infobox"><span>In larger Power BI deployments, distinct users or security groups could be assigned as administrators of different gateways. For example, two users could administer a gateway cluster utilized by enterprise or corporate-owned BI content while two other users could administer a gateway cluster used to support self-service BI content and projects.<br class="calibre3" />
<br class="calibre3" />
This isolation of hardware resources between corporate and self-service BI (that is, business user/team owned) can also be implemented with Power BI Premium capacities, as described in <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling with Premium and Analysis Services.</em> The essential goal of this isolation is to provide the self-service projects with resources aligned to these needs while ensuring that high priority and widely utilized corporate BI assets are not impacted by self-service content or activities.</span></div>
<ol start="2" class="calibre12">
<li class="chapter">Which authentication credentials or method will be used to configure the gateway data sources?
<ul class="calibre17">
<li class="chapter">For SSAS and Azure Analysis Services, this should be a server administrator of the Analysis Services instance </li>
<li class="chapter">For certain DirectQuery data sources, a <strong class="calibre6">single sign-on</strong> (<strong class="calibre6">SSO</strong>) option is supported in which the Power BI user's identity is passed to the source system, thus leveraging the source system's security.</li>
<li class="chapter">The <em class="calibre16">DirectQuery datasets</em> section later in this chapter contains details of this configuration</li>
</ul>
</li>
</ol>
<ol start="3" class="calibre12">
<li class="chapter">Which users will be authorized to use the gateway?
<ul class="calibre17">
<li class="chapter">Users or security groups of users must be mapped to the data source of a gateway</li>
<li class="chapter">These are usually report authors with Power BI Pro licenses</li>
</ul>
</li>
<li class="chapter">Where will the gateway recovery key be stored? 
<ul class="calibre17">
<li class="chapter">This will be necessary for migrating, restoring, or taking over an existing gateway</li>
</ul>
</li>
<li class="chapter">Who will be responsible for updating the On-premises data gateway as new versions are released?
<ul class="calibre17">
<li class="chapter">Just like Power BI Desktop, a new version of the On-premises data gateway is made available each month and includes new features and improvements, such as the support for datasets with both cloud and on-premises data sources</li>
<li class="chapter">The Power BI team recommends staying up to date with new releases and will not support old gateway versions</li>
<li class="chapter">For example, as of March 15, 2018, gateway versions older than the August 2017 release will not be supported</li>
</ul>
</li>
</ol>
<div class="packt_infobox"><span>Each monthly gateway version includes the same M Query engine utilized by that month's release of Power BI Desktop. Examples and considerations for M Queries were described in <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a>,</span> <em class="calibre16">Connecting to Sources and Transforming Data with M</em><span>. </span></div>
<p class="calibre7">In the following image, two users are added to a security group in <strong class="calibre6">Azure Active Directory</strong> (<strong class="calibre6">AD</strong>), dedicated to the administration of the On-premises data gateway:</p>
<div class="cdpalignleft"><img src="images/000075.png" class="calibre311" /></div>
<div class="mce-root2">Security group in Azure Active Directory</div>
<p class="calibre7">In this example, mapping the <kbd class="calibre15">On-Premises Gateway Admins</kbd> security group to a gateway in Power BI would allow Anna and Brett to configure data sources for the gateway and to authorize users or security groups of users to utilize the gateway. The <em class="calibre16">Managing gateway clusters</em> section later in this chapter includes details on using the gateway portal in the Power BI service.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-308">
<div id="calibre_link-1009" class="calibre2">
<div id="calibre_link-1010" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Top gateway planning tasks</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Since the gateway relates to different areas of IT, including infrastructure, networking, and data security, subject matter experts in these areas often inquire about the technical requirements of the gateway and its functionality. Additionally, business intelligence teams want to ensure that the gateway doesn't become a bottleneck to query performance and that dependencies on an individual gateway are avoided. Therefore, the BI/IT teams responsible for deploying Power BI solutions with on-premises data (or IaaS data) must partner with these other IT stakeholders to resolve questions and to provision the appropriate resources for the On-premises data gateway.</p>
<p class="calibre7">This section addresses three of the most common gateway planning questions. Information related to high availability and security is included in the gateway clusters and architectures, and gateway security sections, respectively.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-309">
<div id="calibre_link-1011" class="calibre2">
<div id="calibre_link-1012" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Determining whether a gateway is needed</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As one would expect, an On-premises data gateway is usually not required for connectivity to cloud data sources. PaaS offerings, such as Azure SQL Database, and SaaS solutions, such as Salesforce, do not require a gateway.</p>
<p class="calibre7">However, data sources that reside in an IaaS VM do require a gateway. Additionally, the <kbd class="calibre15">Web.Page()</kbd> function used in M Queries also requires a gateway. This function is used by the <strong class="calibre6">Web Data Connector</strong> (<strong class="calibre6">WDC</strong>) (<span>Get Data</span> | <span>Web</span>) to return the contents of an HTML web page as a table, as shown in the following M Query:</p>
<pre class="calibre19">// Retrieve table of data access M functions and their descriptions<br class="calibre3" />let<br class="calibre3" />  Source = Web.Page(Web.Contents("https://msdn.microsoft.com/en-US/library/mt296615.aspx")),<br class="calibre3" />  PageToTable = Source{0}[Data],<br class="calibre3" />  ChangedType = Table.TransformColumnTypes(PageToTable,</pre>
<pre class="calibre19">        {{"Function", type text}, {"Description", type text}})<br class="calibre3" />in<br class="calibre3" />    ChangedType</pre>
<p class="calibre7">In the preceding example, a two-column table (<kbd class="calibre15">Function</kbd>, <kbd class="calibre15">Description</kbd>) of M functions is retrieved from an MSDN web page <span>and imported into</span> a table in Power BI.</p>
<p class="calibre7">Additionally, all data sources for a dataset that accesses an on-premises data source must be added to the list of data sources in the gateway management portal. For example, if a dataset uses both SharePoint (on-premises) and an Azure SQL database, the URL for the Azure SQL database must also be added as a data source (via the SQL Server data source type) in the gateway management portal. If one of the data sources for the dataset is not configured for the gateway, the gateway will not appear in the dataset settings to support a refresh.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-310">
<div id="calibre_link-1013" class="calibre2">
<div id="calibre_link-1014" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Identifying where the gateway should be installed</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Gateways should be installed in locations that minimize the distance between the Power BI service tenant, the gateway server, and the on-premises data source. Reduced physical distance between these three points results in less network latency and thus improved query performance. Minimizing this latency is especially important when the gateway is used to support interactive report queries from Power BI to on-premises DirectQuery sources and Live connections to on-premises SSAS models.</p>
<div class="packt_tip pcalibre7 pcalibre6">Network latency from an IP location to Azure data regions can be tested at <a href="http://azurespeed.com" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://azurespeed.com</a>.<br class="calibre3" />
For example, via this free tool, it can quickly be determined that the average latency to the West US region is 100 ms while the East US region is only 37 ms. The lower latency of the East US region is due to the physical proximity of this region to the source IP location (near Boston, MA).</div>
<p class="calibre7">For example, if the Power BI tenant for your organization is located in the <span>North Central US</span> region in Microsoft Azure and your on-premises data source (for example, Oracle) is also located in the upper Midwest region of the United States, then the gateway should be installed on a server near or between these two locations. </p>
<p class="calibre7">The location of a Power BI tenant can be found by clicking the <span>About Power BI</span> menu item via the question mark icon in the top-right corner of the Power BI service:</p>
<div class="cdpalignleft"><img src="images/000086.png" class="calibre312" /></div>
<div class="mce-root2">About Power BI: tenant location</div>
<p class="mce-root3">In this example, the Power BI content for the organization is being stored in the <span>North Central US (Illinois)</span> Azure region. <span>Therefore, the gateway should be installed on a location that minimizes the distance between Illinois and the location of the data source. One example of this would be to install the gateway on the same subnet of the production data source server. It's not necessary, or recommended, to install the gateway on the same server as the production data source.</span></p>
<div class="packt_infobox">Currently, there are 36 Azure regions globally with six new regions planned. This link identifies the Azure regions and the criteria for choosing a specific region: <a href="http://bit.ly/2B598tD" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2B598tD</a>.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-311">
<div id="calibre_link-1015" class="calibre2">
<div id="calibre_link-1016" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Defining the gateway infrastructure and hardware requirements</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The recommended starting point for the server on which the gateway will be installed is eight CPU cores, 8 GB of memory, and the 64-bit version of Windows 2012 R2 (or later). However, hardware requirements for the gateway server will vary significantly based on the type of dataset supported (import versus DirectQuery/Live connection), the volume of concurrent users, and the queries requested. </p>
<p class="calibre7"><span>For example, if an M Query or part of an M Query is not folded back to the source system, as described in <a href="#calibre_link-22" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 2</a><em class="calibre16">, Connecting to Sources and Transforming Data with M</em></span>, <span>the gateway server will be required to execute the non-folded M expressions during the scheduled refresh (import) process. Depending on the volume of data and the logic of these expressions, a greater amount of RAM would better support these local operations. Similarly, if many users will be interacting with reports based on a DirectQuery dataset or a Live connection to a SSAS model (on-premises), additional CPU cores will result in better throughput. </span></p>
<div class="packt_tip pcalibre7 pcalibre6">It's strongly recommended to avoid a single point of failure by installing instances of the On-premises data gateway on separate servers. These multiple instances can serve as a single gateway cluster of resources available to support data refreshes and queries against on-premises data sources. Gateway clusters and architectures consisting of separate gateway clusters are described in later sections of this chapter. </div>
<p class="calibre7"><span>Performance counters associated with the gateway and the gateway server can be used to determine whether adjustments in available resources (RAM and CPU) are necessary. Guidance on interpreting these counters and a technique to integrate and visualize this data via Power BI is included in the <em class="calibre16">Monitoring gateway usage</em> section later in this chapter.</span></p>
<p class="calibre7">In terms of network configuration, the gateway creates an outbound connection to the Azure Service Bus and does not require inbound ports. The gateway communicates on the following outbound ports: TCP <kbd class="calibre15">443</kbd> (default), <kbd class="calibre15">5671</kbd>, <kbd class="calibre15">5672</kbd>, and <kbd class="calibre15">9350</kbd> through <kbd class="calibre15">9354</kbd>. It's recommended that organizations whitelist the IP addresses for the data region of their Power BI tenant (for example, North Central US) within their firewall. The list of IP addresses for the Azure data centers can be downloaded via the following URL <a href="http://bit.ly/2oeAQyd" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2oeAQyd</a>.</p>
<p class="calibre7">The downloaded list of Azure IP addresses is contained within an XML file which can be easily accessed via Power BI Desktop, as shown in  the following image:</p>
<div class="cdpalignleft"><img src="images/000096.png" width="340" height="85" class="calibre313" /> </div>
<div class="mce-root2">Azure datacenter IP addresses</div>
<p class="calibre7"><span>The gateway installs on any domain-joined machine and cannot be installed on a domain controller. Additionally, only one gateway can be installed per computer per gateway mode (enterprise versus personal). Therefore, it's possible to have both an enterprise mode and a personal mode gateway running on the same machine.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-312">
<div id="calibre_link-1017" class="calibre2">
<div id="calibre_link-1018" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">On-premises data gateway versus personal mode</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The first configuration setting when installing a gateway is the mode of the gateway, as depicted in the following image: </p>
<div class="cdpalignleft"><img src="images/000107.png" class="calibre314" /></div>
<div class="mce-root2">On-premises data gateway installer</div>
<p class="calibre7"><span>The default and recommended gateway mode (commonly referred to as the enterprise mode) provides all the functionality of the <span>personal mode</span> plus many more features and management capabilities. These additional benefits include support for DirectQuery and Live connection datasets, several other Azure services, such as MS Flow, and the management capabilities described in the <em class="calibre16">Managing gateway clusters</em> section later in this chapter.</span></p>
<p class="calibre7"><span>A single <span>personal mode</span> gateway can be installed per Power BI user account and can only be used for the on-demand or scheduled refresh of the import mode Power BI datasets. Most importantly, the <span>personal mode</span> gateway is completely tied to the individual user and cannot be shared. For example, if the gateway is installed in the <span>personal mode</span> on a user's laptop, that laptop will need to be on and connected to the internet to support any scheduled data refreshes. Additionally, unlike the administrators of the <span>On-premises data gateway</span>, a <span>personal mode</span> user cannot authorize other users to leverage the <span>personal mode</span> gateway and its configured data sources.</span></p>
<p class="calibre7">In the following image, both a <span>personal mode</span> gateway and a standard <span>On-premises data gateway</span> are available to refresh a dataset:</p>
<div class="cdpalignleft"><img src="images/000118.png" class="calibre315" /></div>
<div class="mce-root2">Dataset gateway connection</div>
<p class="calibre7">In the preceding example, if the user was not authorized to use the <span>On-premises data gateway</span> (<span>Frontline Gateway</span>), the <span>personal mode</span> gateway could be used to complete the refresh. This assumes the user has the necessary privileges to the on-premises data sources of the import mode dataset. </p>
<div class="packt_infobox">Although the terms in the <span>Dataset settings</span> menu refer to single gateways (for example, <span>Gateway connection</span>, data gateway), the <span>Frontline Gateway</span> is actually a cluster of gateway resources. Specifically, the <span>Frontline Gateway</span> operates as a single logical unit but may have multiple gateways installed across separate servers. The <em class="calibre16">gateway clusters and architectures section</em> contains additional details on the configuration of multiple clusters and multiple gateways within a cluster.</div>
<p class="calibre7">The <span>personal mode</span> gateway is not intended for large datasets or datasets supporting reports and dashboards that many users depend on. The <span>personal mode</span> gateways should only be considered for enabling individual business users to work on personal or proof-of-concept projects. For example, the business user may have several Excel workbooks and other frequently changing local files that are not configured as data sources on an <span>On-premises data gateway</span>. If the user has been assigned a Power BI Pro license, the <span>personal mode</span> gateway allows the user to keep Power BI reports and dashboards based on these sources updated for review by colleagues. In the event that the user's content requires reliable, longer-term support, the BI/IT organization can add the data sources to an <span>On-premises gateway</span> (enterprise mode) and revise removing the dependency on the user's machine. </p>
<p class="calibre7">All the remaining sections of this chapter are exclusively focused on the <span>On-premises data gateway</span> (that is, the enterprise mode). Although there are overlapping characteristics with the <span>personal mode</span>, any reference to the <span>On-premises data gateway</span> in this chapter and elsewhere in this book refers to the default mode (enterprise).</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-313">
<div id="calibre_link-1019" class="calibre2">
<div id="calibre_link-1020" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Gateway clusters</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>Each Power BI dataset is associated with a single gateway cluster, which is composed of one or many gateway instances. For example, if a Power BI dataset (<kbd class="calibre15">.pbix</kbd>) imports data from both a SQL Server database and an Excel file, the same gateway cluster will be responsible for the import from both sources. Likewise, if hundreds of business users interact with reports based on the same DirectQuery dataset or a Live connection to an on-premises SSAS instance, these user interactions will generate query requests to the same gateway cluster. </span></p>
<p class="calibre7">Gateway clusters representing multiple gateways (for example, primary and secondary), each of which must be installed on separate machines as per the <em class="calibre16">Hardware and network requirements</em> section, provide both high availability and load balancing. <span>From an availability standpoint, if an individual gateway instance within a cluster is not running, due to a server failure, for example, the data refresh and user query requests from the Power BI service will be routed to the other gateway instance(s) within the cluster. In terms of query performance and scalability, the Power BI service will distribute (load balance) the query requests across the multiple gateway instances within the cluster.</span></p>
<div class="packt_infobox">Data source configurations for the primary gateway of the cluster, which is the first gateway installed for the cluster, are leveraged by any additional gateways added to the cluster. For example, when a gateway cluster is first created on server abc and a data source (for example, SQL Server) is added to this cluster, the same data source settings (for example, the authentication method) will be used when another gateway on server xyz is added to the gateway cluster. </div>
<p class="calibre7"><span>In the following image from the gateway installer application, a new gateway is added to an existing gateway cluster:</span></p>
<div class="cdpalignleft"><img src="images/000128.png" class="calibre316" /></div>
<div class="mce-root2">Adding a gateway to a gateway cluster</div>
<p class="calibre7">In this example, the new gateway (<kbd class="calibre15">Frontline Gateway Backup</kbd>) is added to the <span>Frontline Gateway</span> cluster as per the checkbox and <span>Available gateway clusters</span> selection. Note that the <span>Recovery key</span> for the primary gateway instance, which was created when the first gateway instance of the cluster was installed, is required to add a gateway to a cluster. Additionally, be aware that the gateway management portal in the Power BI service only displays the gateway clusters, not the individual gateways within each cluster. Both the gateway clusters and the individual gateways within each cluster can be accessed and managed via PowerShell scripts as per the <em class="calibre16">Managing gateway clusters</em> section.</p>
<div class="packt_infobox"><span>Prior to the release of gateway clusters in late 2017, each Power BI dataset was dependent on a single gateway (and thus a single server). This was a significant limitation from both an availability and a performance standpoint as BI teams and projects would naturally prefer to reuse the same dataset for many reports and dashboards. Adding a gateway or multiple gateways from separate servers to a single gateway cluster eliminates this single point of failure and provides load balancing of the requested queries by default.</span></div>
<p class="calibre7"><span>Before adding a gateway to a cluster, ensure that the new gateway instance will be able to connect to the same data sources configured for the cluster. As described in the <em class="calibre16">Top gateway planning tasks</em> section, the additional gateways added to gateway clusters should also be installed in locations that minimize the distance between the gateway server, the Power BI service tenant, and the data source(s).</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-314">
<div id="calibre_link-1021" class="calibre2">
<div id="calibre_link-1022" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Gateway architectures</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For large-scale deployments of Power BI in which multiple types of datasets and workloads will be supported (import refreshes, as well as DirectQuery and Live connection queries), BI teams can consider multiple gateway clusters. In this approach, each gateway cluster is tailored to meet the specific resource needs (RAM and CPU) of the different workloads, such as large nightly refreshes or high volumes of concurrent queries in the early mornings.</p>
<p class="calibre7">For example, one gateway cluster could be composed of two gateway instances with a relatively high amount of available RAM on each gateway server. This cluster would have resources available during the most intensive scheduled refresh operations (for example, 4 A.M. to 6 A.M.) and would be exclusively used by import mode Power BI datasets and any Azure Analysis Services models that also regularly import data from on-premises sources. A separate gateway cluster would be created based on two gateway instances with a relatively high number of CPU cores on each gateway server. This gateway cluster would be used exclusively by DirectQuery Power BI datasets and any reports based on Live connection to an on-premises SQL Server Analysis Services instance. </p>
<p class="calibre7">A third gateway cluster, in addition to an import and a DirectQuery/Live connection cluster, could be dedicated to business-led BI projects. For example, as described in the <em class="calibre16">On-premises data gateway versus personal mode</em> section earlier in this chapter, certain data sources maintained by business teams (for example, Excel workbooks) may require the high availability and management benefits of the On-premises data gateway. Generally, this self-service cluster would be oriented toward scheduled refresh operations, but organizations may also want to empower business users to create DirectQuery datasets or reports based on Live connections to SSAS instances (on-premises).</p>
<p class="calibre7">In the following example from the <span>Manage gateways</span> portal in the Power BI service, two gateway clusters have been configured:</p>
<div class="cdpalignleft"><img src="images/000138.png" class="calibre317" /></div>
<div class="mce-root2">Manage gateways in Power BI service</div>
<p class="calibre7">As shown in the preceding image, the two Gateway Clusters (<span>Frontline Gateway</span> and <span>Frontline Gateway 2</span>) have been configured to support different data sources. As noted in the previous section, the individual gateway instances installed for each cluster are not currently accessible from the gateway portal but can be accessed via PowerShell scripts. Each cluster represents a single logical unit of gateway resources for its given data source(s).</p>
<div class="packt_tip pcalibre7 pcalibre6">If gateway clusters are created for specific workloads (for example, import versus DirectQuery), it can be helpful to note this both in the <span>Gateway Cluster Name</span> and in its <span>Description</span>. It's not recommended to allow a single point of failure but if only one gateway server is used in a cluster then the name of this server can be included in the cluster name and description.</div>
<p class="calibre7">The following diagram depicts a gateway cluster being used to support a scheduled data refresh of a Power BI dataset:</p>
<div class="cdpalignleft"><img src="images/000148.png" class="calibre318" /></div>
<div class="mce-root2">Scheduled data refresh via gateway cluster</div>
<p class="calibre7">With the data source(s) configured in the <strong class="calibre6">Manage Gateways</strong> portal in the <strong class="calibre6">Power BI Service</strong>, a scheduled data refresh for an import mode dataset can be configured to use the <strong class="calibre6">Gateway Cluster</strong>. The <strong class="calibre6">Gateway Cluster</strong> receives the query request at the scheduled time and is responsible for connecting to the data source(s) and executing the queries that load/refresh the tables of the Power BI dataset. Once the dataset in the <strong class="calibre6">Power BI Service</strong> is refreshed, dashboard tiles based on the dataset will also be refreshed and reports built against the dataset will issue queries against the dataset.</p>
<p class="calibre7">Given that the report queries are local to the refreshed dataset within the same <strong class="calibre6">Power BI Service</strong> tenant, and given the performance optimizations of the engine running within import mode Power BI datasets (that is, columnar compression, in-memory), query performance is usually very good with this deployment.</p>
<div class="packt_infobox">Currently, the entire Power BI dataset must be fully refreshed in each scheduled refresh operation. This is very inefficient, and in some scenarios infeasible, for large datasets as resources are needed to load both historical (unchanged) data and new data. However, incremental data refresh is a top feature identified on the Power BI Premium roadmap and, along with other roadmap features, will help support larger Power BI datasets. Additional details on Power BI Premium are included in <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling with Premium and Analysis Services.</em></div>
<p class="calibre7">The following diagram depicts two gateway clusters being used to support both the scheduled refresh of an import mode dataset and a Live connection to a SSAS tabular instance:</p>
<div class="cdpalignleft"><img src="images/000158.png" class="calibre319" /></div>
<div class="mce-root2">Multiple gateway clusters</div>
<p class="calibre7"><strong class="calibre6">Gateway Cluster A</strong> in the preceding diagram functions just like the previous diagram in supporting scheduled refreshes of import mode datasets. <strong class="calibre6">Gateway Cluster B</strong> has been created to exclusively support queries requested via Live connections to an on-premises SSAS database&mdash;an <strong class="calibre6">SSAS Tabular</strong> model in this scenario. Given the high volume of query requests generated by users interacting with Power BI reports based on the SSAS model, the servers used in <strong class="calibre6">Gateway Cluster B</strong> can be provisioned with additional CPU cores and actively monitored via performance counters for changes in utilization.</p>
<div class="packt_infobox"><span>In addition to the interactive query requests from Live connection reports, owners of datasets can configure a scheduled refresh for the cache supporting dashboard tiles based on Live connection reports. Guidance on configuring this feature is included in the <em class="calibre16">Dashboard cache refresh</em> section at the end of this chapter. </span></div>
<p class="calibre7">The description of <strong class="calibre6">Gateway Cluster B</strong> is also generally applicable to DirectQuery datasets based on supported sources, such as SQL Server, Oracle, and Teradata. Just like Live connections to SSAS, reports built against these datasets will also generate high volumes of queries that must go through the gateway cluster and be returned to the Power BI service tenant.</p>
<p class="calibre7">Given the additional latency created by the requests for queries and the transfer of query results back to the Power BI service, it's especially important to develop and provision efficient data sources for DirectQuery and Live connection reports. Two examples of this include using the clustered columnstore index for SQL Server and optimizing the DAX expressions used for measures of an SSAS model.</p>
<p class="calibre7">Additionally, organizations can consider Azure ExpressRoute to create a fast, private connection between on-premises infastructure and Azure. The following URL provides documentation on this service: <a href="http://bit.ly/2tCCwEv" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2tCCwEv</a>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-315">
<div id="calibre_link-1023" class="calibre2">
<div id="calibre_link-1024" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Gateway security</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Administrators of the <span>On-premises data gateway</span>, such as the security group mentioned in the <em class="calibre16">On-premises data gateway planning</em> section, are responsible for configuring the data sources that can be used with each gateway cluster. Additionally, gateway administrators have control over the users or security group(s) of users that can utilize a gateway data source. As shown in the following image from the <span>Manage gateways</span> portal in the Power BI service, credentials entered for data sources are encrypted:</p>
<div class="cdpalignleft"><img src="images/000168.png" class="calibre320" /></div>
<div class="mce-root2">Encrypted data source credentials</div>
<p class="calibre7">The data source credentials are only decrypted once the query request reaches the on-premises gateway cluster within the corporate network. The gateway decrypts the credentials needed for query requests and, once the query has executed, it encrypts the results of these query requests prior to pushing this data to the Power BI service. The Power BI service never knows the on-premises credential values.</p>
<p class="calibre7">Technically, the following five-step process occurs to facilitate communication and data transfer between the Power BI service and the on-premises sources:</p>
<ol class="calibre12">
<li class="chapter">The Power BI service initiates a scheduled refresh or a user interacts with a DirectQuery or a Live connection report.</li>
</ol>
<p class="calibre156">In either event, a query request is created and analyzed by the data movement service in Power BI.</p>
<ol start="2" class="calibre12">
<li class="chapter">The data movement service determines the appropriate Azure Service Bus communication channel for the given query.</li>
</ol>
<p class="calibre156">A distinct service bus instance is configured per gateway. </p>
<ol start="3" class="calibre12">
<li class="chapter">The <span>On-premises data gateway</span> polls its service bus channel and obtains the pending request.</li>
<li class="chapter"> The gateway decrypts the credentials and then sends the query to the data source for execution.</li>
<li class="chapter">The results of the query (data) are returned to the gateway, encrypted, and then pushed to the Power BI service.</li>
</ol>
<p class="calibre7">The critical component of the gateway's security is the recovery key that's created during the installation and configuration process. In the following image, a user account has signed into the the Power BI service and both a name for the gateway and a recovery key are required to configure the gateway:</p>
<div class="cdpalignleft"><img src="images/000178.png" class="calibre321" /></div>
<div class="mce-root2">Configuration of an On-premises data gateway</div>
<p class="calibre7">The recovery key is used to generate strong RSA and AES encryption keys. As described earlier in this section, these encyrption keys never leave the gateway machine. </p>
<p class="calibre7">It's strongly recommended to store the gateway recovery key in a safe and secure location. This should be on a machine other than the gateway server itself as the recovery key can be used to migrate, restore, or take over an existing gateway, as described in the <em class="calibre16">Troubleshooting and monitoring gateways</em> section later in this chapter. Additionally, the recovery key is required when adding a gateway to a cluster to provide high availability and load balancing.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-316">
<div id="calibre_link-1025" class="calibre2">
<div id="calibre_link-1026" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Gateway configuration</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Once the gateway scenario and architecture has been planned per the previous sections, BI or IT administrators can download and install the gateway (or multiple gateways) on the chosen server(s). The gateway installation file to be downloaded is small (for example, 508 KB) and the installation process is quick and straightforward. However, gateway administrators should be aware of primary settings, such as the default Windows service account used by the gateway, and the option to change this account as well as the option to switch network communication from TCP to HTTPS. </p>
<p class="calibre7">The gateway installer application can be obtained via the <span>Download</span> dropdown in the Power BI service, as shown in the following image:</p>
<div class="cdpalignleft"><img src="images/000188.png" class="calibre322" /></div>
<div class="mce-root2">Download in Power BI service</div>
<p class="calibre7">The <span>Data Gateway</span> item from the download menu in the preceding image currently links to a <span>Power BI Gateway</span> page with a large <span>Download Gateway</span> button at the top. Selecting <span>Download Gateway</span> from this page allows the user to save the installer (<kbd class="calibre15">PowerBIGatewayInstaller.exe</kbd>) locally. If the gateway installation file is downloaded from a web page other than the <span>Power BI Gateway</span> page, such as Azure Logic Apps documentation, the option to install the gateway in <span>personal mode</span> will not be included.</p>
<p class="calibre7">The installation and configuration process via the installer application is very straightforward. Step-by-step instructions have been documented here (see <em class="calibre16">Install the gateway</em> section) <a href="http://bit.ly/2rq22Ao" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2rq22Ao</a>.</p>
<p class="calibre7">Once the installation and configuration is complete, an <span>On-premises data gateway</span> application will be available on the the server machine to help manage the gateway, as shown in the following image:</p>
<div class="cdpalignleft"><img src="images/000198.png" width="743" height="46" class="calibre323" /> </div>
<div class="mce-root2">On-premises data gateway application</div>
<p class="calibre7">Details on the settings available via this application are included in the <em class="calibre16">Troubleshooting and monitoring gateways</em> section later in this chapter. When first getting started with the gateway, you can launch the application after configuration and sign in with a Power BI service account to check the status of the gateway and to get familiar with the tool.</p>
<p class="calibre7">The same installation software can be downloaded and run to update an existing <span>On-premises data gateway</span> to the latest version. For example, the January 2018 version of the gateway corresponds to version <span>14.16.6584.1</span> and this includes the very latest data mashup engine, bug fixes, and new administrative features. The update process is very quick to complete and the <span>On-premises data gateway</span> application will reflect the new version number on the <span>Status</span> page, as shown in the following image:</p>
<div class="mce-root2"><img src="images/000209.png" width="635" height="249" class="calibre324" /> </div>
<div class="mce-root2">On-premises data gateway status</div>
<p class="calibre7">It's strongly recommended to regularly update the <span>On-premises data gateway</span> to the latest version. An out-of-date gateway will be flagged for updating on the <span>Status</span> page of the <span>On-premises data gateway</span> and may result in data refresh or connectivity issues.</p>
<p class="calibre7">Additionally, administrators should be aware of the following two XML configuration files for the gateway:</p>
<pre class="calibre19"><span>C:\Program Files\On-premises data gateway\enterprisegatewayconfigurator.exe.config<br class="calibre3" />C:\Program Files\On-premises data gateway\Microsoft.PowerBI.EnterpriseGateway.exe.config</span></pre>
<p class="calibre7">The <kbd class="calibre15">configurater.exe</kbd> file relates to the installation screens that configure the gateway. The <kbd class="calibre15">PowerBI.EnterpriseGateway.exe</kbd> file is for the actual Windows service that handles the query requests from the Power BI service.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-317">
<div id="calibre_link-1027" class="calibre2">
<div id="calibre_link-1028" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">The gateway service account</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">By default, the gateway runs under the <span>NT SERVICE\PBIEgwService</span> Windows service account. However, as shown in the following image from the <span>On-premises data gateway</span> desktop application, this account can be changed via the <span>Service Settings</span> tab:</p>
<div class="cdpalignleft"><img src="images/000219.png" class="calibre325" /></div>
<div class="mce-root2">On-premises data gateway application</div>
<p class="calibre7">In the preceding example, a user has opened the gateway application from the server on which a gateway instance has been installed. Additionally, in order to change the service account, the user has signed into Power BI from the gateway application with the email address used to log in to the Power BI service. </p>
<p class="calibre7">If the default account (<span>NT SERVICE\PBIEgwService</span>) is able to access the internet and thus its Azure Service Bus, ensure that the account can also authenticate to the required on-premises data sources, such as the production SQL Server instance. In some environments, the default account cannot access the internet as it is not an authenticated domain user. In this scenario, the service account can be revised to a domain user account within the <span>Active Directory</span> domain. To avoid the need to routinely reset the password for the <span>Active Directory</span> account, it's recommended that a managed service account is created in <span>Active Directory</span> and used by the gateway service. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-318">
<div id="calibre_link-1029" class="calibre2">
<div id="calibre_link-1030" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">TCP versus HTTPS mode </h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">By default, the gateway uses direct TCP network communication. However, as shown in the following image from the <span>On-premises data gateway</span> application, the gateway can be forced to exclusively use HTTPS via the <span>Network</span> tab: </p>
<div class="cdpalignleft"><img src="images/000229.png" class="calibre326" /></div>
<div class="mce-root2">On-premises data gateway application</div>
<p class="calibre7"><span>In the preceding example, a user has opened the gateway application from the server on which a gateway instance has been installed. Unlike modifying the service account per the previous section, however, the user does not need to sign in to Power BI from the gateway application to enable the HTTPS mode. A restart of the gateway is required to apply the change to the HTTPS mode and thus this modification should only be implemented when minimal or no query requests are being processed.</span></p>
<p class="calibre7"><span>Once the HTTPS mode has been applied, the gateway will strictly use FQDN only and no communication will happen using IP addresses. As advised in the gateway application, enabling the HTTPS mode may slow the performance of gateway requests.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-319">
<div id="calibre_link-1031" class="calibre2">
<div id="calibre_link-1032" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Managing gateway clusters</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Once a gateway has been installed, the Power BI account used to register the gateway during installation can access the manage gateways portal in the Power BI service to assign administrators for the gateway. <span>For example, if Anna Sanders' account was used to register the gateway during installation, as shown in the following image, Anna would initially be the only administrator of the gateway:</span></p>
<div class="cdpalignleft"><img src="images/000239.png" class="calibre327" /></div>
<div class="mce-root2">Account registering the gateway</div>
<p class="calibre7">Once registered, Anna can use the manage gateways portal to add a security group of users as administrators for the gateway. Anna can then optionally remove her individual account from the list of gateway administrators since she's either already included in the admin security group or it's not her role to administer this gateway. </p>
<p class="calibre7">The <span>Manage gateways</span> portal is available via the gear icon in the top-right corner of the Power BI service, as shown in the following image: </p>
<div class="cdpalignleft"><img src="images/000250.png" class="calibre328" /></div>
<div class="mce-root2">Manage gateways</div>
<p class="calibre7">The <span>Manage gateways</span> portal exposes all gateway clusters that the user is an administrator for. The primary functionality and tasks of gateway administrators are described in the following sections.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-320">
<div id="calibre_link-1033" class="calibre2">
<div id="calibre_link-1034" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Gateway administrators</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Administrators of gateway clusters have the ability to add or remove data sources, modify the authentication to those sources, and to enable or disable users or groups of users from utilizing the cluster. Given the importance of these responsibilities, more than one gateway administrator, such as a security group of admins, is strongly recommended. For example, in the event that the credentials for a data source need to be revised or when a data source needs to reference a different database, only an admin for the gateway will be able to implement these changes in the <span>Manage gateways</span> portal. </p>
<p class="calibre7">In the following image from the <span>Manage gateways</span> portal in Power BI, a single security group (<span>On-Premises Gateway Admins</span>) has been added as the administrator of the <span>Frontline Gateway</span> cluster:</p>
<div class="cdpalignleft"><img src="images/000260.png" class="calibre329" /></div>
<div class="mce-root2">Power BI gateway administrators</div>
<p class="calibre7">As described in the <em class="calibre16">On-premises data gateway planning</em> section earlier in this chapter, this security group currently includes two users (Anna Sanders and Brett Powell). </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-321">
<div id="calibre_link-1035" class="calibre2">
<div id="calibre_link-1036" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Gateway data sources and users</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The primary role of gateway administrators is to add data sources per the gateway cluster and to authorize (or remove) users or groups of users. With the gateway cluster selected within the <span>Manage gateways</span> portal, clicking <span>ADD DATA SOURCE</span> from the list of gateway clusters creates a blank new data source, as shown in the following image:</p>
<div class="cdpalignleft"><img src="images/000270.png" class="calibre330" /></div>
<div class="mce-root2">Adding a data source to a gateway cluster</div>
<p class="calibre7"><span>New data sources can also be added via the ellipsis to the right of each cluster name in the <span>Manage gateways</span> portal. Once data sources have been added, the users who will publish reports and/or schedule data refreshes via the gateway can be added to the data source.</span></p>
<p class="calibre7"><span>In the following example, a security group of users is added to the <span>AdWorksDW</span> data source of the <span>Frontline Gateway</span>:</span></p>
<div class="cdpalignleft"><img src="images/000280.png" class="calibre331" /></div>
<div class="mce-root2"><strong class="calibre6">Adding a security group of users to the gateway data source</strong></div>
<p class="calibre7"><span>The users included in the security group (for example, <span>AdWorks DW Sales Team</span>) will see the option to use the <span>Frontline Gateway</span> to configure scheduled refreshes in the <span>Data Source Settings</span> menu. For DirectQuery datasets and Live connections to on-premises SSAS databases, Power BI Desktop will advise that a gateway has been applied when the PBIX file is published.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-322">
<div id="calibre_link-1037" class="calibre2">
<div id="calibre_link-1038" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">PowerShell support for gateway clusters</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A PowerShell script module is included in the installation of the <span>On-premises data gateway</span> to support the management of gateway clusters. Once the module is imported to a session of PowerShell in which the user has administrator privileges, a login command (<kbd class="calibre15">Login-OnPremisesDataGateway</kbd>) must be be executed to enable other gateway management commands.</p>
<p class="calibre7">By default, the PowerShell module file (<kbd class="calibre15">.psm1</kbd>) can be imported from the following path: </p>
<div class="cdpalignleft"><img src="images/000290.png" class="calibre332" /></div>
<div class="mce-root2">On-premises gateway PowerShell module</div>
<p class="calibre7">Unlike the <span>Manage gateways</span> portal in the Power BI service, the PowerShell commands provide access to the specific gateway instances configured for each cluster. For example, properties of a specific gateway within an instance can be modified or a gateway instance can be removed from a cluster altogether.</p>
<p class="calibre7">In the following example from PowerShell, the gateway admin account (<kbd class="calibre15">ASanders@FrontlineAnalytics.onmicrosoft.com</kbd>) has been used for the <kbd class="calibre15">Login-OnPremisesDataGateway</kbd> command:</p>
<div class="cdpalignleft"><img src="images/000300.png" class="calibre333" /></div>
<div class="mce-root2">Gateway cluster PowerShell commands</div>
<p class="calibre7">Once authenticated as Anna Sanders, the <kbd class="calibre15">Get-OnPremisesDataGatewayClusters</kbd> command has been used to retrieve the list of gateway clusters in which Anna is an administrator. The list of available gateway cluster PowerShell commands and their parameters can be found here: <a href="http://bit.ly/2BfXL2e" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2BfXL2e</a>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-323">
<div id="calibre_link-1039" class="calibre2">
<div id="calibre_link-1040" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Troubleshooting and monitoring gateways</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For organizations with significant dependencies on the <span>On-premises data gateway</span>, it's important to plan for administration scenarios, such as migrating or restoring a gateway to a different machine. Gateway administrators should also be familiar with accessing and analyzing the gateway log files and related settings to troubleshoot data refresh issues. Finally, gateway throughput and resource availability can be consistently monitored via Windows' performance monitor counters associated with the gateway and the gateway server.</p>
<p class="calibre7">In the following image, the status and version number of an installed gateway is obtained via the <span>On-premises data gateway</span> desktop application: </p>
<div class="cdpalignleft"><img src="images/000310.png" class="calibre334" /></div>
<div class="mce-root2">On-premises data gateway application<strong class="calibre6"> </strong></div>
<p class="calibre7">In the preceding example, a user has accessed the server on which the <span>Frontline Gateway</span> instance has been installed and then opened the <span>On-premises data gateway</span> application. To obtain the gateway's status (for example, green check mark), the user is required to sign in with the email address used to log in to the Power BI service. If the <span>Gateway version number</span> is out of date, a message will appear advising that a new version of the gateway is available. It's recommended to regularly update gateways to the latest versions. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-324">
<div id="calibre_link-1041" class="calibre2">
<div id="calibre_link-1042" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Restoring, migrating, and taking over a gateway</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In many scenarios, it's necessary to migrate or restore a gateway to a separate server. For example, a gateway may have initially been installed on a server with insufficient resources to support the current workload. In other cases, a hardware failure may have occurred on a gateway's server and thus it's necessary to quickly restore connectivity. Via the recovery key that's created when a gateway is first installed and configured, the data sources and their associated settings (authentication and credentials) can be restored on a new gateway machine. </p>
<p class="calibre7">In the following image, the gateway installation application (<kbd class="calibre15">PowerBIGatewayInstaller.exe</kbd>) provides the option to <span>Migrate, restore, or takeover an existing gateway</span> rather than register a new gateway:</p>
<div class="cdpalignleft"><img src="images/000320.png" class="calibre335" /></div>
<div class="mce-root2">Gateway setup options</div>
<p class="mce-root3">Choosing to <span>Migrate, restore, or takeover an existing gateway</span> will require the recovery key that is created when a gateway is originally configured. If this key is not available, the only option will be to install a new gateway and manually add the data sources and authorized users for that gateway. <span>Additionally, only an administrator of a gateway can use the recovery key to restore a gateway to a different server.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-325">
<div id="calibre_link-1043" class="calibre2">
<div id="calibre_link-1044" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Gateway log files</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The <span>On-premises data gateway</span> desktop application makes it easy for gateway administrators to analyze gateway request activity. As shown in the following image, the <span>Diagnostics</span> tab allows admins to record additional details in the gateway log files and to export these files for analysis:</p>
<div class="cdpalignleft"><img src="images/000330.png" class="calibre336" /></div>
<div class="mce-root2">Diagnostics settings</div>
<p class="calibre7">Applying the additional logging setting requires the gateway to be restarted but provides visibility to the specific queries requested and the duration of their execution. In a typical troubleshooting or analysis scenario, a gateway admin would temporarily enable additional logging, execute a data refresh or query from the Power BI service, and then export the gateway log files to analyze this activity. Once the log files have been exported, additional logging should be disabled to avoid reduced query throughput.</p>
<div class="packt_infobox">Technically, the additional logging setting modifies the <kbd class="calibre43">EmitQueryTraces</kbd> and <kbd class="calibre43">TracingVerbosity</kbd> properties of the following two XML configuration files, respectively:<br class="calibre3" />
<kbd class="calibre43">Microsoft.PowerBI.DataMovement.Pipeline.GatewayCore.dll</kbd><br class="calibre3" />
<span><kbd class="calibre43">Microsoft.PowerBI.DataMovement.Pipeline.Diagnostics.dll</kbd><br class="calibre3" />
<br class="calibre3" />
As an alternative to the gateway application setting, both configuration files can be accessed and modified at the installation location of the gateway, such as <kbd class="calibre43">C:\Program Files\On-premises data gateway</kbd>.</span></div>
<p class="calibre7">In the following example, a gateway log file with verbose logging has been copied into Excel and filtered for a specific request ID: </p>
<div class="cdpalignleft"><img src="images/000340.png" class="calibre337" /></div>
<div class="mce-root2">Log file output</div>
<p class="calibre7">In the preceding example, a refresh process caused the <kbd class="calibre15">SELECT * FROM BI.vDim_Account</kbd> query to be executed against an on-premises source via the gateway. The duration of this query was 2.48 seconds (2,484 ms) per the final row containing the <kbd class="calibre15">FireActivityCompletedSuccessfullyEvent</kbd> log event. Note that column headers are not included in the log files and that the second column of the logs (a GUID) is the <span>Request ID</span>. This is the column that can be used to match a query with its completion event and duration.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-326">
<div id="calibre_link-1045" class="calibre2">
<div id="calibre_link-1046" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Performance Monitor counters</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Windows performance-monitor counters, specific to both the gateway service and the servers on which the gateway is running, are helpful in assessing workloads relative to available resources. For example, a BI team can determine whether a gateway server has adequate memory available to support the scheduled refreshes of large datasets. Likewise, the performance counters specific to the <span>On-premises data gateway</span> can be used to identify spikes or dips in query executions and failures throughout the day. The results of this analysis could suggest adding a gateway instance to a cluster or migrating a gateway instance to a server with additional CPU cores. </p>
<p class="calibre7">The Windows Performance Monitor tool can be used to create a collector set of the necessary counters, as shown in the following image:</p>
<div class="cdpalignleft"><img src="images/000350.png" class="calibre338" /></div>
<div class="mce-root2">On-premises data gateway counters</div>
<p class="calibre7">As you can see in the preceding image, several of the same counters are available per query type, such as ADO.NET, ADOMD, OLEDB, and mashup. The ADO.NET counters are used by DirectQuery connections and the mashup counters relate to the refresh of imported datasets. Detailed descriptions of all counters and types can be obtained via the Power BI docs website under <span>Gateways</span>.</p>
<p class="calibre7">Power BI tools and services are well suited to integrating and analyzing performance-counter data. A detailed paper describing this solution, as well as a sample Power BI Desktop file, is available on the <em class="calibre16">Insight Quest</em> blog at <a href="http://bit.ly/2Dssgbh" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2Dssgbh</a>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-327">
<div id="calibre_link-1047" class="calibre2">
<div id="calibre_link-1048" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Scheduled data refresh</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The scheduled refresh for an import mode dataset can be configured in the <span>Data Source Settings</span> menu in Power BI. In the following example, a user authorized to use the <span>Frontline Gateway</span> cluster for the source(s) of the dataset configures a daily refresh: </p>
<div class="mce-root2"><img src="images/000360.png" width="822" height="600" class="calibre339" /> </div>
<div class="mce-root2">Scheduled data refresh</div>
<p class="calibre7">Import mode datasets that are hosted in a shared capacity (non-premium) are currently limited to eight scheduled refreshes per day. Import datasets hosted in Power BI Premium capacity, however, can be refreshed up to 48 times per day. Each scheduled refresh for both Power BI Premium and the shared capacity dataset is separated by a minimum of 30 minutes. </p>
<p class="calibre7">In addition to the scheduled refreshes configured in the Power BI service interface, the Power BI REST API can be used to trigger a dataset refresh. A sample PowerShell script (<kbd class="calibre15">manageRefresh.ps1</kbd>) for executing these refreshes is available for download and further details on the Power BI REST API are included in the <em class="calibre16">Staged deployments</em> section of <a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content.</em></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-328">
<div id="calibre_link-1049" class="calibre2">
<div id="calibre_link-1050" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">DirectQuery datasets</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For datasets built with DirectQuery connections to on-premises sources, authorized users of the gateway source will receive the following message when publishing from Power BI Destop: </p>
<div class="cdpalignleft"><img src="images/000370.png" class="calibre340" /></div>
<div class="mce-root2">Gateway assigned to the DirectQuery dataset</div>
<p class="calibre7">It's essential that the data source settings (for example, server name, database name) configured for the gateway data source exactly match the entries used by the Power BI dataset (<kbd class="calibre15">.PBIX</kbd>). Once the DirectQuery dataset has been published to the Power BI service, new reports can be built on top of this dataset via the Power BI service data source described in the <em class="calibre16">Live connections to Power BI datasets</em> section of <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-329">
<div id="calibre_link-1051" class="calibre2">
<div id="calibre_link-1052" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Single sign-on to DirectQuery sources via Kerberos</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Many organizations have made significant investments in scalable on-premises data sources and have implemented user security rules/conditions in these sources. For these organizations, it's often preferable to use DirectQuery data connections that leverage both the resources of the source and the custom security rules. To address this scenario, the <span>On-premises data gateway</span> now supports a single sign-on feature that passes the identity of the Power BI user to the data source via Kerberos constrained delegation. </p>
<p class="calibre7">In the following image from the <span>Manage gateways</span> portal, the single sign-on setting for a SQL Server data source is exposed:</p>
<div class="cdpalignleft"><img src="images/000379.png" class="calibre341" /></div>
<div class="mce-root2">Single sign-on for DirectQuery</div>
<p class="calibre7">By default, the <strong class="calibre6">single sign-on</strong> (<strong class="calibre6">SSO</strong>) feature is not enabled and thus all DirectQuery queries (from any user) will execute via the credentials specified in the source. If enabled, the <strong class="calibre6">user principal name</strong> (<strong class="calibre6">UPN</strong>) of the user viewing content in the Power BI service is mapped to a local Active Directory identity by the gateway. The gateway service then impersonates this local user when querying the data source. </p>
<div class="packt_infobox">Kerberos constrained delegation must be configured for the gateway and data source to properly use the SSO for DirectQuery feature. This involves changing the service account of the gateway to a domain account, as discussed in the <em class="calibre16">Configuration of on-premises gateway</em> section earlier in this chapter. Additionally, an SPN may be needed for the domain account used by the gateway service and delegation settings must be configured for this account as well. Detailed instructions on configuring Kerberos constrained delegation can be found here: <a href="http://bit.ly/2DsTI82" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2DsTI82</a>.</div>
<p class="calibre7">Currently this feature is only available for SQL Server, SAP HANA, and Teradata sources, but Oracle and other common DirectQuery sources are planned.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-330">
<div id="calibre_link-1053" class="calibre2">
<div id="calibre_link-1054" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Live connections to Analysis Services models</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For on-premises SSAS models that Power BI users will access via Live connections, an SSAS data source must be added in the <span>Manage gateways</span> portal. Critically, the credentials entered for this data source in the <span>Manage gateways</span> portal must match an account that has server administrator permissions for the SSAS instance. The following image, from <strong class="calibre6">SQL Server Management Studio</strong> (<strong class="calibre6">SSMS</strong>), exposes the server administrator accounts for the ATLAS instance of SSAS Tabular: </p>
<div class="cdpalignleft"><img src="images/000389.png" class="calibre342" /></div>
<div class="mce-root2">Analysis Services Server administrators</div>
<p class="calibre7">Both SSAS and Azure Analysis Services instances can be accessed via SSMS. Additionally, the <span>Analysis Server Properties</span> dialog from the preceding image can be accessed by right-clicking the instance name. Identification of the Power BI user by SSAS will only work if a server admin account is specified and thus used when opening connections.</p>
<p class="calibre7"><span>User authentication to SSAS is based on the <kbd class="calibre15">EffectiveUserName</kbd> property of SSAS. Specifically, the user principal name (for example, <kbd class="calibre15">JenL@FrontlineAnalytics.onmicrosoft.com</kbd>) of the Power BI user is passed into this property and this email address must match a UPN within the local Active Directory. This allows the SSAS model to apply any row-level security roles built into the model for the given Power BI user.</span> </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-331">
<div id="calibre_link-1055" class="calibre2">
<div id="calibre_link-1056" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Azure Analysis Services refresh</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">To support the data refresh operations of Azure Analysis Services models based on on-premises sources, an <span>On-premises data gateway</span> resource is created in Azure and associated with the Azure Analysis Services resource. As shown in the following image, the gateway resource is located in the same region (<span>North Central US</span>) as the Power BI service tenant:</p>
<div class="cdpalignleft"><img src="images/000399.png" class="calibre343" /></div>
<div class="mce-root2">On-premises data gateway resource in Azure portal</div>
<p class="calibre7">To create a gateway resource in Azure (for example, <span>FrontlineGateway</span>), either search the Azure marketplace for <span>On-premises data gateway</span> in the Azure portal or use the link (<span>Create a gateway in Azure</span>) provided on the <span>Status</span> page of the <span>On-premises data gateway</span> application. Like other resources in Azure, an Azure subscription and resource group are required to create and configure the gateway resource. However, the gateway resource only stores metadata to reference an existing gateway installation and thus there are no billing charges associated with the gateway itself. The name of the existing (and running) gateway should appear on the <span>Installation name</span> property of the <span>Create connection gateway</span> blade in the Azure portal. </p>
<p class="calibre7">Once created, the gateway resource in Azure must be associated with the Azure Analysis Services resource, as shown in the following image:</p>
<div class="cdpalignleft"><img src="images/000409.png" class="calibre344" /></div>
<div class="mce-root2">Azure Analysis Services connected to gateway</div>
<p class="calibre7">In the preceding example, the AAS resource (<span>frontline</span>) has been configured to use the <span>FrontlineGateway</span> resource via the <span>On-premises data gateway</span> setting for AAS resources. The <span>FrontlineGateway</span>, in turn, references an existing installation of the <span>On-premises data gateway</span>. Because the AAS resource is associated with the gateway in the Azure portal, it does not need to be added as a data source in the manage gateways portal of Power BI. </p>
<p class="calibre7">From a user authentication and row-level security standpoint, Live connection queries against AAS provide the Azure Active Directory account of the user. Therefore, the row-level security models built into AAS models must reflect these AAD identities to be enforced.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-332">
<div id="calibre_link-1057" class="calibre2">
<div id="calibre_link-1058" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dashboard cache refresh</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Dashboard tiles based on import mode datasets are refreshed when the dataset itself is refreshed in the Power BI service. For dashboard tiles based on DirectQuery or Live connection datasets, however, the Power BI service maintains a scheduled cache refresh process for updating dashboard tiles. The purpose of this cache is to ensure dashboards are loaded extremely quickly since, as described in <a href="#calibre_link-265" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 7</a>, <em class="calibre16">Designing Power BI Dashboards and Architectures, </em>many users, such as executives, exclusively rely on dashboards.</p>
<p class="calibre7"><span>By default, the dashboard tile cache is refreshed once every hour. As shown in the following image, owners of these datasets can configure this refresh process to occur as frequently as every <span>15 minutes</span> or as infrequently as once per week:</span></p>
<div class="cdpalignleft"><img src="images/000419.png" class="calibre345" /></div>
<div class="mce-root2">Scheduled cache refresh</div>
<p class="calibre7">In the preceding example, a Power BI dataset (<kbd class="calibre15">AdWorksEnterpriseDQ</kbd>) containing a DirectQuery connection to an on-premises SQL Server database has been published to an app workspace in Power BI. The <span>Scheduled cache refresh</span> option will not appear for datasets that import their data&mdash;these datasets can use the scheduled refresh dialog described earlier in this chapter. Per the settings dialog, the dataset is associated with an <span>On-premises data gateway</span> (<span>Frontline Gateway</span>), thus allowing queries from the Power BI service to reach the on-premises database. </p>
<div class="packt_tip pcalibre7 pcalibre6"><span>It can be helpful to run a trace on the source system to capture the volume and performance characteristics of the queries associated with dashboard cache refreshes. If the dataset is used by several dashboards with many tiles and/or complex tiles with many data points, the cache refresh process can be expensive on the source system. The trace can be started immediately prior to a scheduled cache refresh or, if only one dashboard is being refreshed, prior to a manual dashboard tile refresh.</span></div>
<p class="calibre7">Switching the <span>Refresh frequency</span> to <span>15 minutes</span> causes the queries associated with each dashboard tile dependent on the DirectQuery dataset to be submitted in 15-minute intervals, as shown in the following image:</p>
<div class="cdpalignleft"><img src="images/000001.png" class="calibre346" /></div>
<div class="mce-root2">Dataset menu in Power BI service</div>
<p class="calibre7">In addition to the <span>Last Refresh</span> and <span>Next Refresh</span> columns, dataset owners can also access the <span>Refresh history</span> from the same dataset settings menu used to configure the <span>Scheduled cache refresh</span>.</p>
<div class="packt_infobox"><span>Users can also manually refresh dashboard tiles via the <span>Refresh dashboard tiles</span> menu option. This option, exposed via the ellipsis in the top-right corner of dashboards, also sends queries to the DirectQuery or Live connection data source like the scheduled cache refresh.</span></div>
<p class="calibre7"><span>Power BI reports (<kbd class="calibre15">.PBIX</kbd> files) containing either a Live connection to an Analysis Services server (AAS or SSAS) or a DirectQuery connection to the data source will be represented as distinct datasets in the Power BI service. </span>Power BI reports created based on these published datasets will utilize the scheduled cache refresh configured for the given source dataset. The <em class="calibre16">Live connections to Power BI datasets</em> section in <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em> contains details and examples of these reports.</p>
<p class="calibre7">The optimal cache refresh frequency will depend on the business requirements for data freshness, the frequency with which the source database is updated, and the available resources of the source system. For example, if the top priority of the source system is OLTP transactions and the dashboard queries are resource intensive, it may be preferable to limit the refresh frequency to once a day. However, if the very latest data updates are of top value to the business users and ample resources are available to the source system, a 15-minute cache refresh schedule may be appropriate.</p>
<p class="calibre7"><span>Unlike dashboards, a cache is not maintained for Power BI reports based on DirectQuery or Live connection datasets. These reports issue queries as the user interacts with report visuals and therefore can result in some latency. The degree of this latency depends on many factors, including the hardware resources of the data source, whether Power BI Premium capacity has been provisioned, and the complexity or density of the report visuals being analyzed. <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>,</span> <em class="calibre16">Scaling with Premium and Analysis Services</em><span> is dedicated to scalability and performance-related topics.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-333">
<div id="calibre_link-1059" class="calibre2">
<div id="calibre_link-1060" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">This chapter reviewed the primary planning and management scenarios for the On-premises data gateway. This included alternative-solution architectures requiring a gateway, methods for distributing workloads across multiple gateways, and ensuring high availability via gateway clusters. Additionally, this chapter described the process of administering a gateway, including the configuration of data sources and the authorization of users or groups to utilize the gateway per source. Finally, the primary tools and processes for troubleshooting and monitoring the gateway were reviewed.</p>
<p class="calibre7">While this chapter focused on using the Power BI Cloud service with on-premises data, the following chapter highlights the option to deploy Power BI exclusively on-premises via the Power BI Report Server. This includes the publication, refresh, and management of Power BI reports on-premises as well as the primary differences between the Power BI Report Server and the Power BI service.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-11">
<div id="calibre_link-1061" class="calibre2">
<div id="calibre_link-1062" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Deploying the Power BI Report Server</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The Power BI Report Server is a modern enterprise-reporting platform that allows organizations to deploy, manage, and view Power BI reports, in addition to other report types, internally. The Power BI Report Server allows large numbers of users to view and interact with the same reports created in Power BI Desktop in a modern web portal and via the same Power BI mobile applications used with the Power BI cloud service. The Power BI Report Server addresses a current and sometimes long-term need to maintain a fully on-premises BI solution that includes both data sources and reports. Additionally, the Power BI Report Server can be used in combination with the Power BI service to support scenarios in which only certain reports need to remain on premises.</p>
<p class="calibre7"><span>The Power BI Report Server has been built on top of <strong class="calibre6">SQL Server Reporting Services</strong> (<strong class="calibre6">SSRS</strong>), and therefore organizations can continue to utilize existing paginated SSRS reports and familiar management skills to easily migrate to the Power BI Report Server. In addition to Power BI and paginated reports, the <strong class="calibre6">Office Online Server</strong> (<strong class="calibre6">OOS</strong>) can be configured to allow for viewing and be interacting with Excel reports in the same report server portal, thus providing a consolidated hub of BI reporting and analysis. Moreover, when provisioned with Power BI Premium capacity, organizations can later choose to migrate on-premises Power BI reports to dedicated capacity in the Power BI service, without incurring an additional cost.</span></p>
<div class="packt_quote1"><span>"Power BI Report Server is extending our journey of giving customers more flexibility in terms of being able to deploy some of their workloads on-premises behind their firewall."</span></div>
<div class="packt_quote2"><span>                                                      &ndash; Riccardo Muti, Group Program Manager</span></div>
<p class="calibre7">This chapter reviews the primary considerations in planning and deploying the Power BI Report Server. This includes feature compatibility with the Power BI service, licensing and configuration details, and an example deployment topology. Additionally, management and administration topics are reviewed, including the scheduled data refresh of Power BI reports and monitoring <span>server </span>usage via execution log data.</p>
<p class="calibre7">In<span> </span>this chapter, we will review the following topics:</p>
<ul class="calibre12">
<li class="calibre13">Planning for the Power BI Report Server</li>
<li class="calibre13">Installation and configuration of Power BI Report Server</li>
<li class="calibre13">Power BI Desktop for Power BI Report Server</li>
<li class="calibre13">Power BI Report Server Portal</li>
<li class="calibre13">Scheduled data refresh and Live connections</li>
<li class="calibre13">Power BI mobile applications</li>
<li class="calibre13">Power BI Report Server administration</li>
<li class="calibre13">Scaling Power BI Report Server</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-334">
<div id="calibre_link-1063" class="calibre2">
<div id="calibre_link-1064" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Planning for the Power BI Report Server</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Prior to any licensing or deployment planning, an organization should be very clear on the capabilities of the Power BI Report Server in relation to the Power BI cloud service. The Power BI Report Server does not include many of the features provided by the Power BI cloud service, such as the dashboards described in <a href="#calibre_link-265" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 7</a>, <em class="calibre16">Designing Power BI Dashboards and Architectures</em>, or the apps, email subscriptions, Analyze in Excel, and data alert features reviewed in <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>. Although new features are included with new releases of the Power BI Report Server, the Power BI Report Server is not intended or planned to support the features provided in the Power BI cloud service. </p>
<p class="calibre7">Additionally, for organizations using SSRS, it's important to understand the differences between the Power BI Report Server and SSRS, such as the upgrade and support life cycle. Mapping the capabilities and the longer-term role of the Power BI Report Server in relation to a current and a longer-term BI architecture and cloud strategy is helpful in planning for the Power BI Report Server. </p>
<p class="calibre7">The following list of five questions can help guide the decision to deploy the Power BI Report Server:</p>
<ul class="calibre12">
<li class="calibre13">Do some or all reports currently need to stay on-premises and behind a corporate firewall? 
<ul class="calibre17">
<li class="calibre13">Power BI Report Server is a fully on-premises solution designed to meet this specific scenario</li>
<li class="calibre13">Alternatively, organizations can deploy the Power BI Report Server to virtual machines provisioned in Azure</li>
</ul>
</li>
<li class="calibre13">Is SSRS currently being used? 
<ul class="calibre17">
<li class="calibre13">Power BI Report Server includes SSRS and thus allows a seamless migration from an existing SSRS server</li>
<li class="calibre13">Paginated (<kbd class="calibre15">.RDL</kbd>) reports are not currently supported in the Power BI service</li>
</ul>
</li>
<li class="calibre13">Are the primary data sources for reports located on-premises and expected to remain on-premises?
<ul class="calibre17">
<li class="calibre13">As an on-premises solution, the On-premises data gateway is not required to connect to on-premises sources</li>
<li class="calibre13">As discussed in the previous chapter, some degree of query latency, hardware, and administrative costs are incurred by using on-premises data sources with the Power BI service</li>
</ul>
</li>
<li class="calibre13">Are there features exclusive to the Power BI Service that is needed?
<ul class="calibre17">
<li class="calibre13">The Power BI Report Server is limited to rendering Power BI reports (<kbd class="calibre15">.PBIX</kbd>) files, as will be discussed in the following section</li>
</ul>
</li>
<li class="calibre13">Will large import mode Power BI datasets be needed or will the Power BI reports use DirectQuery and Live connections?
<ul class="calibre17">
<li class="calibre13">The size of files that can be uploaded to the Power BI Report Server for <span>Scheduled refresh</span> is limited to 2 GB</li>
<li class="calibre13">Additionally, unlike the Power BI service, a single Power BI dataset cannot be used as a source for other reports</li>
<li class="calibre13">With Power BI Premium capacity in the Power BI Service, 10 GB and larger files (datasets) are supported</li>
</ul>
</li>
</ul>
<p class="calibre7">Given these considerations, organizations with significant on-premises investments or requirements should consider the Power BI Report Server as at least part of their BI architecture. One example of this is a large on-premises data warehouse with many existing paginated (<kbd class="calibre15">.RDL</kbd>) SSRS reports built against it.</p>
<p class="calibre7">As described in the <em class="calibre16">Hardware and user licensing</em> section later in this chapter, new Power BI reports deployed to the Power BI Report Server can later be migrated to the Power BI cloud service via the same licenses. For example, a group of related Power BI reports initially published to a folder on the Power BI Report Server could later be uploaded to an app workspace in the Power BI service. The app workspace could be assigned Power BI Premium capacity and thus the reports could be distributed to all users, including Power BI Free users, via an app, as per <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>. In addition to a straightforward migration path, many features exclusive to the Power BI service, such as dashboards, can leverage reports originally deployed to the Power BI Report Server.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-335">
<div id="calibre_link-1065" class="calibre2">
<div id="calibre_link-1066" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Feature differences with the Power BI service</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The Power BI Report Server renders Power BI reports (PBIX files) for data visualization and exploration, just like the Power BI web service. In terms of Power BI features and functionality, this is the essential scope of the Power BI Report Server. For users or organizations inexperienced with Power BI concepts (datasets, reports, and dashboards) and the Power BI service, these reports may be considered to be dashboards, and many of the additional features provided by the Power BI service, such as dashboards, app workspaces, and apps may not be known or utilized.</p>
<p class="calibre7">Although viewing and interacting with Power BI reports is clearly central to Power BI, Power BI as a <strong class="calibre6">Platform-as-a-Service</strong> (<strong class="calibre6">PaaS</strong>) and <strong class="calibre6">Software-as-a-Service</strong> (<strong class="calibre6">SaaS</strong>) cloud offering provides many additional benefits beyond the standard infrastructure cost and maintenance benefits of a cloud solution. These additional features support content management, collaboration, and the managed distribution of content throughout the organization. Prior to committing to the Power BI Report Server, it's recommended to understand the role and benefit of features exclusive to the Power BI service. </p>
<p class="calibre7">The following list of features is exclusive to the Power BI service:</p>
<ul class="calibre12">
<li class="calibre13">Dashboards</li>
<li class="calibre13">Data Alerts and Notifications</li>
<li class="calibre13">Email Subscriptions to Dashboards and Reports</li>
<li class="calibre13">App Workspaces and Apps</li>
<li class="calibre13">Quick Insights</li>
<li class="calibre13">Natural Language Query (Q &amp; A) </li>
<li class="calibre13">Content Packs</li>
<li class="calibre13">Analyze in Excel</li>
<li class="calibre13">Power BI Publisher for Excel</li>
<li class="calibre13">Streaming Datasets</li>
<li class="calibre13">ArcGIS Map Visual</li>
<li class="calibre13">R Custom Visuals</li>
</ul>
<p class="calibre7"><span>The most straightforward guide to the Power BI features supported by the Power BI Report Server is the Power BI Desktop application. With the exception of new Power BI Desktop features (released in the last 1&ndash;3 months), which are not yet available in the latest release of the Power BI Desktop version optimized for the Power BI Report Server, almost all features in Power BI Desktop, including the great majority of custom visuals, are supported by the Power BI Report Server. One additional and important exception to this, however, is row-level security. As of the October 2017 release of the Power BI Report Server, row-level security roles implemented in Power BI Desktop, as described in <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, </span><em class="calibre16">Developing DAX Measures and Security Roles</em><span>, are not supported in the Power BI Report server. </span></p>
<p class="calibre7">Several of the Power BI service features not available to the Power BI Report Server have been reviewed in earlier chapters, such as dashboards (<a href="#calibre_link-265" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 7</a>, <em class="calibre16">Designing Power BI Dashboards and Architectures</em>, and <a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content</em>). Other features exclusive to the Power BI service, including email subscriptions to dashboards and reports, Power BI apps, and data alerts, are reviewed in the following <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>. Finally, the ArcGIS Map Visual, which may be added to the Power BI Report Server in 2018, was included in <a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16">Applying Custom Visuals, Animation, and Analytics</em>.</p>
<div class="packt_infobox">Content packs of pre-built Power BI datasets, reports, and dashboards for popular online services such as Google Analytics and Salesforce are available from the Microsoft AppSource portal (<a href="http://bit.ly/2n5NB01" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2n5NB01</a>) and via the <span>Get Data</span> page of the Power BI service. These content packs, or apps, developed and maintained by third parties, allow organizations to get started quickly in analyzing this data with Power BI. Organizational content packs developed within an organization for the purpose of distributing content to users are being replaced by Power BI apps, as described in the following chapter. <br class="calibre3" />
<br class="calibre3" />
As per the <em class="calibre16">Quick insights</em> section of <a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16">Applying Custom Visuals, Animation, and Analytics</em>, certain Quick Insights features are now available in Power BI Desktop. Additionally, Q &amp; A (natural language queries) is currently a preview feature in Power BI Desktop. Given the availability of these features in Power BI Desktop, a future release of Power BI Desktop optimized for the Power BI Report Server will very likely include support for these features as well.</div>
<p class="calibre7">Since the Power BI Report Server has been built on top of SSRS, a very mature and robust enterprise reporting platform, it includes several capabilities not currently available in the Power BI service. For example, paginated reports (<kbd class="calibre15">.RDLs</kbd>) developed by tools such as Report Builder and <strong class="calibre6">SQL Server Data Tools</strong> (<strong class="calibre6">SSDT</strong>) can be deployed to the Power BI Report Server but not the Power BI service. Additionally, the mobile reports introduced in SQL Server Reporting Services 2016 and built with the Mobile Report Publisher application are also fully supported.</p>
<p class="calibre7">Furthermore, if an <strong class="calibre6">Office Online Server</strong> (<strong class="calibre6">OOS</strong>) has been deployed on-premises, Excel workbooks with external data connections to sources such as <strong class="calibre6">SQL Server Analysis Services</strong> (<strong class="calibre6">SSAS</strong>) can also be published to the Power BI Report server portal and interacted with like other reports. The ability to view and interact with Excel reports containing external data connections is not currently available in the Power BI service, but is expected in 2018. Additionally, there are plans to bring SSRS reports (<kbd class="calibre15">.RDL</kbd> files) to the Power BI Service at some point in the future.</p>
<p class="calibre7">Per the Dynamics 365 Spring 2018 Release Notes (<a href="https://aka.ms/businessappsreleasenotes" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://aka.ms/businessappsreleasenotes</a>), the ability to publish paginated SSRS reports (<kbd class="calibre15">.RDLs</kbd>) to Power BI Premium capacity in the Power BI service is expected later in 2018. This new capability will remove the requirement of deploying and managing a Power BI Report Server (or SSRS server) to support these report types. <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling with Premium and Analysis Services</em>, contains additional details on Power BI Premium capabilities exclusive to the Power BI service. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-336">
<div id="calibre_link-1067" class="calibre2">
<div id="calibre_link-1068" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Parity with SQL Server Reporting Services</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A Power BI Report Server is 100% compatible with SSRS. A Power BI Report Server can be thought of as a superset of an SSRS server in the sense that both modern Power BI reports and all SSRS features through the latest release of SSRS are included. Therefore, it's not necessary to deploy both an SSRS report server and a Power BI Report Server to support existing SSRS workloads.</p>
<div class="packt_quote1">"There is no reason, except in some edge cases, for you to be running both SSRS and Power BI Report Server." </div>
<div class="packt_quote1">             &ndash; Christopher Finlan, Senior Program Manager for Power BI Report Server</div>
<p class="calibre7"><span>It's certainly possible to deploy the Power BI Report Server along with an instance of SSRS. For example, the Power BI Report Server could be dedicated to self-service BI reports built with Power BI Desktop, while the SSRS server could be dedicated to IT developed paginated (<kbd class="calibre15">.RDL</kbd>) reports.</span></p>
<p class="calibre7"><span>For the majority of organizations, however, the Power BI Report Server and its modern web portal will be used to consolidate all report types.</span></p>
<p class="calibre7">There are three main differences between the Power BI Report Server and SQL Server Reporting Services (SSRS):</p>
<ul class="calibre12">
<li class="calibre13">Power BI Report (<kbd class="calibre15">.PBIX</kbd>) files can only be viewed from the Power BI Report Server's web portal</li>
<li class="calibre13">Excel workbooks (<kbd class="calibre15">.XLSX</kbd>) can only be viewed from the Power BI Report Server's web portal:
<ul class="calibre17">
<li class="calibre13">This requires the OOS, as described in the <em class="calibre16">Configuration</em> section later in this chapter</li>
</ul>
</li>
<li class="calibre13">The upgrade and support cycles are significantly shorter for the Power BI Report Server:
<ul class="calibre17">
<li class="calibre13">A new version of the Power BI Report Server is released approximately every 4 months</li>
<li class="calibre13">Each new version of the Power BI Report Server is supported by Microsoft for 1 year</li>
</ul>
</li>
</ul>
<p class="calibre7">New versions of SSRS will continue to be tied to the release of SQL Server. For example, SSRS 2017 was made <strong class="calibre6">generally available</strong> (<strong class="calibre6">GA</strong>) on October 2nd, 2017, along with SQL Server 2017. Although the upgrade cycle has shortened for SQL Server, it doesn't match the pace of innovation from Power BI's monthly release cycles. Therefore, to make new Power BI features available to customers with on-premises deployments, a new Power BI Report Server is released approximately every 4 months.</p>
<p class="calibre7">Unlike versions of SSRS, which continue to receive support such as cumulative updates for years following their release, support for each Power BI Report Server release ends after one year. Therefore, while upgrading to each new version of the Power BI Report Server every 4 months is not required, organizations should plan to upgrade within one year of each version's release to maintain support. Additional information and considerations on upgrade cycles are included in the <em class="calibre16">Upgrade cycles</em> section later in this chapter.</p>
<div class="packt_infobox"><span>Support for multiple instances per server represents one additional difference between the Power BI Report Server and SSRS. Currently, only one instance of the Power BI Report Server can be installed per server. Therefore, unlike SSRS, virtual machines need to be configured if multiple instances are required for the same server. </span></div>
<p class="calibre7">There are no plans to deprecate SQL Server Reporting Services or replace it with the Power BI Report Server. However, given the additional features exclusive to the Power BI Report Server and the more frequent release cycle, there are strong reasons to choose Power BI Report Server over SSRS going forward. Additionally, an existing SSRS server can be easily migrated to Power BI Report Server as discussed in the <em class="calibre16">Migrating from SQL Server Reporting Services</em> section later in this chapter. </p>
<p class="calibre7"><span>BI teams familiar with SSRS can quickly take advantage of mature features, such as report subscription schedules and role-based user permissions. For organizations running older versions of SSRS, the significant features introduced in SSRS 2016, including the modern web portal and KPIs, can further supplement their BI solution. In summary, the Power BI Report Server allows organizations to continue to fully support existing and new SSRS reports, while also enabling the self-service and data visualization features of Power BI reports.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-337">
<div id="calibre_link-1069" class="calibre2">
<div id="calibre_link-1070" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Data sources and connectivity options</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">All three connectivity options for Power BI Reports (import, DirectQuery, and Live connection) are supported by the Power BI Report Server. As one example, corporate BI teams could develop DirectQuery and Live connection reports based on a Teradata database and a SQL Server Analysis Services model, respectively. Business users with Power BI Pro licenses, however, could import data from Excel and other sources to the Power BI Desktop version optimized for the Power BI Report Server and publish those reports to the Power BI Report Server.</p>
<p class="calibre7">Power BI reports deployed to the Power BI Report Server cannot currently utilize a single Power BI dataset (PBIX file) as their data source, as described in the Live connections to the <em class="calibre16">Power BI Datasets</em> section of <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>. Given the resource limitations of the report server and the important goals of reusability and version control, this implies that DirectQuery and Live connection reports are strongly preferred for the current version of Power BI Report Server. However, the ability to reuse a published Power BI dataset (PBIX file) as a source for new Power BI reports is planned for a future release of the Power BI Report Server. Once released, BI teams will be able to isolate dataset design topics and users (such as relationships or DAX measures) from report authors just like with the Power BI service. </p>
<p class="calibre7">Imported Power BI datasets are currently limited to 2 GB file sizes. This compares to the 10 GB file size limit for Power BI datasets published to Premium capacity in the Power BI server. Therefore, if it's necessary to import data to a Power BI report for deployment to the Power BI Report Server; only include the minimal amount data needed for the specific report.</p>
<div class="packt_tip pcalibre7 pcalibre6">Avoid duplicating imported data across many reports by leveraging report pages, slicer visuals, and bookmarks. If import mode reports are required, such as when data integration is needed or when an Analysis Services model is not available, look for opportunities to consolidate report requests into a few PBIX reports that can be shared.</div>
<p class="calibre7">One advantage of the Power BI Report Server is that, as an on-premises solution, the <em class="calibre16">On-premises data gateway</em> section described in <a href="#calibre_link-15" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 9</a>, <em class="calibre16">Managing the On-Premises Data Gateway</em> is not needed. The report server service account, running either as the Virtual Service Account or as a domain user account within the local Active Directory, will be used to connect to data sources. Additional information on this connectivity, including Kerberos constrained delegation, is included in the <em class="calibre16">Installation and Configuration</em> section.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-338">
<div id="calibre_link-1071" class="calibre2">
<div id="calibre_link-1072" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Hardware and user licensing</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The rights to deploy the Power BI Report Server to a production environment can be obtained by purchasing Power BI Premium capacity or via a SQL Server Enterprise Edition with the Software Assurance agreement. Power BI Premium is the primary and recommended method as this includes both Power BI service (cloud) dedicated capacity and the Power BI Report Server at the same cost. For example, a Power BI Premium P2 SKU includes 16 v-cores of dedicated capacity in the Power BI service, as well as the right to deploy the Power BI Report Server to 16 processor cores on-premises. Furthermore, the cores provisioned via Power BI Premium can be allocated to on-premises hardware; however, the organization chooses them, such as one Power BI Report server with all 16 cores, or two Power BI Report servers with eight cores, each in a scale-out deployment.</p>
<p class="calibre7">A <strong class="calibre6">Power BI Premium P2</strong> SKU is highlighted in the following screenshot from the <span>Purchase Services</span> page of the Office 365 admin center:</p>
<div class="cdpalignleft"><img src="images/000010.png" class="calibre347" /></div>
<div class="mce-root1">Power BI Premium SKU</div>
<p class="calibre7">As shown here, premium capacities represent a subscription-based model, such as $10,000 per month with an annual commitment. Currently, a month-to-month P1 SKU with eight v-cores (P1 for Students) is available, which doesn't require an annual commitment. </p>
<p class="calibre7"><span>By licensing Power BI Report Server via Power BI Premium capacity, an organization can choose to migrate Power BI reports to the Power BI service (cloud) at a future date. For example, some or all of the Power BI reports deployed to the Power BI Report Server in 2018 could be migrated to app workspaces hosted in dedicated Power BI Premium capacity within the Power BI service in 2019. Additionally, as described in the <em class="calibre16">Hybrid Deployment Models</em> section later in this chapter, an organization could allow certain solutions to be developed with the dedicated Premium capacity in the Power BI cloud service, while other reports could remain on-premises on the Power BI Report server.</span></p>
<p class="calibre7">Once Power BI Premium capacity has been purchased, a product key required to install the report server will be available in the Power BI admin portal. The process for retrieving this key from within the Power BI service is included in the <em class="calibre16">Installation</em> section later in this chapter. Additionally, the details of Power BI Premium including the management of premium (dedicated) capacities and the additional capabilities enabled by Premium capacities for deployments to the Power BI service are included in <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling with Premium and Analysis Services</em>.</p>
<p class="calibre7"><span>As an alternative to licensing via Power BI Premium, organizations with SQL Server Enterprise Edition with Software Assurance can use their existing SQL Server licenses to deploy Power BI Report Server.</span></p>
<p class="calibre7"><span>One of the benefits of the Software Assurance program has been to provide access to new versions of SQL Server as they're released, and this benefit has been extended to include the Power BI Report Server. For example, if an organization has already licensed 24 cores to run SQL Server Enterprise Edition, with a Software Assurance agreement they could allocate 8 of those 24 cores to a server for running Power BI Report Server. Just like current SQL Server licensing, additional SQL Server products (such as SQL Server Integration Services) could also be deployed on the same eight-core server. It's essential to realize that, unlike Power BI Premium, this licensing method does not provide access to the many additional features exclusive to the Power BI (cloud) service described earlier in this chapter.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-339">
<div id="calibre_link-1073" class="calibre2">
<div id="calibre_link-1074" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Pro licenses for report authors</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In addition to licensing for the Power BI Report Server, each user who will be publishing Power BI reports (PBIX files) to the report server's web portal will also require a Power BI Pro license. In most large deployments, these are typically a small number of BI report developers and self-service BI power users, as described in the Power BI Licenses section of <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>.</p>
<p class="calibre7">Users who only view and optionally interact with reports published to the Power BI Report Server do not require Power BI Pro licenses or even Power BI Free licenses. This licensing structure (Premium Capacity + Pro licenses for report authors) further aligns the Power BI Report Server with the Power BI service. For example, similar to the <em class="calibre16">Hybrid deployment models</em> described in the following section, a report author with a Power BI Pro license would have the ability to publish one report to the Power BI Report Server and a different report to an app workspace in the Power BI service.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-340">
<div id="calibre_link-1075" class="calibre2">
<div id="calibre_link-1076" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Alternative and hybrid deployment models</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The Power BI Report Server, along with the ability to embed Power BI content into custom applications, gives organizations the option to choose a single deployment model (such as Power BI Report Server only) or a combination of deployment models in which both the Power BI Report Server and the Power BI service are utilized for distinct scenarios or content.</p>
<p class="calibre7">With both the Power BI service and the Power BI Report Server available via Power BI Premium capacity, an organization could choose to match the deployment model to the unique needs of a given project, such as using the Power BI Report Server if traditional paginated reports are needed, or if the reports need to remain on-premises for regulatory reasons.</p>
<p class="calibre7">For example, one Power BI solution for the marketing organization could be completely cloud-based, such as using Azure SQL Database as the source for Power BI reports and dashboards hosted in the Power BI service. A different solution for the sales organization could use the On-premises data gateway to query a SQL Server Analysis Services model (on-premises) from the Power BI service, as described in <a href="#calibre_link-15" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 9</a>, <em class="calibre16">Managing the On-Premises Data Gateway</em>. Finally, for scenarios in which both the data source(s) and the report/visualization layer must remain on-premises, such as for sensitive reports used by the human resources organization. Power BI reports developed against on-premises sources could be deployed to the Power BI Report server. </p>
<p class="calibre7">The following diagram describes the essential architecture of three distinct Power BI solutions: cloud only, cloud and on-premises, and on-premises only:</p>
<div class="cdpalignleft"><img src="images/000021.png" class="calibre348" /></div>
<div class="mce-root1">Power BI solutions by deployment model</div>
<p class="calibre7">In this example, Power BI reports and dashboards developed for the marketing department are hosted in the Power BI service and based on an Azure SQL Database. The sales team also has access to dashboards and reports in the Power BI service, but the queries for this content utilize a Live connection to an on-premises SSAS model via the On-premises data gateway. Finally, Power BI reports developed for the human resources department based on on-premises data sources are deployed to the Power BI Report Server.</p>
<p class="calibre7">BI solutions that utilize PaaS and SaaS cloud offerings generally deliver reduced the overall cost of ownership, greater flexibility (such as scale up/down), and more rapid access to new features. For these reasons, plans and strategies to migrate on-premises data sources to equivalent or superior cloud solutions, such as Azure SQL Data Warehouse and Azure Analysis Services, is recommended. </p>
<p class="calibre7">If multiple Power BI deployment models are chosen, BI teams should understand and plan to manage the different components utilized in different models. For example, identify the administrators, hardware, and users of the On-premises data gateway. Likewise, identify the Power BI service administrators and the tenant settings to apply, as described in <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization</em>. Additionally, as discussed in the <em class="calibre16">Upgrade cycles</em> section later in this chapter, organizations can choose either a single Power BI Desktop version to utilize for both the Power BI Report Server and the Power BI service, or run separate versions of Power BI Desktop side by side.</p>
<p class="calibre7">BI teams responsible for managing these more complex deployments should have monitoring in place to understand the utilization and available resources of the alternative deployment models. For example, rather than adding resources to a Power BI Report Server or adding another report server in a scale-out deployment, certain Power BI reports could be migrated to available to premium capacity in the Power BI service. The Power BI Premium capacities section in <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization</em>, includes details on the premium capacity monitoring provided in the Power BI service.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-341">
<div id="calibre_link-1077" class="calibre2">
<div id="calibre_link-1078" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Report Server reference topology</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The four main components of a Power BI Report Server deployment include the report server instance, the <strong class="calibre6">Report Server Database</strong>, <strong class="calibre6">Active Directory</strong>, and the data sources used by the reports. The <strong class="calibre6">Active Directory</strong> domain controller is needed to securely authenticate requests by both the data sources and the report server.</p>
<p class="calibre7">In the following diagram, a <strong class="calibre6">SQL Server</strong> database and an <strong class="calibre6">SSAS Tabular</strong> model are used as the data sources by the report server: </p>
<div class="cdpalignleft"><img src="images/000029.png" class="calibre349" /></div>
<div class="mce-root1">Power BI Report Server reference topology</div>
<p class="calibre7"><span>In the diagram, the <strong class="calibre6">Report Server Database</strong> is hosted on a separate server than the <strong class="calibre6">Power BI Report Server</strong>. This is recommended to avoid competition for resources (CPU, memory, and network) between the <strong class="calibre6">Power BI Report Server</strong> and the <strong class="calibre6">SQL Server</strong> database engine instance required for the <strong class="calibre6">Report Server Database</strong>. Additional information on the <strong class="calibre6">Report Server Database</strong> and configuring this remote connection is included in the following sections.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-342">
<div id="calibre_link-1079" class="calibre2">
<div id="calibre_link-1080" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Installation</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Once capacity (cores) to deploy the Power BI Report Server has been obtained, teams can prepare to install and configure the environment by downloading the report server software and the version of Power BI Desktop optimized for the Power BI Report Server.</p>
<p class="calibre7">Both the report server installation software and the report server version of Power BI Desktop can be downloaded from the Microsoft download center (<a href="http://bit.ly/2As4E4w" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2As4E4w</a>), as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000038.png" class="calibre350" /></div>
<div class="mce-root1">Power BI Report Server installation files</div>
<p class="calibre7">Here, the <span>Details</span> menu exposes the version of the software associated with the given release. In this example, the version <span>14.0.600.442</span> corresponds to the October 2017 version of the Power BI Report Server. The <span>Advanced</span> download options link at the top of the Power BI Report Server site (<a href="https://powerbi.microsoft.com/en-us/report-server" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://powerbi.microsoft.com/en-us/report-server</a>) also links to the MS download center.</p>
<p class="calibre7">To install Power BI Report Server to a production environment, a product key will need to be obtained from either the Power BI service or the Microsoft Volume Licensing Service Center. Additionally, teams should be aware of hardware and software requirements and other configuration settings, as described in the following sections. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-343">
<div id="calibre_link-1081" class="calibre2">
<div id="calibre_link-1082" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Hardware and software requirements</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">An instance of the SQL Server Database Engine from 2008 or later must be available to configure the Power BI Report Server. Each Power BI Report Server instance, such as <span>ATLAS\PBIRS</span> requires both a Report Server Database and a related report server temporary database on the same instance of the database engine. The Report Server Database stores content, such as reports, schedule definitions, folders, data sources, and the credentials for report data sources. The report server temporary database stores cached reports, session and execution data, and work tables generated by the report server.</p>
<div class="packt_infobox">Both the Report Server Database and the report server temporary databases should be regularly backed up but not modified or tuned. In a restore operation, if the temporary database is not backed-up, it will have to be recreated. If a backed up temporary database is used in a restore operation, the contents of the database should be deleted and the report server windows service should be restarted.</div>
<p class="calibre7"><span>The Power BI Report Server (and SSRS) also requires access to a Read-Write Domain controller to properly administer the service. The Netdom command-line tool for Windows Server can be used to determine whether the domain controller is read-only or read-write. Specifically, the <kbd class="calibre15">netdom query dc</kbd> command will return only writable domain controllers. </span></p>
<p class="calibre7">For the report server instance machine, an operating system of Windows Server 2012 or later is required, as is 1 GB of RAM, 1 GB of available hard-disk space, and an X64 processor with a clock speed of 1.4 GHz or higher. 4 GB of RAM and an X64 processor with a 2.0 GHz or a faster clock speed is recommended. Additional hard disk space will be required on the database server hosting the Report Server Database and the temporary database. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-344">
<div id="calibre_link-1083" class="calibre2">
<div id="calibre_link-1084" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Analysis Services Integrated</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The same columnar, in-memory OLAP database engine used by Analysis Services Tabular models and Power BI datasets is now built into the Power BI Report Server. This engine is used to render Power BI reports containing imported data (import mode) and DirectQuery connections. Therefore, if import mode Power BI datasets (PBIX files) will be deployed to the report server, especially large import mode files (100 MB+), a significantly greater amount of RAM will be needed on the server hosting the Power BI Report Server instance than typical reporting services deployments. Additionally, the <span>Scheduled refresh</span> operations for these large import mode reports will require both RAM and CPU resources, and this should be planned for. </p>
<div class="packt_infobox">The requirement for additional RAM could be significantly mitigated if the Live connections to Power BI datasets feature described in <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>, is made available in a future release of the Power BI Report Server. In this scenario, similar to Power BI service deployments, a single import mode dataset (PBIX file) and it's data refresh process could support many Power BI reports. </div>
<p class="calibre7">Alternatively, if the Power BI reports deployed to the Power BI Report Server will use Live connections or DirectQuery connections to data sources, the Power BI Report server will have significantly lower resource requirements. As with deployments to the Power BI service, the main driver of performance for Live connection and DirectQuery reports will be the data source receiving the query requests from the Power BI Report Server.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-345">
<div id="calibre_link-1085" class="calibre2">
<div id="calibre_link-1086" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Retrieve the Report Server product key</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">If Power Premium capacity has been purchased, the Power BI Report Server product key can be retrieved from the Power BI admin portal. The Power BI admin portal can be accessed by either an Office 365 global administrator or a user assigned to the Power BI service administrator role. For these users, a link to the <span>Admin portal</span> will be exposed from the gear icon in the top-right corner of the Power BI service:</p>
<div class="cdpalignleft"><img src="images/000047.png" class="calibre351" /></div>
<div class="mce-root1">Power BI Admin portal link</div>
<p class="calibre7"><span>The Power BI service administrator role and the assignment of this role in Office 365 were introduced in the <em class="calibre16">Power BI Project roles</em> section of <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>. Additionally, <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization</em></span>, pr<span>ovides granular details on the <span>Tenant settings</span> available in the Power BI Admin portal and other topics related to governing Power BI deployments.</span></p>
<p class="calibre7">In the following screenshot, a Power BI service administrator has accessed the <span>Capacity settings</span> menu of the <span>Admin portal</span>:</p>
<div class="cdpalignleft"><img src="images/000058.png" class="calibre352" /></div>
<div class="mce-root1">Power BI admin portal: Capacity settings</div>
<p class="calibre7">Clicking the <span>Power BI Report Server key</span> icon on the far right of the <span>Capacity settings</span> menu launches a dialog containing the key. This 25-character key value can be copied and used to complete the installation of the server:</p>
<div class="cdpalignleft"><img src="images/000068.png" class="calibre353" /></div>
<div class="mce-root1">Installation of Power BI Report Server</div>
<p class="calibre7">If Power BI Report Server is being licensed via SQL Server Enterprise Edition with Software Assurance, the product key can be downloaded from the Microsoft <strong class="calibre6">Volume Licensing Service Center</strong> (<strong class="calibre6">VLSC</strong>) via the following link: <a href="http://bit.ly/2rqefW1" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2rqefW1</a>.</p>
<p class="calibre7">An instance of the SQL Server Database Engine is not required to complete the standalone installation of the Power BI Report Server. However, as discussed in the <em class="calibre16">Hardware and software requirements</em> section, a SQL Server database engine instance is required to configure the report server. The report server is not available until it's been configured, as described in the <em class="calibre16">Configuration</em> section. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-42">
<div id="calibre_link-1087" class="calibre2">
<div id="calibre_link-1088" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Migrating from SQL Server Reporting Services</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">There is not an in-place upgrade from SSRS to the Power BI Report Server. However, migrating an existing instance of SSRS running in <span>Native</span> mode to Power BI Report Server can be accomplished via the following steps:</p>
<ol class="calibre12">
<li class="chapter">Back up the database, application, and configuration files of the existing SSRS instance:
<ul class="calibre17">
<li class="chapter"><span>The encryption key of the SSRS instance should also be backed up</span></li>
<li class="chapter">The configuration files can be found within the SQL Server installation directory (<kbd class="calibre15">&lt;install directory&gt;\Reporting Services\Report Server</kbd>), as shown in the following screenshot:</li>
</ul>
</li>
</ol>
<div class="cdpalignleft"><img src="images/000079.png" class="calibre354" /></div>
<div class="mce-root1">Reporting Services config</div>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13">The default installation directory for SSRS is <kbd class="calibre15">C:\Program Files\Microsoft SQL Server\MRS13.MSSQLSERVER</kbd></li>
</ul>
</li>
</ul>
<ol start="2" class="calibre12">
<li class="chapter">Clone the Report Server Database hosting the reports for the instance of SSRS.</li>
<li class="chapter">Install the Power BI Report Server instance via the <kbd class="calibre15">PowerBIReportServer.exe</kbd> file described earlier in this section; this installation can be on the same server as the existing SSRS instance.</li>
<li class="chapter">Configure the Power BI Report Server instance to connect to the cloned database via the Report Server Configuration Manager application:
<ul class="calibre17">
<li class="chapter">Additionally, also from the Report Server Configuration Manager, restore the backed-up encryption key</li>
<li class="chapter">The reports from the existing SSRS instance will then appear in the Power BI Report Server web portal</li>
<li class="chapter">The Report Server Configuration Manager is included with the installation of Power BI Report Server</li>
</ul>
</li>
</ol>
<p class="calibre7">The following screenshot from Report Server Configuration Manager gives the option to modify the database of the <span>ATLAS\PBIRS</span> Power BI Report Server instance:</p>
<div class="cdpalignleft"><img src="images/000090.png" class="calibre355" /></div>
<div class="mce-root1">Report Server Configuration Manager</div>
<p class="calibre7">In scenarios where the hardware or topology of a Power BI Report Server deployment needs to change, the same four-step migration process outlined here applies when migrating an instance of Power BI Report Server to a different server. The only exception is that unlike the SSRS (<span>Native</span> mode) to Power BI Report Server migration, new and existing instances of Power BI Report Server must be installed on separate servers. </p>
<p class="calibre7">Migrating from SSRS instances in SharePoint-integrated mode is more complex, as it involves copying content from the SharePoint environment to the Power BI Report Server via report server command-line utilities, such as <kbd class="calibre15">rs.exe</kbd>. Of course, if the volume of reports (<kbd class="calibre15">.RDL</kbd> files) to be migrated is limited, the files could be downloaded manually. A sample script for copying SharePoint content to a report server and further documentation on this process is available at the following URL: <a href="http://bit.ly/2DoBIs9" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2DoBIs9</a>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-34">
<div id="calibre_link-1089" class="calibre2">
<div id="calibre_link-1090" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Configuration</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Once the standalone installation of the new report server is complete (via the <kbd class="calibre15">PowerBIReportServer.exe</kbd> file), it's necessary to configure the report server with the Report Server Configuration Manager. This tool can be found within the <kbd class="calibre15">Microsoft Power BI Report Server</kbd> folder and includes an interface to 10 distinct groups of settings.</p>
<p class="calibre7">Several of these settings are outside the scope of this chapter, but configuring the following four are essential to make a report server operational:</p>
<ul class="calibre12">
<li class="calibre13"><span>Service Account</span></li>
<li class="calibre13"><span>Web Service URL</span></li>
<li class="calibre13"><span>Web Portal URL</span></li>
<li class="calibre13"><span>Database </span></li>
</ul>
<p class="calibre7">Default values are provided for the Web Service URL and Web Portal URL, such as a TCP Port of <kbd class="calibre15">80</kbd> and the URL of the web portal, respectively. When these four settings have been configured correctly, the Power BI Report Server portal should be accessible from a web browser, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000100.png" class="calibre356" /></div>
<div class="mce-root1">Power BI Report Server portal</div>
<p class="calibre7">The web portal for the Power BI Report Server instance here (<span><span>ATLAS\PBIRS</span>)</span> uses the default URL (<kbd class="calibre15">&lt;server&gt;</kbd>/<kbd class="calibre15">reports</kbd>) and the default <kbd class="calibre15">brand</kbd> package of colors and a logo. Users assigned to the system administrator role of the report server can apply a custom brand package, such as a corporate logo and color scheme, by accessing the Site settings item from the web portal, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000111.png" class="calibre357" /></div>
<div class="mce-root1">Power BI Report Server portal: Settings</div>
<p class="calibre7">Details on developing a <kbd class="calibre15">brand</kbd> package to upload and apply to a Power BI Report Server portal are included at the following URL: <a href="http://bit.ly/2F35QcO" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2F35QcO</a>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-346">
<div id="calibre_link-1091" class="calibre2">
<div id="calibre_link-1092" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Service Account</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>As discussed in the Power BI <em class="calibre16">Report Server reference topology</em> section earlier in this chapter, the database server used to host the Report Server Database is usually a separate machine than the report server instance. Therefore, a domain account or a service account with network access must be used to support the remote connection from the report server to the database server containing the Report Server Database. </span>The <span>Service Account</span> can be modified via the top tab of the Report Server Configuration Manager, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000122.png" class="calibre358" /></div>
<div class="mce-root1">Report Server Service Account</div>
<p class="calibre7">The <span>Virtual</span> <span>Service Account</span> is selected as the default service account. If the Report Server Database is created on the same machine (such as <span>ATLAS</span>) as the report server instance, this account should have no issues. However, as shown in the preceding screenshot, a <span>Network Service</span> account or a domain account can be specified as well, which can access the Report Server Database on a remote server. <span>Additional details and considerations on configuring a Report Server Database connection are included at the following URL: <a href="http://bit.ly/2F5vXA1" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2F5vXA1</a>.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-347">
<div id="calibre_link-1093" class="calibre2">
<div id="calibre_link-1094" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Remote Report Server Database</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">If a remote database engine instance is being used, TCP/IP network connectivity will need to be enabled.</p>
<p class="calibre7">This can be accomplished by logging on to the database server and opening the SQL Server Configuration Manager tool, as shown in the following screenshot: </p>
<div class="cdpalignleft"><img src="images/000132.png" class="calibre359" /></div>
<div class="mce-root1">Sql Server Configuration Manager: TCP/IP</div>
<p class="calibre7"><span>Per the screenshot, the SQL Server Network Configuration dropdown menu provides access to the protocols of the database instance (<span>MSSQLSERVER</span>). Once the <span>TCP/IP</span> protocol has been enabled (right-click | <span>Enable</span>), the database instance will need to be restarted. This option is available from the SQL Server Services menu, as shown in the following screenshot:</span></p>
<div class="cdpalignleft"><img src="images/000142.png" class="calibre360" /></div>
<div class="mce-root1">SQL Server Configuration Manager: Restart service</div>
<p class="calibre7">Finally, the port that the SQL Server instance listens on will need to be opened. This is typically port <kbd class="calibre15">1433</kbd> for <span>TCP/IP</span> connections for the default SQL Server database instance.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-348">
<div id="calibre_link-1095" class="calibre2">
<div id="calibre_link-1096" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Office Online Server for Excel Workbooks</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">One of the most exciting Power BI Report Server features introduced in 2017 was the ability to publish and view Excel workbooks on the report server portal. Although Power BI Desktop is increasingly the preferred choice for data analysis, Excel workbooks and particularly Excel connections to <strong class="calibre6">SQL Server Analysis Services</strong> (<strong class="calibre6">SSAS</strong>) models are still very important to many business users as well. Having both Excel and Power BI in the same portal, in addition to paginated reports (<kbd class="calibre15">.RDLs</kbd>) gives BI teams the flexibility to meet many different needs from the same solution. </p>
<p class="calibre7">The <strong class="calibre6">Office Online Server</strong> (<strong class="calibre6">OOS</strong>) must be installed to enable Excel online functionality in the report server. The full process and technical details for deploying the Office Online Server is available at MS DOCs via the following URL: <a href="https://docs.microsoft.com/en-us/power-bi/report-server/excel-oos" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">https://docs.microsoft.com/en-us/power-bi/report-server/excel-oos</a>.</p>
<div class="packt_infobox">If SQL Server Analysis Services is used as a data source, the account for the Office Online Server should be added as a server administrator for the instance of SSAS. SSAS admin accounts and how connections to SSAS models via these accounts enable row-level security roles to be applied to business users was described in the <em class="calibre16">Live connections to Analysis Services models</em> section of <a href="#calibre_link-15" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 9</a>, <em class="calibre16">Managing the On-Premises Data Gateway</em>. </div>
<p class="calibre7">From a Power BI Report Server configuration perspective, the <span>Office Online Server Discovery Endpoint URL</span> must be added within the <span>Advanced</span> properties of <span>Site settings</span> as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000152.png" class="calibre361" /></div>
<div class="mce-root1">Report Server portal: Site settings</div>
<p class="calibre7">This URL is the <kbd class="calibre15">InternalUrl</kbd> used when deploying the OOS server, followed by <kbd class="calibre15">/hosting/discovery</kbd>. As described at the beginning of this section, <span>Site settings</span> (Gear icon | <span>Site settings</span>) can only be accessed by users assigned to the <span>System Administrator</span> role. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-43">
<div id="calibre_link-1097" class="calibre2">
<div id="calibre_link-1098" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Upgrade cycles </h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A new version of the Power BI Report Server is released approximately every 4 months. For example, the June 2017 release was followed by an October 2017 version, which included additional features, such as support for imported data in Power BI reports. As of this writing, the next version of Power BI Report Server (following October 2017) will likely be released in the first quarter of 2018. This new version is expected to incorporate the features introduced in the monthly updates to Power BI Desktop in Q4 of 2017, such as the Bookmarks feature described in <a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16">Applying Custom Visuals, Animation, and Analytics</em>.</p>
<p class="calibre7">The following diagram describes the support provided for three hypothetical releases of the Power BI Report Server (October of 2017, February of 2018, and June of 2018):</p>
<div class="cdpalignleft"><img src="images/000162.png" class="calibre362" /></div>
<div class="mce-root1">Support for Power BI Report Server releases</div>
<p class="calibre7">Per the diagram, a new release and version (for example, February 2018) are made available approximately four months following the prior version (from October 2017 to February 2018, from February 2018 to June 2018). The latest version of the Power BI Report Server receives both security and critical updates until a new version is available.</p>
<p class="calibre7">At that point, only security updates will be made available for the remainder of the 12 months. Therefore, assuming a new version is released in June of 2018, organizations with the February 2018 release would receive security updates from June of 2018 through February of 2019. At a minimum, these organizations would want to upgrade their environment prior to February of 2019 to maintain security support.</p>
<div class="packt_infobox">The upgrade cycle is one of the reasons for choosing the Power BI service as this process is managed by Microsoft. For example, new features are automatically added to the Power BI service each month and users can update to the latest release of Power BI Desktop automatically via the Windows Store in Windows 10 operating systems. The main reason Power BI Report Server is not released more frequently, such as every 2 months, is that most IT organizations will not want to upgrade their BI environments more than three to four times per year. Some organizations are expected to skip one or two of the releases per year to coincide with their internal upgrade policies and schedules.</div>
<p class="calibre7">With each release of the Power BI Report Server, a new version of the Power BI Desktop optimized for this version of the Power BI Report server is also released. This is a distinct application from the Power BI Desktop application, which can be downloaded directly from <a href="https://powerbi.microsoft.com/en-us/" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">PowerBI.com</a> and is described more fully in the following section.</p>
<p class="calibre7">To avoid report rendering errors, it's strongly recommended to synchronize the deployment of the Power BI Report Server with its associated version of the Power BI Desktop. For example, once an upgrade to the February 2018 version of the Power BI Report Server is complete, the February 2018 version of Power BI Desktop optimized for the Power BI Report server will be installed on users machines.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-349">
<div id="calibre_link-1099" class="calibre2">
<div id="calibre_link-1100" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Report Server Desktop Application</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As shown in the <em class="calibre16">Installation</em> section earlier, a <kbd class="calibre15">PowerBIDesktopRS_x64.msi</kbd> file is also available for download from the MS Download center. This is the application used to create Power BI reports to be published to this version (October 2017) of the Power BI Report Server.</p>
<p class="calibre7">As shown in the following screenshot, this application can be distinguished from the standard Power BI Desktop via the title bar (here, October 2017) and the <span>Save As</span> menu: </p>
<div class="cdpalignleft"> <img src="images/000172.png" class="calibre363" /></div>
<div class="mce-root1">Power BI Desktop optimized for Power BI Report Server</div>
<p class="calibre7">As suggested by the <span>Save as</span> menu in the preceding screenshot, a report created via the Power BI Report Server optimized application can be saved directly to the report server. In other words, a PBIX file doesn't necessarily have to be saved to a user's machine&mdash;the Power BI Report Server can serve as a network file share. If a report needs to be modified, the user (with a Power BI Pro license), could open the file directly from the web portal described in the following section and save their changes back to the report server.</p>
<p class="calibre7">At some point in the future, a single version of Power BI Desktop that can be used for both the Power BI service and the Power BI Report Server may be released. This has been identified as an important goal that Power BI teams are currently working through, though no timelines have been suggested as of this writing. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-350">
<div id="calibre_link-1101" class="calibre2">
<div id="calibre_link-1102" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Running desktop versions side by side</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">It's possible to install and run both versions of Power BI Desktop (standard and Report Server optimized) on the same machine. This can be useful in organizations deploying reports to both the Power BI service and the Power BI Report server, as described in the <em class="calibre16">Hybrid deployment models</em> section.</p>
<p class="calibre7">For example, the standard Power BI Desktop application could be used to create a new report for an app workspace in the Power BI service, which utilizes the very latest features. The report server optimized version, however, would be used to create or edit reports that are deployed to the Power BI Report Server.</p>
<p class="calibre7">In the following screenshot from a Windows 10 machine, both versions of Power BI Desktop are pinned to the <span>Start</span> menu:</p>
<div class="cdpalignleft"><img src="images/000182.png" class="calibre364" /></div>
<div class="mce-root1">Side-by-side Power BI Desktop</div>
<p class="calibre7">In the preceding screenshot, hovering over the icon or just observing the three dots within the application tile makes it easy to distinguish the applications. As an alternative to running both applications side by side, an organization could choose to exclusively use the Power BI Report Server-optimized version of Power BI Desktop for reports published to both the Power BI service and the Power BI Report Server. This single application approach could simplify the management of the overall deployment but would prevent the utilization of the latest features available in the standard version of Power BI Desktop. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-351">
<div id="calibre_link-1103" class="calibre2">
<div id="calibre_link-1104" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Report Server Web Portal</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">With the report server installed and configured, Power BI and other types of reports can be published or uploaded to the report server. This content can then be managed, organized into folders, and viewed by users from web browsers and the Power BI mobile application.</p>
<p class="calibre7">In the following screenshot, nine report items have been published to the <span>Home</span> page of the web portal:</p>
<div class="cdpalignleft"><img src="images/000192.png" class="calibre365" /></div>
<div class="mce-root2">Power BI Report Server Web Portal</div>
<p class="calibre7">As illustrated here, Power BI reports can be easily distinguished from other report types and users can mark reports as favorites (star icon) for quick access from the <span>Favorites</span> page.</p>
<div class="packt_infobox">KPIs are created exclusively in the web portal via the <span>New</span> dropdown at the top. Paginated reports (<kbd class="calibre43">.RDL</kbd> files) can be created with the Report Builder application and with Report Server projects in <strong class="calibre6">SQL Server Data Tools</strong> (<strong class="calibre6">SSDT</strong>) for Visual Studio. Additionally, Excel workbooks can be uploaded and the Mobile Report Publisher application can be used to create and publish mobile reports (<kbd class="calibre43">.rsmobile</kbd> files).</div>
<p class="calibre7">Clicking a Power BI report, such as the <span>Customer Sales Repor</span>t, opens this report in the browser and provides the same interactive experience of filtering and cross-highlighting available in Power BI Desktop and the Power BI service.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-352">
<div id="calibre_link-1105" class="calibre2">
<div id="calibre_link-1106" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Scheduled data refresh</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Power BI reports built with a DirectQuery or Live connection to their data sources execute their queries when the report is accessed by users. For import mode Power BI reports, a <span>Scheduled refresh</span> can be configured from the <span>Manage</span> page, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000202.png" class="calibre366" /></div>
<div class="mce-root1">Scheduled refresh of Power BI report </div>
<p class="calibre7">The <span>Manage</span> page for a report can be accessed via the ellipsis (three dots) of the report icon or via right-clicking. A custom refresh schedule can be configured specific to a given report, or alternatively a shared scheduled can be created in the <span>Site settings</span> menu (Gear icon | <span>Site settings</span>). In the preceding example, the <span>Product Sales Report</span> has been assigned to a shared schedule used by other import mode sales reports.</p>
<div class="packt_tip pcalibre7 pcalibre6"><span>Given the RAM and CPU resources required to complete the refresh process for large import mode Power BI datasets, separate schedules may be configured to split this workload. Additionally, once the feature is available, a single Power BI dataset should be used as the source for other Power BI reports thus eliminating the need to refresh multiple files.</span></div>
<p class="calibre7"><span>The refresh schedules created in the Power BI Report Server's web portal are implemented as SQL Server Agent jobs. The properties of these jobs (schedule and owner) can be accessed from <strong class="calibre6">SQL Server Management Studio</strong> (<strong class="calibre6">SSMS</strong>). </span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-353">
<div id="calibre_link-1107" class="calibre2">
<div id="calibre_link-1108" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Data source authentication</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In addition to configuring a <span>Scheduled refresh</span>, report server administrators can use the <span>Manage</span> page to modify the data source properties of a report. For example, Power BI reports based on Live connections to <strong class="calibre6">SQL Server Analysis Services</strong> (<strong class="calibre6">SSAS</strong>) models will attempt to access the SSAS source as the user viewing the report by default. However, assuming that the SSAS instance is installed on a separate machine than the Power BI Report Server, <strong class="calibre6">Kerberos Constrained Delegation</strong> (<strong class="calibre6">KCD</strong>) is required for this impersonation to function. To enable this data source connection without KCD, while still respecting any row-level security defined in the SSAS model, an administrator can modify the data source properties of the report.</p>
<p class="calibre7">In the following screenshot from the <span>Manage</span> report page, a specific user credential is specified for accessing an SSAS source: </p>
<div class="cdpalignleft"><img src="images/000213.png" class="calibre367" /></div>
<div class="mce-root2">Manage report data source properties</div>
<p class="calibre7">With the check mark option enabled as in the preceding screenshot, once a connection has been opened to the SSAS model via the credential specified (<kbd class="calibre15">ATLAS\Brett Powell</kbd>), the identity of the user viewing the report can be passed to the source. In this scenario, the credential specified should be a server administrator for the source SSAS instance, thus enabling row-level security to be applied to the user viewing the report. Information on the SSAS server administrator role and user impersonation via the <kbd class="calibre15">EffectiveUserName</kbd> property is included in the Live connections to <em class="calibre16">Analysis Services Models</em> section of <a href="#calibre_link-15" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 9</a>, <em class="calibre16">Managing the On-Premises Data Gateway</em><em class="calibre16">.</em> Additionally, the following URL contains information on KCD in Windows Server 2012 (<a href="http://bit.ly/2DMCKCj" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2DMCKCj</a>).</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-354">
<div id="calibre_link-1109" class="calibre2">
<div id="calibre_link-1110" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI mobile applications</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The same Power BI mobile applications for iOS, Android, and Windows platforms used to access content published to the Power BI service can also be used with the Power BI Report Server. As shown in the following screenshot, the user has opened the <span>Settings</span> menu via the global navigation button (â¡) to connect to a report server:</p>
<div class="cdpalignleft"> <img src="images/000223.jpg" class="calibre368" /></div>
<div class="mce-root2">Power BI mobile app: Settings</div>
<p class="calibre7">From the global navigation page, the <span>Settings</span> menu can be accessed via the Gear icon at the top of the page. Clicking <span>Connect to server</span> opens a page to enter the report server address and to optionally provide a friendly name for the server, such as <span>AdWorks Report Server </span>. The server address entered should follow one of two formats:</p>
<pre class="calibre19">http://&lt;servername&gt;/reports<br class="calibre3" />https://&lt;servername&gt;/reports</pre>
<p class="calibre7"><span>The connection between the mobile application and the report server can be created by opening a port in the firewall, being on the same network (or VPN), or through a Web Application Proxy from outside the organization. Information on configuring OAuth authentication via Web Application Proxy is available at the following URL <a href="http://bit.ly/2EepW4J" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2EepW4J</a>.</span></p>
<div class="packt_infobox">Regardless of the platform (iOS or Android), up to five concurrent connections can be created to different report servers. Each report server connection will appear in the Settings menu. Additionally, the <span>Favorites</span> menu will display reports and content marked as favorites, whether that content is hosted on a Power BI Report Server or in the Power BI service.</div>
<p class="calibre7">From a business user or consumption standpoint, the <span>Phone Layout</span> and the mobile optimizations described in the Mobile Optimized Reports section of <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>, are reflected in Power BI reports accessed from the Power BI mobile app. Additionally, the KPIs that can be created in the Power BI Report Server's web portal and the mobile reports created via the Mobile Report Publisher application can also be viewed from the Power BI mobile app.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-355">
<div id="calibre_link-1111" class="calibre2">
<div id="calibre_link-1112" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Report server administration</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">BI teams deploying the Power BI Report Server will want to limit user access to specific reports and groups of reports contained in folders. For example, users or groups of users in <strong class="calibre6">Active Directory</strong> (<strong class="calibre6">AD</strong>) will be granted the right to view certain Power BI reports, while other users or groups will have the right to edit content. Additionally, BI teams will be interested in understanding the usage and performance characteristics of the content deployed to the Power BI Report Server. </p>
<p class="calibre7">The Power BI Report Server inherits mature role-based permission features and the execution history log data of SSRS. For more granular analysis of report server activity, administrators can access the <span>Report Server Service Trace Log</span>, the <span>Windows Application Log</span>, and <span>Windows Performance Counters</span>. Additional details on these sources are available at the following URL: (<a href="http://bit.ly/2DFed29" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2DFed29</a>). </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-356">
<div id="calibre_link-1113" class="calibre2">
<div id="calibre_link-1114" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Securing Power BI report content</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Several built-in security roles are available to assign to users or groups of users. This security assignment can be scoped at the folder level and is by default inherited by all reports within that folder or assigned to a specific report. </p>
<p class="calibre7">In the following screenshot, a security group (<span>AdWorksSales</span>) is assigned to the <span>Browser</span> role for the <span>Product Sales Report</span>:</p>
<div class="cdpalignleft"><img src="images/000233.png" class="calibre369" /></div>
<div class="mce-root2">Role security in Power BI Report Server</div>
<p class="calibre7">The security configuration page for both reports and folders can be accessed via the <span>Manage</span> page, as described in the <em class="calibre16">Scheduled data refresh</em> section earlier in this chapter. By default, the <span>BUILTIN\Administrators</span> group is assigned to a <span>System Administrator system-level</span> role and the <span>Content Manager item-level</span> role of the <span>Home</span> folder. </p>
<p class="calibre7">Security roles can also be created and customized in <strong class="calibre6">SQL Server Management Studio</strong> (<strong class="calibre6">SSMS</strong>). In the following example, a new user role is created that provides the same permissions as the default <span>Browser</span> role (such as <span>View Reports</span>), but also enables users to manage the comments posted to reports:</p>
<div class="cdpalignleft"><img src="images/000233.png" class="calibre369" /></div>
<div class="mce-root2">Power BI Report Server Security Roles</div>
<p class="calibre7">As shown in the preceding screenshot, the new role (<kbd class="calibre15">Browser with Comment Management</kbd>), is allowed to perform seven tasks including managing comments. There are 18 tasks, available to define a user role, which allow users to create, view, and manage report server content. This customization, along with default item level inheritance of a parent item's security, provides report server administrators with robust controls to implement role-based security.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-357">
<div id="calibre_link-1115" class="calibre2">
<div id="calibre_link-1116" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Execution logs</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Administrators of Power BI Report Servers can query and potentially build report server monitoring reports on top of execution log data maintained within the Report Server Database. This data, which is stored in the <kbd class="calibre15">ExecutionLogStorage</kbd> table, is exposed via <span>Views</span>, such as <kbd class="calibre15">dbo.ExecutionLog3</kbd>, and includes all essential attributes of report server execution history. This includes the report requested, the user requesting the report, the time, and the data size of the activity.</p>
<p class="calibre7">The names of the Report Server Database and its host server can be found via the <span>Database</span> page of the Report Server Configuration Manager application, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000243.png" class="calibre370" /></div>
<div class="mce-root2">Report Server Configuration Manager: Database</div>
<p class="calibre7">In this example, any ad hoc analyses or standard monitoring reports based on execution log data will need to access the <span>ReportServerPBI</span> SQL Server database hosted on the ATLAS server. As described in the <em class="calibre16">Report Server reference topology</em> section, the Report Server Database is usually hosted on a separate server than the instance of the Power BI Report Server (<span>ATLAS\PBIRS</span>).</p>
<p class="calibre7">In the following screenshot from SQL Server Management Studio (SSMS), the <kbd class="calibre15">ExecutionLog3</kbd> view of the <span>ReportServerPBI</span> database is queried to retrieve execution history: </p>
<div class="cdpalignleft"><img src="images/000254.png" class="calibre371" /></div>
<div class="mce-root2">Report server execution log views </div>
<p class="calibre7">As shown in the preceding screenshot, the <kbd class="calibre15">Format</kbd> field can be used to query for specific report types, such as Power BI (such as PBIX). The list of columns available in the execution log view <span>and their descriptions</span> are documented at the following URL: (<a href="http://bit.ly/2nforva" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2nforva</a>).</p>
<div class="packt_infobox">The <kbd class="calibre43">ExecutionLog</kbd> and <kbd class="calibre43">ExecutionLog2</kbd> views were created in older versions of SSRS. Therefore, if no dependencies exist on these views, <kbd class="calibre43">ExecutionLog3</kbd> is recommended.</div>
<p class="calibre7">By default, log entries are stored for 60 days. However, report server admins can modify this setting via the <span>Logging</span> page of <span>Server Properties</span>, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000264.png" class="calibre372" /></div>
<div class="mce-root2">Power BI Report Server Logging properties</div>
<p class="calibre7">Server properties are accessible by right-clicking on the context menu of the Power BI Report Server instance in SSMS. As described in the <em class="calibre16">Report Server reference topology</em> section, the report server instance and the Report Server Database (which stores the log data) are usually on separate physical servers.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-358">
<div id="calibre_link-1117" class="calibre2">
<div id="calibre_link-1118" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Scale Power BI Report Server</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Both scale-up and scale-out options are available to Power BI Report Server deployments. In a scale-up scenario, additional CPU cores can be provisioned via Power BI Premium capacity or an existing SQL Server Enterprise Edition with Software Assurance agreement. For example, if 16 cores were obtained via Power BI Premium P2 SKU, an additional 8 cores could be purchased via a P1 SKU. Additionally, particularly if import mode Power BI datasets are used, additional RAM can be installed on report servers. </p>
<p class="calibre7">In a scale-out deployment, multiple instances of Power BI Report Server are installed on separate machines. These instances share the same <strong class="calibre6">Report Server Database</strong> and serve as a single logical unit exposed to business users via the web portal.</p>
<p class="calibre7">In the following <span>diagram</span> of a scale-out deployment, business user report requests are distributed between two different instances of the Power BI Report server via a network <strong class="calibre6">Load Balancer</strong>:</p>
<div class="cdpalignleft"><img src="images/000274.png" class="calibre373" /></div>
<div class="mce-root2">Scale-out Power BI Report Servers</div>
<p class="calibre7">Servers can be added or removed from a scale-out deployment via the <span>Scale-out Deployment</span> settings page of the Report Server Configuration Manager application. This is what points each server to the same Report Server Database. In addition, to support for more users and greater usage, scale-out deployment of the report server instances also increases the resiliency of the deployment. To avoid a single point of failure, the scale-out deployment of the report servers can be coupled with high availability features for the Report Server Database, such as SQL Server Always On availability groups or a failover cluster. Additional information on configuring <span>Always On availability</span> groups with a Report Server Database is available via the following URL: <a href="http://bit.ly/2rLtSqY" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2rLtSqY</a>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-359">
<div id="calibre_link-1119" class="calibre2">
<div id="calibre_link-1120" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">This chapter reviewed the Power BI Report Server as Microsoft's modern, on-premises solution for enterprise and self-service BI. The main features of the report server and licensing requirements were described and contrasted with the Power BI cloud service. Furthermore, the core processes of installing, configuring, and administering the Power BI Report Server were detailed.</p>
<p class="calibre7">The next chapter returns to the Power BI (cloud) service and focuses on the distribution of published content to end users. This includes the delivery and management of packages of related Power BI content to large groups of users via Power BI apps. Additionally, other content delivery capabilities of the Power BI service are reviewed, including data-driven alerts and scheduled email subscriptions. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-36">
<div id="calibre_link-1121" class="calibre2">
<div id="calibre_link-1122" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Creating Power BI Apps and Content Distribution</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">This chapter walks through all facets of Power BI apps as the primary method for distributing content to groups of users. Given the one-to-one relationship between apps and app workspaces, readers should review <a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Power BI Content</em>, prior to this chapter. </p>
<p class="calibre7">In addition to apps, other distribution and data access methods are described, including email subscriptions, data alerts, SharePoint Online embedding, and Analyze in Excel. Moreover, guidance is provided on leveraging Microsoft Flow to create custom email alert notifications. <span>Distribution methods available to the Power BI Report Server and the</span><span> technical details of integrating Power BI content into custom applications are</span><span> outside the scope of this chapter. </span></p>
<p class="calibre7">In this chapter, we will review the following topics:</p>
<ul class="calibre12">
<li class="calibre13">Content distribution methods</li>
<li class="calibre13">Power BI apps</li>
<li class="calibre13">Sharing dashboards and reports</li>
<li class="calibre13">Data Alerts and notifications</li>
<li class="calibre13">SharePoint Online embedding</li>
<li class="calibre13">Report and dashboard subscriptions</li>
<li class="calibre13">Analyze in Excel</li>
<li class="calibre13">Custom application embedding</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-360">
<div id="calibre_link-1123" class="calibre2">
<div id="calibre_link-1124" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Content distribution methods</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>One the of the main value propositions of Power BI is the ability for users to access relevant analytical content in a context that's best suited to their needs. For example, many read-only users may log into the Power BI service to view dashboards or reports contained within Power BI apps specific to their role or department. Other users, however, may only receive snapshot images of reports and dashboards via Email Subscriptions or respond to data alert notifications on their mobile device. In other scenarios, certain users may analyze a dataset hosted in Power BI from an Excel workbook while other users could observe a Power BI report embedded within a team SharePoint site. </span></p>
<p class="calibre7">Organizations can choose to distribute or expose their Power BI content hosted in the Power BI service in one or a combination of methods. The following table summarizes 11 methods of content distribution and data access: </p>
<div class="cdpalignleft"><img src="images/000284.png" class="calibre374" /></div>
<div class="mce-root2">Content distribution methods in Power BI</div>
<p class="calibre7">The most common corporate BI distribution methods for supporting large numbers of users are Power BI apps and embedding Power BI content into custom applications, that is, embed in custom applications. Several other methods, however, are useful for small-scale and self-service scenarios, such as Analyze in Excel as well as supplements to larger Power BI solutions. Additionally, email subscriptions, data alerts, and embedding options can serve to streamline the analysis process and increase user productivity.</p>
<div class="packt_infobox">Organizational content packs are currently being replaced by <strong class="calibre6">Power BI Apps</strong> and thus are excluded from the preceding table. The ability to enable users to customize the content that has been distributed to them, which is currently supported via organizational content packs, will soon be supported by Power BI apps. Once Power BI apps deliver the same (and additional) capabilities as organizational content packs, the ability to create new organizational content packs will likely be removed from the Power BI service.</div>
<p class="calibre7">The Power BI mobile application aligns with and supports several of the primary distribution methods including Power BI apps, the sharing of dashboards and reports, and data alerts. Examples of the relationship between the Power BI service, Power BI mobile and other Microsoft applications and services are included in the following sections.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-361">
<div id="calibre_link-1125" class="calibre2">
<div id="calibre_link-1126" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI apps</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A Power BI app is a published collection of content from an app workspace. The app can include all or a subset of the dashboards, reports, and any Excel workbooks within an app workspace. Just as app workspaces are intended for the creation and management of Power BI content, apps are intended for the distribution of that content to groups of users. With security and permission to view the app granted, users can view with the dashboards and reports of the app within the Power BI web service or via the Power BI mobile applications.</p>
<p class="calibre7">Microsoft has been clear that Power BI apps are the future of content consumption within organizations and that they will remain simple for users to access. The app workspaces used by report authors and BI professionals to define and manage the apps, however, will become more robust. Two examples of these enhancements include display folders for grouping content within an app as well as the automatic installation of published apps for users.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-362">
<div id="calibre_link-1127" class="calibre2">
<div id="calibre_link-1128" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Licensing apps</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Apps are particularly well-suited to large, corporate BI deployments that support the reporting and analysis needs of many users. In most of these scenarios, the great majority of users only need to view certain reports or dashboards and don't require the ability to edit or create any content like Power BI Pro users.</p>
<p class="calibre7">For example, a salesperson within the northwest region of the United States may only briefly access a few dashboards or reports 2 &ndash; 3 times per week and occasionally interact with this content, such as via slicer visuals. With the Power BI Premium capacity, these read-only users can be assigned Power BI Free licenses yet still be allowed to access and view published apps. </p>
<p class="calibre7"><span>In the absence of the Power BI Premium capacity, a Power BI Pro license would be required for each user that needs to access the app. In small-scale scenarios, such as when organizations are just getting started with Power BI, purchasing Power BI Pro licenses for all users can be more cost-efficient than Power BI Premium capacities. However, at a certain volume of users, the Power BI Premium capacity becomes a much more cost-efficient licensing model. Additionally, Power BI Premium enables many other features intended to support enterprise deployments. The details of provisioning and managing Power BI Premium capacity is described in <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, </span><em class="calibre16">Scaling with Premium and Analysis Services</em>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-363">
<div id="calibre_link-1129" class="calibre2">
<div id="calibre_link-1130" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">App deployment process</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A Power BI app is published from an app workspace and inherits the name of its source workspace. Likewise, an app can only contain content from its source workspace. However, an app does not have to expose all the content of its source workspace. The members of the workspace responsible for publishing and updating the app can utilize the <span>Included in App</span> toggle switch to selectively exclude certain dashboards or reports. For example, two new reports that have yet to be validated or tested could be excluded from the app in its initial deployment. Following the validation and testing, the <span>Included in Ap</span><span>p</span> property (on the far right of each report and dashboard) can be enabled and the app can be updated, thus allowing users to access the new reports. </p>
<div class="packt_tip pcalibre7 pcalibre6">T<span>he one-to-one relationship between workspaces and apps underscores the importance of planning for the scope of an app workspace and providing a user-friendly name aligned with this scope. Too narrow a scope could lead to users needing to access many different apps for relevant reports and dashboards. Alternatively, too broad a scope could make it more difficult for users to find the reports and dashboards they need within the app. Additionally, the workspace and app-update process could become less manageable. </span></div>
<p class="calibre7">A simple publish (or update) process is available within the app workspace for defining the users or security groups who can access the app as well as adding a description and choosing a default landing page for users of the app. The details of the publish process are included in the <em class="calibre16">Publishing apps</em> section.</p>
<p class="calibre7">The following diagram and supporting five-step process describe the essential architecture of apps and app workspaces:</p>
<div class="cdpalignleft"><img src="images/000294.png" class="calibre375" /></div>
<div class="mce-root2">Global Sales app deployment process</div>
<p class="calibre7">In this example, the Global Sales app is accessed by the sales team consisting of 200 users, as per the <em class="calibre16">Sample Power BI Project template</em> section in <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>. Additionally, the row-level security roles described in <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em>, and the organizational dashboard architecture reviewed in <a href="#calibre_link-265" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 7</a>, <em class="calibre16">Designing Power BI Dashboards and Architectures</em>, are utilized by the app.</p>
<ol start="1" class="calibre12">
<li class="chapter">An app workspace is created in the Power BI service and members are added with edit rights to the workspace.
<ul class="calibre17">
<li class="chapter">Individual members (not security groups) can be added to app workspaces.</li>
</ul>
</li>
<li class="chapter">Members of the app workspace publish reports to the given workspace and create dashboards based on those reports.
<ul class="calibre17">
<li class="chapter">Power BI Desktop is used to author and publish reports based on a Live connection to a Power BI dataset.</li>
<li class="chapter">Visuals from the published reports are pinned to dashboards, such as European Sales.
<ul class="calibre17">
<li class="chapter">Dashboards are not required to publish an app.</li>
</ul>
</li>
</ul>
</li>
<li class="chapter">Scheduled data refresh or dashboard cache refresh schedules are configured and the workspace content is validated.
<ul class="calibre17">
<li class="chapter">As an import mode dataset, the dashboards and reports are updated when the scheduled refresh is completed.</li>
</ul>
</li>
</ol>
<ol start="4" class="calibre12">
<li class="chapter">A workspace administrator or a member with edit rights publishes an app from the workspace.</li>
</ol>
<ul class="calibre12">
<li class="front-matter">
<ul class="calibre17">
<li class="calibre13">The app is distributed to one or multiple <strong class="calibre6">Azure Active Directory</strong> (<strong class="calibre6">AAD</strong>) security groups of users.</li>
</ul>
</li>
</ul>
<ol start="5" class="calibre12">
<li class="chapter">Members of the sales team view and optionally interact with the content in Power BI and Power BI mobile.
<ul class="calibre17">
<li class="chapter">The dashboards and reports would reflect the row-level security roles configured in the dataset.</li>
</ul>
</li>
</ol>
<p class="calibre7">Certain sales team users requiring Power BI Pro features, such as Analyze in Excel, could utilize the Power BI app as well. Additional content access methods exclusive to Power BI Pro users, such as Email Subscriptions to dashboards and reports, are described later in this chapter.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-364">
<div id="calibre_link-1131" class="calibre2">
<div id="calibre_link-1132" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">User permissions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>BI teams distributing Power BI content via apps have two layers of control for granting users permission to view the app's dashboards and reports.</span> <span>The first layer is configured by choosing the users or security groups of users when publishing the app in the Power BI service.</span></p>
<p class="calibre7"><span>In the following image, a security group from AAD (<kbd class="calibre15">Global Sales Team</kbd>) is specified when publishing the <span>Global Sales</span> workspace as an app:</span></p>
<div class="cdpalignleft"><img src="images/000304.png" class="calibre376" /></div>
<div class="mce-root2">Publish app to a security group</div>
<p class="calibre7">In this example, a Power BI user will need to be included in the <kbd class="calibre15">Global Sales Team</kbd> security group to see and access the app. The user who published the app will also automatically be granted permission to the app. Additionally, as per the <span>Install app automatically</span> checkmark, the published app will be automatically installed for members of the <kbd class="calibre15">Global Sales Team</kbd>. These users will be able to access the installed app in the Apps menu between the <span>Recent</span> and <span>Shared with me</span> menu. An example of the Apps menu is included in the <em class="calibre16">Installing apps</em> section later in this chapter.</p>
<div class="packt_infobox">The <span>Install app automatically</span> option will only appear if this setting has been enabled in the Power BI admin portal. Specifically, a Power BI admin can enable the <span>Push apps to end users</span> setting in the <span>Tenant settings</span> page for an entire organization or for specific security groups of users. Microsoft recommends that apps should only be pushed to users during off hours and that teams should verify the availability of the app prior to communicating to a team that the published app is available. The configuration of <span>Tenant settings</span> in the Power BI admin portal is described in the following chapter.</div>
<p class="calibre7">The second layer of control is the <strong class="calibre6">row-level security</strong> (<strong class="calibre6">RLS</strong>) roles configured for the dataset supporting the reports and dashboards. If RLS has been defined within the dataset, all users accessing the app will need to be mapped to one of the RLS roles in the Power BI service.</p>
<p class="calibre7">In the following example, other Azure Active Directory security groups (for example, <kbd class="calibre15">BI Admin</kbd>) are mapped to four RLS roles:</p>
<div class="cdpalignleft"><img src="images/000314.png" class="calibre377" /></div>
<div class="mce-root2">Dataset security role assignment</div>
<p class="calibre7">As per the preceding image, a <kbd class="calibre15">BI Admin</kbd> security group is mapped to the <span>Executives</span> security role. Unlike the other three security roles, which filter the <kbd class="calibre15">Sales Territory Group</kbd> column of the <kbd class="calibre15">Sales Territory</kbd> table, the <span>Executives</span> role does not have any filters applied.</p>
<p class="calibre7">The user accessing and consuming the app will, therefore, need to be a member of both the <kbd class="calibre15">Global Sales Team</kbd> security group and one or more of the security groups assigned to an RLS role. If the user is only a member of the <kbd class="calibre15">Global Sales Team</kbd> security group (from the <span>App Access</span> page), the visuals of the dashboard and report will not render. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-365">
<div id="calibre_link-1133" class="calibre2">
<div id="calibre_link-1134" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Publishing apps</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Apps are published from app workspaces in the following way:</p>
<ol class="calibre12">
<li class="chapter">A workspace member with edit rights clicks <span>Publish</span> in the top-right corner of the app workspace.
<ul class="calibre17">
<li class="chapter">Three pages are launched for configuring the app: <span>Details</span>, <span>Content</span>, and <span>Access</span>. </li>
</ul>
</li>
<li class="chapter">On the <span>Details</span> page, a short description of the app is entered, such as the following example:</li>
</ol>
<div class="cdpalignleft"><img src="images/000324.png" class="calibre378" /></div>
<div class="mce-root2">Publish app</div>
<ol start="3" class="calibre12">
<li class="chapter">In addition to the description, a background color for the app can be selected at the bottom of the <span>Details</span> page. </li>
</ol>
<p class="calibre7"> </p>
<ol start="4" class="calibre12">
<li class="chapter">On the <span>Content</span> page, a specific <span>App landing page</span> is selected, such as the <kbd class="calibre15">Global Sales (dashboard)</kbd> in the following example:</li>
</ol>
<div class="cdpalignleft"><img src="images/000334.png" class="calibre379" /></div>
<div class="mce-root2">App landing page</div>
<p class="calibre7">In this example, users accessing the Global Sales app will land on the <span>Global Sales (dashboard)</span> by default. Alternatively, if <span>None</span> is selected, a list view of the dashboards and reports of the app will be exposed for the user to choose from. This setting is appropriate when an app contains many different dashboards and reports and diverse use cases. For example, if only a few users view the <span>Global Sales (dashboard)</span>, all other users will have to open the list view themselves to navigate to their report or dashboard.</p>
<p class="calibre7"><span>The</span> <span>Content</span> page <span>also provides a consolidated view of the dashboards, reports, and datasets that will be included in the app given the current settings. In the event that any dashboard, report, or workbook is included that shouldn't be, the user can navigate to this item in the workspace and disable the <span>Included in App</span> property. </span></p>
<div class="packt_tip pcalibre7 pcalibre6">By default, the <span>Included in App</span> property for new reports and dashboards is enabled. Therefore, prior to publishing the app, ensure that this property has been disabled for any internal testing or development content. </div>
<ol start="5" class="calibre12">
<li class="chapter">On the <span>Access</span> page, the users or security groups who should have permission to the app are defined:<br class="calibre3" />
<ul class="calibre17">
<li class="chapter">If the user publishing the app has the right to push apps to end users via the <span>Push apps to end users</span> in <span>Tenant settings</span> in the Power BI admin portal, the <span>Install app automatically</span> option will be appearing as well.</li>
<li class="chapter"><span>Click the Finish icon in the top-right corner of the <span>Access</span> page to publish the app.</span></li>
<li class="chapter">An example of the <span>Access</span> page was included in the preceding <em class="calibre16">User permissions</em> section.</li>
</ul>
</li>
</ol>
<p class="calibre7">A URL to the app will be provided in a window along with a <span>SUCCESSFULLY PUBLISHED</span> message, as per the following example:</p>
<div class="cdpalignleft"><img src="images/000344.png" class="calibre380" /></div>
<div class="mce-root2">Published app</div>
<p class="calibre7">The published app can now be accessed by the users or groups of users defined on the <span>Access</span> page. If the <span>Install app automatically</span> option was used, the user or team publishing the app can verify with a few users that the app is indeed now installed and available. Depending on the number of items (reports, dashboards) included in the app, the automatic installation could take some time. Once the automatic installation has been confirmed, an email or other communication could then be sent to advise users of the availability of the published app.</p>
<p class="calibre7">The following section describes the installation of an app if the <span>Install app automatically</span> (<span>Push apps to end users</span>) feature was not used. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-366">
<div id="calibre_link-1135" class="calibre2">
<div id="calibre_link-1136" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Installing apps</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">When an app has been published and not pushed to end users via the <span>Install app automatically</span> feature described in the previous section, a one-time install per user is necessary. This install can be completed by either sharing the URL for the app with users or by instructing users to add the app in the Power BI service.</p>
<p class="calibre7">In the following example, a user has logged into the Power BI service and clicked <span>Get apps</span> from the <span>Apps</span> menu to observe the Global Sales app: </p>
<div class="cdpalignleft"><img src="images/000354.png" class="calibre381" /></div>
<div class="mce-root2">Installing the Power BI app</div>
<p class="calibre7">The <span>Apps</span> menu can be found below the <span>Recent</span> menu and above the <span>Shared with me</span> menu. By clicking <span>Get it now</span>, the app will be added to the <span>Apps</span> menu of the user, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000364.png" class="calibre382" /></div>
<div class="mce-root2">App installed</div>
<p class="calibre7">Users can hover over the app icon, such as GS in this example, to either mark the app as a favorite or to remove the app. A new feature expected in 2018 is the ability to automatically install apps for users. For example, once the Global Sales app is published, all users assigned to the <kbd class="calibre15">Global Sales Team</kbd> security group would have the app.</p>
<p class="calibre7">A second option to install the app is to share the URL to the app provided in the Power BI service. As per the <em class="calibre16">Publishing apps</em> section, this URL is provided in a dialog when the app is first published. Additionally, this URL can be obtained from the <span>Access</span> page of the <span>Apps</span> menu, as per the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000374.png" class="calibre383" /></div>
<div class="mce-root2">App URL</div>
<p class="calibre7">In the preceding example, a member of the Global Sales app workspace has clicked <span>Update app</span> from the top-right corner of the app workspace and navigated to the <span>Access</span> page. The <span>App URL</span>, as well as other URLs specific to dashboards and reports within the app, is located below the <span>Permissions</span> input box. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-367">
<div id="calibre_link-1137" class="calibre2">
<div id="calibre_link-1138" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Apps on Power BI mobile</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Just like the <span>Apps</span> menu item in the Power BI service, users can access published Power BI apps from the main menu within the Power BI mobile application. In the following image, a user has accessed the Global Sales app on the Power BI mobile application for iOS devices:</p>
<div class="cdpalignleft"><img src="images/000383.png" class="calibre384" /></div>
<div class="mce-root2">App on Power BI mobile</div>
<p class="calibre7">The user can easily swipe between dashboards and reports and take advantage of all standard mobile features, such as the ability to annotate and share both the annotations and the content with colleagues. Additionally, any mobile optimizations configured by the report authors for the reports and dashboards are also reflected through apps. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-368">
<div id="calibre_link-1139" class="calibre2">
<div id="calibre_link-1140" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">App updates</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">One of the main advantages of Power BI apps is their isolation from app workspaces. The members of the app workspace can continue to develop, test, and modify content in the app workspace while users only view the latest published app. This single level of built-in staging could be a sufficient alternative for some teams and projects relative to the multiple workspaces (Dev, Test, Prod) involved in a staged deployment life cycle, as described in <a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content</em>.</p>
<p class="calibre7">After an app has been published, the Publish app icon in the top-right corner of the app workspace will be changed to an <span>Update app</span> icon, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000393.png" class="calibre385" /></div>
<div class="mce-root2">Update app</div>
<p class="calibre7">In the preceding screenshot, the ellipsis (three dots) to the right of the <span>Update app</span> icon has been selected from the context of the administrator for the workspace administrator. In addition to the options to edit and leave the workspace, an <span>Unpublish App</span> option exists to immediately remove user access to the published app. Workspace members (non-admins) can also unpublish the app and execute app updates. </p>
<p class="calibre7">Clicking <span>Update app</span> launches the same three pages (<span>Details</span>, <span>Content</span>, <span>Access</span>) described in the <em class="calibre16">Publishing apps</em> section. In the most common update scenarios, such as adding a new report or modifying a dashboard, it's unnecessary to change any of these settings and the <span>Update app</span> icon can be clicked a second time. However, these pages enable fundamental modifications to be implemented, including the users or groups with permission to access the app and the default landing page for the app. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-369">
<div id="calibre_link-1141" class="calibre2">
<div id="calibre_link-1142" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Dataset-to-workspace relationship</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As described in the <em class="calibre16">Workspace datasets</em> section of <a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content</em>, the Power BI reports, based on Live connections to published Power BI datasets, are currently tied to the app workspace of the dataset. Therefore, in the absence of an Analysis Services database for Live connection reports or a supported DirectQuery data source, each app workspace and its corresponding app will require its own import mode dataset. The ability to utilize a single source Power BI dataset to support reports and dashboards across multiple app workspaces (and thus apps) is expected in 2018.</p>
<div class="packt_tip pcalibre7 pcalibre6">Prior to the availability of this centralized dataset workspace, BI teams can avoid duplicating datasets by deploying large, consolidated apps. These apps would contain the reports and dashboards relevant to multiple teams (for example, Sales, Finance), and the business users could use the Favorites feature to quickly access the most relevant content. Although not ideal, this would eliminate the need to manage multiple data-refresh schedules and to keep multiple datasets synchronized to the same business definitions.</div>
<p class="calibre7">Despite new features and capabilities that will increase the scalability of Power BI datasets, particularly Power BI Premium capacity, many organizations will choose either <strong class="calibre6">SQL Server Analysis Services</strong> (<strong class="calibre6">SSAS</strong>) or <strong class="calibre6">Azure Analysis Services</strong> (<strong class="calibre6">AAS</strong>) to support large-scale deployments.</p>
<p class="calibre7">For example, a BI project targeted at a particular business process and team, such as shipping for the supply chain team, may start out as a large Power BI dataset (<kbd class="calibre15">.pbix</kbd>). Once the Power BI dataset has proven to be valuable and stable in terms of business definitions and requirements, the dataset could be migrated to an Analysis Services model. The differences between Power BI datasets and Analysis Services models as well as migration considerations are contained in <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling Up with Power BI Premium.</em></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-370">
<div id="calibre_link-1143" class="calibre2">
<div id="calibre_link-1144" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Self-Service BI workspace</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As per the <em class="calibre16">Power BI deployment modes</em> section of <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>, some organizations may choose to empower certain business users to create and manage the visualization layer (Self-Service Visualization). This hybrid approach gives business users more flexibility to address rapidly changing analytical needs, yet leverages IT-supported and validated data sources and resources. When even greater business user flexibility is required, or when IT resources are not available, the Self-Service BI mode can be implemented via Power BI Pro licenses and an app workspace.</p>
<p class="calibre7">In the Self-Service BI deployment model, several business users (for example, five to ten) who regularly collaborate within a team or department are assigned Power BI Pro licenses. One of these users then creates an app workspace in the Power BI service and adds the other users who've been assigned Pro licenses as members with edit rights. The BI/IT team would typically require that at least one member of the BI organization be added as a workspace administrator. Additionally, if applicable, the BI/IT team would authorize a few business users in the workspace to utilize an On-premises data gateway for their required data sources.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-371">
<div id="calibre_link-1145" class="calibre2">
<div id="calibre_link-1146" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Self-Service content distribution</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Given that each user has a Pro license, members of the Self-Service BI Workspace (for example, Finance Team), a user has the full flexibility to view content in the Power BI service or mobile app as well utilize pro features, such as Analyze in Excel and Email Subscriptions. The users could choose to publish an app from the app workspace and advise workspace members to only use the published app for any production scenarios, such as printing reports or dashboards or referencing this content in meetings. As a small team, the users could delegate responsibilities for creating and testing the dataset(s), reports, dashboards, and any Excel workbooks hosted in the workspace.</p>
<div class="packt_infobox">A typical example of Self-Service BI is with advanced power users within finance and accounting functions. These users often have sophisticated and rapidly changing analytical needs that can't easily be translated into corporate BI-owned solutions. Additionally, the managers or stakeholders of this team's work may not require accessing this content themselves. For example, the analyst team could produce a monthly financial close package (that is, PowerPoint deck) or a project analysis and either present this content in person or distribute printed materials.</div>
<p class="calibre7">If it's determined that the business team requires additional resources, such as support for greater scale or sharing their content with users outside the workspace, the BI/IT team can consider assigning the workspace to the Power BI Premium capacity. Additionally, if the needs or the value of the workspace grows, the project could be migrated from Self-Service BI to one of the other deployment modes.</p>
<p class="calibre7">For example, the Power BI dataset created by the business team could be migrated to an Analysis Services model maintained by the BI team.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-372">
<div id="calibre_link-1147" class="calibre2">
<div id="calibre_link-1148" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Risks to Self-Service BI</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Perhaps no greater risk exists in business intelligence than the potential to motivate or drive an incorrect decision. Several of the chapters earlier in this book, particularly <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>, through <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em>, are dedicated to topics and practices that aim to reduce that risk. Although business users and analysts are often comfortable with the visualization layer, the quality and sustainability of this content rest on the planning, testing, and skills (for example, M queries, DAX measures) applied to the source dataset. A severe risk, therefore, to Self-Service BI projects is whether the business user(s) can build and maintain a source dataset that provides consistent, accurate information. </p>
<p class="calibre7">Another significant risk is a loss of version control and change management. The workspace users may not internally manage changes to content and thus inadvertently misinterpret or share content without the knowledge of changes implemented by other users. For example, rather than only using the published app for external communication and collaborating on any updates to the app, the users could view and edit the content of the app workspace itself thus eliminating all the staging of changes. </p>
<p class="calibre7">A final risk is that the self-service solution created may ultimately need to be discarded rather than migrated. For example, to quickly respond to new and changing analytical needs, the source dataset and reports may include many inefficient customizations and design patterns. These customizations can render the solution difficult to support and potentially consume unnecessary system resources. As more users and reports become dependent on these designs or anti-patterns, it can be more difficult and costly to migrate to a more sustainable solution.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-373">
<div id="calibre_link-1149" class="calibre2">
<div id="calibre_link-1150" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Sharing dashboards and reports</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In addition to Power BI apps, Power BI Pro users can share individual dashboards and reports directly to users, security groups of users, and even guest users from outside the organization. For example, unlike a Power BI app built for the sales organization containing several dashboards and many reports, a single dashboard or report could be shared with two or three users in the customer service department. In this scenario, the few customer service department users may have limited or undefined reporting needs or the corporate BI team may not have a full Power BI app for their department prepared yet.</p>
<p class="calibre7">Recipients of shared dashboards and reports receive the same essential benefits of Power BI apps in terms of easy access as well as the latest updates and modifications to the content. In terms of user access, the <span>Shared with Me</span> menu is positioned immediately following the <span>App</span><span>s</span> menu in both the Power BI service and the Power BI mobile applications.</p>
<p class="calibre7">In the following screenshot, the user has accessed the main menu of the Power BI mobile via the navigation icon (<span>â¡</span>) at the top left:</p>
<div class="cdpalignleft"><img src="images/000403.png" class="calibre386" /></div>
<div class="mce-root2">Power BI mobile main menu</div>
<p class="calibre7">Recipients of shared dashboards and reports can also add this content to their list of <span>Favorites</span> just like Power BI apps. </p>
<p class="calibre7">The Power BI service gives content owners a properties pane to define the recipients of the shared content and whether the recipients will also be allowed to share the content. This pane can be accessed via the Share icon at the top right of the given report or dashboard when these items have been opened or from the <span>ACTIONS</span> group of the app workspace.</p>
<p class="calibre7">The following image identifies the share icon for two dashboards of the <kbd class="calibre15">Corporate Sales</kbd> app workspace:</p>
<div class="cdpalignleft"><img src="images/000413.png" class="calibre387" /></div>
<div class="mce-root2">Share Action in Power BI service</div>
<p class="calibre7">The same sharing icon from the preceding image is also exposed in the <span>ACTIONS</span> workspace column for Power BI reports.</p>
<div class="packt_infobox">Excel workbooks published to the Power BI service cannot be shared directly. To share a published Excel workbook (indirectly), a dashboard can be shared containing a tile that was pinned from the Excel workbook. The user receiving the shared dashboard can access the workbook via the dashboard tile, just like accessing a Power BI report based on a pinned report visual. </div>
<p class="calibre7"><span>Once the sharing action has been selected, a sharing properties page is launched to define the recipients who will receive access. In the following example, the <span>CUSTOMER SERVICE TRENDS</span> dashboard is being shared with</span> <kbd class="calibre15">Stacy Loeb</kbd> <span>and <kbd class="calibre15">Brett Powell</kbd>:</span></p>
<div class="cdpalignleft"><img src="images/000422.png" class="calibre388" /></div>
<div class="mce-root2">Share dashboard</div>
<p class="calibre7">As per the checkmark in the preceding image, the content owner has the option to allow recipients of the share to also share the dashboard themselves. This feature, referred to as resharing, expires one month after the share, if enabled originally. </p>
<div class="packt_tip pcalibre7 pcalibre6"><span>Sharing dashboards and reports should only be generated from app workspaces and not from a user's private <span>My Workspace</span>. The app workspace allows the workspace members to manage both the content and its distribution, and thus eliminates a dependency on a single user.</span></div>
<p class="calibre7">Members with edit rights to the app workspace containing the shared dashboard or report can manage user access following the sharing of the content. For example, several days after the <span><span>CUSTOMER SERVICE TRENDS</span></span> dashboard was shared, it may be necessary to add or remove users from the share. <span>Additionally, the ability of recipients to reshare the content can be revoked if this was enabled originally.</span></p>
<p class="calibre7"><span>In the following image, a member of the <span>Customer Servic</span><span>e</span> app workspace has again selected the Share action for the <span>CUSTOMER SERVICE TRENDS</span> dashboard but has now navigated to the <span>Access</span> pane:</span></p>
<div class="cdpalignleft"><img src="images/000004.png" class="calibre389" /></div>
<div class="mce-root2">Manage shared access</div>
<p class="calibre7">By clicking the ellipsis next to each individual user, the app workspace member (with edit rights) has the option to remove the user's access altogether or to toggle the user's access between <span>Read</span> only and <span>Read and reshare</span>. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-374">
<div id="calibre_link-1151" class="calibre2">
<div id="calibre_link-1152" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Sharing scopes</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>When a dashboard is shared, the reports containing the visuals pinned to that dashboard are shared as well. The recipient of the shared dashboard can, therefore, access and interact with the underlying reports by clicking the linked dashboard tile(s). The ability to share a report directly eliminates the need for the owners of a report to create a dashboard and for the recipients to leverage this dashboard when they only need to access the report. However, recipients of a shared dashboard can still add one or more of the underlying reports as favorites, thus providing the same ease of access as a shared report. </span></p>
<p class="calibre7">Although a single report may be all that's needed currently, sharing a dashboard provides greater scalability. For example, a shared dashboard may begin with only one report but visuals from two or three new reports could be pinned to the dashboard, thus granting access to these additional reports. This would negate the need to share each new report individually, and the dashboard could help summarize the reports for the user. When a report is shared, the only option for adding content is to add report pages to the existing report, and this can reduce the usability of the report. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-375">
<div id="calibre_link-1153" class="calibre2">
<div id="calibre_link-1154" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Sharing versus Power BI apps</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Just like Power BI apps, either Power BI Pro licenses or Power BI Premium capacity can be used to enable user access. In the example from this section, both <kbd class="calibre15">Stacy Loeb</kbd> and <kbd class="calibre15">Brett Powell</kbd> could be assigned Power BI Pro licenses to allow both users to view the shared content. Alternatively, the app workspace (<span>Customer Service</span>) of the shared content could be assigned to a Power BI Premium capacity, thus allowing Power BI Free users to access the content. The same licensing considerations for external guest users described in the <em class="calibre16">Power BI apps</em> section applies to sharing dashboards and reports.</p>
<p class="calibre7">Also, like Power BI apps, the recipients of the shared dashboard or report will need to be mapped to an RLS role if RLS has been configured on the source dataset. The users attempting to access the shared content will receive an error message if this mapping is not implemented within the security settings of the dataset, as described in the <em class="calibre16">User permission</em>s section earlier in this chapter. </p>
<p class="calibre7">Ultimately, Power BI apps provide the best long-term solution for content distribution, particularly for groups of users. Unlike sharing dashboards and reports, any number of new dashboards and reports can be added to Power BI apps as needs grow and change. Additionally, as described earlier in this chapter, owners of the app workspace can stage and test content prior to republishing the app via the app update process. In the case of shared dashboards and reports, any revision to the shared content is immediately visible to the user(s).</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-376">
<div id="calibre_link-1155" class="calibre2">
<div id="calibre_link-1156" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">SharePoint Online embedding</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Many organizations use team sites in SharePoint Online to facilitate collaboration between colleagues. These sites often contain important team or departmental documents (that is, Word, PowerPoint), calendars, and relevant links. Via the Power BI report web part for SharePoint Online, a Power BI report can be embedded into a SharePoint Online page to further enrich these sites.</p>
<div class="packt_infobox">Yana Berkovich, Microsoft Data Platform MVP and collaboration consultant, has co-authored this section.</div>
<p class="calibre7">Technically, the SharePoint Online embedding process consists of two steps within the Power BI service and two steps within SharePoint Online. However, the following 12 step process can be used to effectively plan and implement the embedding:</p>
<ol class="calibre12">
<li class="chapter">Identify the business users of the team site who will need to view the embedded Power BI report.</li>
<li class="chapter">Identify the app workspace and the report within that workspace that will be embedded in the team site.</li>
<li class="chapter">Determine which of the following two options will be used to authorize the SharePoint Online site users:
<ul class="calibre17">
<li class="chapter">Assign Power BI Pro licenses to each user and add these users as members of the app workspace.</li>
<li class="chapter">Assign the app workspace to the Power BI Premium capacity such that Power BI Free users can view the content. </li>
</ul>
</li>
</ol>
<ol start="4" class="calibre12">
<li class="chapter">Open the report in the Power BI service and select <span>Embed in SharePoint Online</span> from the <span>File</span> menu dropdown:
<ul class="calibre17">
<li class="chapter">The embed URL is provided via a dialog, per the following screeshot:</li>
</ul>
</li>
</ol>
<div class="cdpalignleft"><img src="images/000014.png" class="calibre390" /></div>
<div class="mce-root2">Embed link to Power BI report</div>
<ol start="5" class="calibre12">
<li class="chapter">In a modern SharePoint Online page, click the add (<span>+</span>) icon and select the <span>Power BI</span> web part, as shown in the following screenshot:</li>
</ol>
<div class="cdpalignleft"><img src="images/000025.png" class="calibre391" /></div>
<div class="mce-root2">Add Power BI report web part</div>
<ol start="6" class="calibre12">
<li class="chapter">The add (<span>+</span>) icon to add a web part is provided by default for new site pages. For existing site pages, clicking the Edit icon in the top right will provide the same add (<span>+</span>) icon.</li>
</ol>
<div class="packt_tip pcalibre7 pcalibre6">If the page's version hasn't already been set to modern, contact the SharePoint or Office 365 administrator as this is required to use the Power BI web part.</div>
<ol start="7" class="calibre12">
<li class="chapter">Select the <span>Add report</span> command button to access the web part property pane for configuring the embedded report.
<ul class="calibre17">
<li class="chapter">This will launch the web part property pane on the right, including an input box for the Power BI Report URL.</li>
</ul>
</li>
<li class="chapter"> Paste the Power BI report URL into the <span>Power BI report link</span> input box.
<ul class="calibre17">
<li class="chapter">Use the <span>Page name</span> dropdown to select the default page that is shown on the report page.</li>
</ul>
</li>
<li class="chapter">Configure the web part via the <span>Display</span> (for example, <span>16:9</span>), <span>Show Navigation Pane</span>, and <span>Show Filter Pane</span> properties.
<ul class="calibre17">
<li class="chapter">The <span>Show Navigation Pane</span> should be enabled if users require access to multiple pages of the report.</li>
</ul>
</li>
<li class="chapter">In the following screenshot, a Power BI report with two report pages (<span>General,</span> <span>Agents</span>) has been embedded into a SharePoint Online site page:</li>
</ol>
<div class="cdpalignleft"><img src="images/000032.png" class="calibre392" /></div>
<div class="mce-root2">Power BI report embedded in SharePoint Online site page</div>
<ol start="11" class="calibre12">
<li class="chapter">Once embedded in the site page, the web part will reflect data refreshes and any report modifications implemented in Power BI. </li>
<li class="chapter">Click the <span>Publish</span> button on the top-right of the site page to make the embedded report visible to site users. 
<ul class="calibre17">
<li class="chapter">When finished on the site page, click <span>Save and Close</span> on the left side of the page.</li>
</ul>
</li>
</ol>
<div class="packt_quote1"><span>"Share Power BI reports where team collaboration is done to provide users with greater context and to drive overall productivity."<br class="calibre3" />
<br class="calibre3" /></span> <span>                                            &ndash; Yana Berkovich, Microsoft Data Platform MVP </span><span><br class="calibre3" /></span></div>
<p class="calibre7">As described in <a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content</em>, security groups are not supported for adding members to app workspaces. Therefore, if large numbers of users require access to Power BI reports via SharePoint Online, assigning the workspace(s) to the Power BI Premium capacity can both simplify management and reduce the cost of individual Power BI Pro licenses. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-377">
<div id="calibre_link-1157" class="calibre2">
<div id="calibre_link-1158" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Custom application embedding</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In addition to SharePoint Online embedding, the Power BI API can be leveraged to embed reports, dashboards, and individual dashboard tiles into any custom application. With the Power BI Premium capacity provisioned, content developed in the Power BI service can be embedded in new or existing applications for an organization so that Power BI Free users are able to view this content. Depending on the Power BI Premium SKU purchased, an organization can exclusively embed Power BI content in their application(s) or use embedding along with the Power BI service portal for content consumption. </p>
<p class="calibre7">Two kinds of Power BI Premium SKUs are available in the Office 365 portal that support embedding: P SKUs and EM SKUs. The EM SKUs are exclusive to custom applications and other <strong class="calibre6">software as a service</strong> (<strong class="calibre6">SaaS</strong>) offerings, such as SharePoint Online and teams. Power BI Free users are able to view embedded Power BI content in these applications but cannot view content in the Power BI service (<a href="https://powerbi.microsoft.com/en-us/" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">PowerBI.com</a>). Power BI Premium P SKUs, however, support both embedding content in custom applications as well as user access in the Power BI service, such as via Power BI apps. For example, an organization could use the same P3 SKU to support four Power BI apps and the embedding of content in a custom application.</p>
<div class="packt_infobox">The third type of SKU that supports embedding Power BI content in custom applications is the A SKU. These SKUs are also referred to as Power BI Embedded and are exclusively available in the Microsoft Azure portal. A SKUs, or Power BI Embedded, are targeted at <strong class="calibre6">independent software vendors</strong> (<strong class="calibre6">ISVs</strong>) who will provide users from external organizations with access to the embedded content. As an Azure resource, the software vendor can utilize familiar development and operations processes, including the ability to scale up, down, and pause or resume the provisioned resources as workloads change.</div>
<p class="calibre7">Monthly billing and both monthly and yearly commitment options are available for Power BI Premium EM and P SKUs. Given their more limited scope, EM SKUs are significantly less expensive than P SKUs. In the following screenshot from the Office 365 admin center, the Power BI Premium EM SKU is available for purchase: </p>
<div class="cdpalignleft"><img src="images/000042.png" class="calibre393" /></div>
<div class="mce-root2">Power BI Premium &ndash; EM3</div>
<p class="calibre7">As shown in the preceding screenshot, the EM3 SKU provides four virtual cores and is available via month-to-month commitments. Currently, the EM3 SKU is the largest of the EM Premium SKUs in terms of virtual cores and memory but is the only EM SKU available in the Office 365 admin center. The EM1 and EM2 SKUs, which have fewer resources and thus lower prices, must be purchased through Microsoft volume licensing. For example, the EM1 SKU currently includes one virtual core, 3 GB of RAM, and is priced at $625 per month.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-378">
<div id="calibre_link-1159" class="calibre2">
<div id="calibre_link-1160" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Publish to web</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">If enabled by the Power BI administrator, reports in the Power BI service can also be embedded on any website and shared via URL on the public internet. The <span>Publish to web</span> feature provides an embed code for the Power BI report, including iFrame HTML and a report URL. Organizations can utilize <span>Publish to web</span> to expose non-confidential or publicly available information on their public-facing corporate website.</p>
<p class="calibre7">In the following screenshot, a <span>Publish to web</span> embed code has been obtained in the Power BI service:</p>
<div class="cdpalignleft"><img src="images/000051.png" class="calibre394" /></div>
<div class="mce-root2">Publish to web embed code</div>
<p class="calibre7">The <span>Publish to web</span> feature is accessed via the <span>File</span> menu dropdown for a report, just like the SharePoint Online embedding URL from the previous section. However, unlike the SharePoint Online embedding feature, the Power BI service stores the <span>Publish to web</span> embed codes so that both administrators and users with edit rights to the reports can access and manage these codes.</p>
<p class="calibre7">For example, a member of an app workspace with edit rights can use the settings menu (Gear icon) to access a <span>Manage embed codes</span> page. This page allows the user to retrieve or delete any embed codes for the given app workspace. </p>
<div class="packt_infobox">With the exception of custom visuals built with the R language, custom visuals are supported in Publish-to-web reports. This is the same limitation currently in place with the Power BI Report Server as described in <a href="#calibre_link-11" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 10</a>, <em class="calibre16">Deploying the Power BI Report Server</em>. Reports based on datasets with row-level security roles configured and reports that use on-premises Analysis Services Tabular models are not supported.</div>
<p class="calibre7">Given the obvious potential risk of users accidentally sharing confidential or protected information over the public internet, Power BI administrators have granular controls over this feature including the ability to disable it for the entire organization. Details of these administrative settings are included in <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization.</em></p>
<p class="calibre7"><span>Power BI reports accessed via embed codes will reflect the latest data refresh of the source dataset within approximately one hour of its completion. Additional documentation on Publish to web, including tips for fitting the iFrame into websites, is available at <a href="http://bit.ly/2s2aJkL" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2s2aJkL</a>.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-379">
<div id="calibre_link-1161" class="calibre2">
<div id="calibre_link-1162" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Data alerts</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Data-driven alerts are one of the top capabilities exclusive to dashboards in the Power BI service. For many users and business scenarios, data-driven alerts are a high-value complement, or even a substitute, to dashboards and reports as they help to avoid frequently accessing Power BI to search for actionable information. For example, rather than opening Power BI in the browser or on a phone every morning and looking for red colors or certain KPI symbols, the user could view certain dashboards or reports only once a week and otherwise only respond to data-driven alert notifications sent via email. </p>
<p class="calibre7">With a standard card, KPI, or gauge visual pinned to a dashboard, a data-driven alert can be configured either in the Power BI service or via the Power BI mobile app. In the following screenshot, a separate data alert has been configured for the gauge, the KPI, and the card visual reflecting the current day's average call length, staff versus target, and service calls, respectively: </p>
<div class="cdpalignleft"><img src="images/000062.png" class="calibre395" /></div>
<div class="mce-root2">Manage alerts in Power BI service</div>
<p class="calibre7">The manage alerts option (bell icon), accessed by clicking the ellipsis in the top right corner of the tile, is only available for the standard gauge, KPI, and card visuals. In the following screenshot, an alert rule is set for the <span>Today's Call Length</span> measure, represented by the gauge visual:</p>
<div class="cdpalignleft"><img src="images/000072.png" class="calibre396" /></div>
<div class="mce-root2">Setting an alert rule</div>
<p class="calibre7">In this screenshot, the target value from the gauge (<span>10</span>) is set as the threshold value of the alert rule by default. However, per the alert rule dialog in the preceding image, <span>Alert title</span>, the <span>Threshold</span> value, the <span>Condition</span> (<span>Above</span> or <span>Below</span>), the <span>Maximum notification frequency</span>, and the email notification can all be configured per alert rule. Only the <span>Set alerts rule for</span> input box is not configurable as this is based on the measure within the tile, in this case the <span>Today's Call Length</span> measure.</p>
<div class="packt_infobox">Each alert rule is limited to a single condition and thus additional alert rules can be configured for the same dashboard tile to provide notifications for multiple conditions. For example, a separate alert rule could be configured for the gauge tile with a condition of <span>Below</span> <span>3</span>. When the underlying dataset of the dashboard tile is refreshed, a value for the <span>Today's Length Measure</span> of <span>Above</span> <span>10</span> or <span>Below</span> <span>3</span> would trigger an alert notification. </div>
<p class="calibre7">Data alerts and notifications are deeply integrated with the Power BI mobile applications. In the following screenshot from an iPhone, data alert notifications associated with each tile (3) are promoted to the Power BI mobile app icon:</p>
<div class="cdpalignleft"><img src="images/000083.png" class="calibre397" /></div>
<div class="mce-root2">Data alert notification on iPhone</div>
<p class="calibre7">Additionally, as shown in the preceding screenshot, the notification associated with each alert rule is presented on the home screen including <span>ALERT TITLE</span>, <span>VALUE</span>, <span>CONDITION</span>, and <span>THRESHOLD</span>. Clicking on the Power BI mobile app icon provides access to the notifications pane that, like the Power BI Service, includes a link to the specific tile for further analysis. Between the mobile alert notifications, the notifications within the Power BI service, and the optional email delivery of the notification, users are able to respond quickly as significant data changes occur.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-380">
<div id="calibre_link-1163" class="calibre2">
<div id="calibre_link-1164" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Microsoft Flow integration</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>Currently, the alert notification emails from Power BI are limited to the the user who configured the data alert. In many scenarios, however, several users or a group email account should receive the notification email and it's not practical for each user to individually configure the data alerts.</span></p>
<p class="calibre7"><span>Microsoft Flow provides a powerful but easy-to-use alternative to the standard Power BI alert email. For example, without any custom data connections or code, it enables a single user to fully define one or multiple email recipients of an alert notification and to customize the content of this message.</span></p>
<p class="calibre7"><span>Microsoft Flow is an online service that enables the automation of workflows between applications and services. Since each MS flow is fundamentally composed of a trigger (starting action) and one or more corresponding actions, a top use case for MS Flow is to send custom email messages based on various trigger events. For example, when a sales lead is added in Salesforce, an email could be automatically sent to a sales team member via MS Flow.</span></p>
<p class="calibre7">Several pre-built MS Flow templates are available that leverage the Power BI data alert as a trigger. These templates make it easy to get started and to customize details, such as email addresses and the data from the alert to include. In the following MS Flow, the <span>Today's Average Call Length</span> alert described in the <em class="calibre16">Data alerts</em> section is used as the trigger of a customized email via an Office 365 for Outlook account:</p>
<div class="cdpalignleft"><img src="images/000093.png" class="calibre398" /></div>
<div class="mce-root2">Power BI alert email via MS Flow</div>
<p class="calibre7">Power BI icons associated with the data alert trigger are available when populating the send email action via the Outlook for Office 365 connector. In the preceding screenshot, text labels with a closing colon are positioned in front of the icons to make the alert email messages easy to understand. The following sample email message reflects the preceding MS Flow configuration:</p>
<div class="cdpalignleft"><img src="images/000104.png" class="calibre399" /></div>
<div class="mce-root2">Power BI alert email message via MS Flow</div>
<p class="calibre7">MS Flow provides a rich platform for building both simple and complex workflows to obtain greater value from Power BI assets. Other common MS Flow and Power BI integrations, beyond custom email notifications, include posting messages to a Slack channel and triggering an alert in Microsoft Teams based on an alert in Power BI.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-381">
<div id="calibre_link-1165" class="calibre2">
<div id="calibre_link-1166" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Email Subscriptions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Power BI also provides Email Subscriptions for Power BI Pro users of both reports and dashboards. With Email Subscriptions configured in the Power BI service, a user is sent a snapshot of either the report page or the dashboard canvas as well as a link to the content in the Power BI service. In the following service. In the following screenshot, a user with a Power BI Pro license has accessed the <span>Global Sales (dashboard)</span> described earlier in this chapter from within a Power BI app:</p>
<div class="cdpalignleft"><img src="images/000115.png" class="calibre400" /></div>
<div class="mce-root2">Subscribe to dashboard</div>
<p class="calibre7">Clicking the subscribe icon shown in the preceding image opens the following dialog to confirm the email subscription:</p>
<div class="cdpalignleft"><img src="images/000125.png" class="calibre401" /></div>
<div class="mce-root2">Dashboard Email Subscription</div>
<p class="calibre7">With the yellow slider set to <span>On</span>, selecting <span>Save and close</span> at the bottom of the dialog enables the email subscription to the dashboard. An email containing an image of the current state of the dashboard and a link to the dashboard in Power BI will then be sent when any of the underlying datasets change. If the source datasets refresh more than once per day, only the first email snapshot of the refresh will be sent. </p>
<div class="packt_infobox">A very similar subscription icon and dialog is also available for Power BI reports. The only significant difference with report subscriptions is that each subscription is associated with a single page. Therefore, the Power BI Pro user must choose the page for each subscription and configure multiple subscriptions to the same report if multiple pages of the report need to be emailed. </div>
<p class="calibre7"><span>At this time, similar to data alerts, Email Subscriptions are only associated with the user who creates the subscriptions. However, the Power BI team has advised that they intend to enhance Email Subscriptions to include subscribing others to emails, such as security groups of users. Additionally, Email Subscriptions are currently sent with the report's default filter and slicer states. Per the Power BI team, this limitation is also expected to be addressed by allowing subscriptions to reports with specific slicer and filter states set.</span></p>
<p class="calibre7"><span>Finally, emails are only sent to the <strong class="calibre6">User Principal Name</strong> (<strong class="calibre6">UPN</strong>) used to log into the Power BI service. For example, if the <kbd class="calibre15">Mark Langford</kbd> user doesn't receive email at his Power BI account (<kbd class="calibre15">Mlangford@AdWorks.onmicrosoft.com</kbd>), he will not receiv</span>e Email Subscriptions. The Powe<span>r BI documentation advises that the Power BI team is working to relax this limitation as well.</span></p>
<div class="packt_infobox"><span><strong class="calibre6">Email Subscriptions</strong> do not support most custom visuals. However, certified custom visuals, such as the Power KPI visual used in the</span> <span><span>Global S</span><span>ales (dashboard)</span></span>, <span>are supported. Additional details on certified custom visuals can be found in the <em class="calibre16">Custom visuals</em> section of <a href="#calibre_link-11" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 10</a>, <em class="calibre16">Deploying the Power BI Report Server</em>.</span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-382">
<div id="calibre_link-1167" class="calibre2">
<div id="calibre_link-1168" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Analyze in Excel</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Users with Power BI Pro licenses can connect to datasets hosted in the Power BI service from both Power BI Desktop and Microsoft Excel. Either of these tools will display the fields list of tables and measures for the dataset and, based on the report visuals created (for example, pivot tables), send queries to Power BI for execution by the source dataset. In the case of Power BI Desktop, these reports can be published back to the Power BI service and will retain their connection to the dataset, as recommended in the <em class="calibre16">Live connections to Power BI datasets</em> section of <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>.</p>
<p class="calibre7">Excel reports based on these connections, however, currently do not retain their connection and thus cannot be refreshed or interacted with in the Power BI service. Despite this limitation, and the many additional analytical and visualization features of Power BI Desktop, Excel remains a very popular tool given its inherent flexibility and its mature, familiar features. Power BI's deep support for Excel, including both Analyze in Excel and the Power BI publisher for Excel, is an advantage over other BI platforms. </p>
<p class="calibre7">Additionally, t<span>he limitation of external data connections from Excel in the Power BI service is expected to be removed in 2018. The Power BI Report Server, for example, already supports Excel workbooks with Live connections as described in the</span> <em class="calibre16">Office Online Server for</em> <span><em class="calibre16">Excel workbooks</em> section in <a href="#calibre_link-11" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 10</a>, <em class="calibre16">Deploying the Power BI Report Server</em>. </span></p>
<div class="packt_tip pcalibre7 pcalibre6">Prior to broadly recommending Excel as a client-reporting tool, consider whether Power BI Desktop isn't better suited to common use cases, such as pivot tables. Many new features were added to Power BI Desktop in 2017 that targeted Excel pivot table scenarios, such as showing multiple metrics on rows, granular formatting, layout controls, and displaying values as a percentage of the total. Additionally, as the adoption of Power BI increases, Power BI reports built in Power BI Desktop provide a richer and more familiar user experience. </div>
<p class="calibre7">The Analyze in Excel feature is exposed as an action for Power BI reports via an Excel workbook icon in the Power BI service. The action is accessible in both app workspaces and in published apps for Power BI Pro users. In the following example from an app workspace, the option to analyze the <kbd class="calibre15">Monthly Sales Summary</kbd> report in Excel is available on the right: </p>
<div class="cdpalignleft"><img src="images/000135.png" class="calibre402" /></div>
<div class="mce-root2">Analyze in Excel icon</div>
<p class="calibre7">Clicking the Analyze in Excel icon provides a <strong class="calibre6">Microsoft Office Data Connection</strong> (<strong class="calibre6">ODC</strong>) file that can be saved to the local machine. By default, opening this file launches Excel with a connection to the source dataset of the Power BI report. For example, even though the <kbd class="calibre15">Monthly Sales Summary</kbd> may only utilize a few measures and columns of the dataset, the entire fields list of the dataset will be exposed with a pivot table connection in Excel, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000145.png" class="calibre403" /></div>
<div class="mce-root2">Excel connection to the Power BI dataset</div>
<p class="calibre7">Similar to the fields list in Power BI Desktop, Excel positions tables with only measures visible at the top of the list preceding the dimension tables. Just like standard Excel pivot tables, users can drag measures and columns to the field wells to structure each pivot table report. Right-clicking a column name, such as <kbd class="calibre15">Employee</kbd> department, presents the option to add the column as a slicer.</p>
<p class="calibre7">Just like interacting with a Power BI report, any RLS roles applied on the source dataset will be enforced on the user's report queries generated from Excel. The Excel workbook and any reports created based on the connection can be saved and shared like other Excel workbooks. However, for other users to refresh and query the source dataset from Excel, they will need access to the app or app workspace, a Power BI Pro license, and will need to be mapped to a security role if RLS has been configured. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-383">
<div id="calibre_link-1169" class="calibre2">
<div id="calibre_link-1170" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI Publisher for Excel</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In addition to the Analyze in Excel feature from the Power BI service, even deeper integration with Excel is possible via the Power BI publisher for Excel add-in. This add-in can be downloaded from the Power BI service via the same drop-down menu used for the On-premises data gateway, as illustrated in the <em class="calibre16">Configuration of on-premises gateway</em> section of <a href="#calibre_link-15" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 9</a>, <em class="calibre16">Managing the On-Premises Data Gateway</em>. Once downloaded and installed, a <span>Power BI</span> tab will be visible on the Excel ribbon:</p>
<div class="cdpalignleft"><img src="images/000155.png" class="calibre404" /></div>
<div class="mce-root2">Power BI Publisher for Excel </div>
<p class="calibre7">Via the <span>Connect to Data</span> button, users can access the reports and datasets of the app workspaces they have permissions to. For example, rather than navigating to the specific Power BI report of interest in the Power BI service to access the Analyze in Excel feature, the user could simply select the workspace and a report or dataset from a dropdown in Excel.</p>
<p class="calibre7">In the following screenshot, the user has clicked the <span>Connect to Data</span> button and navigated to the <kbd class="calibre15">World Tour - New York</kbd> app workspace:</p>
<div class="cdpalignleft"><img src="images/000165.png" class="calibre405" /></div>
<div class="mce-root2">Connect to Data</div>
<p class="calibre7">The same Power BI workspaces and datasets accessible from Power BI Desktop can be accessed via the <span>Connect to Data</span> feature. Additionally, the Power BI publisher for Excel enables users to pin items, such as ranges of cells or charts, to dashboards in the Power BI service and to manage updates to these local items. Additional information on the Power BI publisher for Excel is available here: <a href="http://bit.ly/2nuzQIt" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2nuzQIt</a>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-384">
<div id="calibre_link-1171" class="calibre2">
<div id="calibre_link-1172" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">This chapter provided a broad overview of Power BI's different content distribution and data access methods. Power BI apps were particularly emphasized as they represent the primary distribution mechanism supporting large groups of users going forward. The essential details of utilizing other distribution methods, such as email Subscriptions, data alerts, and sharing reports and dashboards were also reviewed. Furthermore, guidance was provided on analyzing the impact or usage of a published app as well as utilizing Microsoft Flow to drive custom email alerts.</p>
<p class="calibre7">The following chapter looks at Power BI deployments from an administration perspective. This includes the Power BI service administrator role and the controls available for administrators to define and manage authentication, monitor user activities, and limit or disable various features. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-6">
<div id="calibre_link-1173" class="calibre2">
<div id="calibre_link-1174" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Administering Power BI for an Organization</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The management and administrative processes described in previous chapters have primarily reflected the role of corporate business intelligence teams and BI professionals. In this chapter, the features and processes relevant to IT administrators are reviewed, to help organizations deploy and manage Power BI according to their policies and preferences. This includes data governance in the context of both self-service BI and corporate BI, the Power BI admin portal, monitoring user activity and adoption, and the administration of Power BI Premium capacity.</p>
<p class="calibre7">As in the previous chapter, this chapter exclusively covers the Power BI service. Administrative topics relevant to the on-premises deployments that were included in <a href="#calibre_link-11" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 10</a>, <em class="calibre16">Deploying the Power BI Report Server</em>. Additionally, although data governance concepts and implementation guidance are included, readers are encouraged to review Microsoft documentation for further details on implementing data governance as part of Power BI deployments.</p>
<p class="calibre7">In this chapter, we will review the following topics:</p>
<ul class="calibre12">
<li class="calibre13">Data governance for Power BI</li>
<li class="calibre13">Azure Active Directory conditional access policies</li>
<li class="calibre13">Azure Active Directory B2B collaboration</li>
<li class="calibre13">Power BI admin portal</li>
<li class="calibre13">Power BI service Tenant settings</li>
<li class="calibre13">Power BI activities in Audit Logs</li>
<li class="calibre13">Using metrics reports</li>
<li class="calibre13">Administering Power BI Premium capacities</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-385">
<div id="calibre_link-1175" class="calibre2">
<div id="calibre_link-1176" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Data governance for Power BI</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><strong class="calibre6">Data governance</strong> is defined as a set of policies to secure an organization's data, ensure consistent and accurate decision making, and to manage access to data. Data governance is applicable to business intelligence generally, but organizations investing in Power BI for the long term should consider their data governance strategy and policies in the context of Power BI. A central component of data governance relates to the three deployment modes described at the beginning of <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects, </em>and seeks to address the following question: "How can we ensure our data is secure and accurate while still providing the business with the access and flexibility it needs?"</p>
<p class="calibre7">It's generally understood that some level of <strong class="calibre6">self-service BI</strong> (<strong class="calibre6">SSBI</strong>) is appropriate and beneficial to empower business users to explore and discover insights into data. Tools, such as Power BI Desktop, and features in the Power BI web service, such as apps, make it easier than ever for business users to independently analyze data and potentially create and distribute content. However, experience with SSBI projects has also strongly suggested that IT-owned and managed administrative controls, enterprise-grade BI tools, and data assets, such as data warehouses, are still very much necessary. In response to the strengths and weaknesses of traditional IT-led BI and business-led SSBI, Microsoft has suggested and internally implemented a managed self-service approach to data governance.</p>
<p class="calibre7">From a BI architecture standpoint, managed self-service BI aligns represents a hybrid approach of both the Corporate BI and the Self-Service Visualization modes introduced in <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>. As shown in the following diagram, certain projects are carried out by the BI/IT department, while business users have flexibility to analyze data and create their own reporting:</p>
<div class="cdpalignleft"><img src="images/000175.png" class="calibre406" /></div>
<div class="mce-root2">Multi-mode Power BI deployments</div>
<p class="calibre7">The three capabilities of <strong class="calibre6">Corporate BI Projects</strong> identified in the preceding screenshot address the limitations or weaknesses of self-service BI projects and tools. These limitations include data accuracy, scalability, complex data integration processes, and custom distributions of reports to groups of users. Certain projects requiring these skills and tools such as the integration of multiple source systems and the scheduled distribution of user-specific reports could be exclusively developed and managed by IT. Additionally, the business stakeholders for certain projects may prefer or insist that certain projects are wholly owned by IT. From an on-premises perspective, one example of this would include an <strong class="calibre6">extract-transform-load</strong> (<strong class="calibre6">ETL</strong>) package developed in <strong class="calibre6">SQL Server Integration Service</strong> (<strong class="calibre6">SSIS</strong>), an <strong class="calibre6">SQL Server Analysis Services</strong> (<strong class="calibre6">SSAS</strong>) data model, and a combination of paginated and Power BI reports developed for the Power BI Report Server.</p>
<div class="packt_tip pcalibre7 pcalibre6">Some of the limitations, such as scalability and custom distributions of reports, may be mitigated in the near future by further enhancements to Power BI Premium and new features in the Power BI service. However, despite these new capabilities, certain projects and processes critical to a BI deployment are likely best suited for IT/BI professionals. </div>
<p class="calibre7">However, as shown in the <strong class="calibre6">Business User SSBI</strong> mode of the <em class="calibre16">Multi-mode Power BI deployments</em> diagram, business users are still empowered to leverage SSBI tools, such as Power BI Desktop, to conduct their own analysis and to internally determine requirements within their business unit. Most commonly, business users can leverage an IT-owned asset, such as an Analysis Services model, thus avoiding the data preparation and modeling components while retaining flexibility on the visualization layer. This Self-Service Visualization model is very popular and particularly effective when combined with Excel report connections.</p>
<p class="calibre7"><span>Note that continuous monitoring and data governance policies are in effect across the organization regardless of Corporate BI or Business User SSBI. This is very important to detect any anomalies in user activity and as a first step in migrating a business developed solution to a corporate BI solution. For example, monitoring of the Office 365 Audit Log data for Power BI may indicate high and growing adoption of particular reports and dashboards based on a particular Power BI dataset. Given this query workload, or possibly other future needs for the dataset, such as advanced DAX measures, it may be appropriate to migrate this dataset to an Analysis Services model maintained by IT. An example of this migration process to an Azure Analysis Services model is included in <a href="#calibre_link-46" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 13</a>, <em class="calibre16">Scaling with Premium and Analysis Services</em></span>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-9">
<div id="calibre_link-1177" class="calibre2">
<div id="calibre_link-1178" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Implementing data governance</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">With an overarching strategy in place for deploying Power BI, as shown in the previous section, concrete tasks can be defined for implementing data governance. Several of these tasks include the following:</p>
<ol class="calibre12">
<li class="chapter">Identify all data sources and tag sources containing sensitive data:
<ul class="calibre17">
<li class="chapter">Additional access and oversight policies should be applied to data sources containing sensitive or protected data.</li>
<li class="chapter">The classifications assigned to dashboards (Confidential, Organizational) in the <em class="calibre16">Dashboard data classifications</em> section of <a href="#calibre_link-10" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content</em>, is an example of data tagging.</li>
</ul>
</li>
<li class="chapter">Determine where critical data sources will be stored:
<ul class="calibre17">
<li class="chapter">For example, determine whether the data warehouse will be hosted on-premises or in the cloud.</li>
<li class="chapter">Power BI reporting can be deployed fully on-premises via the Power BI Report Server, fully in the cloud, or organizations can pursue hybrid deployment models. Examples of these deployment options are described in the <em class="calibre16">Hybrid deployment models</em> section of <a href="#calibre_link-11" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chapter 10</a>, <em class="calibre16">Deploying the Power BI Report Server</em></li>
<li class="chapter">Additionally, determine whether analytical (OLAP) BI tools such as Analysis Services and SAP BW will be used with these data sources and whether those tools will be stored on-premises or in the cloud.</li>
</ul>
</li>
<li class="chapter">Define who can access which data and how this access can be implemented:
<ul class="calibre17">
<li class="chapter">Defining and managing security groups in <strong class="calibre6">Azure Active Directory</strong> (<strong class="calibre6">AAD</strong>) or <strong class="calibre6">Active Directory</strong> (<strong class="calibre6">AD</strong>) is strongly recommended.</li>
<li class="chapter">Determine whether data security roles will be implemented in a data warehouse source such as Teradata or if row-level security roles will be implemented in analytical models such as Analysis Services.</li>
</ul>
</li>
<li class="chapter">Develop or obtain monitoring solutions to continuously monitor activities:
<ul class="calibre17">
<li class="chapter">Visibility to the Office 365 Audit log data, as described later in this chapter, is an essential piece of this task.</li>
<li class="chapter">Any high-risk or undesired activities should be automatically detected, enabling swift action.</li>
</ul>
</li>
</ol>
<ol start="5" class="calibre12">
<li class="chapter">Train business users on data governance and security:
<ul class="calibre17">
<li class="chapter">This is particularly relevant for any dataset designers within business units who will leverage Power BI Desktop and to access shape, and model data. </li>
</ul>
</li>
</ol>
<p class="calibre7">The extent of data governance policies is driven by the size of the organization, its industry and associated regulations, and the desired data culture. For example, a large healthcare provider that wishes to pursue a more conservative data culture will implement many data governance policies to eliminate security risks and promote data quality and accuracy. However, a small to mid-sized company in a less regulated industry, and perhaps with less IT resources available, will likely implement less dense governance policies to promote flexibility. </p>
<p class="calibre7">For example, with Power BI Desktop and Power BI Premium capacity, a large analysis model containing complex M queries and DAX expressions could potentially be created and supported by a business user or team. However, the dataset designer of this model will need to be familiar with both the governance policy determining the level of visibility users of the dataset will have, as well as how to implement the corresponding row-level security roles. Additionally, business users with Power BI Pro licenses responsible for distributing content such as via Power BI apps will need to know the security groups that should have access to the app.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-24">
<div id="calibre_link-1179" class="calibre2">
<div id="calibre_link-1180" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Azure Active Directory</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As with other Microsoft Azure services, Power BI relies on Azure AD to authenticate and authorize users. Therefore, even if Power BI is the only service being utilized, organization's can leverage Azure AD's rich set of identity management and governance features, such as conditional access policies, <strong class="calibre6">multi-factor authentication</strong> (<strong class="calibre6">MFA</strong>) and business-to-business collaboration. For example, a conditional access policy can be defined within the Azure Portal which blocks access to Power BI based on the user's network location, or which requires MFA given the location and the security group of the user. Additionally, organizations can invite external users as guest users withing their Azure AD tenant to allow for seamless distribution of Power BI content to external parties, such as suppliers or customers. </p>
<p class="calibre7">Guidance on configuring Azure AD security groups to support <strong class="calibre6">row-level security</strong> (<strong class="calibre6">RLS</strong>) is included in <a href="#calibre_link-25" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 4</a>, <em class="calibre16">Developing DAX Measures and Security Roles</em>. This section reviews other top features of Azure AD in the content of Power BI deployments.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-35">
<div id="calibre_link-1181" class="calibre2">
<div id="calibre_link-1182" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Azure AD B2B collaboration</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Azure AD <strong class="calibre6">business-to-business</strong> (<strong class="calibre6">B2B</strong>) collaboration enables organizations using the Azure AD to work securely with users from any organization. Invitations can be sent to external users, whether the user's organization uses Azure AD or not, and once accepted the guest user can leverage their own credentials to access resources, such as dashboards and reports contained in a Power BI app. Just like users within the organization, guest users can be added to security groups and these groups can be referenced in the Power BI service. </p>
<div class="packt_infobox">Prior to the existence of Azure AD B2B, it was necessary to create identities within Azure AD for external guest users, or even develop an application with custom authentication.</div>
<p class="calibre7">A guest user can be added to Azure AD by sending an invitation from Azure AD and by sharing content with the external user from the Power BI service. The first method, referred to as the planned invite method, involves adding a guest user from within Azure AD and sending an invitation to the user's email address. In the following screenshot from the Azure portal, <span>Azure Active Directory</span> has been selected and the <span>All users</span> page has been accessed from the <span>Manage users and groups</span> tab:</p>
<div class="cdpalignleft"><img src="images/000185.png" class="calibre407" /></div>
<div class="mce-root2">Add guest user in Azure AD</div>
<p class="calibre7">As shown in the preceding screenshot, the administrator can click <span>New guest user</span> to add the user, and enter an invitation message, such as in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000195.png" class="calibre408" /></div>
<div class="mce-root2">Invite a guest user to Azure AD</div>
<p class="calibre7">The guest or external user will be sent an invitation via email containing the personal message, as well as a <span>Get Started</span> button. The user will need to click <span>Get Started</span> and accept the invitation. Once accepted, the guest user can be managed and added to security groups for use in Power BI. In the following screenshot from the <span>All users</span> tab in Azure AD, the guest user (<kbd class="calibre15">Brett.Powell@....</kbd>) has accepted the guest user invite:</p>
<div class="mce-root2"><strong class="calibre6"><img src="images/000206.png" class="calibre409" /></strong></div>
<div class="mce-root2">Guest User in Azure AD</div>
<p class="calibre7">Guest users are identified in Azure AD with a globe icon and with a <span>Guest</span> value in the <span>USER TYPE</span> property, as shown in the preceding screenshot. </p>
<p class="calibre7">As an alternative to the planned invite method via Azure AD described before, an invite to an external user can also be generated from the Power BI service directly. In this method, commonly referred to as ad hoc invites, a guest user's email address is specified when publishing or updating a Power BI app (via the <span>Access</span> page) or when sharing a Power BI dashboard or report. The external user would then receive an email invite to the specific content. Upon accepting this invite, the external user would be added as a guest user in Azure AD. Details on distributing content to users via apps and other methods are included in <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>.</p>
<p class="calibre7">Organizations have the option to completely block sharing with external users via the Share content with external users setting in the Power BI admin portal. As shown in the following screenshot, this setting can be enabled or disabled for an entire organization, or limited to certain security groups:</p>
<div class="cdpalignleft"><img src="images/000216.png" class="calibre410" /></div>
<div class="mce-root2">Share content with external users setting in Power BI admin portal</div>
<p class="calibre7">In addition to the Power BI admin portal, additional management options over external guest users are available in Azure AD. These settings, including whether members in the organization (non-admins) can invite guest users, are available on the manage user settings page of Azure AD.</p>
<p class="calibre7">External B2B users are limited to consuming content that has been shared or distributed to them. For example, they can view apps, export data (if allowed by the organization) and create email subscriptions, but they cannot access app workspaces or create and publish their own content. Additionally, external users cannot currently access shared content via the Power BI mobile apps.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-48">
<div id="calibre_link-1183" class="calibre2">
<div id="calibre_link-1184" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Licensing external users</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">In addition to authentication to the Power BI content, either a Power BI Pro license or Power Premium capacity is needed to allow the guest user to view the content. The following three licensing scenarios are supported:</p>
<ol class="calibre12">
<li class="chapter">The app workspace of the Power BI app can be assigned to Power BI Premium capacity:
<ul class="calibre17">
<li class="chapter">Only Power BI Premium P SKUs support sharing with external users</li>
<li class="chapter">Differences between P and EM SKUs were included in the <em class="calibre16">Custom application embedding</em> section in Chapter 11, <em class="calibre16">Creating Power BI Apps and Content Distribution</em></li>
</ul>
</li>
<li class="chapter">The guest user can be assigned a Power BI Pro license by the guest user's organization</li>
<li class="chapter">A Power BI Pro license can be assigned to the guest user by the sharing organization:
<ul class="calibre17">
<li class="chapter">The Power BI Pro license only allows the user to access content within the sharing organization</li>
</ul>
</li>
</ol>
<p class="calibre7">In the following screenshot from Azure AD, a guest user (<kbd class="calibre15">Brett.Powell</kbd>) is assigned a Power BI Pro license:</p>
<div class="cdpalignleft"><img src="images/000226.png" class="calibre411" /></div>
<div class="mce-root2">Power BI Pro license assignment in Azure AD</div>
<p class="calibre7">The License assignment for the guest user, as shown in the preceding screenshot, can be accessed via the <span>Manage Licenses</span> page for the given user in Azure AD. From this page, select the Assign icon (+) and then the <span>Products</span> tab to complete the assignment. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-386">
<div id="calibre_link-1185" class="calibre2">
<div id="calibre_link-1186" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Conditional access policies</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Administrators of Azure AD can configure conditional access policies to restrict user access to Power BI based on the user or security group, the IP address of the user sign-in attempt, the device platform of the user, and other factors. A very common scenario supported by conditional access policies is to either block access to Power BI from outside the corporate network or to require <strong class="calibre6">multi-factor authentication</strong> (<strong class="calibre6">MFA</strong>) for these external sign-in attempts. As a robust, enterprise-grade feature, organizations can use conditional access policies in conjunction with security groups to implement specific data governance policies.</p>
<p class="calibre7">Each Azure AD conditional access policy is composed of one or more conditions and one or more controls. The conditions define the context of the sign-in attempt such as the security group of the user and the user's IP address, while the controls determine the action to take given the context. For example, a policy could be configured for the entire organization and all non-trusted IP addresses (the conditions) that requires MFA to access Power BI (the control). The Azure portal provides a simple user interface for configuring the conditions and controls of each conditional access policy. </p>
<p class="calibre7">The following steps and supporting screenshots describe the creation of an Azure AD conditional access policy which requires MFA for users from the sales team accessing Power BI from outside the corporate network:</p>
<ol class="calibre12">
<li class="chapter">Log in to the Azure portal and select <span>Azure Active Directory</span> from the main menu</li>
<li class="chapter">From the <span>SECURITY</span> group of menu items, select <span>Conditional access</span>, as shown in the screenshot:</li>
</ol>
<div class="cdpalignleft"><img src="images/000236.png" class="calibre412" /></div>
<div class="mce-root2">Conditional access in Azure AD</div>
<ol start="3" class="calibre12">
<li class="chapter">Select the new policy icon at the top and enter a name for the policy, such as <kbd class="calibre15">Sales Team External Access MFA</kbd></li>
<li class="chapter">Set the users and group assignment property to an Azure AD security group (such as <kbd class="calibre15">AdWorks DW Sales Team</kbd>)</li>
<li class="chapter">Set the <span>Cloud apps</span> assignment property to Microsoft Power BI service</li>
<li class="chapter">On the <span>Conditions</span> assignment property, configure the locations to include any location and exclude all trusted locations:
<ul class="calibre17">
<li class="chapter">With this definition, the policy will apply to all IP addresses not defined as trusted locations in Azure AD</li>
</ul>
</li>
<li class="chapter">On the <span>Grant</span> access control property, select the checkbox to require multifactor authentication</li>
<li class="chapter">Finally, set the <span>Enable</span> policy property at the bottom to <span>On</span> and click the <span>Create</span> command button:</li>
</ol>
<div class="cdpalignleft"><img src="images/000246.png" class="calibre413" /></div>
<div class="mce-root2">Configure new Azure AD conditional access policy</div>
<p class="calibre7">The minimum requirements to create new conditional access policies are the <span>Users and groups</span> property, the <span>Cloud apps</span> property (Power BI service), and at least one access control. <span>As with all security implementations, conditional access policies should be tested and validated. In this screenshot, a user within the <kbd class="calibre15">AdWorks DW Sales Team</kbd> could attempt to log in to Power BI from outside the corporate network. The user should be prompted (challenged) to authenticate by providing a mobile device number and entering an access code sent via text message. </span></p>
<p class="calibre7">It's important to remember that conditional access policies are in addition to the user permissions defined in the Power BI service and the row-level security roles created in Power BI datasets or Analysis Services data models. The <em class="calibre16">User Permissions</em> section in <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>, contains additional information on these security layers. </p>
<div class="packt_infobox">Azure AD conditional access policies require either an Enterprise Mobility and Security E5 license or Azure AD Premium P2 license. <strong class="calibre6">Enterprise Mobility and Security</strong> (<strong class="calibre6">EMS</strong>) E5 licenses include Azure AD Premium P2 as well as Microsoft Intune, Microsoft's mobile device management service. Additional information on features, licensing, and pricing for EMS is available at the following URL <a href="http://bit.ly/2lmHDZt" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2lmHDZt</a>.<br class="calibre3" />
<span><br class="calibre3" />
The following URL from MS Docs contains best practices for conditional access policies in Azure AD <a href="http://bit.ly/2nXAjlA" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2nXAjlA</a>.</span></div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-387">
<div id="calibre_link-1187" class="calibre2">
<div id="calibre_link-1188" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI Admin Portal</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The Power BI Admin Portal provides controls for administrators to manage the Power BI tenant for their organization. This includes settings governing who in the organization can utilize which features, how Power BI Premium capacity is allocated and by whom, and other settings such as embed codes and custom visuals. </p>
<p class="calibre7">The admin portal is accessible to Office 365 Global Administrators and users mapped to the Power BI service administrator role. The Power BI service administrator role and the assignment of a user to this role in Office 365 was described in the <em class="calibre16">Power BI project roles</em> section of <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>. To open the admin portal, log in to the Power BI service and select the <span>Admin portal</span> item from the Settings (Gear icon) menu in the top right, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000257.png" class="calibre414" /></div>
<div class="mce-root2">Admin portal in Settings menu</div>
<p class="calibre7">All Power BI users, including Power BI free users, are able to access the <span>Admin portal</span>. However, users who are not admins can only view the <span>Capacity settings</span> page. The Power BI service administrators and Office 365 global administrators have view and edit access to the following seven pages:</p>
<div class="cdpalignleft"><img src="images/000267.png" class="calibre415" /></div>
<div class="mce-root2">Admin portal pages</div>
<p class="calibre7">Administrators of Power BI most commonly utilize the <span>Tenant settings</span> and <span>Capacity settings</span> as described in the Tenant Settings and Power BI Premium Capacities sections later in this chapter. However, the admin portal can also be used to manage any approved custom visuals for the organization, as well as any embed codes associated with the <span>Publish to web</span> feature described in <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-388">
<div id="calibre_link-1189" class="calibre2">
<div id="calibre_link-1190" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Usage metrics</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The <span>Usage metrics</span> page of the <span>Admin portal</span> provides admins with a Power BI dashboard of several top metrics, such as the most consumed dashboards and the most consumed dashboards by workspace. However, the dashboard cannot be modified and the tiles of the dashboard are not linked to any underlying reports or separate dashboards to support further analysis. Given these limitations, alternative monitoring solutions are recommended, such as the Office 365 audit logs and usage metric datasets specific to Power BI apps. Details of both monitoring options are included in the app usage metrics and Power BI audit log activities sections later in this chapter. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-389">
<div id="calibre_link-1191" class="calibre2">
<div id="calibre_link-1192" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Users and Audit logs</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The <span>Users</span> and <span>Audit logs</span> pages only provide links to the Office 365 admin center. In the admin center, Power BI users can be added, removed and managed. If audit logging is enabled for the organization via the Create audit logs for internal activity and auditing and compliance tenant setting, this audit log data can be retrieved from the Office 365 Security &amp; Compliance Center or via PowerShell. This setting is noted in the following section regarding the <span>Tenant settings</span> tab of the Power BI admin portal. </p>
<p class="calibre7">An Office 365 license is not required to utilize the Office 365 admin center for Power BI license assignments or to retrieve Power BI audit log activity. Examples of assigning Power BI Pro licenses and the Power BI service administrator role to users from within the Office 365 admin center are included in <a href="#calibre_link-73" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 1</a>, <em class="calibre16">Planning Power BI Projects</em>. Retrieving and analyzing the Power BI audit log data is described in the Power BI Audit Log Activities section later in this chapter. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-390">
<div id="calibre_link-1193" class="calibre2">
<div id="calibre_link-1194" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Tenant settings</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The <span>Tenant settings</span> page of the Admin portal allows administrators to enable or disable various features of the Power BI web service. For example, an administrator could disable the <span>Publish to web</span> feature described in <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>, for the entire organization. Likewise, the administrator could allow only a certain security group to embed Power BI content in SaaS applications such as SharePoint Online. </p>
<p class="calibre7">The following diagram identifies the 18 tenant settings currently available in the admin portal and the scope available to administrators for configuring each setting:</p>
<div class="cdpalignleft"><img src="images/000277.png" class="calibre416" /></div>
<div class="mce-root2">Power BI Tenant settings</div>
<p class="calibre7">From a data security perspective, the first seven settings within the <strong class="calibre6">Export and Sharing</strong> and <strong class="calibre6">Content packs and apps</strong> groups are most important. For example, many organizations choose to disable the <span>Publish to web</span> feature for the entire organization. Additionally, only certain security groups may be allowed to export data or to print hard copies of reports and dashboards. As shown in the <strong class="calibre6">Scope</strong> column of the previous table and the following example, granular security group configurations are available to minimize risk and manage the overall deployment. </p>
<p class="calibre7">Currently, only one tenant setting is available for custom visuals and this setting (<strong class="calibre6">Custom visuals settings</strong>) can be enabled or disabled for the entire organization only. For organizations that wish to restrict or prohibit custom visuals for security reasons, this setting can be used to eliminate the ability to add, view, share, or interact with custom visuals. More granular controls to this setting are expected later in 2018, such as the ability to define users or security groups of users who are allowed to use custom visuals. </p>
<p class="calibre7">In the following screenshot from the <span>Tenant settings</span> page of the <span>Admin portal</span>, only the users within the BI Admin security group who are not also members of the BI Team security group are allowed to publish apps to the entire organization:</p>
<div class="cdpalignleft"><img src="images/000287.png" class="calibre417" /></div>
<div class="mce-root2">Security group permissions in Tenant settings</div>
<p class="calibre7">For example, a report author who also helps administer the On-premises data gateway via the <span>BI Admin</span> security group would be denied the ability to publish apps to the organization given membership in the <span>BI Team</span> security group. Many of the tenant setting configurations will be more simple than this example, particularly for smaller organizations or at the beginning of Power BI deployments. However, as adoption grows and the team responsible for Power BI changes, it's important that the security groups created to help administer these settings are kept up to date.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-391">
<div id="calibre_link-1195" class="calibre2">
<div id="calibre_link-1196" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Embed Codes</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Embed Codes are created and stored in the Power BI service when the <span>Publish to web</span> feature is utilized. As described in the <em class="calibre16">Publish to web</em> section of the previous chapter, this feature allows a Power BI report to be embedded in any website or shared via URL on the public internet. Users with edit rights to the workspace of the published to web content are able to manage the embed codes themselves from within the workspace. However, the admin portal provides visibility and access to embed codes across all workspaces, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000297.png" class="calibre418" /></div>
<div class="mce-root2">Embed Codes in Power BI admin portal</div>
<p class="calibre7">Via the <span>Actions</span> commands on the far right of the <span>Embed Codes</span> page, a Power BI Admin can view the report in a browser (diagonal arrow) or remove the embed code. The <span>Embed Codes</span> page can be helpful to periodically monitor the usage of the <span>Publish to web</span> feature and for scenarios in which data was included in a publish to web report that shouldn't have been, and thus needs to be removed. As shown in the <em class="calibre16">Power BI Tenant settings</em> table referenced in the previous section, this feature can be enabled or disabled for the entire organization or for specific users within security groups. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-392">
<div id="calibre_link-1197" class="calibre2">
<div id="calibre_link-1198" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Organizational Custom visuals</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The <span>Custom Visuals</span> page allows admins to upload and manage custom visuals (<kbd class="calibre15">.pbiviz</kbd> files) that have been approved for use within the organization. For example, an organization may have proprietary custom visuals developed internally, which it wishes to expose to business users. Alternatively, the organization may wish to define a set of approved custom visuals, such as only the custom visuals that have been certified by Microsoft. The process of obtaining custom visuals via Microsoft AppSource and the details of certified custom visuals are included in the <em class="calibre16">Custom visuals</em> section of <a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16">Applying Custom Visuals, Animation, and Analytics</em>.</p>
<p class="calibre7">In the following screenshot, the <kbd class="calibre15">Chiclet Slicer</kbd> custom visual is added as an organizational custom visual from the <span>Organizational visuals</span> page of the Power BI admin portal:</p>
<div class="cdpalignleft"><img src="images/000307.png" class="calibre419" /></div>
<div class="mce-root2">Add organizational custom visual</div>
<p class="calibre7">The <span>Organizational visuals</span> page provides a link (<span>Add a custom visual</span>) to launch the form and identifies all uploaded visuals, as well as their last update. Once a visual has been uploaded, it can be deleted but not updated or modified. Therefore, when a new version of an organizational visual becomes available, this visual can be added to the list of organizational visuals with a descriptive title (<kbd class="calibre15">Chiclet Slicer v2.0</kbd>). Deleting an organizational custom visual will cause any reports that use this visual to stop rendering.</p>
<p class="calibre7">The following screenshot reflects the uploaded <kbd class="calibre15">Chiclet Slicer</kbd> custom visual on the <span>Organization visuals</span> page:</p>
<div class="cdpalignleft"><img src="images/000317.png" class="calibre420" /></div>
<div class="mce-root2">Organization Visuals page in Power BI admin portal</div>
<p class="calibre7">Once the custom visual has been uploaded as an organizational custom visual, it will be accessible to users in Power BI Desktop. In the following screenshot from Power BI Desktop, the user has opened the <span>MARKETPLACE</span> of custom visuals and selected <span>MY ORGANIZATION</span>:</p>
<div class="cdpalignleft"><img src="images/000327.png" class="calibre421" /></div>
<div class="mce-root2"> Power BI Custom visuals</div>
<p class="calibre7">In this screenshot, rather than searching through the <span>MARKETPLACE</span>, the user can go directly to visuals defined by the organization. T<span>he marketplace of custom visuals can be launched via either the <span>Visualizations</span> pane or the <span>From Marketplace</span> icon on the <span>Home</span> tab of the ribbon. Additional details on adding custom visuals are included in </span><a href="#calibre_link-44" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 6</a>, <em class="calibre16">Applying Custom Visuals, Animation, and Analytic</em>s.</p>
<p class="calibre7">Organizational custom visuals are not supported for reports or dashboards shared with external users. Additionally, organizational custom visuals used in reports that utilize the publish to web feature will not render outside the Power BI tenant. Moreover, Organizational custom visuals are currently a preview feature. Therefore, users must enable the My organization custom visuals feature via the Preview features tab of the Options window in Power BI Desktop.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-393">
<div id="calibre_link-1199" class="calibre2">
<div id="calibre_link-1200" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Usage metrics reports</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The Power BI service provides standard usage metrics reports for both dashboards and reports. These reports, which themselves are Power BI reports, provide quick insights to fundamental user adoption questions, such as how often the published content is being viewed and which users are viewing the content the most. These read-only reports can be generated for specific dashboards and reports and can also be personalized (edited) by saving a copy. Once a copy of a usage metrics report has been saved, a Power BI dataset of usage metrics will be created for either all the dashboards or all the reports in the app workspace. The usage metrics datasets, which are updated by the Power BI service for the last 90 days of activity, and the saved usage reports can then serve as a foundation for a lightweight but robust monitoring solution for the app workspace. </p>
<p class="calibre7">For example, the <span>Global Sales</span> app described in the previous chapter contains several dashboards and reports with some of the reports containing multiple report pages. The following 11-step process and supporting diagram walk through the creation of two usage metrics datasets (dashboards and reports), two usage metrics reports, and a dashboard summarizing usage metrics for the app workspace across dashboards and reports:</p>
<ol class="calibre12">
<li class="chapter">Access the app workspace in the Power BI service containing the content to monitor:
<ul class="calibre17">
<li class="chapter">A Power BI Pro license and edit rights to the app workspace are required to access usage metrics data.</li>
</ul>
</li>
<li class="chapter">From the <span>Dashboards</span> page, select the View usage metrics report icon (line chart symbol) under <span>ACTIONS</span> for one of the dashboards, as shown in the following screenshot:</li>
</ol>
<div class="cdpalignleft"><img src="images/000337.png" class="calibre422" /></div>
<div class="mce-root2">View usage metrics action</div>
<ol start="3" class="calibre12">
<li class="chapter">Once prompted, click the <span>View usage metrics</span> button on the <span>Usage metrics ready</span> popup textbox:
<ul class="calibre17">
<li class="chapter">Alternatively, click the View usage metrics report icon again for any of the dashboards in the workspace.</li>
</ul>
</li>
</ol>
<p class="calibre156">A Power BI report containing usage metrics for the selected dashboard will be displayed, such as the following:</p>
<div class="cdpalignleft"><img src="images/000347.png" class="calibre423" /></div>
<div class="mce-root2">Dashboard Usage Metrics report</div>
<p class="calibre156">In addition to the slicers and visuals in the preceding screenshot, the usage metrics report page includes visuals for total views, total viewers (users), and views by user table that identifies the User Principal Name (login) and display name of the user.</p>
<p class="calibre156">At this point, usage metrics reports specific to each dashboard in the workspace will be accessible on demand via the View usage metrics report icon.</p>
<ol start="4" class="calibre12">
<li class="chapter">With the usage metrics report opened, click <span>Save as</span> from the <span>File</span> menu dropdown to save a copy of the report:
<ul class="calibre17">
<li class="chapter">A report named <span>Dashboard Usage Metrics Report - Copy</span> will be saved in the reports group.</li>
<li class="chapter">Additionally, a dataset will be created named <span>Dashboard Usage Metrics Model - Copy</span>.</li>
</ul>
</li>
<li class="chapter">Open the report saved from step <em class="calibre16">4</em> and click <span>Edit report</span>.</li>
<li class="chapter">In edit mode, remove the <span>Report level filters</span> that are specific to a single dashboard, as identified in the following screenshot:</li>
</ol>
<div class="cdpalignleft"><img src="images/000357.png" class="calibre424" /></div>
<div class="mce-root2">Usage metrics report filtered for dashboard</div>
<ol start="7" class="calibre12">
<li class="chapter">Create a separate report page that uses the <kbd class="calibre15">DisplayName</kbd> column of the <kbd class="calibre15">Dashboards</kbd> table to analyze usage of the dashboards within the workspace. </li>
<li class="chapter">Save the modifications from the file menu dropdown (<span>File</span> | <span>Save</span>). </li>
<li class="chapter">Repeat steps <em class="calibre16">1</em> through <em class="calibre16">8</em> for a Power BI report in the same app workspace:
<ul class="calibre17">
<li class="chapter">Use the <kbd class="calibre15">DisplayName</kbd> column from the <kbd class="calibre15">Reports</kbd> table and the <kbd class="calibre15">ReportPage</kbd> column from the <kbd class="calibre15">Views</kbd> table to design a usage metrics report for the reports in the workspace.</li>
</ul>
</li>
<li class="chapter">Create a new dashboard named <kbd class="calibre15">Usage Metrics</kbd>.</li>
<li class="chapter">Pin report visuals from both the dashboard usage metrics report and the report usage metrics report to the <span>Usage Metrics</span> dashboard:
<ul class="calibre17">
<li class="chapter">By default, the included in app property will be disabled for usage metrics reports, and the dashboard containing visuals from the usage metrics reports.</li>
</ul>
</li>
</ol>
<p class="calibre7">At this point, the workspace will include one usage metrics report for dashboards, one for reports, and two Power BI datasets supporting these usage reports, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000367.png" class="calibre425" /></div>
<div class="mce-root2">Report and dashboard usage metrics datasets</div>
<p class="calibre7">Via the Create report action icons (chart symbol) included in the preceding screenshot, additional usage reports can be created in the Power BI service. Additionally, new reports can be created in Power BI Desktop by connecting to either of these two datasets, as described in the <em class="calibre16">Live connections to Power BI datasets</em> section of <a href="#calibre_link-202" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>.</p>
<p class="calibre7">Excluding any new reports or dashboards, the monitoring solution for the <span>Global Sales</span> workspace is structured as follows:</p>
<div class="cdpalignleft"><img src="images/000377.png" class="calibre426" /></div>
<div class="mce-root2">Usage metrics reporting: Global Sales workspace</div>
<p class="calibre7">Depending on the importance and size of the workspace, more reports and dashboards can be created to provide further insight into the adoption of the content. For example, the usage metric reporting may indicate that only one or two reports of an app workspace are being utilized, or that one particular report page of a report is most important to users. The BI team can use this information to engage with business stakeholders to better understand the reasoning behind the usage patterns reported. </p>
<p class="calibre7"><span>The usage metrics data includes both Power BI Pro and Power BI Free users. For example, this includes Power BI Pro users who are members of the app workspace with edit rights to the content, as well as Power BI Free users who only access the content via a Power BI app. A <kbd class="calibre15">DistributionMethod</kbd> table in both the dashboard and report usage metrics datasets contains a <kbd class="calibre15">Name</kbd> field, which identifies how the user obtained access to view the specific item. This access will be one of the following three methods&mdash;as a member of the app workspace, as a recipient of a shared dashboard or report, or by installing an app.</span></p>
<div class="packt_infobox"><span>User views of content through a Power BI app are currently counted as content packs but, as mentioned in the previous chapter, content packs are being replaced by apps. Additional information on the metrics and columns included in the usage metrics datasets is available in MS Docs via the following URL: <a href="http://bit.ly/2nTyua4" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2nTyua4</a>.</span></div>
<p class="calibre7">Although very useful for app workspaces that support many users or important scenarios (such as executive dashboards), usage metrics reports are ultimately limited to individual workspaces. Additionally, the usage metrics don't include other activities of interest to administrators, such as when the newly scheduled refresh is configured or when a data source from a gateway is removed. A more comprehensive monitoring dataset inclusive of all app workspaces and all Power BI activities is available via the Office 365 audit logs for Power BI, as described in the following section.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-394">
<div id="calibre_link-1201" class="calibre2">
<div id="calibre_link-1202" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Audit logs</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Power BI activities stored in the Office 365 audit logs provide administrators with a complete view of user activities in the Power BI service. Each log event record identifies the user, the date and time of the activity, the type of activity, such as printed a report page, and the item in Power BI, such as the report that was printed. This level of detail at the tenant level across all primary activities helps administrators answer both high-level usage and adoption questions, as well as targeted compliance questions.</p>
<p class="calibre7">For example, the audit logs could prove that the volume of users and their level of engagement with Power BI reports and dashboards is increasing. Alternatively, an administrator could investigate the activities of just a few users to ensure they're only engaging in activities aligned with their role. Perhaps most importantly, an IT organization can understand what Power BI content is being utilized by the business. In the event that a few reports or dashboards become very popular, some level of engagement may be appropriate to ensure the underlying dataset is accurate and secure or migrate the content to an IT-supported solution. </p>
<p class="calibre7">Once enabled in the Power BI admin portal, the audit log data can be retrieved on an ad hoc basis or, more commonly, retrieved on a recurring basis as part of a continuous monitoring and governance solution. To minimize the setup and maintenance of these monitoring solutions, Microsoft has made available PowerShell scripts that export Power BI audit log data to a CSV file format. Additionally, a Power BI solution template is available with built-in audit log retrieval and prebuilt monitoring reports. </p>
<p class="calibre7">The first step in utilizing the audit logs is to enable the create audit logs setting in the Power BI admin portal. This setting in the <span>Audit</span> and <span>Usage settings</span> group of the <span>Tenant settings</span> page is set at the organizational level, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000386.png" class="calibre427" /></div>
<div class="mce-root2">Enable Power BI audit logs</div>
<p class="calibre7">Once the audit log setting is enabled, user activities start to be recorded in the audit logs with a delay of 12 hours or less from their occurrence and will be stored for 90 days. This log data can be accessed directly from the Office 365 admin center or remotely via PowerShell scripts and solution templates. In terms of direct or ad hoc access, an Office 365 global administrator or a user with permission to the Security &amp; Compliance Center can log in to Office 365 (<a href="http://www.office.com" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">www.office.com</a>) and select the <span>Security &amp; Compliance</span> app icon, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000396.png" class="calibre428" /></div>
<div class="mce-root2">Office 365 app menu</div>
<p class="calibre7">Alternatively, a link to the Office 365 admin center is provided on the Audit logs page of the Power BI admin portal. This links directly to the Audit log search interface of the Security &amp; Compliance Center described later.</p>
<p class="calibre7">From the Security &amp; Compliance Center, the <span>Search and Investigation</span> menu at the bottom (magnifying-glass icon) can be expanded to expose an <span>Audit log</span> search item. Select <span>Audit log search</span> and then specify the Power BI activities to search for, the start and end dates for the search, and, optionally the users, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000406.png" class="calibre429" /></div>
<div class="mce-root2">Audit log search in Security &amp; Compliance Center</div>
<p class="calibre7">In this example, the following four activities are searched for&mdash;Created Power BI gateway, created Power BI dataset, deleted Power BI gateway, and deleted Power BI dataset. The <span>Filter results</span> button can be used to filter the results of the search by any of the search columns (<kbd class="calibre15">User</kbd>, <kbd class="calibre15">Activity</kbd>, <kbd class="calibre15">Item</kbd>). The <span>Export results</span> dropdown supports two formats to be exported to a <strong class="calibre6">comma-separated value</strong> (<strong class="calibre6">CSV</strong>) file. Specifically, the <span>Save loaded results</span> option exports only the columns displayed in the search. The <span>Download all results</span> option contains many more columns, <span>such as the name of the app workspace and the user's web browser. However, these details are embedded in a single</span> JSON column (<kbd class="calibre15">AuditData</kbd>), such as the following activity record: </p>
<pre class="calibre19">{"Id":"9933734c-0dbd-ba5b-41ce-42d89b7ac8cd","RecordType":20,"CreationTime":"2018-02-10T21:17:18","Operation":"CreateDataset","OrganizationId":"77243ddd-cf6a-466f-9246-06edb8809332","UserType":0,"UserKey":"10033FFFA28BA395","Workload":"PowerBI","UserId":"JenLawrence@abcdef.onmicrosoft.com","ClientIP":"12.123.645.99","UserAgent":"Mozilla\/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\/537.36 (KHTML  like Gecko) Chrome\/99.0.3539.132 Safari\/537.36","Activity":"CreateDataset","ItemName":"Dashboard Usage Metrics Model",<strong class="calibre6">"WorkSpaceName":"Global Sales"</strong>,"DatasetName":"Dashboard Usage Metrics Model",<strong class="calibre6">"WorkspaceId":"fb70ab4f-0daf-4aa8-b704-7fae5ff9506f"</strong>,"ObjectId":"Dashboard Usage Metrics Model",<strong class="calibre6">"DatasetId":"4465997a-b043-4f7c-b31f-82e9740ad4f1"</strong>,<strong class="calibre6">"DataConnectivityMode":"DirectQuery"</strong>}</pre>
<p class="calibre7">As shown in the preceding activity record associated with the creation of a Power BI dataset, many more attributes of the activity are available in the audit logs which aren't displayed from the main <span>Audit log search</span> results interface. To view these additional details from the <span>Audit log search</span> page, one of the result records must be selected, thus prompting a <span>Details</span> window specific to this user activity.</p>
<div class="packt_tip pcalibre7 pcalibre6"> Object IDs such as <kbd class="calibre43">WorkspaceID</kbd> and <kbd class="calibre43">DatasetID</kbd> can be used to programmatically manage Power BI content via the Power BI REST API, as described in the Staged Deployments section of <a href="#calibre_link-10" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content</em>.</div>
<p class="calibre7"><span>A BI team would expect the creation and deletion of datasets and gateways to be infrequent activities relative to the creation and deletion of reports and dashboards. If many datasets are being created, this could be a sign of inefficient resource utilization and version control issues. For example, rather than four reports using Live connections to a single published dataset, each report may have its own dataset, which requires its own resources and data refresh schedule (if import mode). </span></p>
<p class="calibre7">Excluding global admins, an Exchange Online license is required to access the auditing section of the Office 365 Security &amp; Compliance Center. Additionally, administrators who are not global admins need to be mapped to an Exchange admin role that provides access to the audit log. As shown in the following screenshot, the <span>Permissions</span> menu of the Security &amp; Compliance Center provides a link to the Exchange Admin center to add users to the necessary roles to access the audit logs:</p>
<div class="cdpalignleft"><img src="images/000416.png" class="calibre430" /></div>
<div class="mce-root2">Security &amp; Compliance Center: Permissions</div>
<p class="calibre7">Clicking the Exchange admin center link highlighted in the preceding screenshot allows a global admin to assign a user to an Exchange Online role group, such as Compliance Management, that includes access to audit logs. </p>
<div class="packt_infobox"><span>There are currently 45 distinct Power BI activities tracked in the audit logs, including the sharing of dashboards and reports, any updates to an organization's Power BI settings (<span>Tenant settings</span>), and activities related to the management of Power BI Premium capacities as described in the next section. The list of Power BI activities audited and their descriptions is available and updated at MS Docs via the following URL <a href="http://bit.ly/2skXjAB" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2skXjAB</a>.</span></div>
<p class="calibre7">The maximum date range for an audit log search is 90 days and the date/time of each activity is presented in <strong class="calibre6">Coordinated Universal Time</strong> (<strong class="calibre6">UTC</strong>) format. Additionally, a maximum of 1,000 events (one user and one activity) can be displayed per audit log search. Given these limitations and the manual nature of audit log searches, a scheduled log retrieval process is necessary to support a more robust monitoring solution. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-395">
<div id="calibre_link-1203" class="calibre2">
<div id="calibre_link-1204" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Audit log monitoring solutions</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">To internally develop a monitoring solution based on the audit log data, a PowerShell script which searches and exports the audit log data to a CSV file can be scheduled. This CSV file is then used as the source of an <strong class="calibre6">extract-transform-load</strong> (ETL) or <strong class="calibre6">extract-load-transform</strong><span> (<strong class="calibre6">ELT</strong></span>) process to persist the log data in a source system, such as a SQL Server database. Finally, Power BI Desktop can be used to implement remaining lightweight transformations, create DAX measures, and develop the monitoring reports. </p>
<p class="calibre7">The following list of steps and supporting screenshots describe the monitoring workflow in detail:</p>
<ol class="calibre12">
<li class="chapter">A PowerShell script (<kbd class="calibre15">.ps1</kbd>) is executed on a schedule and generates a CSV file of Power BI activities:</li>
</ol>
<p class="calibre156">The following sample script searches the audit log for Power BI activities since yesterday and exports the data to a CSV file:</p>
<pre class="calibre19">$UserCredential = Get-Credential<br class="calibre3" />$CurrentDate = get-date<br class="calibre3" />$Yesterday = $CurrentDate.AddDays(-1)<br class="calibre3" />$csvFile = "C:\Users\Brett Powell\Desktop\PowerBIAuditLogs.csv"<br class="calibre3" />$Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://outlook.office365.com/powershell-liveid/ -Credential $UserCredential -Authentication Basic -AllowRedirection<br class="calibre3" /> <br class="calibre3" />Import-PSSession $Session<br class="calibre3" /><br class="calibre3" />$result = Search-UnifiedAuditLog -StartDate $Yesterday -EndDate $CurrentDate -RecordType PowerBI -ResultSize 5000 | Export-Csv $csvFile</pre>
<p class="calibre156">The <kbd class="calibre15">ResultSize</kbd> parameter (count of rows) of the <kbd class="calibre15">Search-UnifiedAuditLog</kbd> cmdlet is limited to 5,000. If not specified, the default value is 100. Depending on the level of usage in the organization, the frequency of executing the script and overall process will need to be adjusted accordingly to capture all Power BI activities.</p>
<ol start="2" class="calibre12">
<li class="chapter">An ETL (or ELT) process is executed to access the CSV file and load the new data to a data source:
<ul class="calibre17">
<li class="chapter"> T<span>he results of each audit log search can contain duplicate rows. However, the Identity column included in the search results can be used to eliminate these duplicate rows.</span></li>
</ul>
</li>
</ol>
<p class="calibre156">In an on-premises MSBI environment, a combination of SQL Server Agent, <strong class="calibre6">SQL Server Integration Services</strong> (<strong class="calibre6">SSIS</strong>), and the SQL Server relational database engine could be used to implement the data retrieval process. For example, an Agent Services job could be scheduled to sequentially execute the PowerShell script, an SSIS package, and optionally a SQL Server stored procedure.</p>
<ol start="3" class="calibre12">
<li class="chapter">A Power BI dataset (<kbd class="calibre15">.PBIX</kbd>) with a connection to the data source in step <em class="calibre16">2</em> is refreshed:
<ul class="calibre17">
<li class="chapter">The M query used to load the data model can include transformations to parse the JSON column and expose all columns to the data model, as shown in the following screenshot.</li>
<li class="chapter">As an import mode dataset, additional data sources, such as Active Directory, could be included in the refresh process.</li>
<li class="chapter">Additionally, the refresh of this dataset could be triggered to execute immediately following the completion of step <em class="calibre16">2</em> via the Power BI Rest API, as described in the Power BI REST API section of <a href="#calibre_link-10" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Power BI Content</em>.</li>
</ul>
</li>
</ol>
<p class="calibre7">In the following screenshot, audit log search result data has been connected to from Power BI Desktop:</p>
<div class="cdpalignleft"><img src="images/000426.png" class="calibre431" /></div>
<div class="mce-root2">Power BI Desktop: Parse JSON transformation</div>
<p class="calibre7">As shown in the preceding screenshot, a Parse JSON command is available on the <span>Transform</span> tab of the <span>Power Query Editor</span>. Selecting the <kbd class="calibre15">AuditData</kbd> column containing the JSON and then the Parse JSON transform converts each cell value into a record value. Once parsed, <span>select the outward facing arrows next to the <kbd class="calibre15">AuditData</kbd> column header</span> to convert these records into individual columns.</p>
<div class="packt_infobox">Technically, the two steps described here in the Power Query Editor are converted into M expressions, which utilize the <kbd class="calibre43">Table.TransformColumns()</kbd> and <kbd class="calibre43">Table.ExpandRecordColumn()</kbd> functions, respectively. As an essential M query to a monitoring solution, a review of the M syntax via the Advanced Editor and other enhancements, such as parameterizing the source file location, is recommended.</div>
<p class="calibre7">With the parsed JSON column expanded, 19 columns with an <kbd class="calibre15">AuditData</kbd> prefix will be available to load to the data model, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000008.png" class="calibre432" /></div>
<div class="mce-root2">Transformed audit log data</div>
<p class="calibre7">As shown in the preceding screenshot, the columns expanded will be of the Any data type in M (ABC123 icon). As <kbd class="calibre15">Any type</kbd> columns, these columns will be loaded to the data model as Text data type columns. Therefore, the <kbd class="calibre15">CreationDate</kbd> column, which is available outside the <kbd class="calibre15">AuditData</kbd> (JSON) column, should be used on the reporting layer as this column will be stored as a <kbd class="calibre15">Date/Time</kbd> type. </p>
<p class="calibre7">With a sound data retrieval process in place, DAX measures could be authored, such as the count of active users, the average number of users per day and per month, and the count of created reports or dashboards. To support security and compliance, measures and visualizations could be created targeting high-risk or undesirable activities, such as exporting report visual data or publishing reports to the web. For example, a card visual representing the count of data export activities could be pinned to a Power BI dashboard and a data alert could be configured against this dashboard tile.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-396">
<div id="calibre_link-1205" class="calibre2">
<div id="calibre_link-1206" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Audit logs solution template</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As an alternative to an internally developed monitoring solution, a Power BI solution template is now available containing an end-to-end MS Azure architecture for analyzing Power BI usage. The Power BI Usage metrics solution template created by Neal Analytics (with collaboration from Microsoft) allows the organization to leverage prebuilt data flows and Power BI usage reports as well as further customize the monitoring solution to meet their needs. Specifically, the solution template utilizes Azure Logic Apps for a recurring ETL process and Azure SQL Database to store the audit log data. Additionally, a robust Power BI dataset (relationships, measures, formatting) and several well-designed report pages will be included as a Power BI Desktop file. </p>
<p class="calibre7">The following screenshot is from the Apps Summary report page of the Power BI Usage metrics solution template:</p>
<div class="mce-root2"><strong class="calibre6"><img src="images/000019.png" class="calibre433" /></strong></div>
<div class="mce-root2">Power BI Usage metrics solution template</div>
<p class="calibre7">Several summary-level report pages similar to this example are included with the solution template, such as <span>Views Summary</span> and <span>Dataset Summary</span>. Additionally, the template contains multiple detail report pages (such as <span>User Details</span> and <span>Scheduling Details</span>) that expose all relevant attributes of specific user actions, or events in the Power BI service, such as editing a report or exporting a report. Between the dataset, the visualization layer, and the tested architecture in MS Azure, organizations can quickly derive value from the solution template and target their efforts to further improve monitoring visibility if necessary.</p>
<p class="calibre7">Links to Power BI solution templates in AppSource are available from PowerBI.com as well as Power BI Desktop. The following screenshot identifies the <span>Solution Templates</span> link under the <span>Solutions</span> menu in <a href="https://powerbi.microsoft.com/en-us/" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">PowerBI.com</a>:</p>
<div class="cdpalignleft"><img src="images/000036.png" class="calibre434" /></div>
<div class="mce-root2">Power BI Solution Templates</div>
<p class="calibre7">In Power BI Desktop, a <span>Solution Templates</span> icon on the <span>Help</span> tab links to the solution templates in AppSource as well. The solution templates in AppSource include introductory videos, a <span>Test Drive</span> feature to interact with the Power BI report containing sample data, and a cost estimator document under the <em class="calibre16">Learn More</em> section.</p>
<p class="calibre7">Additionally, a <span>Get it Now</span> option provides further details on the architecture and the requirements of the template. In the following screenshot, the <span>Free Trial</span> option of the new Power BI Usage metrics solution template has been selected:</p>
<div class="cdpalignleft"><img src="images/000015.png" class="calibre435" /></div>
<div class="mce-root2">Power BI solution template: Get It Now</div>
<p class="calibre7">The preceding screenshot from the <span>Getting Started</span> tab is representative of the <span>Get it Now</span> option for other solution templates. Specifically, the templates connect to a specific source or service, process or transform that data, and load Azure SQL Database for analysis by a Power BI dataset and report. It's assumed that the current <span>Free Trial</span> option will be replaced with a <span>Get it Now</span> option later in 2018.</p>
<p class="calibre7"><span>The natural trade-off for the solution template, of course, is the monthly cost of utilizing the underlying Azure resources. This cost will vary significantly based on the volume of users, and thus the volume of data to process and store. An estimate of this cost is not available as of this writing, but a cost estimator document is expected, similar to the documents available for other solution templates in Microsoft AppSource. For many organizations, this monthly cost (for example, $400) could be of great value relative to the development and operational costs associated with an internally developed monitoring solution.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-397">
<div id="calibre_link-1207" class="calibre2">
<div id="calibre_link-1208" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI Premium capacities</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">One of the most important responsibilities of a Power BI administrator is the management of Power BI Premium capacities. Power BI Premium is fully described in the following chapter but, from a Power BI service administration perspective, Power BI Premium can be thought of as an organization's dedicated hardware resources to support the use of the Power BI service. Not all of an organization's content needs to be hosted in premium capacity. However, these resources enable the distribution of content to read-only Power BI Free users and they provide more consistent performance, among other scalability and management benefits.</p>
<div class="packt_infobox">Power BI Premium SKUs (such as P1 and P2) are available on the Purchase services page of the Office 365 admin center. Given that Power BI Premium can also be used to deploy the Power BI Report Server, an example of a premium SKU was included in the <em class="calibre16">Power BI Report Server Licensing</em> section of <a href="#calibre_link-11" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 10</a>, <em class="calibre16">Deploying the Power BI Report Server</em>. The specific actions involved in executing purchases of premium capacities, as well as cancellations of existing Premium subscriptions, is included via the following URL <a href="http://bit.ly/2HeiXtG" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2HeiXtG</a>.</div>
<p class="calibre7"><span>Office 365 global administrators and users assigned to the Power BI service administrator role automatically have the right to administer premium capacities in the Power BI admin portal. </span>An administrator's role in relation to premium capacity is to ensure that the provisioned resources are utilized according to the organization's policies, and that sufficient resources are available to support the existing workload.</p>
<p class="calibre7">Power BI Premium administrators should be familiar with the following list of responsibilities:</p>
<ul class="calibre12">
<li class="calibre13"><span>Create a new capacity with the available (purchased) v-cores:</span>
<ul class="calibre17">
<li class="calibre13">An organization may choose to dedicate a premium capacity to a specific project or application</li>
<li class="calibre13">In other scenarios, one capacity could be dedicated self-service projects while another capacity could be used by corporate BI projects.
<ul class="calibre17">
<li class="calibre13">See Chapter 13 (<em class="calibre16">Scaling with Premium and Analysis Services</em>) for additional details on allocating premium capacity.</li>
</ul>
</li>
</ul>
</li>
<li class="calibre13">Grant capacity assignment permissions to users or security groups of users:
<ul class="calibre17">
<li class="calibre13">This enables Power BI Pro users who are also administrators of app workspaces to assign their workspaces to premium capacity</li>
<li class="calibre13">This setting can also be disabled or enabled for the entire organization</li>
</ul>
</li>
<li class="calibre13"><span>Assign workspaces to premium capacity, or remove a workspace from premium capacity, in the Power BI admin portal:</span>
<ul class="calibre17">
<li class="calibre13">This is an alternative and complementary approach to capacity assignment permissions</li>
<li class="calibre13">Power BI service administrators can manage existing capacities and assign workspaces in bulk:
<ul class="calibre17">
<li class="calibre13">These bulk assignments can be by user, by security group of users, or for the entire organization</li>
</ul>
</li>
</ul>
</li>
<li class="calibre13">Monitor the usage metrics of premium capacities to ensure sufficient resources are available:
<ul class="calibre17">
<li class="calibre13">The Power BI Admin portal includes utilization monitoring for each premium capacity</li>
<li class="calibre13">Additionally, activities involving premium capacities such as the migration of an app workspace to a premium capacity are included in the audit logs described earlier in this chapter</li>
</ul>
</li>
<li class="calibre13">Change the size on an existing capacity to a larger (scale up) or smaller (scale down) capacity node:
<ul class="calibre17">
<li class="calibre13"><span><span>As more users and content utilize a specific capacity, it may be necessary to scale up or to allocate certain app workspaces to a different premium capacity or to shared (free) capacity</span></span></li>
</ul>
</li>
<li class="calibre13">Assign a user or group of users as capacity administrators for a capacity:
<ul class="calibre17">
<li class="calibre13"> This can be appropriate to support large, enterprise deployments with multiple capacities and many app workspaces</li>
</ul>
</li>
</ul>
<p class="calibre7">Given the importance of performance to any BI project, as well as the cost of Power BI Premium capacities, it's important for BI/IT teams to plan for an efficient, manageable allocation of premium capacity as described in the next chapter. This allocation plan and any project-specific decisions need to be communicated to the premium administrator(s) for implementation. <span>The following sections describe the responsibilities identified here and related considerations in greater detail. </span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-398">
<div id="calibre_link-1209" class="calibre2">
<div id="calibre_link-1210" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Capacity allocation</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Power BI Premium provides organizations with significant flexibility for both allocating their resources to premium capacities, as well as assigning Power BI content to those capacities. A single premium capacity can be provisioned and created for an organization or, for larger and more diverse deployments, multiple premium capacities can be created with different sizes (CPU, memory, bandwidth) appropriate for their specific workloads. </p>
<p class="calibre7">In terms of allocating resources to premium capacities, an organization is only limited by the number of <strong class="calibre6">virtual cores</strong> (<strong class="calibre6">v-cores</strong>) that have been purchased. For example, an organization could initially purchase a P2 capacity, which includes 16 v-cores. Once purchased, a P2 capacity could be created in the <span>Capacity settings</span> page of the <span>Admin portal</span> that utilizes all of these cores. However, at some later date, this capacity could be changed to a P1 capacity which only uses 8 v-cores. This would allow the organization to create a second P1 capacity given the eight remaining v-cores available. Alternatively, a second P2 capacity could be purchased, providing another 16 v-cores. With 32 total v-cores purchased by the organization, an existing P2 capacity could be increased to a P3 capacity (32 v-cores). </p>
<p class="calibre7">The following diagram illustrates this example of capacity allocation:</p>
<div class="cdpalignleft"><img src="images/000076.png" class="calibre436" /></div>
<div class="mce-root2">Power BI Premium capacity allocation</div>
<p class="calibre7">Regardless of the premium SKU (P1, P2, or P3), the combination of SKUs purchased in the Office 365 admin center, or the number of specific SKUs (instances), an organization can use the total number of v-cores purchased as it wishes. For example, purchasing a P3 SKU provides 32 v-cores, the same as purchasing four instances of a P1 SKU (8 X 4 = 32).</p>
<div class="packt_tip pcalibre7 pcalibre6">For organizations getting started with Power BI and that are comfortable with actively managing their premium capacities, individual instances of the P1 SKU with no annual commitment (month-to-month) could make sense. For example, a single P1 instance could be purchased to start and then, if it's determined that more resources are needed, a second P1 instance could be purchased, making 16 cores available for either a P2 capacity or two P1 capacities.</div>
<p class="calibre7">In this diagram, an organization has chosen to isolate the sales and purchasing app workspaces to their own P1 capacities with eight v-cores each. This isolation ensures that the resources required for one workspace, such as the user's connection to the <span>Sales</span> app, will not impact the other workspace (<span>Purchasing</span>). Additionally, the <span>Finance</span> and <span>Marketing</span> workspaces have been left in shared (free) capacity for now, but could later be assigned to <strong class="calibre6">Capacity A</strong> or <strong class="calibre6">Capacity B</strong> if sufficient resources are available.</p>
<p class="calibre7"><span>Whether Power BI workspaces (dashboards, reports, datasets) are allocated to premium capacity or shared capacity is transparent to end users. For example, the same login and content navigation experience in the Power BI web service and Power BI mobile apps applies to both premium and shared capacity. Therefore, organizations can selectively allocate certain workspaces, such as production workspaces accessed by many Power BI Free users, to premium capacity while allowing other small or team workspaces to remain in the shared capacity.</span></p>
<p class="calibre7">Different patterns for deploying premium capacity are discussed in the following chapters but, at a minimum, administrators should be familiar with the relationships between purchased premium capacity and premium capacities configured for an organization, as well as the assignment of app workspaces to those capacities. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-399">
<div id="calibre_link-1211" class="calibre2">
<div id="calibre_link-1212" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Create, size, and monitor capacities</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Office 365 global admins and Power BI service administrators can view, create, and manage all Power BI Premium capacities via the Admin portal. In the following screenshot from the <span>Capacity settings</span> page of the <span>Admin portal</span>, eight v-cores have been provisioned for the organization and a single P1 capacity has been created, which consumes all of these cores:</p>
<div class="cdpalignleft"><img src="images/000087.png" class="calibre437" /></div>
<div class="mce-root2">Admin portal: Capacity settings</div>
<p class="calibre7">As shown in the preceding screenshot, a <span>Set up new capacity</span> button is located above the list of premium capacities that have been configured. In this example, since all purchased v-cores have been used by a single capacity, the <span>Set up new capacity</span> button is grayed out. In the event that v-cores are available for a new capacity, clicking <span>Set up new capacity</span> button would launch a setup window, such as the following:</p>
<div class="cdpalignleft"><img src="images/000097.png" class="calibre438" /></div>
<div class="mce-root2">Set up new Premium Capacity</div>
<p class="calibre7">In this example, nine v-cores are available for the new capacity and thus a P1 capacity requiring eight v-cores can be created. The capacity is named and the capacity administrator(s) for the new capacity are defined. <span>The <span>Capacity size</span> dropdown will expose all different capacity sizes (P2, P3) but sizes requiring more v-cores than the volume of v-cores currently available will be grayed out. Once these properties have been configured, click <span>Set up</span> to complete the process.</span></p>
<p class="calibre7">Note that the <span>Capacity size</span> and <span>Capacity admins</span> properties are required to set up the new capacity. Each capacity must have at least one capacity admin, who will have full administrative rights to the given capacity. Additional information on capacity admins is included in the <em class="calibre16">Power BI Capacity Admins</em> section later in this chapter.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-400">
<div id="calibre_link-1213" class="calibre2">
<div id="calibre_link-1214" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Change capacity size</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">At some point after a capacity has been created, it may be necessary to change the size of the capacity. For example, given increased adoption of Power BI, the P1 SKU may be insufficient to support the current workload and thus an additional eight v-cores could be purchased with the intent to scale up the existing capacity to a P2 capacity size (16 v-cores). Alternatively, an admin may wish to view the recent utilization of a premium capacity to help determine whether additional app workspaces can be assigned to the capacity. </p>
<p class="calibre7">To change a capacity size and to view the utilization for a capacity, click the name of the capacity from the <span>Capacity settings</span> page described earlier. In the following screenshot, the <span>Capacity <span>P1 #1 8GB</span> model</span> from the <span>Capacity settings</span> screenshot earlier has been selected:</p>
<div class="cdpalignleft"><img src="images/000108.png" class="calibre439" /></div>
<div class="mce-root2">Manage premium capacity</div>
<p class="calibre7">A yellow <span>Change capacity size</span> button is exposed below the three usage metrics (<span>CPU</span>, <span>Memory thrashing</span>, and <span>Direct Query</span>). Selecting this button launches a simple window with a <span>Capacity size</span> dropdown, such as the <span>Capacity size</span> dropdown used for setting up a capacity. In this scenario, all capacity size options are grayed out in the <span>Change capacity size</span> window since the P1 capacity consumes all available v-cores. Nonetheless, with just a few clicks in the Admin portal, an admin can scale up or down a capacity. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-401">
<div id="calibre_link-1215" class="calibre2">
<div id="calibre_link-1216" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Monitor premium capacities</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The three usage metrics displayed in the manage capacity screen have built-in KPI formatting and conditional logic for good (green), marginal (yellow), and critical (red) statuses. Depending on the type of datasets (import, DirectQuery) and many other factors (such as usage patterns and query complexity), any of the three resources (CPU, memory, bandwidth) could represent a bottleneck.</p>
<p class="calibre7">For example, a P1 capacity has only 25 GB of RAM and thus will not be suitable for very large import (in-memory) datasets. It's recommended to monitor these metrics and to make adjustments if necessary to ensure users have an acceptable experience in terms of performance and responsiveness.</p>
<p class="calibre7">The usage metrics are driven by hourly time windows of activity for the given capacity over the past seven days. For example, the CPU usage metric (far left) will count the number of hours out of the last 168 hours (7 days * 24 hours) that experienced CPU utilization over 80%. These instances of high CPU utilization could be driven by the refresh process of an import mode dataset or users viewing and clicking through reports. During these high-CPU hours, users may experience poor performance when accessing or interacting with reports.</p>
<div class="packt_infobox"><span>The refresh process for large, in-memory Power BI datasets and Analysis Services models is CPU intensive. For this reason, most scale out deployments of Analysis Services isolate the processing operations from the query workload. Specifically, a dedicated Analysis Services server would connect to the source(s) and refresh the model, and then the updated model would be synchronized to multiple separate servers which resolve user queries. This architecture is already available in Azure Analysis Services and a dedicated processing server is identified on the roadmap for Power BI Premium.</span></div>
<p class="calibre7">The memory thrashing usage metric (middle) measures how often in-memory datasets are evicted from memory. Premium capacities opportunistically keep frequently utilized datasets loaded to memory to reduce load performance. However, with multiple in-memory datasets assigned to a capacity, and given the fixed amount of RAM provided per capacity (such as 50 GB for P2), the service may unload a dataset from memory to use this memory for other datasets. Users requesting to access an unloaded dataset, such as viewing a report based on the dataset, could experience long wait times for the report to display data.</p>
<p class="calibre7">The Direct Query usage metric (far right) refers to throughput or concurrent queries over both Direct Query connections and Live connections to Analysis Services models. In addition to V-Cores and RAM, each premium capacity includes a connection limit for the maximum volume of DirectQuery/Live connection queries per second, such as 30 per second for a P1 capacity. In the event that this limit is exceeded, the incremental queries beyond the throughput limit will be forced to wait.</p>
<p class="calibre7">For example, in the event that 80 DirectQuery or Live connection queries are received by the P1 premium capacity, 30 queries will be executed in the first second with no delay. However, another 30 queries will have to wait one second before being executed, and finally, the remaining 20 queries will have to wait two seconds before executing. This wait time is in addition to the time required to execute the requested query by the data source system and thus represents a potential bottleneck for large-scale Power BI deployments with DirectQuery and Live connection data sources, if appropriate premium capacities are not provisioned.</p>
<p class="calibre7"><span>As shown in the screenshots and diagram in this section, administrators have tools to monitor the performance of premium capacities and to scale up and down as an organization's needs and available resources allow. Once premium capacities have been created and sized, the next step is to assign app workspaces to these capacities so that an organization's content is moved from free (shared) capacity to the appropriate dedicated premium capacity.</span></p>
<p class="calibre7"><span>Premium capacities can be allocated at a granular level, such as individual app workspaces, or broadly applied to all workspaces of an organization. Additionally, as described in the following sections, Power BI administrators can also delegate administrative rights over premium capacities, as well as authorize certain Power BI users to assign workspaces to premium capacity.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-402">
<div id="calibre_link-1217" class="calibre2">
<div id="calibre_link-1218" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">App workspace assignment</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>Just as organizations have the flexibility to allocate their purchased v-cores across one or multiple premium capacities, there are also multiple options for assigning app workspaces to premium capacity. To bulk assign multiple workspaces to a capacity within the Admin portal, click the <span>Assign workspaces</span> button for a capacity. This button and the list of workspaces already assigned to the capacity is below the <span>Change capacity size</span> button described in the previous section. In the following screenshot, two workspaces have been selected for assignment to a premium capacity:</span></p>
<div class="cdpalignleft"><img src="images/000119.png" class="calibre440" /></div>
<div class="mce-root2">Assign workspaces</div>
<p class="calibre7">As shown in the preceding screenshot, the workspaces associated with individual users or groups of users can also be assigned to a premium capacity. If applied to specific users, any existing workspaces assigned to those users, including workspaces already in a separate capacity, will be moved to the capacity assigned. </p>
<p class="calibre7">As an alternative or complementary approach to assigning workspaces in the admin portal, administrators of a capacity can also grant users or groups of users the permission to assign workspaces to premium capacity. In the following screenshot, a user (<span>brettp76</span>) is granted assignment permission to a premium capacity:</p>
<div class="cdpalignleft"><img src="images/000129.png" class="calibre441" /></div>
<div class="mce-root2">Assignment Permissions</div>
<p class="calibre7">The <span>USER PERMISSIONS</span> options, which also includes <span>Capacity admins</span> described in the following section, is also just below the <span>Change capacity size</span> button, such as the <span>Assign workspaces</span> button. Users granted this permission will also require administrative rights to any app workspace they wish to assign to premium capacity.</p>
<p class="calibre7">In the following screenshot, a Power BI Pro user (<span>brettp76</span>) and administrator of an app workspace have opened the <span>Edit workspace</span> dialog to assign a workspace to premium capacity:</p>
<div class="cdpalignleft"><img src="images/000139.png" class="calibre442" /></div>
<div class="mce-root2">App workspace administrator: Assign to premium capacity</div>
<p class="calibre7">The differences between app workspace administrators and members were described in the Application Workspaces section of <a href="#calibre_link-10" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 8</a>, <em class="calibre16">Managing Application Workspaces and Content</em>. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-403">
<div id="calibre_link-1219" class="calibre2">
<div id="calibre_link-1220" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Capacity admins</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">One or more capacity admins are required for each premium capacity, and these users do not have to be an Office 365 global admin or a Power BI service admin. Users assigned as capacity administrators have the same administrative rights to the given capacity as Power BI Service admins, such as changing capacity size and assigning workspaces or user assignment permissions.</p>
<p class="calibre7">For example, a Power BI Pro user could be assigned as a capacity admin and could access this capacity via the Admin portal just like a Power BI admin. However, only the capacities for which the user is a capacity admin would appear on the <span>Capacity setting</span>s page. Additionally, other pages of the <span>Admin portal</span>, such as <span>Tenant settings</span>, would not be visible or accessible to the capacity admin. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-404">
<div id="calibre_link-1221" class="calibre2">
<div id="calibre_link-1222" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">This chapter reviewed the features and processes applicable to administering Power BI for an organization. These included the configuration of tenant settings in the Power BI admin portal, analyzing the usage of Power BI assets, and monitoring overall user activity via the Office 365 audit logs. Additionally, important administrative capabilities of Azure Active Directory, such as conditional access policies and external guest users, were also described. Moreover, the tasks and options available to administer Power BI Premium capacity were also detailed. </p>
<p class="calibre7">The following chapter looks at the options for scaling Power BI to support increased user adoption, larger data sets, and enterprise BI solutions. This includes methodologies for allocating Power BI Premium capacity to workloads, leveraging the additional benefits of Power BI Premium, and migrating Power BI datasets to Analysis Services.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-46">
<div id="calibre_link-1223" class="calibre2">
<div id="calibre_link-1224" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Scaling with Premium and Analysis Services</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For many organizations, the deployment of Power BI entails the reporting and self-service needs of hundreds or even thousands of users, as well as massive datasets. Power BI Premium and Analysis Services are positioned to address these needs via workload-based pricing, flexible scale-up and scale-out options, and enterprise-grade semantic modeling features. Although organizations and certain projects may start out with Power BI Desktop and shared capacity in the Power BI service, the utilization of Power BI Premium capacity and optionally the migration to Analysis Services is often essential to deliver the scale, <strong class="calibre6">return on investment</strong><span> (<strong class="calibre6">ROI</strong>), </span>and administrative controls of an enterprise BI platform.</p>
<p class="calibre7">This chapter begins with a review of the capabilities enabled by Power BI Premium capacities and the top considerations in provisioning this capacity. In addition to premium capacities, <strong class="calibre6">Azure Analysis Services</strong> (<strong class="calibre6">AAS</strong>) and <strong class="calibre6">SQL Server Analysis Services</strong> (<strong class="calibre6">SSAS</strong>) are introduced as enterprise BI modeling tools with features that address limitations with Power BI Desktop. Finally, the steps and considerations in the migration of a Power BI Desktop file to an Analysis Services model are described.</p>
<p class="calibre7">In<span> </span>this chapter, we will review the following topics:</p>
<ul class="calibre12">
<li class="calibre13">Power BI Premium</li>
<li class="calibre13">Power BI Premium provisioning factors</li>
<li class="calibre13">Power BI Premium capacity allocation</li>
<li class="calibre13">Analysis Services versus Power BI datasets</li>
<li class="calibre13">Azure Analysis Services and SQL Server Analysis Services</li>
<li class="calibre13">Migration from Power BI dataset to Analysis Services model</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-405">
<div id="calibre_link-1225" class="calibre2">
<div id="calibre_link-1226" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI Premium</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Power BI Premium consists of dedicated capacity (hardware) that an organization can provision to host some or all of its Power BI content (datasets, reports, and dashboards). As an alternative to the free clusters of capacity provided by Microsoft and shared by many organizations, premium capacities are isolated to a specific organization and thus are not impacted by the use of Power BI by other organizations. Another very important benefit of this isolation is that the provisioning organization can utilize their capacity as needed and is not constrained by the limits imposed on shared (free) capacity, such as dataset sizes and refresh frequencies. Additionally, as a cloud service managed by Microsoft, organizations have great flexibility to scale, allocate, and manage premium resources according to their preferred allocation methodology and changing requirements. </p>
<p class="calibre7">The top benefit of Power BI Premium is the ability to provide read-only access to Power BI Free users and thus cost-effectively scale Power BI deployments based on workloads rather than individual user accounts. This is particularly essential for large organizations with thousands of users, the majority of which only need the ability to view and optionally interact with content. If Power BI content is hosted in a premium capacity, the users consuming content such as via Power BI apps can view and interact with the content, such as making filter selections on a report or viewing a mobile-optimized dashboard on Power BI mobile applications. Power BI Premium enables organizations to limit the assignment of Power BI Pro users to those who will create and distribute content and to focus on provisioning and allocating premium resources according to the use cases and needs of workloads within the organization.</p>
<div class="packt_infobox">Prior to Power BI Premium, the cost and management overhead of assigning pro licenses to all users in an organization was the main barrier to large-scale deployments. From a customer's perspective, it simply doesn't make sense to pay the same price for a user that only views a few reports and dashboards each week as for a BI developer who's working in Power BI constantly. Additionally, as usage patterns and the scope of BI solutions can change rapidly, the ability to quickly scale up or down premium resources and thus only pay for what's needed, similar to other cloud services, was a top request from customers.</div>
<p class="calibre7">Additionally, Power BI Premium capacity can be used to deliver Power BI content to users in applications and environments outside of the Power BI service. For example, premium capacity can be used to embed Power BI visuals in custom applications, in other SaaS applications such as SharePoint Online, and can be used to license the Power BI Report Server. Details regarding the Power BI Report Server and alternative content distribution methods are included in <a href="#calibre_link-11" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 10</a>, <em class="calibre16">Deploying the Power BI Report Server</em>, and <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>, respectively.</p>
<p class="calibre7">The premium capacity-based licensing model, which currently starts at $5,000 per month for a P1 SKU, implies the following three fundamental questions:</p>
<ol class="calibre12">
<li class="chapter">How much premium capacity should be provisioned?</li>
<li class="chapter">How should provisioned capacity be allocated? </li>
<li class="chapter">What can be done to minimize capacity utilization and thus resource costs?</li>
</ol>
<p class="calibre7">Guidance and consideration of these questions are included in the following sections. </p>
<div class="packt_infobox">Premium Embedded SKUs (EM3), which are exclusive to embedding Power BI content in applications or services such as SharePoint Online, have a lower starting price point and less resources. As most organizations will leverage the Power BI service and mobile apps for large-scale deployments, Power BI Premium P SKUs are the focus of this chapter.</div>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-406">
<div id="calibre_link-1227" class="calibre2">
<div id="calibre_link-1228" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI Premium capabilities</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>Power BI Premium already provides several additional capabilities beyond the ability to distribute content to read-only Power BI Free users. As described in <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization</em></span>, <span>organizations have full control over their provisioned resources and therefore, unlike provisioning on-premises hardware, can quickly and easily adjust the amount and allocation of premium resources. For example, with v-core pooling, an organization can choose to distribute the 32 v-cores of a P3 capacity SKU across two P1 capacities and a single P2 capacity (8 + 8 +16 = 32). Likewise, with single-click scale up, an organization could provision an additional 8 v-cores by purchasing a P1 SKU and then change an existing P1 capacity to a P2 capacity, which requires 16 v-cores. The details of the hardware of each premium capacity node (CPU, RAM, and bandwidth) and the limits imposed on using those nodes are included in the <em class="calibre16">Premium capacity nodes</em> section.</span></p>
<p class="calibre7"><span>The following table describes 12 capabilities of Power BI Premium that are either currently available or have been identified by the Power BI team as a potential capability in the future:</span></p>
<div class="cdpalignleft"><span> <img src="images/000149.png" width="665" height="628" class="calibre443" /></span></div>
<div class="mce-root2">Power BI Premium capabilities</div>
<p class="calibre7"><span>Some of the capabilities identified in this table enable completely new scenarios for projects involving Power BI datasets created with Power BI Desktop. For example, up to a 10 GB dataset can be hosted in Premium capacity currently and much larger datasets will be supported in the future. Likewise, a dataset can be configured to refresh every 30 minutes in premium capacity and this frequency will also increase in the future. Incremental data refresh is expected to be delivered by mid-2018, and this will address a critical gap in the ability to leverage a large Power BI dataset. The following section, Corporate Power BI datasets, reviews the <strong class="calibre6">Single Dataset Across Workspaces</strong> (<em class="calibre16">#7</em></span>) <span>limitation that may also support this deployment option. </span></p>
<p class="calibre7"><span>The ability to publish <strong class="calibre6">SQL Server Reporting Services</strong> (<strong class="calibre6">SSRS</strong>) reports, also referred to as paginated reports or (<kbd class="calibre15">.RDL</kbd> reports), to the Power BI service will be especially valuable for organizations with significant SSRS investments. Without this capability, these organizations have needed to deploy the Power BI Report Server (or an SSRS server) as described in <a href="#calibre_link-11" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 10</a>, </span><em class="calibre16">Deploying the Power BI Report Server</em>. Additionally, connectivity parity with Analysis Services will allow organizations to utilize familiar development and management tools such as Visual Studio and <strong class="calibre6">SQL Server Management Studio</strong> (<strong class="calibre6">SSMS</strong>) to apply life cycle management processes to Power BI datasets as they would with Analysis Services models. Moreover, <span>connectivity parity with Analysis Services will allow organizations to leverage other common data visualization and BI tools such as Tableau. For example, both Power BI and Tableau reports could be built against a Power BI dataset provided the dataset is assigned to a workspace in premium capacity.   </span></p>
<p class="calibre7">To support the largest Power BI deployments, a scale-out option involving read-only replicas with load balancing and dedicated data refresh nodes is mentioned in the roadmap section of the Power BI Premium October 2017 whitepaper. This document and other Power BI whitepapers can be accessed at the following URL <a href="http://bit.ly/2Hu57DK" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2Hu57DK</a>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-407">
<div id="calibre_link-1229" class="calibre2">
<div id="calibre_link-1230" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Corporate Power BI datasets</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Given the features described in the previous section, Premium capacity can be used to support entirely new scenarios with Power BI datasets. For example, rather than migrate a Power BI Desktop file (<kbd class="calibre15">.PBIX</kbd>) to an Analysis Services model, as described later in this chapter, an organization could choose to provision the necessary Premium capacity and leverage the scalability (that is, 10 GB+) and data refresh features available to content hosted in Premium capacity. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-408">
<div id="calibre_link-1231" class="calibre2">
<div id="calibre_link-1232" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Limitation of Corporate BI datasets &ndash; Reusability</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A significant barrier to leveraging a large Power BI dataset is the link between Power BI Live connection reports and the dataset(s) in their app workspace. For example, if an organization wishes to create three Power BI apps targeting three separate business units, a separate Power BI dataset currently needs to be hosted within the app workspace for each app. Naturally, any BI/IT organization would want to avoid creating (and managing) copies of a Power BI dataset, including its data model, queries, and measures. </p>
<p class="calibre7">This barrier or limitation is being worked on by the Power BI team so that, at some point in the future, a single Power BI dataset is expected to be able to support reports hosted in multiple workspaces. This isolation between visualizations (reports and dashboards) and datasets would lend itself to the following solution architecture:</p>
<div class="cdpalignleft"><img src="images/000159.png" class="calibre444" /></div>
<div class="mce-root2">Power BI dataset supporting multiple app workspaces</div>
<p class="calibre7">As shown in the preceding diagram, a team's dataset designer(s) could be responsible for a single but potentially very large and complex Power BI dataset, including many fact and dimension tables. The dataset would be hosted in a premium capacity with v-cores and RAM aligned to its size and incremental data refresh could be configured to only load recent or new data. From a data visualization and distribution standpoint, report authors would create Live connection Power BI reports based on the large dataset (<kbd class="calibre15">AdWorks Enterprise</kbd>) and publish these reports to specific app workspaces. These reports would be refreshed based on the refresh schedule for the source dataset and, in the case of DirectQuery datasets, a scheduled cache refresh could be configured for the dashboards. </p>
<div class="packt_infobox">Although the capability suggested previously is not yet available, it's assumed that both the dataset workspace and the visualization workspaces (reports, dashboards) would need to be assigned to the same Premium capacity.</div>
<p class="calibre7">As of February 2018, no timeline has been provided on the availability of this feature. Therefore, even with support for incremental data refresh and very large datasets, the need to maintain a single, consolidated data model will lead many organizations to choose Analysis Services models for corporate BI solutions. Additional reasons for choosing Analysis Services models over Power BI Desktop are included in the Analysis Services section later in this chapter.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-409">
<div id="calibre_link-1233" class="calibre2">
<div id="calibre_link-1234" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Premium capacity nodes</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A premium capacity node can be thought of as a fully managed server in the Azure cloud which runs the Power BI service. The capacity node is dedicated and isolated to the organization that provisioned the capacity and the same user experience and functionality is delivered as the shared (free) capacity provided by the Power BI service. Each capacity node has a set of processing and memory resources (v-cores and RAM), bandwidth limits, and a cost that aligns with these resources. For example, a P1 capacity node includes 8 v-cores and 25 GB of RAM at a cost of $5,000 per month, while a P2 capacity includes 16 v-cores and 50 GB of RAM at a cost of $10,000 per month. When app workspaces containing Power BI content (datasets, reports, and dashboards) are assigned to premium capacity nodes, the resources of the given capacity node are used to execute Power BI activities associated with this content, such as query processing and data refresh operations.</p>
<p class="calibre7"><a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization</em>, referred to the v-cores (virtual processing cores) of Premium capacity nodes but didn't provide details on other resources (RAM and bandwidth) and their relationship to Power BI workloads. For example, if all Power BI reports will utilize a DirectQuery dataset or a Live connection to an Analysis Services model, then the amount of RAM provided per capacity will be much less important than the limits on the number of connections and the max page renders at peak times. In these deployments, the resources provisioned for the data source system (CPU cores, clock speed, and RAM), as well as the latency and bandwidth of the connection between the source system and the data center region of the Power BI tenant, would largely drive query performance.</p>
<p class="calibre7">The following table identifies the resources associated the six EM and P Premium capacity nodes currently available: </p>
<div class="cdpalignleft"><img src="images/000169.png" class="calibre445" /></div>
<div class="mce-root2">Premium capacity nodes</div>
<p class="calibre7">As shown in this table, as of February 2018 the largest premium capacity node includes 32 v-cores, 100 GB of RAM, and supports a max of 120 DirectQuery or Live connection queries per second. Larger capacity nodes, such as a P4 with 64 v-cores and 200 GB of RAM, will likely be released later in 2018 and will complement a scale out (multi-node) capacity as identified in the Power BI Premium whitepaper for October of 2017. </p>
<div class="packt_infobox">As shown in the <em class="calibre16">Custom application embedding</em> section of <a href="#calibre_link-36" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 11</a>, <em class="calibre16">Creating Power BI Apps and Content Distribution</em>, EM SKUs are exclusive to embedding Power BI content in applications and do not support viewing content in the Power BI service or Power BI mobile apps. Given these more limited workloads, EM SKUs have significantly less resources and cost less to provision. Premium P SKUs (P1, P2, and P3), however, support both embedding content in applications and the usage of the Power BI service.</div>
<p class="calibre7"><span>Microsoft Azure resources such as Azure Analysis Services or Azure SQL Database, which can be created within the same region as the Power BI service tenant, provide their own user interface and tools for scaling up and down as the needs of workloads dictate. Guidance on identifying the location of your Power BI tenant, and thus the preferred location for Power BI data sources, is included in the <em class="calibre16">Top gateway planning tasks</em> section of <a href="#calibre_link-15" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 9</a>, </span><em class="calibre16">Managing the On-Premises Data Gateway</em>. Th<span>e minimal distance between a Power BI tenant and an Azure data source in the same data center region provides a natural performance advantage over connections to on-premises sources via the On-premises data gateway.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-410">
<div id="calibre_link-1235" class="calibre2">
<div id="calibre_link-1236" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Frontend versus backend resources</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">It's important to understand the composition of frontend and backend resources in relation to Power BI workloads. For example, although a P2 capacity provides 16 total v-cores, only 8 backend cores are dedicated to processing queries, refreshing datasets, and server-side rendering of reports. Additionally, only the backend of a premium capacity node, such as the 50 GB of RAM for a P2 capacity, is exclusive to the provisioning organization. If Power BI is only being used to create reports and dashboards against DirectQuery or Live connection sources, then these backend resources are less important and the connection limit (60 per second for a P2 capacity) would be the most relevant resource to understand and monitor. </p>
<p class="calibre7">The frontend cores (8 for a P2) are shared with other organizations in a pool of servers responsible for the web service, the management of reports and dashboards, uploads/downloads, and the user experience in navigating the Power BI service generally. Organizations that utilize Power BI datasets in the default import (in-memory) mode will want to ensure sufficient RAM and backend cores are available to support both the data refresh process and the query workloads. </p>
<p class="calibre7">The following diagram illustrates the distribution of frontend and backend resources for a P2 capacity node:</p>
<div class="cdpalignleft"><img src="images/000179.png" class="calibre446" /></div>
<div class="mce-root2">Power BI Premium Capacity node (P2)</div>
<p class="calibre7">As shown in this diagram, the backend of a capacity node can be thought of as a dedicated server or virtual machine with a fixed amount of CPU and RAM. It's the backend server which is responsible for the most resource-intensive or <em class="calibre16">heavy lifting</em> operations and thus should always be considered in relation to the resource needs of import mode datasets assigned to the given capacity.</p>
<p class="calibre7">In the near future, organizations will be able to fully utilize the memory included in their capacity to host even larger Power BI datasets (100 GB+), containing hundreds of millions or even billions of rows. To support these scenarios, BI teams will want to provision a capacity node with enough cores and RAM to support the data refresh operation and user queries against this dataset. </p>
<div class="packt_tip pcalibre7 pcalibre6">A factor of 2.5X is generally used to size the RAM requirements of in-memory Power BI datasets and Analysis Services Tabular models. For example, a 10 GB Power BI dataset (<kbd class="calibre43">.PBIX</kbd>), would require 25 GB of RAM (10 * 2.5 = 25). This estimate is based on 10 GB to store the dataset in-memory, another 10 GB for a copy of the dataset which is created during full refresh/processing operations, and an extra 5 GB to support temporary memory structures that can be required to resolve user queries.</div>
<p class="calibre7">Note that this example is exclusive to import mode datasets hosted in the Power BI premium capacity (the backend server). A separate architecture and considerations for capacity nodes apply when query requests are routed to Analysis Services models via Live connection or a DirectQuery data source such as Teradata or SAP HANA. From a premium capacity perspective, in these scenarios, the BI team would need to determine via load testing and the usage metrics described in the <em class="calibre16">Monitor premium capacities</em> section of <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization</em>, whether the query throughput limit (60 per second for P2) to these sources will be sufficient. If this throughput level is sufficient yet performance is still unacceptable, several other components of the overall solution could represent the performance bottleneck and could be evaluated separately.</p>
<p class="calibre7">These other components or factors impacting performance include the design of the data model and the efficiency or complexity of DAX measures, the design of the data source and its available resources, the design of Power BI reports (for example, quantity and type of visuals), the resources and performance of the gateway server(s) if applicable, the network connection between the Power BI service and the data source, and the level of user interactivity with reports. Techniques and practices to optimize data models and the visualization layer in Power BI are provided in the <em class="calibre16">Data model optimizations</em> and <em class="calibre16">Report and visualization optimizations</em> sections later in this chapter, respectively.     </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-411">
<div id="calibre_link-1237" class="calibre2">
<div id="calibre_link-1238" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI Premium capacity allocation</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Although it's possible to broadly assign all app workspaces (and thus all content) of an organization to a single premium capacity, most organizations will want to efficiently allocate and manage these resources. For example, certain Power BI reports and dashboards that are utilized by executives or which contribute to important business processes will be identified and prioritized for premium capacity. In an initial deployment of a premium capacity, a BI/IT team may exclusively assign the workspaces associated with content considered mission critical to this capacity. This capacity may remain isolated to the specific workload(s) or, based on testing and monitoring, the BI team may determine that sufficient resources are available to support additional workspaces and their associated resource requirements.</p>
<p class="calibre7">Similar to provisioning a premium capacity exclusive to high-value content, a premium capacity may be provisioned due to the unique requirements of a particular solution. As one example, a new Power BI dataset may be developed that represents a data source or business process not currently supported in the data warehouse. In this scenario, a large import mode Power BI dataset, perhaps initially developed by the business team, would serve as the source for reports and dashboards which require distribution to many Power BI Free users or even the entire organization. Given these characteristics, a premium capacity node could be provisioned and dedicated to the app workspace hosting this dataset and its visualizations so that no other solution could impact its performance. </p>
<p class="calibre7">The following section describes a capacity planning method.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-412">
<div id="calibre_link-1239" class="calibre2">
<div id="calibre_link-1240" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Corporate and Self-Service BI capacity </h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">As described in the <em class="calibre16">Data governance for Power BI</em> section of <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>,  <span><em class="calibre16">Administering Power BI for an Organization</em>,</span> certain projects will likely be wholly owned by the BI/IT team including the report and visualization layer. Other projects, however, may be owned by business units or teams but still require or benefit from IT-provided resources such as the On-premises data gateway and premium capacity. The BI department can manage a continuous life cycle over both project types (Corporate BI, Self-Service BI) by validating use cases or requirements for premium capacity. Additionally, the migration of Power BI content across distinct premium capacities could become part of a standard migration process from a self-service solution to a corporate BI owned solution.</p>
<p class="calibre7">The provisioning and allocation of Power BI Premium capacity can further reflect an organization's support for both Corporate and Self-Service BI solutions. Typically the Power BI content created and managed by IT is considered mission critical to the organization or is accessed by a high volume of users. Self-service BI solutions, however, tend to utilize smaller datasets and usually need to be accessible to a smaller group of users.</p>
<p class="calibre7">The following example allocation includes two premium capacities, a <strong class="calibre6">P3</strong>, and a <strong class="calibre6">P2</strong>, dedicated to <strong class="calibre6">Corporate BI Capacity</strong> and <strong class="calibre6">Self-Service BI Capacity</strong> content, respectively:</p>
<div class="cdpalignleft"><img src="images/000189.png" class="calibre447" /></div>
<div class="mce-root2">Power BI Premium Capacity allocation: Corporate and Self-Service BI</div>
<p class="calibre7">As shown in the diagram the sales, and a finance app workspace have been assigned to a P3 capacity dedicated to corporate BI solutions. As described in the <em class="calibre16">Premium capacity nodes</em> section earlier, a P3 capacity is currently the largest premium capacity available with 32 v-cores. These additional resources and limits, such as a max of 120 DirectQuery or Live connection queries per second, may be required to support organization-wide usage and an optimal user experience.</p>
<p class="calibre7">The Human Resources and Purchasing workspaces, however, have been assigned to a P2 Premium capacity dedicated to self-service BI projects. For example, certain Power BI Pro users in these departments have developed datasets and reports that have proven to be valuable to several stakeholders. The assignment of these workspaces to premium capacity enables these users to make this content accessible to a wider audience, such as the 20 Power BI Free users in the Purchasing department.</p>
<div class="packt_tip pcalibre7 pcalibre6"><span>Remember that not all app workspaces will need to consume premium capacity resources. A team of Power BI Pro users may collaborate within an app workspace and still be effective with the content hosted in the shared capacity. Premium capacity is only needed in scenarios requiring broad distribution to read-only Power BI Free users or when the additional capabilities (for example, large datasets) identified in the <em class="calibre16">Power BI Premium capabilities</em> section earlier in this chapter are required.</span></div>
<p class="calibre7">In the event that one of the self-service solutions needs to be migrated to the corporate BI team, the BI team could re-assign the workspace to the existing P3 capacity. Alternatively, to avoid consuming any additional resources of the existing P3 capacity and potentially impacting these workloads, a new corporate BI capacity could be created for the workspace.</p>
<p class="calibre7">BI teams will consistently need to evaluate the trade-offs involved with isolating projects/solutions to specific premium capacities. Assigning a single workspace or multiple related workspaces to a dedicated capacity ensures that no other project or activity will impact performance. However, many dedicated premium capacities may become onerous to manage and could be an inefficient use of resources if the Power BI workload doesn't fully utilize the resources. Ultimately, teams will need to monitor capacity resource utilization and either re-allocate and re-assign capacities and workspaces, respectively, or provision additional premium resources (v-cores) and scale up existing capacities.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-413">
<div id="calibre_link-1241" class="calibre2">
<div id="calibre_link-1242" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Power BI Premium resource utilization</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Given the cost of premium capacity, BI teams will want to follow practices to ensure that these resources are actually required and not being used inefficiently. For example, with large import mode datasets, a simple design change such as the removal of unused columns from a fact table can significantly reduce the size of the dataset and thus the amount of memory needed. By following a series of recommended practices in terms of both modeling and report design, less premium capacity resources will be required to deliver the same query performance and scale. </p>
<div class="packt_tip pcalibre7 pcalibre6">With small-scale self-service BI datasets and reports, performance tuning and optimization is usually not necessary. Nonetheless, as these models and reports can later take on greater scale and importance, a basic review of the solution can be applied before the content is assigned to premium capacity. For example, the BI/IT team can identify a few small changes to be implemented prior to assigning the pro user's workspace to premium capacity.</div>
<p class="calibre7">The following two sections identify several of the top data modeling and report design practices to efficiently utilize hardware resources. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-414">
<div id="calibre_link-1243" class="calibre2">
<div id="calibre_link-1244" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Data model optimizations</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For many data models, particularly those that were developed as part of pilot projects or by business users, a number of modifications can be implemented to reduce resource requirements or improve query performance. Therefore, prior to concluding that a certain amount of Premium capacity (or Analysis Services resources) is required, data models can be evaluated against a number of standard design practices and optimization techniques such as the following:</p>
<ul class="calibre12">
<li class="calibre13">Avoid duplicate or near-duplicate data models:
<ul class="calibre17">
<li class="calibre13">Design and maintain a consolidated, standardized data model of fact and dimension tables.</li>
</ul>
</li>
<li class="calibre13">Remove tables and columns that aren't needed by the model:
<ul class="calibre17">
<li class="calibre13">For import mode models, columns with the unique values (cardinality) will be the most expensive to store and scan at query time.</li>
<li class="calibre13">The <em class="calibre16">Fact table columns</em> section of <a href="#calibre_link-23" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em> provides examples of avoiding derived columns that, for import mode models, can be efficiently implemented via DAX measures.</li>
</ul>
</li>
<li class="calibre13">Reduce the precision and cardinality of columns when possible:
<ul class="calibre17">
<li class="calibre13"><span>If four digits to the right of the decimal place are sufficient precision,</span> revise a column's data type from a <span>Decimal number</span> to a <span>Fixed decimal number</span> (19, 4):
<ul class="calibre17">
<li class="calibre13">Apply rounding if even less precision is required.</li>
</ul>
</li>
<li class="calibre13">Split columns containing multiple values such as a <kbd class="calibre15">datetime</kbd> column into separate columns (date and time).</li>
</ul>
</li>
<li class="calibre13">Limit or avoid high cardinality relationships, such as dimension tables with over 1.5 million rows:
<ul class="calibre17">
<li class="calibre13">Consider splitting very large dimension tables into two tables and defining relationships between these tables and the fact table. The less granular table (such as <kbd class="calibre15">Product Subcategory</kbd> grain) could support most reports while the more granular table (such as <kbd class="calibre15">Product</kbd>) could be used only when this granularity is required.</li>
</ul>
</li>
<li class="calibre13">Only use iterating DAX functions such as <kbd class="calibre15">SUMX()</kbd>, <kbd class="calibre15">RANKX()</kbd>, and <kbd class="calibre15">FILTER()</kbd> when either the table iterated over is small or when the row expression for these functions can be executed by the storage engine:
<ul class="calibre17">
<li class="calibre13">Simple expressions such as the multiplication of two columns from the table being iterated over can be executed by the storage engine.</li>
</ul>
</li>
<li class="calibre13">Use whole number (integer) data types instead of text data types whenever possible.</li>
<li class="calibre13">If the data model uses a DirectQuery data source, optimize this source such as with indexes or columnar technologies available such as the <kbd class="calibre15">Clustered Columnstore Index</kbd> for SQL Server:
<ul class="calibre17">
<li class="calibre13">Additionally, ensure that the source database supports referential integrity and that the DirectQuery model assumes referential integrity in its defined relationships. This will result in inner join queries to the source.
<ul class="calibre17">
<li class="calibre13">The Fact-to-dimension relationships section of <a href="#calibre_link-23" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chapter 3</a>, <em class="calibre16">Designing Import and DirectQuery Data Models</em>, contains additional details.<em class="calibre16"> </em></li>
</ul>
</li>
</ul>
</li>
<li class="calibre13">Avoid or limit <kbd class="calibre15">DISTINCTCOUNT()</kbd> measures against high cardinality columns:
<ul class="calibre17">
<li class="calibre13">For example, create the <kbd class="calibre15">DISTINCTCOUNT()</kbd> measure expression against the natural key or business key column identifying the dimension member (such as <kbd class="calibre15">Customer ABC</kbd>), rather than the columns used in the fact-to-dimension relationship. With slowly changing dimension processes, the relationship columns could store many more unique values per dimension member and thus reduce performance. </li>
</ul>
</li>
<li class="calibre13">Avoid the use of calculated DAX columns on fact tables:
<ul class="calibre17">
<li class="calibre13">Create these columns in the source system or in the queries used to load the model to allow for better data compression. </li>
<li class="calibre13">For DirectQuery models, avoid the use of DAX calculated columns for all tables.</li>
</ul>
</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-415">
<div id="calibre_link-1245" class="calibre2">
<div id="calibre_link-1246" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Report and visualization optimizations</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">A well-designed analytical model with ample resources can still struggle to produce adequate performance due to an inefficient visualization layer. The following list of techniques can be applied to Power BI reports and dashboards to reduce the query workload and avoid slower resource-intensive queries:  </p>
<ul class="calibre12">
<li class="calibre13">Create dashboards on top of reports to leverage cached query results representing the latest data refresh:<br class="calibre3" />
<ul class="calibre17">
<li class="calibre13">Unlike dashboards, report queries are sent and executed on the fly when Power BI reports are loaded.</li>
<li class="calibre13">Multiple dashboards can be linked together as described in <a href="#calibre_link-265" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chapter 7</a>, <em class="calibre16">Designing Power BI Dashboards and Architectures</em>.</li>
<li class="calibre13">If the dataset uses a DirectQuery or Live connection, take advantage of scheduled cache refresh as described in the <em class="calibre16">Dashboard cache refresh</em> section of <a href="#calibre_link-15" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chapter 9</a>, <em class="calibre16">Managing the On-Premises Data Gateway</em>.</li>
</ul>
</li>
<li class="calibre13">Avoid report visuals that return large amounts of data such as tables with thousands of rows and many columns:
<ul class="calibre17">
<li class="calibre13">Report visuals that require scrolling or which represent a data extract format should be filtered and summarized.</li>
<li class="calibre13">Report visuals that return more data points than necessary to address their business question can be modified to a lower granularity. For example, a dense scatter chart of individual products could be modified to use the less granular product subcategories column.  </li>
</ul>
</li>
<li class="calibre13">Ensure that filters are being applied to reports so that only the required data is returned:
<ul class="calibre17">
<li class="calibre13">Apply report level filters to only return the time periods needed (such as current year and last year).</li>
<li class="calibre13">Use visual level filters such as a top N filter as described in the <em class="calibre16">Visual-level filtering</em> section of <a href="#calibre_link-202" target="_blank" class="front-matter1 pcalibre1 pcalibre2 pcalibre pcalibre3">Chapter 5</a>, <em class="calibre16">Creating and Formatting Power BI Reports</em>.</li>
</ul>
</li>
<li class="calibre13">Limit the volume of visuals used on a given report page:
<ul class="calibre17">
<li class="calibre13">Optionally remove the interactions between visuals (cross-highlighting) to further reduce report queries.</li>
</ul>
</li>
<li class="calibre13">Understand which DAX measures are less performant and only use these measures when required:
<ul class="calibre17">
<li class="calibre13">For example, only use expensive measures in card visuals or within highly filtered visuals exposing only a few distinct numbers.</li>
</ul>
</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-416">
<div id="calibre_link-1247" class="calibre2">
<div id="calibre_link-1248" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Premium capacity estimations</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The volume of factors involved in premium capacity utilization makes it difficult to forecast the amount of premium capacity (and thus cost) required. This complexity is particularly acute for large deployments with diverse use cases to support. Additionally, for organizations relatively new to Power BI, the level and growth of user adoption, as well as the requirements for future projects, can be unclear. Nonetheless, to provide an initial estimate of the cost of deploying Power BI with premium capacities, Microsoft has developed the Power BI Premium calculator. This online forecasting tool provides free estimates of the combined monthly cost of Power BI Pro licenses and Power BI Premium capacity. </p>
<p class="calibre7">In the following screenshot of the Power BI Premium calculator, the user has specified 2,500 total Power BI users and used the two slider bars to distribute those users among the following profiles&mdash;<span>Pro Users</span>, <span>Frequent Users</span>, and <span>Occasional Users</span>:</p>
<div class="cdpalignleft"><img src="images/000199.png" class="calibre448" /></div>
<div class="mce-root2">Power BI Premium calculator</div>
<p class="calibre7">In the example, 170 Pro Users results in 170 Pro licenses costing a total of $1,700 per month (170 * $10/mo). More importantly, the calculator estimates that two P1 nodes (8 v-cores) of Premium capacity will be required for the organization at a cost of $9,990 per month (2 * $4,995/mo). Therefore, an organization could use $11,690 per month as an initial and high-level estimate of their Power BI deployment. The Power BI Premium calculator is accessible at the following URL <a href="http://bit.ly/2eKil1I" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2eKil1I</a>.</p>
<p class="calibre7">Thankfully the P1 month-to-month SKU eliminates the need for organizations to make large financial commitments in advance of actual usage. The 8 v-cores provided by a Premium P1 capacity (month-to-month) can be acquired in the Office 365 admin center as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000210.png" class="calibre449" /></div>
<div class="mce-root2">Premium Capacity: Month to month</div>
<p class="calibre7">In a fiscally conservative approach, an organization could create a single P1 capacity and test this capacity against different workloads until both the usage metrics described in the previous chapter and actual load test experiences suggest additional capacity is needed. Load testing of premium capacity typically consists of multiple users simulating normal user behaviors in the Power BI service such as clicking a slicer, pausing to view the results of a selection, and then making another filter selection. Additional options and guidance for load testing premium capacity are included in the <em class="calibre16">Power BI Premium Capacity Planning and Deployment Whitepaper</em> available at the following URL <a href="http://bit.ly/2Hu57DK" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2Hu57DK</a>.</p>
<p class="calibre7">Once it's determined that additional capacity is needed, an organization can simply provision another instance of a P1 (month-to-month) thus obtaining 16 total v-cores. In the following image from the <span>Purchase services</span> page of the Office 365 admin center, the quantity of an existing P1 (month-to-month) SKU can be revised: </p>
<div class="cdpalignleft"><img src="images/000220.png" class="calibre450" /></div>
<div class="mce-root2">Purchasing additional premium capacity</div>
<p class="calibre7">Selecting the ellipsis (...) at the bottom of the Premium SKU exposes the Change license quantity option. Once the number of premium instances has been increased and submitted, the additional v-cores will be available in the Capacity settings page of the Power BI admin portal. Creating and managing premium capacities, including the assignment of app workspaces to premium capacities, was described in <a href="#calibre_link-6" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 12</a>, <em class="calibre16">Administering Power BI for an Organization</em>.</p>
<p class="calibre7">With both v-core pooling and single-click scale up capabilities available in the Power BI admin portal it's very easy to reallocate premium capacity. In this example with 16 total v-cores purchased, an existing P1 capacity could be scaled up to a P2 capacity. Alternatively, a new and isolated P1 capacity could be created thus leaving two P1 capacities to handle the distinct workloads generated by different app workspaces.</p>
<p class="calibre7">The three-step process of purchasing additional v-cores, scaling up existing capacities or configuring new capacities, and testing workloads against premium capacities by assigning workspaces to those capacities will be repeated throughout the deployment life cycle. In the event that usage or resource needs decline, the monthly price for a P1 month-to-month instance can be avoided thus reducing the amount of v-cores available.</p>
<p class="calibre7">The flexibility of premium capacity and other cloud services such as Azure Analysis Services naturally aligns with the frequently changing needs of BI projects. The following sections describe both AAS and SSAS as a primary tool to complement Power BI Premium and to support large-scale enterprise deployments of Power BI.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-417">
<div id="calibre_link-1249" class="calibre2">
<div id="calibre_link-1250" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Analysis Services</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Analysis Services has been Microsoft's enterprise <strong class="calibre6">Online Analytical Processing</strong> (<strong class="calibre6">OLAP</strong>) BI engine for many years. The Analysis Services Tabular model including the DAX programming language, in-memory and columnar storage, and columnar compression was first introduced with Microsoft's entry to self-service business intelligence with Power Pivot for Excel 2010. Analysis Services Tabular, which now includes the Power Query M programming language and the optional DirectQuery storage mode described earlier in this book, is the default installation mode of SSAS 2017. Additionally, the Analysis Services Tabular engine is built into Excel, Power BI, and the Azure Analysis Services PaaS offering.</p>
<div class="packt_infobox">The data model built into Excel workbooks is limited to in-memory storage mode and does not support bi-directional relationships. Additionally, Excel workbooks containing data models are limited to 250 MB and cannot be used as sources for Live connection Power BI reports or via Analyze in Excel like published Power BI datasets. For these reasons and many other features exclusive to Power BI Desktop and Power BI datasets, Power BI Desktop is recommended over Excel for creating data models in almost all scenarios. </div>
<p class="calibre7"><span>SSAS also continues to support multidimensional mode instances, which consist of row and disk-based storage, and <strong class="calibre6">Multidimensional Expressions</strong> (<strong class="calibre6">MDX</strong>) for business logic. Despite structural advantages of tabular mode, multidimensional mode remains popular as it was available long before tabular mode and since it included many additional features relative to the initial releases of tabular mode. Power BI reports can leverage SSAS multidimensional models as Live connection data sources just like SSAS Tabular models and Microsoft has been clear that multidimensional mode will not be deprecated. However, multidimensional mode instances are currently not available in Azure Analysis Services and many new features and capabilities introduced in the past two years have been exclusive to tabular models.</span></p>
<p class="calibre7"><span>Analysis Services Tabular, either via SSAS or <strong class="calibre6">Azure Analysis Services</strong> (<strong class="calibre6">Azure AS</strong>) instances, is recommended over multidimensional mode for new enterprise BI models. Similar to Power BI Desktop over Excel for self-service modeling and reporting, this recommendation is better aligned with Microsoft's BI roadmap and thus entails access to new features and capabilities. Additionally, given the common underlying engine between Power BI and Analysis Services Tabular, experience with Analysis Services Tabular positions organizations to better manage the relationship between Self-Service BI and Corporate BI.</span></p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-418">
<div id="calibre_link-1251" class="calibre2">
<div id="calibre_link-1252" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Analysis Services Models versus Power BI Desktop</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>A local instance of Analysis Services Tabular is used by Power BI Desktop when creating both import and DirectQuery data models. When these models are published to the Power BI Service as Power BI Desktop (<kbd class="calibre15">.PBIX</kbd>) files, the Power BI service extracts the Analysis Services database from the Power BI Desktop file and provides an Analysis Services server instance for running the database in Power BI. However, despite this very deep integration with Analysis Services, Power BI Desktop is primarily targeted at business analysts and self-service BI, while Analysis Services is intended for business intelligence professionals and enterprise BI solutions.</span></p>
<p class="calibre7"><span>Given these different target personas and use cases, many features and capabilities of Analysis Services Tabular models are not available to Power BI Desktop. For example, BI/IT organizations generally utilize robust version control systems such as <strong class="calibre6">Visual Studio Team Services</strong> (<strong class="calibre6">VSTS</strong>) and multiple tools and programmatic interfaces to manage and administer their solutions. Additionally, there are modeling features of Analysis Services including <strong class="calibre6">Perspectives</strong>, <strong class="calibre6">Display Folders</strong>, and <strong class="calibre6">KPIs</strong> that are currently not accessible to dataset designers of Power BI datasets. </span></p>
<p class="calibre7"><span>The following table compares Power BI Desktop models to Analysis Services (Tabular) models across 19 features:</span></p>
<div class="cdpalignleft"><img src="images/000230.png" class="calibre451" /></div>
<div class="mce-root2">Power BI Desktop versus Analysis Services feature matrix</div>
<p class="calibre7">As shown in the table, Analysis Services Tabular models, whether deployed to SSAS or Azure AS instances, are able to provide both maximum modeling functionality to aid the user experience as well as rich administrative tools and interfaces. It's outside the scope of this chapter to describe each feature, but the following three sections summarize the primary incremental benefits provided by Analysis Services over Power BI datasets built with Power BI Desktop.</p>
<div class="packt_infobox">Per<span> the Power BI Premium capabilities section earlier in this chapter (see Capability #11), the same tools used to interface with Analysis Services servers will soon (2018) be available for app workspaces assigned to a Power BI premium capacity. For example, a BI team could use Visual Studio and <strong class="calibre6">SQL Server Management Studio</strong> (<strong class="calibre6">SSMS</strong>) for development and management of the Power BI dataset, respectively. Likewise, popular BI and data visualization tools such as Tableau could be used to connect to Power BI datasets stored in premium capacity. </span></div>
<p class="calibre7">In addition to the features identified in the table and described in the following sections, Analysis Services models avoid the dataset per app workspace limitation described in the Corporate Power BI datasets section earlier. A single Analysis Services model and its refresh process can be leveraged across multiple app workspaces and their corresponding Power BI apps.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-419">
<div id="calibre_link-1253" class="calibre2">
<div id="calibre_link-1254" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Scale</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Partitions are the key to scaling in-memory SSAS Tabular models as only certain partitions, such as the partitions representing the last two months of data, need to be included in a recurring refresh process.</p>
<p class="calibre7">These partitions can be defined in <strong class="calibre6">SQL Server Data Tools</strong> (<strong class="calibre6">SSDT</strong>) as shown in the following screenshot, and many patterns and practices have been documented for automating the management and refresh of partitions:</p>
<div class="cdpalignleft"><img src="images/000240.png" class="calibre452" /></div>
<div class="mce-root2">Partition Manager in SQL Server Data Tools (SSDT)</div>
<p class="calibre7">In the preceding screenshot, the <kbd class="calibre15">Reseller Sales</kbd> table is comprised of multiple yearly partitions (that is, <span>ResellerSales2018</span>). In most large models, the partitions would be much smaller (months, weeks) and logic would be built into a refresh process for dynamically determining which partitions to process and which (if any) to add or delete. Incremental data refresh for Power BI datasets hosted in Power BI Premium capacities is expected to offer the same essential as partitions in terms of minimizing refresh times and resources. However, it's unlikely that incremental data refresh will offer the same level of complete control.</p>
<p class="calibre7">Scaling out query workloads across multiple Analysis Services servers and implementing load balancing is also a very important feature of enterprise deployments. Azure Analysis Services greatly simplifies this setup and the planning involved by providing the following interface in the Azure portal:</p>
<div class="cdpalignleft"><img src="images/000251.png" class="calibre453" /></div>
<div class="mce-root2">Scale out via Replicas in Azure Analysis Services</div>
<p class="calibre7">As shown in the preceding screenshot, up to seven query replicas of an Azure Analysis Services server can be created. If the processing server responsible for the data refresh process is not separated from the querying pool, a total of eight analysis services servers would be available in the Azure cloud to resolve queries from Power BI and other tools such as Excel and Tableau with load balancing provided automatically by Azure Analysis Services.</p>
<div class="packt_infobox">In addition to the Azure portal interface, the Analysis Services REST API can be used to configure scale-out. </div>
<p class="calibre7">Scale out architectures are certainly also supported with SSAS Tabular in on-premises environments, but require significantly more planning and coordination to provision and configure the infrastructure. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-420">
<div id="calibre_link-1255" class="calibre2">
<div id="calibre_link-1256" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Usability</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Large enterprise models support many users from across the organization and typically each user only requires access to a section of the model. For example, a sales team member may only need to access a sales fact table and several dimension tables and thus shouldn't have to navigate through many other irrelevant tables that support other business teams. Perspectives in Analysis Services allow the modeler to map objects of the model (tables, columns, and measures) to a specific perspective such that users connecting to the model via the perspective only see those objects.</p>
<p class="calibre7">Display folders including hierarchies of folders (that is, subfolders) can be defined for Analysis Services models to simplify user access to measures and columns. In the following example from a Power BI Live connection report to an Analysis Services model, the measures associated with the <kbd class="calibre15">Internet Sales</kbd> and <kbd class="calibre15">Reseller Sales</kbd> fact tables have been grouped into display folders for each fact table:</p>
<div class="cdpalignleft"><img src="images/000261.png" class="calibre454" /></div>
<div class="mce-root2">Analysis Services Display Folders</div>
<p class="calibre7">Given the high volume of date intelligence measures, it's often best to isolate these measures so that the user can easily access the most common and basic measures such as total sales or the count of the products sold. </p>
<p class="calibre7">Another usability feature of Analysis Services not supported by Power BI currently includes support for multiple languages:</p>
<div class="cdpalignleft"><img src="images/000271.png" class="calibre455" /></div>
<div class="mce-root2">Multi-language support in Analysis Services</div>
<p class="calibre7">In Analysis Services projects within Visual Studio, the model author can export an empty JSON that contains placeholders for the translations, add string translations to the file, and then import the JSON file back to the model for access by users.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-421">
<div id="calibre_link-1257" class="calibre2">
<div id="calibre_link-1258" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Development and management tools</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Power BI Desktop is much closer to a Microsoft Office application than an <strong class="calibre6">integrated development environment</strong> (<strong class="calibre6">IDE</strong>) tool such as Visual Studio, which offers granular control over the data model. With Analysis Services, business intelligence developers and the teams responsible for Analysis Services models can take advantage of the rich development experience built into SSDT for Visual Studio, as well as familiar management capabilities available in <strong class="calibre6">SQL Server Management Studio</strong> (<strong class="calibre6">SSMS</strong>). Additionally, these same tools can be used for both AAS and SSAS models.</p>
<p class="calibre7">For example, the following screenshot from an Analysis Services project in Visual Studio 2017 exposes the <span>DAX Editor</span> window (left) and the Tabular Model Explorer interface (right):</p>
<div class="cdpalignleft"><img src="images/000281.png" class="calibre456" /></div>
<div class="mce-root2">DAX Editor and Tabular Model Explorer in Visual Studio</div>
<p class="calibre7">With the Tabular Model Explorer, the model developer has a central location to find, view, and optionally edit the objects of the model. This interface, along with the DAX Editor window, is very helpful when working with large models containing many tables and complex DAX expressions. </p>
<p class="calibre7">In terms of managing deployed models, SSMS provides a familiar object explorer interface and enhanced support for DAX queries, as shown in the following screenshot:</p>
<div class="cdpalignleft"><img src="images/000291.png" class="calibre457" /></div>
<div class="mce-root2">SQL Server Management Studio (SSMS)</div>
<p class="calibre7">In the preceding screenshot, the same data model (<span>AdWorksImport</span>) from Visual Studio is accessed from SSMS and an ad hoc DAX query is authored in the query window. In addition to the new <kbd class="calibre15">.MSDAX</kbd> files for DAX queries, <strong class="calibre6">Tabular Model Scripting Language</strong> (<strong class="calibre6">TMSL</strong>) commands can be scripted and executed in SSMS. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-422">
<div id="calibre_link-1259" class="calibre2">
<div id="calibre_link-1260" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Azure Analysis Services versus SSAS</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">For many organizations, the Power BI service is only a part of an existing and broader cloud-based data and analytics environment. For example, the organization may already be using the <strong class="calibre6">Azure Data Lake Store</strong> (<strong class="calibre6">ADLS</strong>), Azure SQL Database, or Azure SQL Data Warehouse cloud services to store and process data for reporting analysis. In other organizations, the adoption of the Power BI service as a primary BI and collaboration platform may be part of a larger migration from an on-premises BI environment to the cloud. As one example of this migration, existing <strong class="calibre6">extract-transform-load</strong> (<strong class="calibre6">ETL</strong>) packages executed via on-premises <strong class="calibre6">SQL Server Integration Services</strong> (<strong class="calibre6">SSIS</strong>) servers could be moved (lift and shift) to <strong class="calibre6">virtual machines</strong> (<strong class="calibre6">VMs</strong>) in Azure and managed through the Azure Data Factory cloud service.</p>
<p class="calibre7">Even if neither of these two scenarios applies in the short term, an organization may still choose Azure Analysis Services over SSAS to reap the cost, performance, and agility benefits <span>(scale-up/down) of this PaaS offering. With an Azure Analysis Services instance storing the data model(s) queried from Power BI within the same data region as the Power BI service tenant, the report and dashboard queries generated by Power BI avoid the latency incurred by accessing an on-premises SSAS instance via the On-premises data gateway. If data source(s) of the Analysis Services model remain on-premises, the same On-premises data gateway described in <a href="#calibre_link-15" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 9</a>, <em class="calibre16">Managing the On-Premises Data Gateway</em></span>, c<span>an be used to support a recurring data refresh process of Azure Analysis Services models from on-premises sources.</span></p>
<p class="calibre7"><span>Perhaps even more importantly than query performance, Azure Analysis Services dramatically reduces the following challenges with deploying SSAS at scale in enterprises:</span></p>
<ol class="calibre12">
<li class="chapter">Planning server resource requirements:
<ul class="calibre17">
<li class="chapter">It's difficult to accurately predict how much CPU and RAM will be needed by an Analysis Services server, even for the next 1-2 years. Additionally, the optimal hardware for Analysis Services, such as CPU clock speed and NUMA Awareness, is sometimes not fully communicated or delivered when provisioning these servers.</li>
<li class="chapter">With Azure AS, optimally tuned Analysis Services resources can be quickly and easily aligned to changing needs of the workload by switching pricing tiers. </li>
<li class="chapter">BI teams can even schedule Azure AS resources to be scaled up at certain times to support high query volumes (such as every Monday morning) and then scaled down or even paused at times of low query volume such as nights and weekends.</li>
</ul>
</li>
</ol>
<ol start="2" class="calibre12">
<li class="chapter">Installation and server maintenance:
<ul class="calibre17">
<li class="chapter">In an on-premises environment, SSAS has to be installed on the provisioned server and the server itself has to be managed and patched.</li>
<li class="chapter">As a PaaS offering, Azure AS servers are fully installed once deployed and the underlying servers are maintained by Microsoft to support 99.9 percent availability.</li>
</ul>
</li>
<li class="chapter">Implementing scale-out: 
<ul class="calibre17">
<li class="chapter">Provisioning the read-only query servers, the processing servers, and configuring load balancing can take weeks or longer in on-premises environments. </li>
<li class="chapter">As depicted in the Scale section earlier, Azure Analysis Services provides a graphical interface to easily configure a pool of read-only query replicas for distributing or balancing query requests. </li>
</ul>
</li>
</ol>
<p class="calibre7">These considerations specific to Analysis Services, as well as the broader advantages of a cloud architecture, serve as powerful motivation to choose Azure Analysis Services over SQL Server Analysis Services. For example, new features and enhancements to Azure Analysis Services are released more frequently than versions of SSAS, and some of these new features such as the Azure Analysis Services web designer are exclusive to the cloud service. Additionally, Azure AS instances are able to benefit from new capabilities and ongoing investments in other Azure services such as Azure Automation and Azure Functions. This is similar to the advantage of the Power BI service over the Power BI Report Server as described in <a href="#calibre_link-11" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 10</a>, <em class="calibre16">Deploying the Power BI Report Server</em>.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-2">
<div id="calibre_link-1261" class="calibre2">
<div id="calibre_link-1262" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">SSAS to Azure AS Migration</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>Organizations with existing SSAS Tabular models may choose to migrate to Azure Analysis Services to support their Power BI deployment and for other reasons identified in previous sections. This can be accomplished by deploying an existing on-premises model (<kbd class="calibre15">.bim</kbd> file) to an Azure Analysis Services instance from SSDT in Visual Studio.</span></p>
<p class="calibre7"><span>In the following screenshot, the deployment server of an existing SSAS model is changed to an Azure Analysis Services server:</span></p>
<div class="cdpalignleft"><img src="images/000301.png" class="calibre458" /></div>
<div class="mce-root2">Analysis Services Tabular project: Project properties page</div>
<p class="calibre7">This page can be accessed by right-clicking the Analysis Services project name in SSDT and selecting <span>Configuration Properties</span>. Via the <span>Do Not Process</span> from the <span>Processing Option</span> property, only the metadata of the model will be deployed to the Azure Analysis Services server. Additionally, note that the server name to ensure should be the management server name provided by Azure Analysis Services in the Azure portal as described in the following section. </p>
<p class="calibre7">With a successful deployment of the model's metadata from SSDT, the user can manage and process the Azure Analysis Services model in SSMS. In the following screenshot, the same <span>AdWorksImport</span> model is now deployed to both an on-premises server (ATLAS) and the Azure Analysis Services server:</p>
<div class="cdpalignleft"><img src="images/000311.png" class="calibre459" /></div>
<div class="mce-root2">SSAS and Azure Analysis Services instances in SSMS </div>
<p class="calibre7">As shown in the preceding screenshot, the <span>AdWorksImport</span> database is now deployed to both an on-premises instance of SQL Server Analysis Services (Tabular) and an Azure Analysis Services instance. The same functionality SSAS developers and managers are familiar with in SSMS, such as viewing and processing partitions and tables of models, is still fully supported with Azure Analysis Services. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-14">
<div id="calibre_link-1263" class="calibre2">
<div id="calibre_link-1264" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Provision Azure Analysis Services </h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Azure Analysis Services can be found within the <span>Data and Analytics</span> tab in the <span>Azure Marketplace</span>. Clicking the Analysis Services icon presents a configuration blade to define the new resource including its location (data center region) and pricing tier.</p>
<p class="calibre7">In the following <span>screenshot, </span>a new Azure AS instance (<kbd class="calibre15">Frontline</kbd>) is created in the <span>North Central US</span> region and for the <span>S0</span> pricing tier:</p>
<div class="cdpalignleft"><img src="images/000321.png" class="calibre460" /></div>
<div class="mce-root2">Provision Azure Analysis Services Instance</div>
<p class="calibre7">The view full pricing details link has been accessed in the preceding screenshot to expose additional SKUs currently supported. As of this writing, the largest Azure AS instance is an S9 with 640 <strong class="calibre6">Query Processing Units</strong> (<strong class="calibre6">QPUs</strong>) and 400 GB of memory. A single virtual core is currently approximately equal to 25 QPUs and thus an S9 server instance can be estimated at 25 to 26 virtual cores (640 / 25 = 25.6). The full list of SKUs, including the Basic tier (B1, B2) and additional details on pricing, is available at the Analysis Services Pricing page <a href="http://bit.ly/2ooOKQI" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2ooOKQI</a>.</p>
<div class="packt_infobox">The location of the Azure Analysis Services instance should match the location of the Power BI service tenant. The location of the Power BI Service tenant can be found via the About Power BI menu item under the question mark icon in the Power BI Service as illustrated in the <em class="calibre16">Identify where the gateway should be installed</em> section of <a href="#calibre_link-15" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 9</a>, <em class="calibre16">Managing the On-Premises Data Gateway</em>.</div>
<p class="calibre7">Once all required input boxes have been completed, clicking create starts the deployment process, which typically requires less than a minute. By default, the deployed Azure AS resource will be running but can be paused to avoid incurring any further charges, as shown in the following screenshot from the <span>Overview</span> page:</p>
<div class="cdpalignleft"><img src="images/000331.png" class="calibre461" /></div>
<div class="mce-root2">Deployed and running Azure Analysis Services instance</div>
<p class="calibre7">As shown in the preceding screenshot, both a <span>Server name</span> and a <span>Management Server Name</span> are provided on the <span>Overvie</span><span>w</span> tab. The <span>Server name</span> is what should be used by client applications such as Power BI Desktop and Excel. The <span>Management Server Name</span>, which includes an <span>:rw</span> qualifier, should be used in SSMS, SSDT, and other operational or administrative tools such as PowerShell. </p>
<div class="packt_tip pcalibre7 pcalibre6">A server name alias can be created to provide a more friendly server name when creating reports. The alias created is specified as an endpoint using the <kbd class="calibre43">link://</kbd> format and the alias endpoint returns the real server name in order to connect to the server. Details on created Azure Analysis Services server aliases are available at the following URL <a href="http://bit.ly/2EN2LC3" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">http://bit.ly/2EN2LC3</a>.</div>
<p class="calibre7">In addition to the Azure AS resource itself, if a data model on the Azure AS server needs to retrieve data from an on-premises source, it will be necessary to create an On-premises data gateway resource in the Azure portal as well. The Azure Analysis Services section of <a href="#calibre_link-15" target="_blank" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3">Chapter 9</a>, <em class="calibre16">Managing the On-Premises Data Gateway</em>, includes details on creating and configuring this resource. </p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-28">
<div id="calibre_link-1265" class="calibre2">
<div id="calibre_link-1266" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Migration of Power BI Desktop to Analysis Services</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">The Azure Analysis Services web designer, currently in preview, supports the ability to import a data model contained within a Power BI Desktop file. The imported or migrated model can then take advantage of the resources available to the Azure Analysis Services server and can be accessed from client tools such as Power BI Desktop. Additionally, Azure Analysis Services provides a Visual Studio project file and a <kbd class="calibre15">Model.bim</kbd> file for the migrated model that a corporate BI team can use in SSDT for Visual Studio.</p>
<p class="calibre7">The following process migrates the model within a Power BI Desktop file to an Azure Analysis Server and downloads the Visual Studio project file for the migrated model: </p>
<ol class="calibre12">
<li class="chapter">Open the Web designer from the <span>Overview</span> page of the Azure Analysis Services resource in the Azure portal</li>
<li class="chapter">On the <span>Models</span> form, click <span>Add</span> and then provide a name for the new model in the <span>New model</span> form</li>
<li class="chapter">Select the <span>Power BI Desktop File</span> source icon at the bottom and choose the file on the <span>Import</span> menu</li>
</ol>
<p class="calibre7"> </p>
<ol start="4" class="calibre12">
<li class="chapter">Click <span>Import</span> to begin the migration process</li>
</ol>
<p class="calibre156">The following screenshot represents these four steps from the Azure Analysis Services web designer:</p>
<div class="cdpalignleft"><img src="images/000341.png" class="calibre462" /></div>
<div class="mce-root2">Create an Analysis Services model from a Power BI Desktop File</div>
<p class="calibre156">In this example, a Power BI Desktop file (<kbd class="calibre15">AdWorks Enterprise.pbix</kbd>) that contains an import mode model based on two on-premises sources (SQL Server and Excel) is imported via the Azure Analysis Services web designer. </p>
<p class="calibre156">Once the import is complete, the <span>Field</span> list from the model will be exposed on the right and the imported model will be accessible from client tools like any other Azure Analysis Services model. For example, refreshing the Azure AS server in SQL Server Management Studio will expose the new database (<span>AdWorks Enterprise</span>). Likewise, the Azure Analysis Services database connection in Power BI Desktop (<span>Get Data</span> | <span>Azure</span>) can be used to connect to the migrated model, as shown in the following <span>screenshot</span>:</p>
<div class="cdpalignleft"><img src="images/000351.png" class="calibre463" /></div>
<div class="mce-root2">Migrated Model accessed from Azure as server in Power BI Desktop</div>
<p class="calibre156">Just like the SQL Server Analysis Services database connection (<span>Get Data</span> | <span>Database</span>), the only required field is the name of the server which is provided in the Azure portal as described in the <em class="calibre16">Provision Azure Analysis Service</em>s section earlier.</p>
<ol start="5" class="calibre12">
<li class="chapter">From the <span>Overview</span> page of the Azure Analysis Services resource, select the <span>Open in Visual Studio</span> project option from the context menu on the far right, as shown in the following <span>screenshot</span>:</li>
</ol>
<div class="cdpalignleft"><img src="images/000361.png" class="calibre464" /></div>
<div class="mce-root2">Context menu in Azure Portal for a model</div>
<ol start="6" class="calibre12">
<li class="chapter">Save the zip file provided by Azure Analysis Services to a secure local network location.</li>
<li class="chapter">Extract the files from the zip file to expose the Analysis Services project and <kbd class="calibre15">.bim</kbd> file, as shown in the following <span>screenshot</span>:</li>
</ol>
<div class="cdpalignleft"><img src="images/000371.png" class="calibre465" /></div>
<div class="mce-root2">Folder contents downloaded from Azure Analysis Services</div>
<ol start="8" class="calibre12">
<li class="chapter">In Visual Studio, open a project/solution (<span>File</span> | <span>Open</span> | <span>Project/Solutio</span>n) and navigate to the downloaded project file (<kbd class="calibre15">.smproj</kbd>). Select the project file and click <span>Open</span>. </li>
<li class="chapter">Double-click the <kbd class="calibre15">Model.bim</kbd> file in the Solution Explorer window to expose the metadata of the migrated model. </li>
</ol>
<p class="calibre7">All of the objects of the data model built into the Power BI Desktop file including <span>Data Sources</span>, <span>Queries</span>, and <span>Measures</span> are accessible in SSDT just like standard Analysis Services projects, as shown in the following <span>screenshot</span>:</p>
<div class="cdpalignleft"><img src="images/000380.png" class="calibre466" /></div>
<div class="mce-root2">Migrated model opened as Analysis Services Project</div>
<p class="calibre7">The preceding screenshot from <span>Diagram</span> view in SQL Server Data Tools exposes the two on-premises sources of the imported PBIX file via the Tabular Model Explorer window. By default, the deployment server of the Analysis Services project in SSDT is set to the Azure Analysis Services server, but this can be revised as was described in the <em class="calibre16">SSAS to Azure AS Migration</em> section earlier. </p>
<div class="packt_tip pcalibre7 pcalibre6">Since the ability to import a Power BI Desktop file directly in SSDT is not yet available, BI teams with on-premises SSAS environments could temporarily provision an Azure Analysis Services server to support migrations. Once the project file is downloaded from Azure, the Azure AS server could be paused or deleted and the deployment server property in the project could be revised to an SSAS server.</div>
<p class="calibre7">As an alternative to a new solution with a single project, an existing solution with an existing Analysis Services project could be opened and the new project from the migration could be added to this solution. This can be accomplished by right-clicking the existing solution's name in the Solution Explorer window and selecting the <span>Existing project</span> from the <span>Ad</span><span>d</span> menu (<span>Add</span> | <span>Existing project</span>). </p>
<p class="calibre7">This approach allows the corporate BI developer to view and compare both models and optionally implement incremental changes, such as new columns or measures that were exclusive to the Power BI Desktop file.</p>
<p class="calibre7">The following <span>screenshot </span>from a solution in Visual Studio includes both the migrated model (via the project file) and an existing Analysis Services model (<span>AdWorks Import</span>):</p>
<div class="cdpalignleft"><img src="images/000390.png" class="calibre467" /></div>
<div class="mce-root2">Tabular Model Explorer</div>
<p class="calibre7">The ability to quickly migrate Power BI datasets to Analysis Services models complements the flexibility and scale of Power BI Premium capacity in allowing organizations to manage and deploy Power BI on their terms.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-39">
<div id="calibre_link-1267" class="calibre2">
<div id="calibre_link-1268" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">This chapter reviewed Power BI Premium and Analysis Services as the primary means to deploy Power BI at scale and with enterprise BI tools and controls. The current and future features of Power BI Premium were described, as well as the factors to account for inefficiently provisioning and allocating premium capacity. Additionally, Analysis Services was contrasted with Power BI Desktop-based datasets to expose the features and benefits exclusive to Microsoft's enterprise BI modeling tool. Moreover, details were provided in comparing Azure Analysis Services with SSAS and in migrating a Power BI Desktop model to Analysis Services. </p>
<p class="calibre7">Power BI Premium and Analysis Services further Microsoft's goal of providing organizations with the flexibility to deploy Power BI on their terms. Organizations can quickly scale up a self-service solution to support many users and they can also migrate self-service content to IT-owned corporate BI solutions. The common modeling engine between Power BI and Analysis Services, as well as the elastic nature of cloud resources, serves to both reduce the friction between self-service and corporate BI, and reduce the time and costs associated with delivering BI solutions.</p>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-51">
<div id="calibre_link-1269" class="calibre2">
<div id="calibre_link-1270" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Other Books You May Enjoy</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7"><span>If you enjoyed this book, you may be interested in these other books by Packt:</span></p>
<p class="calibre7"><a href="https://www.packtpub.com/big-data-and-business-intelligence/microsoft-power-bi-cookbook" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3"><img src="images/000400.png" width="302" height="373" class="calibre468" /></a></p>
<p class="calibre7"><strong class="calibre6">Microsoft Power BI Cookbook</strong><br class="calibre3" />
<span>Brett Powell</span></p>
<p class="calibre7">ISBN: <span>978-1-78829-014-2</span></p>
<ul class="calibre12">
<li class="calibre13">Cleanse, stage, and integrate your data sources with Power BI</li>
<li class="calibre13">Abstract data complexities and provide users with intuitive, self-service BI capabilities</li>
<li class="calibre13">Build business logic and analysis into your solutions via the DAX programming language and dynamic, dashboard-ready calculations</li>
<li class="calibre13">Take advantage of the analytics and predictive capabilities of Power BI</li>
<li class="calibre13">Make your solutions more dynamic and user specific and/or defined including use cases of parameters, functions, and row level security</li>
<li class="calibre13">Understand the differences and implications of DirectQuery, Live Connections, and Import-Mode Power BI datasets and how to deploy content to the Power BI Service and schedule refreshes</li>
<li class="calibre13">Integrate other Microsoft data tools such as Excel and SQL Server Reporting Services into your Power BI solution</li>
</ul>
<p class="calibre7"><a href="https://www.packtpub.com/big-data-and-business-intelligence/mastering-qlik-sense" class="pcalibre1 pcalibre2 pcalibre calibre9 pcalibre3"><img src="images/000410.png" width="302" height="373" class="calibre468" /></a></p>
<p class="calibre7"><strong class="calibre6">Mastering Qlik Sense</strong><br class="calibre3" />
<span>Martin Mahler, Juan Ignacio Vitantonio</span></p>
<p class="calibre7">ISBN: <span>978-1-78355-402-7</span></p>
<ul class="calibre12">
<li class="calibre13">Understand the importance of self-service analytics and the IKEA-effect</li>
<li class="calibre13">Explore all the available data modeling techniques and create efficient and optimized data models</li>
<li class="calibre13">Master security rules and translate permission requirements into security rule logic</li>
<li class="calibre13">Familiarize yourself with different types of Master Key Item(MKI) and know how and when to use MKI.</li>
<li class="calibre13">Script and write sophisticated ETL code within Qlik Sense to facilitate all data modeling and data loading techniques</li>
<li class="calibre13">Get an extensive overview of which APIs are available in Qlik Sense and how to take advantage of a technology with an API</li>
<li class="calibre13">Develop basic mashup HTML pages and deploy successful mashup projects</li>
</ul>


            </article>

            
        </section>
    </div>
</div>
</div>


<div class="calibre1" id="calibre_link-423">
<div id="calibre_link-1271" class="calibre2">
<div id="calibre_link-1272" class="calibre3"><section class="calibre4">

                            <header class="calibre5">
                    <h1 class="header-title">Leave a review - let other readers know what you think</h1>
                </header>
            
            <article class="calibre5">
                
<p class="calibre7">Please share your thoughts on this book with others by leaving a review on the site that you bought it from. <span>If you purchased the book from Amazon, please leave us an honest review on this book's Amazon page.</span> This is vital so that other potential readers can see and use your unbiased opinion to make purchasing decisions, we can understand what our customers think about our products, and our authors can see your feedback on the title that they have worked with Packt to create. It will only take a few minutes of your time, but is valuable to other potential customers, our authors, and Packt. Thank you!</p>


            </article>

            
        </section>
    </div>
</div>
</div>


</body></html>